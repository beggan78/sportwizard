/*! For license information please see main.22bbc86e.js.LICENSE.txt */
(()=>{var e={180(e,t,a){"use strict";a.r(t),a.d(t,{getAllPositions:()=>w,getBottomSubstitutePosition:()=>j,getFormationPositions:()=>h,getFormationPositionsWithGoalie:()=>p,getInitialFormationTemplate:()=>f,getMaxInactiveCount:()=>k,getModeDefinition:()=>m,getOutfieldPositions:()=>v,getPlayerCountForMode:()=>x,getSubstitutePositions:()=>N,getValidPositions:()=>S,getValidationMessage:()=>g,hasMultipleSubstitutes:()=>b,initializePlayerRoleAndStatus:()=>T,supportsInactiveUsers:()=>y});var n=a(555),r=a(816),s=a(935),i=a(239),o=a(829);const l={[s.FORMATS.FORMAT_5V5]:{[s.FORMATIONS.FORMATION_2_2]:{fieldPositions:["leftDefender","rightDefender","leftAttacker","rightAttacker"],positions:{leftDefender:r.q.DEFENDER,rightDefender:r.q.DEFENDER,leftAttacker:r.q.ATTACKER,rightAttacker:r.q.ATTACKER},expectedRoleCounts:{[r.q.DEFENDER]:2,[r.q.ATTACKER]:2}},[s.FORMATIONS.FORMATION_1_2_1]:{fieldPositions:["defender","left","right","attacker"],positions:{defender:r.q.DEFENDER,left:r.q.MIDFIELDER,right:r.q.MIDFIELDER,attacker:r.q.ATTACKER},expectedRoleCounts:{[r.q.DEFENDER]:1,[r.q.MIDFIELDER]:2,[r.q.ATTACKER]:1}}},[s.FORMATS.FORMAT_7V7]:{[s.FORMATIONS.FORMATION_2_2_2]:{fieldPositions:["leftDefender","rightDefender","leftMidfielder","rightMidfielder","leftAttacker","rightAttacker"],positions:{leftDefender:r.q.DEFENDER,rightDefender:r.q.DEFENDER,leftMidfielder:r.q.MIDFIELDER,rightMidfielder:r.q.MIDFIELDER,leftAttacker:r.q.ATTACKER,rightAttacker:r.q.ATTACKER},expectedRoleCounts:{[r.q.DEFENDER]:2,[r.q.MIDFIELDER]:2,[r.q.ATTACKER]:2}},[s.FORMATIONS.FORMATION_2_3_1]:{fieldPositions:["leftDefender","rightDefender","leftMidfielder","centerMidfielder","rightMidfielder","attacker"],positions:{leftDefender:r.q.DEFENDER,rightDefender:r.q.DEFENDER,leftMidfielder:r.q.MIDFIELDER,centerMidfielder:r.q.MIDFIELDER,rightMidfielder:r.q.MIDFIELDER,attacker:r.q.ATTACKER},expectedRoleCounts:{[r.q.DEFENDER]:2,[r.q.MIDFIELDER]:3,[r.q.ATTACKER]:1}}}},c=(e,t)=>{const a={goalie:null};return e.fieldPositions.forEach(e=>{a[e]=null}),t.forEach(e=>{a[e]=null}),a},d=(e,t)=>(0,n.A)((0,n.A)({goalie:{key:"goalie",role:r.q.GOALIE}},(e=>Object.fromEntries(Object.entries(e.positions).map(e=>{let[t,a]=e;return[t,{key:t,role:a}]})))(e)),(e=>Object.fromEntries(e.map(e=>[e,{key:e,role:r.q.SUBSTITUTE}])))(t)),u=new Map,m=e=>{if(!e)return null;const t=JSON.stringify(e);if(u.has(t))return u.get(t);const a=e.format||s.FORMATS.FORMAT_5V5,n=(l[a]||{})[e.formation];if(!n)return console.warn("Unknown formation: ".concat(e.formation," for format ").concat(a)),null;const r=((e,t,a,n)=>{const{format:r,squadSize:s,formation:i}=e,o=d(t,a),l=((e,t)=>({outfield:e+t,onField:e}))(n,a.length),u=["goalie",...t.fieldPositions,...a],m=0===(h=a.length)?"none":1===h?"simple":2===h?"carousel":"advanced_carousel";var h;return{format:r,squadSize:s,formation:i,positions:o,expectedCounts:l,positionOrder:u,fieldPositions:t.fieldPositions,substitutePositions:a,supportsInactiveUsers:a.length>0,hasMultipleSubstitutes:a.length>=2,substituteRotationPattern:m,initialFormationTemplate:c(t,a),validationMessage:"Please complete the team formation with 1 goalie and ".concat(s-1," unique outfield players.")}})(e,n,((e,t)=>{const a=(s.FORMAT_CONFIGS[e]||s.FORMAT_CONFIGS[s.FORMATS.FORMAT_5V5]).fieldPlayers,n=Math.max(0,t-(a+s.GAME_CONSTANTS.GOALIE_COUNT));return Array.from({length:n},(e,t)=>"substitute_".concat(t+1))})(a,e.squadSize),(s.FORMAT_CONFIGS[a]||s.FORMAT_CONFIGS[s.FORMATS.FORMAT_5V5]).fieldPlayers);return u.set(t,r),r};function h(e){const t=m(e);return t?t.fieldPositions:[]}function p(e){const t=m(e);if(!t)return[];return[...(0,o.a)(t.fieldPositions),"goalie",...t.substitutePositions]}function f(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const a=m(e);if(!a)return{};const r=(0,n.A)({},a.initialFormationTemplate);return t&&(r.goalie=t),r}function g(e){const t=m(e);return t?t.validationMessage:"Invalid team configuration"}function v(e){const t=m(e);return t?[...t.fieldPositions,...t.substitutePositions]:[]}function y(e){const t=m(e);return!!t&&t.supportsInactiveUsers}function b(e){const t=m(e);return!!t&&t.hasMultipleSubstitutes}function x(e){return e?e.squadSize:null}function w(e){const t=m(e);return t?t.positionOrder:[]}function S(e){const t=m(e);return t?t.positionOrder:[]}function k(e){const t=m(e);return t?t.substitutePositions.length:0}function N(e){const t=m(e);return t?t.substitutePositions:[]}function j(e){const t=m(e);return t&&t.substitutePositions.length?t.substitutePositions[t.substitutePositions.length-1]:null}function T(e,t,a){const n=m(a);if(!n)return{currentRole:r.q.SUBSTITUTE,currentStatus:r.P.SUBSTITUTE};for(const[s,o]of Object.entries(t))if(o===e){const e=n.positions[s];if(e){const t=(0,i.GY)(e.role);let a;return(0,i.XG)(t,"initializePlayerRoleAndStatus for position ".concat(s)),a="goalie"===s?r.P.GOALIE:n.fieldPositions.includes(s)?r.P.ON_FIELD:n.substitutePositions.includes(s)?r.P.SUBSTITUTE:t,{currentRole:t,currentStatus:a,currentPositionKey:s}}}return{currentRole:r.q.SUBSTITUTE,currentStatus:r.P.SUBSTITUTE,currentPositionKey:"substitute_1"}}},150(e,t,a){"use strict";a.r(t),a.d(t,{DEFAULT_MATCH_TYPE:()=>s,MATCH_TYPES:()=>n,getMatchTypeOptions:()=>r});const n={FRIENDLY:"friendly",INTERNAL:"internal",LEAGUE:"league",TOURNAMENT:"tournament",CUP:"cup"},r=e=>[{value:n.LEAGUE,label:e("configuration:matchTypes.league.label"),description:e("configuration:matchTypes.league.description")},{value:n.FRIENDLY,label:e("configuration:matchTypes.friendly.label"),description:e("configuration:matchTypes.friendly.description")},{value:n.CUP,label:e("configuration:matchTypes.cup.label"),description:e("configuration:matchTypes.cup.description")},{value:n.TOURNAMENT,label:e("configuration:matchTypes.tournament.label"),description:e("configuration:matchTypes.tournament.description")},{value:n.INTERNAL,label:e("configuration:matchTypes.internal.label"),description:e("configuration:matchTypes.internal.description")}],s=n.LEAGUE},211(e,t,a){"use strict";a.r(t),a.d(t,{DEFAULT_VENUE_TYPE:()=>r,VENUE_TYPES:()=>n,getVenueTypeOptions:()=>s});const n={HOME:"home",AWAY:"away",NEUTRAL:"neutral"},r=n.HOME,s=e=>[{value:n.HOME,label:e("configuration:venueTypes.home.label"),description:e("configuration:venueTypes.home.description")},{value:n.AWAY,label:e("configuration:venueTypes.away.label"),description:e("configuration:venueTypes.away.description")},{value:n.NEUTRAL,label:e("configuration:venueTypes.neutral.label"),description:e("configuration:venueTypes.neutral.description")}]},816(e,t,a){"use strict";a.d(t,{P:()=>r,q:()=>n});const n={GOALIE:"GOALIE",DEFENDER:"DEFENDER",ATTACKER:"ATTACKER",MIDFIELDER:"MIDFIELDER",SUBSTITUTE:"SUBSTITUTE",FIELD_PLAYER:"FIELD_PLAYER",UNKNOWN:"UNKNOWN"},r={ON_FIELD:"on_field",SUBSTITUTE:"substitute",GOALIE:"goalie"}},239(e,t,a){"use strict";a.d(t,{GY:()=>c,XG:()=>u,XO:()=>d,x8:()=>l});var n=a(816);const r={[n.q.GOALIE]:"goalie",[n.q.DEFENDER]:"defender",[n.q.ATTACKER]:"attacker",[n.q.MIDFIELDER]:"midfielder",[n.q.SUBSTITUTE]:"substitute",[n.q.FIELD_PLAYER]:"defender",[n.q.UNKNOWN]:"unknown"},s=(n.q.GOALIE,n.q.DEFENDER,n.q.ATTACKER,n.q.MIDFIELDER,n.q.SUBSTITUTE,n.q.FIELD_PLAYER,n.q.UNKNOWN,{goalie:n.q.GOALIE,defender:n.q.DEFENDER,attacker:n.q.ATTACKER,midfielder:n.q.MIDFIELDER,substitute:n.q.SUBSTITUTE,unknown:n.q.UNKNOWN}),i={Goalie:n.q.GOALIE,Defender:n.q.DEFENDER,Attacker:n.q.ATTACKER,Midfielder:n.q.MIDFIELDER,Substitute:n.q.SUBSTITUTE,Field:n.q.FIELD_PLAYER,Unknown:n.q.UNKNOWN},o={[n.q.ATTACKER]:1,[n.q.MIDFIELDER]:2,[n.q.DEFENDER]:3,[n.q.GOALIE]:4,[n.q.SUBSTITUTE]:5,[n.q.UNKNOWN]:5};function l(e){if(!e)return console.warn("roleToDatabase: No role provided, defaulting to unknown"),r[n.q.UNKNOWN];const t=r[e];return t||(console.warn('roleToDatabase: Unknown role "'.concat(e,'", defaulting to unknown')),r[n.q.UNKNOWN])}function c(e){if(!e)return n.q.UNKNOWN;const t=String(e).trim();if(Object.values(n.q).includes(t))return t;const a=s[t.toLowerCase()];if(a)return a;const r=i[t];if(r)return r;const o=t.toUpperCase();return Object.values(n.q).includes(o)?o:(console.warn('normalizeRole: Could not normalize role "'.concat(e,'", defaulting to UNKNOWN')),n.q.UNKNOWN)}function d(e){const t=o[e];return void 0===t?(console.warn('getRolePriority: Unknown role "'.concat(e,'", returning lowest priority')),o[n.q.UNKNOWN]):t}function u(e){}},935(e,t,a){"use strict";a.r(t),a.d(t,{FORMATIONS:()=>o,FORMATION_DEFINITIONS:()=>l,FORMATS:()=>r,FORMAT_CONFIGS:()=>c,GAME_CONSTANTS:()=>s,MAX_SQUAD_SIZE_BY_FORMAT:()=>i,createDefaultTeamConfig:()=>g,createTeamConfig:()=>m,getMaximumPlayersForFormat:()=>u,getMinimumPlayersForFormat:()=>d,getValidFormations:()=>h,validateAndCorrectTeamConfig:()=>f,validateTeamConfig:()=>p});var n=a(555);const r={FORMAT_5V5:"5v5",FORMAT_7V7:"7v7"},s={FIELD_PLAYERS_5V5:4,GOALIE_COUNT:1,MIN_SQUAD_SIZE:5,DEFAULT_MAX_SQUAD_SIZE:15},i={[r.FORMAT_5V5]:11,[r.FORMAT_7V7]:15,"9v9":19},o={FORMATION_2_2:"2-2",FORMATION_1_2_1:"1-2-1",FORMATION_1_3:"1-3",FORMATION_1_1_2:"1-1-2",FORMATION_2_1_1:"2-1-1",FORMATION_2_2_2:"2-2-2",FORMATION_2_3_1:"2-3-1",FORMATION_3_3:"3-3",FORMATION_1_3_2:"1-3-2",FORMATION_2_1_3:"2-1-3",FORMATION_3_2_1:"3-2-1",FORMATION_3_1_2:"3-1-2"},l={[o.FORMATION_2_2]:{label:"2-2",status:"available",formats:[r.FORMAT_5V5]},[o.FORMATION_1_2_1]:{label:"1-2-1",status:"available",formats:[r.FORMAT_5V5]},[o.FORMATION_1_3]:{label:"1-3",status:"coming-soon",formats:[r.FORMAT_5V5]},[o.FORMATION_1_1_2]:{label:"1-1-2",status:"coming-soon",formats:[r.FORMAT_5V5]},[o.FORMATION_2_1_1]:{label:"2-1-1",status:"coming-soon",formats:[r.FORMAT_5V5]},[o.FORMATION_2_2_2]:{label:"2-2-2",status:"available",formats:[r.FORMAT_7V7]},[o.FORMATION_2_3_1]:{label:"2-3-1",status:"available",formats:[r.FORMAT_7V7]},[o.FORMATION_3_3]:{label:"3-3",status:"coming-soon",formats:[r.FORMAT_7V7]},[o.FORMATION_1_3_2]:{label:"1-3-2",status:"coming-soon",formats:[r.FORMAT_7V7]},[o.FORMATION_2_1_3]:{label:"2-1-3",status:"coming-soon",formats:[r.FORMAT_7V7]},[o.FORMATION_3_2_1]:{label:"3-2-1",status:"coming-soon",formats:[r.FORMAT_7V7]},[o.FORMATION_3_1_2]:{label:"3-1-2",status:"coming-soon",formats:[r.FORMAT_7V7]}},c={[r.FORMAT_5V5]:{label:"5v5",fieldPlayers:4,defaultFormation:o.FORMATION_2_2,formations:[o.FORMATION_2_2,o.FORMATION_1_2_1,o.FORMATION_1_3,o.FORMATION_1_1_2,o.FORMATION_2_1_1]},[r.FORMAT_7V7]:{label:"7v7",fieldPlayers:6,defaultFormation:o.FORMATION_2_2_2,formations:[o.FORMATION_2_2_2,o.FORMATION_2_3_1,o.FORMATION_3_3,o.FORMATION_1_3_2,o.FORMATION_2_1_3,o.FORMATION_3_2_1,o.FORMATION_3_1_2]}};function d(e){var t;const a=c[e],n=null!==(t=s.GOALIE_COUNT)&&void 0!==t?t:1;if(!a||"number"!==typeof a.fieldPlayers)return s.MIN_SQUAD_SIZE;const r=a.fieldPlayers+n;return Math.max(s.MIN_SQUAD_SIZE,r)}function u(e){const t=i[e];return"number"===typeof t?Math.max(s.MIN_SQUAD_SIZE,t):Math.max(s.MIN_SQUAD_SIZE,s.DEFAULT_MAX_SQUAD_SIZE)}const m=(e,t,a)=>({format:e,squadSize:t,formation:a}),h=(e,t)=>{const a=Object.entries(l).filter(t=>{let[,a]=t;return!(a.formats&&!a.formats.includes(e))}).map(e=>{let[t]=e;return t});return a.length>0?a:[o.FORMATION_2_2]},p=e=>{const{format:t,squadSize:a,formation:n}=e;if(!Object.values(r).includes(t)||!c[t])throw new Error("Invalid format: ".concat(t,". Must be one of: ").concat(Object.values(r).join(", ")));const i=u(t);if(a<s.MIN_SQUAD_SIZE||a>i)throw new Error("Invalid squad size: ".concat(a,". Must be between ").concat(s.MIN_SQUAD_SIZE," and ").concat(i," players for ").concat(t));const o=h(t,a);if(!o.includes(n))throw new Error("Formation ".concat(n," not valid for ").concat(t," with ").concat(a," players. Valid formations: ").concat(o.join(", ")));return!0},f=e=>{const t=[];let a=(0,n.A)({},e);try{return p(e),{isValid:!0,correctedConfig:e,corrections:[]}}catch(r){try{return p(a),{isValid:!1,correctedConfig:a,corrections:t}}catch(s){throw r}}},g=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.FORMAT_5V5;const a=c[t]?t:r.FORMAT_5V5,n=c[a].defaultFormation||o.FORMATION_2_2;return m(a,e,n)}},338(e,t,a){"use strict";a.d(t,{Kf:()=>c,Mf:()=>s,fd:()=>o,pr:()=>i});var n=a(180),r=a(816);function s(e){if(!e)return null;const t=e.toLowerCase();return t.includes("defender")?r.q.DEFENDER:t.includes("attacker")||t.includes("forward")||"attacker"===t?r.q.ATTACKER:"left"===t||"right"===t||t.includes("midfielder")||t.includes("mid")?r.q.MIDFIELDER:t.includes("substitute")?r.q.SUBSTITUTE:"goalie"===t?r.q.GOALIE:null}function i(e){const t=(0,n.getModeDefinition)(e);return t?t.fieldPositions:[]}function o(e){const t=(0,n.getModeDefinition)(e);return t?t.substitutePositions:[]}function l(e){const t=(0,n.getModeDefinition)(e);return t?t.expectedCounts:{outfield:0,onField:0}}function c(e){return l(e).onField}},829(e,t,a){"use strict";a.d(t,{P:()=>i,a:()=>o});var n=a(816),r=a(338);const s=[n.q.ATTACKER,n.q.MIDFIELDER,n.q.DEFENDER],i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!Array.isArray(e)||0===e.length)return[];const t=new Map;e.forEach(e=>{const a=(0,r.Mf)(e);a&&(t.has(a)||t.set(a,[]),t.get(a).push(e))});const a=[];return s.forEach(e=>{t.has(e)&&a.push({role:e,positions:t.get(e)})}),a},o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!Array.isArray(e))return[];const t=[];s.forEach(a=>{e.forEach(e=>{(0,r.Mf)(e)===a&&t.push(e)})});const a=new Set(t);return e.forEach(e=>{a.has(e)||t.push(e)}),t}},497(e,t,a){"use strict";var n=a(218);function r(){}function s(){}s.resetWarningCache=r,e.exports=function(){function e(e,t,a,r,s,i){if(i!==n){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var a={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:r};return a.PropTypes=a,a}},173(e,t,a){e.exports=a(497)()},218(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},4(e,t,a){"use strict";var n=a(853),r=a(43),s=a(950);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(a=t.return),e=t.return}while(e)}return 3===t.tag?a:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function d(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(l(e)!==e)throw Error(i(188))}function m(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=m(e)))return t;e=e.sibling}return null}var h=Object.assign,p=Symbol.for("react.element"),f=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),x=Symbol.for("react.consumer"),w=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),T=Symbol.for("react.lazy");Symbol.for("react.scope");var A=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var _=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var C=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=C&&e[C]||e["@@iterator"])?e:null}var P=Symbol.for("react.client.reference");function E(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===P?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case v:return"Fragment";case b:return"Profiler";case y:return"StrictMode";case k:return"Suspense";case N:return"SuspenseList";case A:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case g:return"Portal";case w:return e.displayName||"Context";case x:return(e._context.displayName||"Context")+".Consumer";case S:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case j:return null!==(t=e.displayName||null)?t:E(e.type)||"Memo";case T:t=e._payload,e=e._init;try{return E(e(t))}catch(a){}}return null}var I=Array.isArray,R=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,O=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,D={pending:!1,data:null,method:null,action:null},F=[],L=-1;function q(e){return{current:e}}function U(e){0>L||(e.current=F[L],F[L]=null,L--)}function B(e,t){L++,F[L]=e.current,e.current=t}var G,z,V=q(null),H=q(null),K=q(null),W=q(null);function Y(e,t){switch(B(K,t),B(H,e),B(V,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?vu(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=yu(t=vu(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}U(V),B(V,e)}function J(){U(V),U(H),U(K)}function Q(e){null!==e.memoizedState&&B(W,e);var t=V.current,a=yu(t,e.type);t!==a&&(B(H,e),B(V,a))}function $(e){H.current===e&&(U(V),U(H)),W.current===e&&(U(W),dm._currentValue=D)}function X(e){if(void 0===G)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);G=t&&t[1]||"",z=-1<a.stack.indexOf("\n    at")?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+G+e+z}var Z=!1;function ee(e,t){if(!e||Z)return"";Z=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var n={DetermineComponentFrameRoot:function(){try{if(t){var a=function(){throw Error()};if(Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(a,[])}catch(r){var n=r}Reflect.construct(e,[],a)}else{try{a.call()}catch(s){n=s}e.call(a.prototype)}}else{try{throw Error()}catch(i){n=i}(a=e())&&"function"===typeof a.catch&&a.catch(function(){})}}catch(o){if(o&&n&&"string"===typeof o.stack)return[o.stack,n.stack]}return[null,null]}};n.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(n.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(n.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=n.DetermineComponentFrameRoot(),i=s[0],o=s[1];if(i&&o){var l=i.split("\n"),c=o.split("\n");for(r=n=0;n<l.length&&!l[n].includes("DetermineComponentFrameRoot");)n++;for(;r<c.length&&!c[r].includes("DetermineComponentFrameRoot");)r++;if(n===l.length||r===c.length)for(n=l.length-1,r=c.length-1;1<=n&&0<=r&&l[n]!==c[r];)r--;for(;1<=n&&0<=r;n--,r--)if(l[n]!==c[r]){if(1!==n||1!==r)do{if(n--,0>--r||l[n]!==c[r]){var d="\n"+l[n].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}}while(1<=n&&0<=r);break}}}finally{Z=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?X(a):""}function te(e,t){switch(e.tag){case 26:case 27:case 5:return X(e.type);case 16:return X("Lazy");case 13:return e.child!==t&&null!==t?X("Suspense Fallback"):X("Suspense");case 19:return X("SuspenseList");case 0:case 15:return ee(e.type,!1);case 11:return ee(e.type.render,!1);case 1:return ee(e.type,!0);case 31:return X("Activity");default:return""}}function ae(e){try{var t="",a=null;do{t+=te(e,a),a=e,e=e.return}while(e);return t}catch(n){return"\nError generating stack: "+n.message+"\n"+n.stack}}var ne=Object.prototype.hasOwnProperty,re=n.unstable_scheduleCallback,se=n.unstable_cancelCallback,ie=n.unstable_shouldYield,oe=n.unstable_requestPaint,le=n.unstable_now,ce=n.unstable_getCurrentPriorityLevel,de=n.unstable_ImmediatePriority,ue=n.unstable_UserBlockingPriority,me=n.unstable_NormalPriority,he=n.unstable_LowPriority,pe=n.unstable_IdlePriority,fe=n.log,ge=n.unstable_setDisableYieldValue,ve=null,ye=null;function be(e){if("function"===typeof fe&&ge(e),ye&&"function"===typeof ye.setStrictMode)try{ye.setStrictMode(ve,e)}catch(t){}}var xe=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(we(e)/Se|0)|0},we=Math.log,Se=Math.LN2;var ke=256,Ne=262144,je=4194304;function Te(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ae(e,t,a){var n=e.pendingLanes;if(0===n)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes;e=e.warmLanes;var o=134217727&n;return 0!==o?0!==(n=o&~s)?r=Te(n):0!==(i&=o)?r=Te(i):a||0!==(a=o&~e)&&(r=Te(a)):0!==(o=n&~s)?r=Te(o):0!==i?r=Te(i):a||0!==(a=n&~e)&&(r=Te(a)),0===r?0:0!==t&&t!==r&&0===(t&s)&&((s=r&-r)>=(a=t&-t)||32===s&&0!==(4194048&a))?t:r}function _e(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Ce(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Me(){var e=je;return 0===(62914560&(je<<=1))&&(je=4194304),e}function Pe(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function Ee(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Ie(e,t,a){e.pendingLanes|=t,e.suspendedLanes&=~t;var n=31-xe(t);e.entangledLanes|=t,e.entanglements[n]=1073741824|e.entanglements[n]|261930&a}function Re(e,t){var a=e.entangledLanes|=t;for(e=e.entanglements;a;){var n=31-xe(a),r=1<<n;r&t|e[n]&t&&(e[n]|=t),a&=~r}}function Oe(e,t){var a=t&-t;return 0!==((a=0!==(42&a)?1:De(a))&(e.suspendedLanes|t))?0:a}function De(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Fe(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Le(){var e=O.p;return 0!==e?e:void 0===(e=window.event)?32:Tm(e.type)}function qe(e,t){var a=O.p;try{return O.p=e,t()}finally{O.p=a}}var Ue=Math.random().toString(36).slice(2),Be="__reactFiber$"+Ue,Ge="__reactProps$"+Ue,ze="__reactContainer$"+Ue,Ve="__reactEvents$"+Ue,He="__reactListeners$"+Ue,Ke="__reactHandles$"+Ue,We="__reactResources$"+Ue,Ye="__reactMarker$"+Ue;function Je(e){delete e[Be],delete e[Ge],delete e[Ve],delete e[He],delete e[Ke]}function Qe(e){var t=e[Be];if(t)return t;for(var a=e.parentNode;a;){if(t=a[ze]||a[Be]){if(a=t.alternate,null!==t.child||null!==a&&null!==a.child)for(e=Du(e);null!==e;){if(a=e[Be])return a;e=Du(e)}return t}a=(e=a).parentNode}return null}function $e(e){if(e=e[Be]||e[ze]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function Xe(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(i(33))}function Ze(e){var t=e[We];return t||(t=e[We]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function et(e){e[Ye]=!0}var tt=new Set,at={};function nt(e,t){rt(e,t),rt(e+"Capture",t)}function rt(e,t){for(at[e]=t,e=0;e<t.length;e++)tt.add(t[e])}var st=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),it={},ot={};function lt(e,t,a){if(r=t,ne.call(ot,r)||!ne.call(it,r)&&(st.test(r)?ot[r]=!0:(it[r]=!0,0)))if(null===a)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var n=t.toLowerCase().slice(0,5);if("data-"!==n&&"aria-"!==n)return void e.removeAttribute(t)}e.setAttribute(t,""+a)}var r}function ct(e,t,a){if(null===a)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+a)}}function dt(e,t,a,n){if(null===n)e.removeAttribute(a);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(a)}e.setAttributeNS(t,a,""+n)}}function ut(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function mt(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ht(e){if(!e._valueTracker){var t=mt(e)?"checked":"value";e._valueTracker=function(e,t,a){var n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){a=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return a},setValue:function(e){a=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function pt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var a=t.getValue(),n="";return e&&(n=mt(e)?e.checked?"true":"false":e.value),(e=n)!==a&&(t.setValue(e),!0)}function ft(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var gt=/[\n"\\]/g;function vt(e){return e.replace(gt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function yt(e,t,a,n,r,s,i,o){e.name="",null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i?e.type=i:e.removeAttribute("type"),null!=t?"number"===i?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ut(t)):e.value!==""+ut(t)&&(e.value=""+ut(t)):"submit"!==i&&"reset"!==i||e.removeAttribute("value"),null!=t?xt(e,i,ut(t)):null!=a?xt(e,i,ut(a)):null!=n&&e.removeAttribute("value"),null==r&&null!=s&&(e.defaultChecked=!!s),null!=r&&(e.checked=r&&"function"!==typeof r&&"symbol"!==typeof r),null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.name=""+ut(o):e.removeAttribute("name")}function bt(e,t,a,n,r,s,i,o){if(null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.type=s),null!=t||null!=a){if(!("submit"!==s&&"reset"!==s||void 0!==t&&null!==t))return void ht(e);a=null!=a?""+ut(a):"",t=null!=t?""+ut(t):a,o||t===e.value||(e.value=t),e.defaultValue=t}n="function"!==typeof(n=null!=n?n:r)&&"symbol"!==typeof n&&!!n,e.checked=o?e.checked:!!n,e.defaultChecked=!!n,null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i&&(e.name=i),ht(e)}function xt(e,t,a){"number"===t&&ft(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function wt(e,t,a,n){if(e=e.options,t){t={};for(var r=0;r<a.length;r++)t["$"+a[r]]=!0;for(a=0;a<e.length;a++)r=t.hasOwnProperty("$"+e[a].value),e[a].selected!==r&&(e[a].selected=r),r&&n&&(e[a].defaultSelected=!0)}else{for(a=""+ut(a),t=null,r=0;r<e.length;r++){if(e[r].value===a)return e[r].selected=!0,void(n&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function St(e,t,a){null==t||((t=""+ut(t))!==e.value&&(e.value=t),null!=a)?e.defaultValue=null!=a?""+ut(a):"":e.defaultValue!==t&&(e.defaultValue=t)}function kt(e,t,a,n){if(null==t){if(null!=n){if(null!=a)throw Error(i(92));if(I(n)){if(1<n.length)throw Error(i(93));n=n[0]}a=n}null==a&&(a=""),t=a}a=ut(t),e.defaultValue=a,(n=e.textContent)===a&&""!==n&&null!==n&&(e.value=n),ht(e)}function Nt(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&3===a.nodeType)return void(a.nodeValue=t)}e.textContent=t}var jt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Tt(e,t,a){var n=0===t.indexOf("--");null==a||"boolean"===typeof a||""===a?n?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":n?e.setProperty(t,a):"number"!==typeof a||0===a||jt.has(t)?"float"===t?e.cssFloat=a:e[t]=(""+a).trim():e[t]=a+"px"}function At(e,t,a){if(null!=t&&"object"!==typeof t)throw Error(i(62));if(e=e.style,null!=a){for(var n in a)!a.hasOwnProperty(n)||null!=t&&t.hasOwnProperty(n)||(0===n.indexOf("--")?e.setProperty(n,""):"float"===n?e.cssFloat="":e[n]="");for(var r in t)n=t[r],t.hasOwnProperty(r)&&a[r]!==n&&Tt(e,r,n)}else for(var s in t)t.hasOwnProperty(s)&&Tt(e,s,t[s])}function _t(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ct=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Mt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Pt(e){return Mt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Et(){}var It=null;function Rt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ot=null,Dt=null;function Ft(e){var t=$e(e);if(t&&(e=t.stateNode)){var a=e[Ge]||null;e:switch(e=t.stateNode,t.type){case"input":if(yt(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),t=a.name,"radio"===a.type&&null!=t){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+vt(""+t)+'"][type="radio"]'),t=0;t<a.length;t++){var n=a[t];if(n!==e&&n.form===e.form){var r=n[Ge]||null;if(!r)throw Error(i(90));yt(n,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(t=0;t<a.length;t++)(n=a[t]).form===e.form&&pt(n)}break e;case"textarea":St(e,a.value,a.defaultValue);break e;case"select":null!=(t=a.value)&&wt(e,!!a.multiple,t,!1)}}}var Lt=!1;function qt(e,t,a){if(Lt)return e(t,a);Lt=!0;try{return e(t)}finally{if(Lt=!1,(null!==Ot||null!==Dt)&&(Zc(),Ot&&(t=Ot,e=Dt,Dt=Ot=null,Ft(t),e)))for(t=0;t<e.length;t++)Ft(e[t])}}function Ut(e,t){var a=e.stateNode;if(null===a)return null;var n=a[Ge]||null;if(null===n)return null;a=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(a&&"function"!==typeof a)throw Error(i(231,t,typeof a));return a}var Bt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Gt=!1;if(Bt)try{var zt={};Object.defineProperty(zt,"passive",{get:function(){Gt=!0}}),window.addEventListener("test",zt,zt),window.removeEventListener("test",zt,zt)}catch($m){Gt=!1}var Vt=null,Ht=null,Kt=null;function Wt(){if(Kt)return Kt;var e,t,a=Ht,n=a.length,r="value"in Vt?Vt.value:Vt.textContent,s=r.length;for(e=0;e<n&&a[e]===r[e];e++);var i=n-e;for(t=1;t<=i&&a[n-t]===r[s-t];t++);return Kt=r.slice(e,1<t?1-t:void 0)}function Yt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Jt(){return!0}function Qt(){return!1}function $t(e){function t(t,a,n,r,s){for(var i in this._reactName=t,this._targetInst=n,this.type=a,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(r):r[i]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?Jt:Qt,this.isPropagationStopped=Qt,this}return h(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Jt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Jt)},persist:function(){},isPersistent:Jt}),t}var Xt,Zt,ea,ta={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},aa=$t(ta),na=h({},ta,{view:0,detail:0}),ra=$t(na),sa=h({},na,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ga,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ea&&(ea&&"mousemove"===e.type?(Xt=e.screenX-ea.screenX,Zt=e.screenY-ea.screenY):Zt=Xt=0,ea=e),Xt)},movementY:function(e){return"movementY"in e?e.movementY:Zt}}),ia=$t(sa),oa=$t(h({},sa,{dataTransfer:0})),la=$t(h({},na,{relatedTarget:0})),ca=$t(h({},ta,{animationName:0,elapsedTime:0,pseudoElement:0})),da=$t(h({},ta,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),ua=$t(h({},ta,{data:0})),ma={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ha={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pa={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fa(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=pa[e])&&!!t[e]}function ga(){return fa}var va=$t(h({},na,{key:function(e){if(e.key){var t=ma[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Yt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?ha[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ga,charCode:function(e){return"keypress"===e.type?Yt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Yt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),ya=$t(h({},sa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),ba=$t(h({},na,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ga})),xa=$t(h({},ta,{propertyName:0,elapsedTime:0,pseudoElement:0})),wa=$t(h({},sa,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Sa=$t(h({},ta,{newState:0,oldState:0})),ka=[9,13,27,32],Na=Bt&&"CompositionEvent"in window,ja=null;Bt&&"documentMode"in document&&(ja=document.documentMode);var Ta=Bt&&"TextEvent"in window&&!ja,Aa=Bt&&(!Na||ja&&8<ja&&11>=ja),_a=String.fromCharCode(32),Ca=!1;function Ma(e,t){switch(e){case"keyup":return-1!==ka.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pa(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Ea=!1;var Ia={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ra(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Ia[e.type]:"textarea"===t}function Oa(e,t,a,n){Ot?Dt?Dt.push(n):Dt=[n]:Ot=n,0<(t=nu(t,"onChange")).length&&(a=new aa("onChange","change",null,a,n),e.push({event:a,listeners:t}))}var Da=null,Fa=null;function La(e){Jd(e,0)}function qa(e){if(pt(Xe(e)))return e}function Ua(e,t){if("change"===e)return t}var Ba=!1;if(Bt){var Ga;if(Bt){var za="oninput"in document;if(!za){var Va=document.createElement("div");Va.setAttribute("oninput","return;"),za="function"===typeof Va.oninput}Ga=za}else Ga=!1;Ba=Ga&&(!document.documentMode||9<document.documentMode)}function Ha(){Da&&(Da.detachEvent("onpropertychange",Ka),Fa=Da=null)}function Ka(e){if("value"===e.propertyName&&qa(Fa)){var t=[];Oa(t,Fa,e,Rt(e)),qt(La,t)}}function Wa(e,t,a){"focusin"===e?(Ha(),Fa=a,(Da=t).attachEvent("onpropertychange",Ka)):"focusout"===e&&Ha()}function Ya(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return qa(Fa)}function Ja(e,t){if("click"===e)return qa(t)}function Qa(e,t){if("input"===e||"change"===e)return qa(t)}var $a="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Xa(e,t){if($a(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var a=Object.keys(e),n=Object.keys(t);if(a.length!==n.length)return!1;for(n=0;n<a.length;n++){var r=a[n];if(!ne.call(t,r)||!$a(e[r],t[r]))return!1}return!0}function Za(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function en(e,t){var a,n=Za(e);for(e=0;n;){if(3===n.nodeType){if(a=e+n.textContent.length,e<=t&&a>=t)return{node:n,offset:t-e};e=a}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Za(n)}}function tn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?tn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function an(e){for(var t=ft((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var a="string"===typeof t.contentWindow.location.href}catch(n){a=!1}if(!a)break;t=ft((e=t.contentWindow).document)}return t}function nn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var rn=Bt&&"documentMode"in document&&11>=document.documentMode,sn=null,on=null,ln=null,cn=!1;function dn(e,t,a){var n=a.window===a?a.document:9===a.nodeType?a:a.ownerDocument;cn||null==sn||sn!==ft(n)||("selectionStart"in(n=sn)&&nn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},ln&&Xa(ln,n)||(ln=n,0<(n=nu(on,"onSelect")).length&&(t=new aa("onSelect","select",null,t,a),e.push({event:t,listeners:n}),t.target=sn)))}function un(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var mn={animationend:un("Animation","AnimationEnd"),animationiteration:un("Animation","AnimationIteration"),animationstart:un("Animation","AnimationStart"),transitionrun:un("Transition","TransitionRun"),transitionstart:un("Transition","TransitionStart"),transitioncancel:un("Transition","TransitionCancel"),transitionend:un("Transition","TransitionEnd")},hn={},pn={};function fn(e){if(hn[e])return hn[e];if(!mn[e])return e;var t,a=mn[e];for(t in a)if(a.hasOwnProperty(t)&&t in pn)return hn[e]=a[t];return e}Bt&&(pn=document.createElement("div").style,"AnimationEvent"in window||(delete mn.animationend.animation,delete mn.animationiteration.animation,delete mn.animationstart.animation),"TransitionEvent"in window||delete mn.transitionend.transition);var gn=fn("animationend"),vn=fn("animationiteration"),yn=fn("animationstart"),bn=fn("transitionrun"),xn=fn("transitionstart"),wn=fn("transitioncancel"),Sn=fn("transitionend"),kn=new Map,Nn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jn(e,t){kn.set(e,t),nt(t,[e])}Nn.push("scrollEnd");var Tn="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},An=[],_n=0,Cn=0;function Mn(){for(var e=_n,t=Cn=_n=0;t<e;){var a=An[t];An[t++]=null;var n=An[t];An[t++]=null;var r=An[t];An[t++]=null;var s=An[t];if(An[t++]=null,null!==n&&null!==r){var i=n.pending;null===i?r.next=r:(r.next=i.next,i.next=r),n.pending=r}0!==s&&Rn(a,r,s)}}function Pn(e,t,a,n){An[_n++]=e,An[_n++]=t,An[_n++]=a,An[_n++]=n,Cn|=n,e.lanes|=n,null!==(e=e.alternate)&&(e.lanes|=n)}function En(e,t,a,n){return Pn(e,t,a,n),On(e)}function In(e,t){return Pn(e,null,null,t),On(e)}function Rn(e,t,a){e.lanes|=a;var n=e.alternate;null!==n&&(n.lanes|=a);for(var r=!1,s=e.return;null!==s;)s.childLanes|=a,null!==(n=s.alternate)&&(n.childLanes|=a),22===s.tag&&(null===(e=s.stateNode)||1&e._visibility||(r=!0)),e=s,s=s.return;return 3===e.tag?(s=e.stateNode,r&&null!==t&&(r=31-xe(a),null===(n=(e=s.hiddenUpdates)[r])?e[r]=[t]:n.push(t),t.lane=536870912|a),s):null}function On(e){if(50<Vc)throw Vc=0,Hc=null,Error(i(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Dn={};function Fn(e,t,a,n){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ln(e,t,a,n){return new Fn(e,t,a,n)}function qn(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Un(e,t){var a=e.alternate;return null===a?((a=Ln(e.tag,t,e.key,e.mode)).elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=65011712&e.flags,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function Bn(e,t){e.flags&=65011714;var a=e.alternate;return null===a?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,t=a.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Gn(e,t,a,n,r,s){var o=0;if(n=e,"function"===typeof e)qn(e)&&(o=1);else if("string"===typeof e)o=function(e,t,a){if(1===a||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,a,V.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case A:return(e=Ln(31,a,t,r)).elementType=A,e.lanes=s,e;case v:return zn(a.children,r,s,t);case y:o=8,r|=24;break;case b:return(e=Ln(12,a,t,2|r)).elementType=b,e.lanes=s,e;case k:return(e=Ln(13,a,t,r)).elementType=k,e.lanes=s,e;case N:return(e=Ln(19,a,t,r)).elementType=N,e.lanes=s,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case w:o=10;break e;case x:o=9;break e;case S:o=11;break e;case j:o=14;break e;case T:o=16,n=null;break e}o=29,a=Error(i(130,null===e?"null":typeof e,"")),n=null}return(t=Ln(o,a,t,r)).elementType=e,t.type=n,t.lanes=s,t}function zn(e,t,a,n){return(e=Ln(7,e,n,t)).lanes=a,e}function Vn(e,t,a){return(e=Ln(6,e,null,t)).lanes=a,e}function Hn(e){var t=Ln(18,null,null,0);return t.stateNode=e,t}function Kn(e,t,a){return(t=Ln(4,null!==e.children?e.children:[],e.key,t)).lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Wn=new WeakMap;function Yn(e,t){if("object"===typeof e&&null!==e){var a=Wn.get(e);return void 0!==a?a:(t={value:e,source:t,stack:ae(t)},Wn.set(e,t),t)}return{value:e,source:t,stack:ae(t)}}var Jn=[],Qn=0,$n=null,Xn=0,Zn=[],er=0,tr=null,ar=1,nr="";function rr(e,t){Jn[Qn++]=Xn,Jn[Qn++]=$n,$n=e,Xn=t}function sr(e,t,a){Zn[er++]=ar,Zn[er++]=nr,Zn[er++]=tr,tr=e;var n=ar;e=nr;var r=32-xe(n)-1;n&=~(1<<r),a+=1;var s=32-xe(t)+r;if(30<s){var i=r-r%5;s=(n&(1<<i)-1).toString(32),n>>=i,r-=i,ar=1<<32-xe(t)+r|a<<r|n,nr=s+e}else ar=1<<s|a<<r|n,nr=e}function ir(e){null!==e.return&&(rr(e,1),sr(e,1,0))}function or(e){for(;e===$n;)$n=Jn[--Qn],Jn[Qn]=null,Xn=Jn[--Qn],Jn[Qn]=null;for(;e===tr;)tr=Zn[--er],Zn[er]=null,nr=Zn[--er],Zn[er]=null,ar=Zn[--er],Zn[er]=null}function lr(e,t){Zn[er++]=ar,Zn[er++]=nr,Zn[er++]=tr,ar=t.id,nr=t.overflow,tr=e}var cr=null,dr=null,ur=!1,mr=null,hr=!1,pr=Error(i(519));function fr(e){throw wr(Yn(Error(i(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),pr}function gr(e){var t=e.stateNode,a=e.type,n=e.memoizedProps;switch(t[Be]=e,t[Ge]=n,a){case"dialog":Qd("cancel",t),Qd("close",t);break;case"iframe":case"object":case"embed":Qd("load",t);break;case"video":case"audio":for(a=0;a<Wd.length;a++)Qd(Wd[a],t);break;case"source":Qd("error",t);break;case"img":case"image":case"link":Qd("error",t),Qd("load",t);break;case"details":Qd("toggle",t);break;case"input":Qd("invalid",t),bt(t,n.value,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name,!0);break;case"select":Qd("invalid",t);break;case"textarea":Qd("invalid",t),kt(t,n.value,n.defaultValue,n.children)}"string"!==typeof(a=n.children)&&"number"!==typeof a&&"bigint"!==typeof a||t.textContent===""+a||!0===n.suppressHydrationWarning||cu(t.textContent,a)?(null!=n.popover&&(Qd("beforetoggle",t),Qd("toggle",t)),null!=n.onScroll&&Qd("scroll",t),null!=n.onScrollEnd&&Qd("scrollend",t),null!=n.onClick&&(t.onclick=Et),t=!0):t=!1,t||fr(e,!0)}function vr(e){for(cr=e.return;cr;)switch(cr.tag){case 5:case 31:case 13:return void(hr=!1);case 27:case 3:return void(hr=!0);default:cr=cr.return}}function yr(e){if(e!==cr)return!1;if(!ur)return vr(e),ur=!0,!1;var t,a=e.tag;if((t=3!==a&&27!==a)&&((t=5===a)&&(t=!("form"!==(t=e.type)&&"button"!==t)||bu(e.type,e.memoizedProps)),t=!t),t&&dr&&fr(e),vr(e),13===a){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));dr=Ou(e)}else if(31===a){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));dr=Ou(e)}else 27===a?(a=dr,Tu(e.type)?(e=Ru,Ru=null,dr=e):dr=a):dr=cr?Iu(e.stateNode.nextSibling):null;return!0}function br(){dr=cr=null,ur=!1}function xr(){var e=mr;return null!==e&&(null===Mc?Mc=e:Mc.push.apply(Mc,e),mr=null),e}function wr(e){null===mr?mr=[e]:mr.push(e)}var Sr=q(null),kr=null,Nr=null;function jr(e,t,a){B(Sr,t._currentValue),t._currentValue=a}function Tr(e){e._currentValue=Sr.current,U(Sr)}function Ar(e,t,a){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===a)break;e=e.return}}function _r(e,t,a,n){var r=e.child;for(null!==r&&(r.return=e);null!==r;){var s=r.dependencies;if(null!==s){var o=r.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=r;for(var c=0;c<t.length;c++)if(l.context===t[c]){s.lanes|=a,null!==(l=s.alternate)&&(l.lanes|=a),Ar(s.return,a,e),n||(o=null);break e}s=l.next}}else if(18===r.tag){if(null===(o=r.return))throw Error(i(341));o.lanes|=a,null!==(s=o.alternate)&&(s.lanes|=a),Ar(o,a,e),o=null}else o=r.child;if(null!==o)o.return=r;else for(o=r;null!==o;){if(o===e){o=null;break}if(null!==(r=o.sibling)){r.return=o.return,o=r;break}o=o.return}r=o}}function Cr(e,t,a,n){e=null;for(var r=t,s=!1;null!==r;){if(!s)if(0!==(524288&r.flags))s=!0;else if(0!==(262144&r.flags))break;if(10===r.tag){var o=r.alternate;if(null===o)throw Error(i(387));if(null!==(o=o.memoizedProps)){var l=r.type;$a(r.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(r===W.current){if(null===(o=r.alternate))throw Error(i(387));o.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(null!==e?e.push(dm):e=[dm])}r=r.return}null!==e&&_r(t,e,a,n),t.flags|=262144}function Mr(e){for(e=e.firstContext;null!==e;){if(!$a(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Pr(e){kr=e,Nr=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Er(e){return Rr(kr,e)}function Ir(e,t){return null===kr&&Pr(e),Rr(e,t)}function Rr(e,t){var a=t._currentValue;if(t={context:t,memoizedValue:a,next:null},null===Nr){if(null===e)throw Error(i(308));Nr=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Nr=Nr.next=t;return a}var Or="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,a){e.push(a)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Dr=n.unstable_scheduleCallback,Fr=n.unstable_NormalPriority,Lr={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function qr(){return{controller:new Or,data:new Map,refCount:0}}function Ur(e){e.refCount--,0===e.refCount&&Dr(Fr,function(){e.controller.abort()})}var Br=null,Gr=0,zr=0,Vr=null;function Hr(){if(0===--Gr&&null!==Br){null!==Vr&&(Vr.status="fulfilled");var e=Br;Br=null,zr=0,Vr=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Kr=R.S;R.S=function(e,t){Ic=le(),"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Br){var a=Br=[];Gr=0,zr=Gd(),Vr={status:"pending",value:void 0,then:function(e){a.push(e)}}}Gr++,t.then(Hr,Hr)}(0,t),null!==Kr&&Kr(e,t)};var Wr=q(null);function Yr(){var e=Wr.current;return null!==e?e:pc.pooledCache}function Jr(e,t){B(Wr,null===t?Wr.current:t.pool)}function Qr(){var e=Yr();return null===e?null:{parent:Lr._currentValue,pool:e}}var $r=Error(i(460)),Xr=Error(i(474)),Zr=Error(i(542)),es={then:function(){}};function ts(e){return"fulfilled"===(e=e.status)||"rejected"===e}function as(e,t,a){switch(void 0===(a=e[a])?e.push(t):a!==t&&(t.then(Et,Et),t=a),t.status){case"fulfilled":return t.value;case"rejected":throw is(e=t.reason),e;default:if("string"===typeof t.status)t.then(Et,Et);else{if(null!==(e=pc)&&100<e.shellSuspendCounter)throw Error(i(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var a=t;a.status="fulfilled",a.value=e}},function(e){if("pending"===t.status){var a=t;a.status="rejected",a.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw is(e=t.reason),e}throw rs=t,$r}}function ns(e){try{return(0,e._init)(e._payload)}catch(t){if(null!==t&&"object"===typeof t&&"function"===typeof t.then)throw rs=t,$r;throw t}}var rs=null;function ss(){if(null===rs)throw Error(i(459));var e=rs;return rs=null,e}function is(e){if(e===$r||e===Zr)throw Error(i(483))}var os=null,ls=0;function cs(e){var t=ls;return ls+=1,null===os&&(os=[]),as(os,e,t)}function ds(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function us(e,t){if(t.$$typeof===p)throw Error(i(525));throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ms(e){function t(t,a){if(e){var n=t.deletions;null===n?(t.deletions=[a],t.flags|=16):n.push(a)}}function a(a,n){if(!e)return null;for(;null!==n;)t(a,n),n=n.sibling;return null}function n(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(e,t){return(e=Un(e,t)).index=0,e.sibling=null,e}function s(t,a,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<a?(t.flags|=67108866,a):n:(t.flags|=67108866,a):(t.flags|=1048576,a)}function o(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,a,n){return null===t||6!==t.tag?((t=Vn(a,e.mode,n)).return=e,t):((t=r(t,a)).return=e,t)}function c(e,t,a,n){var s=a.type;return s===v?u(e,t,a.props.children,n,a.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===T&&ns(s)===t.type)?(ds(t=r(t,a.props),a),t.return=e,t):(ds(t=Gn(a.type,a.key,a.props,null,e.mode,n),a),t.return=e,t)}function d(e,t,a,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==a.containerInfo||t.stateNode.implementation!==a.implementation?((t=Kn(a,e.mode,n)).return=e,t):((t=r(t,a.children||[])).return=e,t)}function u(e,t,a,n,s){return null===t||7!==t.tag?((t=zn(a,e.mode,n,s)).return=e,t):((t=r(t,a)).return=e,t)}function m(e,t,a){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Vn(""+t,e.mode,a)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case f:return ds(a=Gn(t.type,t.key,t.props,null,e.mode,a),t),a.return=e,a;case g:return(t=Kn(t,e.mode,a)).return=e,t;case T:return m(e,t=ns(t),a)}if(I(t)||M(t))return(t=zn(t,e.mode,a,null)).return=e,t;if("function"===typeof t.then)return m(e,cs(t),a);if(t.$$typeof===w)return m(e,Ir(e,t),a);us(e,t)}return null}function h(e,t,a,n){var r=null!==t?t.key:null;if("string"===typeof a&&""!==a||"number"===typeof a||"bigint"===typeof a)return null!==r?null:l(e,t,""+a,n);if("object"===typeof a&&null!==a){switch(a.$$typeof){case f:return a.key===r?c(e,t,a,n):null;case g:return a.key===r?d(e,t,a,n):null;case T:return h(e,t,a=ns(a),n)}if(I(a)||M(a))return null!==r?null:u(e,t,a,n,null);if("function"===typeof a.then)return h(e,t,cs(a),n);if(a.$$typeof===w)return h(e,t,Ir(e,a),n);us(e,a)}return null}function p(e,t,a,n,r){if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return l(t,e=e.get(a)||null,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case f:return c(t,e=e.get(null===n.key?a:n.key)||null,n,r);case g:return d(t,e=e.get(null===n.key?a:n.key)||null,n,r);case T:return p(e,t,a,n=ns(n),r)}if(I(n)||M(n))return u(t,e=e.get(a)||null,n,r,null);if("function"===typeof n.then)return p(e,t,a,cs(n),r);if(n.$$typeof===w)return p(e,t,a,Ir(t,n),r);us(t,n)}return null}function y(l,c,d,u){if("object"===typeof d&&null!==d&&d.type===v&&null===d.key&&(d=d.props.children),"object"===typeof d&&null!==d){switch(d.$$typeof){case f:e:{for(var b=d.key;null!==c;){if(c.key===b){if((b=d.type)===v){if(7===c.tag){a(l,c.sibling),(u=r(c,d.props.children)).return=l,l=u;break e}}else if(c.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===T&&ns(b)===c.type){a(l,c.sibling),ds(u=r(c,d.props),d),u.return=l,l=u;break e}a(l,c);break}t(l,c),c=c.sibling}d.type===v?((u=zn(d.props.children,l.mode,u,d.key)).return=l,l=u):(ds(u=Gn(d.type,d.key,d.props,null,l.mode,u),d),u.return=l,l=u)}return o(l);case g:e:{for(b=d.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===d.containerInfo&&c.stateNode.implementation===d.implementation){a(l,c.sibling),(u=r(c,d.children||[])).return=l,l=u;break e}a(l,c);break}t(l,c),c=c.sibling}(u=Kn(d,l.mode,u)).return=l,l=u}return o(l);case T:return y(l,c,d=ns(d),u)}if(I(d))return function(r,i,o,l){for(var c=null,d=null,u=i,f=i=0,g=null;null!==u&&f<o.length;f++){u.index>f?(g=u,u=null):g=u.sibling;var v=h(r,u,o[f],l);if(null===v){null===u&&(u=g);break}e&&u&&null===v.alternate&&t(r,u),i=s(v,i,f),null===d?c=v:d.sibling=v,d=v,u=g}if(f===o.length)return a(r,u),ur&&rr(r,f),c;if(null===u){for(;f<o.length;f++)null!==(u=m(r,o[f],l))&&(i=s(u,i,f),null===d?c=u:d.sibling=u,d=u);return ur&&rr(r,f),c}for(u=n(u);f<o.length;f++)null!==(g=p(u,r,f,o[f],l))&&(e&&null!==g.alternate&&u.delete(null===g.key?f:g.key),i=s(g,i,f),null===d?c=g:d.sibling=g,d=g);return e&&u.forEach(function(e){return t(r,e)}),ur&&rr(r,f),c}(l,c,d,u);if(M(d)){if("function"!==typeof(b=M(d)))throw Error(i(150));return function(r,o,l,c){if(null==l)throw Error(i(151));for(var d=null,u=null,f=o,g=o=0,v=null,y=l.next();null!==f&&!y.done;g++,y=l.next()){f.index>g?(v=f,f=null):v=f.sibling;var b=h(r,f,y.value,c);if(null===b){null===f&&(f=v);break}e&&f&&null===b.alternate&&t(r,f),o=s(b,o,g),null===u?d=b:u.sibling=b,u=b,f=v}if(y.done)return a(r,f),ur&&rr(r,g),d;if(null===f){for(;!y.done;g++,y=l.next())null!==(y=m(r,y.value,c))&&(o=s(y,o,g),null===u?d=y:u.sibling=y,u=y);return ur&&rr(r,g),d}for(f=n(f);!y.done;g++,y=l.next())null!==(y=p(f,r,g,y.value,c))&&(e&&null!==y.alternate&&f.delete(null===y.key?g:y.key),o=s(y,o,g),null===u?d=y:u.sibling=y,u=y);return e&&f.forEach(function(e){return t(r,e)}),ur&&rr(r,g),d}(l,c,d=b.call(d),u)}if("function"===typeof d.then)return y(l,c,cs(d),u);if(d.$$typeof===w)return y(l,c,Ir(l,d),u);us(l,d)}return"string"===typeof d&&""!==d||"number"===typeof d||"bigint"===typeof d?(d=""+d,null!==c&&6===c.tag?(a(l,c.sibling),(u=r(c,d)).return=l,l=u):(a(l,c),(u=Vn(d,l.mode,u)).return=l,l=u),o(l)):a(l,c)}return function(e,t,a,n){try{ls=0;var r=y(e,t,a,n);return os=null,r}catch(i){if(i===$r||i===Zr)throw i;var s=Ln(29,i,null,e.mode);return s.lanes=n,s.return=e,s}}}var hs=ms(!0),ps=ms(!1),fs=!1;function gs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function vs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ys(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function bs(e,t,a){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&hc)){var r=n.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),n.pending=t,t=On(e),Rn(e,null,a),t}return Pn(e,n,t,a),On(e)}function xs(e,t,a){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&a))){var n=t.lanes;a|=n&=e.pendingLanes,t.lanes=a,Re(e,a)}}function ws(e,t){var a=e.updateQueue,n=e.alternate;if(null!==n&&a===(n=n.updateQueue)){var r=null,s=null;if(null!==(a=a.firstBaseUpdate)){do{var i={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};null===s?r=s=i:s=s.next=i,a=a.next}while(null!==a);null===s?r=s=t:s=s.next=t}else r=s=t;return a={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:n.shared,callbacks:n.callbacks},void(e.updateQueue=a)}null===(e=a.lastBaseUpdate)?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}var Ss=!1;function ks(){if(Ss){if(null!==Vr)throw Vr}}function Ns(e,t,a,n){Ss=!1;var r=e.updateQueue;fs=!1;var s=r.firstBaseUpdate,i=r.lastBaseUpdate,o=r.shared.pending;if(null!==o){r.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?s=c:i.next=c,i=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==s){var u=r.baseState;for(i=0,d=c=l=null,o=s;;){var m=-536870913&o.lane,p=m!==o.lane;if(p?(gc&m)===m:(n&m)===m){0!==m&&m===zr&&(Ss=!0),null!==d&&(d=d.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var f=e,g=o;m=t;var v=a;switch(g.tag){case 1:if("function"===typeof(f=g.payload)){u=f.call(v,u,m);break e}u=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(m="function"===typeof(f=g.payload)?f.call(v,u,m):f)||void 0===m)break e;u=h({},u,m);break e;case 2:fs=!0}}null!==(m=o.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=r.callbacks)?r.callbacks=[m]:p.push(m))}else p={lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=p,l=u):d=d.next=p,i|=m;if(null===(o=o.next)){if(null===(o=r.shared.pending))break;o=(p=o).next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}null===d&&(l=u),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=d,null===s&&(r.shared.lanes=0),Nc|=i,e.lanes=i,e.memoizedState=u}}function js(e,t){if("function"!==typeof e)throw Error(i(191,e));e.call(t)}function Ts(e,t){var a=e.callbacks;if(null!==a)for(e.callbacks=null,e=0;e<a.length;e++)js(a[e],t)}var As=q(null),_s=q(0);function Cs(e,t){B(_s,e=Sc),B(As,t),Sc=e|t.baseLanes}function Ms(){B(_s,Sc),B(As,As.current)}function Ps(){Sc=_s.current,U(As),U(_s)}var Es=q(null),Is=null;function Rs(e){var t=e.alternate;B(qs,1&qs.current),B(Es,e),null===Is&&(null===t||null!==As.current||null!==t.memoizedState)&&(Is=e)}function Os(e){B(qs,qs.current),B(Es,e),null===Is&&(Is=e)}function Ds(e){22===e.tag?(B(qs,qs.current),B(Es,e),null===Is&&(Is=e)):Fs()}function Fs(){B(qs,qs.current),B(Es,Es.current)}function Ls(e){U(Es),Is===e&&(Is=null),U(qs)}var qs=q(0);function Us(e){for(var t=e;null!==t;){if(13===t.tag){var a=t.memoizedState;if(null!==a&&(null===(a=a.dehydrated)||Pu(a)||Eu(a)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(0!==(128&t.flags))return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Bs=0,Gs=null,zs=null,Vs=null,Hs=!1,Ks=!1,Ws=!1,Ys=0,Js=0,Qs=null,$s=0;function Xs(){throw Error(i(321))}function Zs(e,t){if(null===t)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!$a(e[a],t[a]))return!1;return!0}function ei(e,t,a,n,r,s){return Bs=s,Gs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,R.H=null===e||null===e.memoizedState?go:vo,Ws=!1,s=a(n,r),Ws=!1,Ks&&(s=ai(t,a,n,r)),ti(e),s}function ti(e){R.H=fo;var t=null!==zs&&null!==zs.next;if(Bs=0,Vs=zs=Gs=null,Hs=!1,Js=0,Qs=null,t)throw Error(i(300));null===e||Io||null!==(e=e.dependencies)&&Mr(e)&&(Io=!0)}function ai(e,t,a,n){Gs=e;var r=0;do{if(Ks&&(Qs=null),Js=0,Ks=!1,25<=r)throw Error(i(301));if(r+=1,Vs=zs=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}R.H=yo,s=t(a,n)}while(Ks);return s}function ni(){var e=R.H,t=e.useState()[0];return t="function"===typeof t.then?ci(t):t,e=e.useState()[0],(null!==zs?zs.memoizedState:null)!==e&&(Gs.flags|=1024),t}function ri(){var e=0!==Ys;return Ys=0,e}function si(e,t,a){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a}function ii(e){if(Hs){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Hs=!1}Bs=0,Vs=zs=Gs=null,Ks=!1,Js=Ys=0,Qs=null}function oi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Vs?Gs.memoizedState=Vs=e:Vs=Vs.next=e,Vs}function li(){if(null===zs){var e=Gs.alternate;e=null!==e?e.memoizedState:null}else e=zs.next;var t=null===Vs?Gs.memoizedState:Vs.next;if(null!==t)Vs=t,zs=e;else{if(null===e){if(null===Gs.alternate)throw Error(i(467));throw Error(i(310))}e={memoizedState:(zs=e).memoizedState,baseState:zs.baseState,baseQueue:zs.baseQueue,queue:zs.queue,next:null},null===Vs?Gs.memoizedState=Vs=e:Vs=Vs.next=e}return Vs}function ci(e){var t=Js;return Js+=1,null===Qs&&(Qs=[]),e=as(Qs,e,t),t=Gs,null===(null===Vs?t.memoizedState:Vs.next)&&(t=t.alternate,R.H=null===t||null===t.memoizedState?go:vo),e}function di(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return ci(e);if(e.$$typeof===w)return Er(e)}throw Error(i(438,String(e)))}function ui(e){var t=null,a=Gs.updateQueue;if(null!==a&&(t=a.memoCache),null==t){var n=Gs.alternate;null!==n&&(null!==(n=n.updateQueue)&&(null!=(n=n.memoCache)&&(t={data:n.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===a&&(a={lastEffect:null,events:null,stores:null,memoCache:null},Gs.updateQueue=a),a.memoCache=t,void 0===(a=t.data[t.index]))for(a=t.data[t.index]=Array(e),n=0;n<e;n++)a[n]=_;return t.index++,a}function mi(e,t){return"function"===typeof t?t(e):t}function hi(e){return pi(li(),zs,e)}function pi(e,t,a){var n=e.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=a;var r=e.baseQueue,s=n.pending;if(null!==s){if(null!==r){var o=r.next;r.next=s.next,s.next=o}t.baseQueue=r=s,n.pending=null}if(s=e.baseState,null===r)e.memoizedState=s;else{var l=o=null,c=null,d=t=r.next,u=!1;do{var m=-536870913&d.lane;if(m!==d.lane?(gc&m)===m:(Bs&m)===m){var h=d.revertLane;if(0===h)null!==c&&(c=c.next={lane:0,revertLane:0,gesture:null,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),m===zr&&(u=!0);else{if((Bs&h)===h){d=d.next,h===zr&&(u=!0);continue}m={lane:0,revertLane:d.revertLane,gesture:null,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(l=c=m,o=s):c=c.next=m,Gs.lanes|=h,Nc|=h}m=d.action,Ws&&a(s,m),s=d.hasEagerState?d.eagerState:a(s,m)}else h={lane:m,revertLane:d.revertLane,gesture:d.gesture,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(l=c=h,o=s):c=c.next=h,Gs.lanes|=m,Nc|=m;d=d.next}while(null!==d&&d!==t);if(null===c?o=s:c.next=l,!$a(s,e.memoizedState)&&(Io=!0,u&&null!==(a=Vr)))throw a;e.memoizedState=s,e.baseState=o,e.baseQueue=c,n.lastRenderedState=s}return null===r&&(n.lanes=0),[e.memoizedState,n.dispatch]}function fi(e){var t=li(),a=t.queue;if(null===a)throw Error(i(311));a.lastRenderedReducer=e;var n=a.dispatch,r=a.pending,s=t.memoizedState;if(null!==r){a.pending=null;var o=r=r.next;do{s=e(s,o.action),o=o.next}while(o!==r);$a(s,t.memoizedState)||(Io=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),a.lastRenderedState=s}return[s,n]}function gi(e,t,a){var n=Gs,r=li(),s=ur;if(s){if(void 0===a)throw Error(i(407));a=a()}else a=t();var o=!$a((zs||r).memoizedState,a);if(o&&(r.memoizedState=a,Io=!0),r=r.queue,Bi(bi.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==Vs&&1&Vs.memoizedState.tag){if(n.flags|=2048,Di(9,{destroy:void 0},yi.bind(null,n,r,a,t),null),null===pc)throw Error(i(349));s||0!==(127&Bs)||vi(n,t,a)}return a}function vi(e,t,a){e.flags|=16384,e={getSnapshot:t,value:a},null===(t=Gs.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Gs.updateQueue=t,t.stores=[e]):null===(a=t.stores)?t.stores=[e]:a.push(e)}function yi(e,t,a,n){t.value=a,t.getSnapshot=n,xi(t)&&wi(e)}function bi(e,t,a){return a(function(){xi(t)&&wi(e)})}function xi(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!$a(e,a)}catch(n){return!0}}function wi(e){var t=In(e,2);null!==t&&Yc(t,e,2)}function Si(e){var t=oi();if("function"===typeof e){var a=e;if(e=a(),Ws){be(!0);try{a()}finally{be(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:e},t}function ki(e,t,a,n){return e.baseState=a,pi(e,zs,"function"===typeof n?n:mi)}function Ni(e,t,a,n,r){if(mo(e))throw Error(i(485));if(null!==(e=t.action)){var s={payload:r,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==R.T?a(!0):s.isTransition=!1,n(s),null===(a=t.pending)?(s.next=t.pending=s,ji(t,s)):(s.next=a.next,t.pending=a.next=s)}}function ji(e,t){var a=t.action,n=t.payload,r=e.state;if(t.isTransition){var s=R.T,i={};R.T=i;try{var o=a(r,n),l=R.S;null!==l&&l(i,o),Ti(e,t,o)}catch(c){_i(e,t,c)}finally{null!==s&&null!==i.types&&(s.types=i.types),R.T=s}}else try{Ti(e,t,s=a(r,n))}catch(d){_i(e,t,d)}}function Ti(e,t,a){null!==a&&"object"===typeof a&&"function"===typeof a.then?a.then(function(a){Ai(e,t,a)},function(a){return _i(e,t,a)}):Ai(e,t,a)}function Ai(e,t,a){t.status="fulfilled",t.value=a,Ci(t),e.state=a,null!==(t=e.pending)&&((a=t.next)===t?e.pending=null:(a=a.next,t.next=a,ji(e,a)))}function _i(e,t,a){var n=e.pending;if(e.pending=null,null!==n){n=n.next;do{t.status="rejected",t.reason=a,Ci(t),t=t.next}while(t!==n)}e.action=null}function Ci(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Mi(e,t){return t}function Pi(e,t){if(ur){var a=pc.formState;if(null!==a){e:{var n=Gs;if(ur){if(dr){t:{for(var r=dr,s=hr;8!==r.nodeType;){if(!s){r=null;break t}if(null===(r=Iu(r.nextSibling))){r=null;break t}}r="F!"===(s=r.data)||"F"===s?r:null}if(r){dr=Iu(r.nextSibling),n="F!"===r.data;break e}}fr(n)}n=!1}n&&(t=a[0])}}return(a=oi()).memoizedState=a.baseState=t,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mi,lastRenderedState:t},a.queue=n,a=lo.bind(null,Gs,n),n.dispatch=a,n=Si(!1),s=uo.bind(null,Gs,!1,n.queue),r={state:t,dispatch:null,action:e,pending:null},(n=oi()).queue=r,a=Ni.bind(null,Gs,r,s,a),r.dispatch=a,n.memoizedState=e,[t,a,!1]}function Ei(e){return Ii(li(),zs,e)}function Ii(e,t,a){if(t=pi(e,t,Mi)[0],e=hi(mi)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var n=ci(t)}catch(i){if(i===$r)throw Zr;throw i}else n=t;var r=(t=li()).queue,s=r.dispatch;return a!==t.memoizedState&&(Gs.flags|=2048,Di(9,{destroy:void 0},Ri.bind(null,r,a),null)),[n,s,e]}function Ri(e,t){e.action=t}function Oi(e){var t=li(),a=zs;if(null!==a)return Ii(t,a,e);li(),t=t.memoizedState;var n=(a=li()).queue.dispatch;return a.memoizedState=e,[t,n,!1]}function Di(e,t,a,n){return e={tag:e,create:a,deps:n,inst:t,next:null},null===(t=Gs.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Gs.updateQueue=t),null===(a=t.lastEffect)?t.lastEffect=e.next=e:(n=a.next,a.next=e,e.next=n,t.lastEffect=e),e}function Fi(){return li().memoizedState}function Li(e,t,a,n){var r=oi();Gs.flags|=e,r.memoizedState=Di(1|t,{destroy:void 0},a,void 0===n?null:n)}function qi(e,t,a,n){var r=li();n=void 0===n?null:n;var s=r.memoizedState.inst;null!==zs&&null!==n&&Zs(n,zs.memoizedState.deps)?r.memoizedState=Di(t,s,a,n):(Gs.flags|=e,r.memoizedState=Di(1|t,s,a,n))}function Ui(e,t){Li(8390656,8,e,t)}function Bi(e,t){qi(2048,8,e,t)}function Gi(e){var t=li().memoizedState;return function(e){Gs.flags|=4;var t=Gs.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},Gs.updateQueue=t,t.events=[e];else{var a=t.events;null===a?t.events=[e]:a.push(e)}}({ref:t,nextImpl:e}),function(){if(0!==(2&hc))throw Error(i(440));return t.impl.apply(void 0,arguments)}}function zi(e,t){return qi(4,2,e,t)}function Vi(e,t){return qi(4,4,e,t)}function Hi(e,t){if("function"===typeof t){e=e();var a=t(e);return function(){"function"===typeof a?a():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Ki(e,t,a){a=null!==a&&void 0!==a?a.concat([e]):null,qi(4,4,Hi.bind(null,t,e),a)}function Wi(){}function Yi(e,t){var a=li();t=void 0===t?null:t;var n=a.memoizedState;return null!==t&&Zs(t,n[1])?n[0]:(a.memoizedState=[e,t],e)}function Ji(e,t){var a=li();t=void 0===t?null:t;var n=a.memoizedState;if(null!==t&&Zs(t,n[1]))return n[0];if(n=e(),Ws){be(!0);try{e()}finally{be(!1)}}return a.memoizedState=[n,t],n}function Qi(e,t,a){return void 0===a||0!==(1073741824&Bs)&&0===(261930&gc)?e.memoizedState=t:(e.memoizedState=a,e=Wc(),Gs.lanes|=e,Nc|=e,a)}function $i(e,t,a,n){return $a(a,t)?a:null!==As.current?(e=Qi(e,a,n),$a(e,t)||(Io=!0),e):0===(42&Bs)||0!==(1073741824&Bs)&&0===(261930&gc)?(Io=!0,e.memoizedState=a):(e=Wc(),Gs.lanes|=e,Nc|=e,t)}function Xi(e,t,a,n,r){var s=O.p;O.p=0!==s&&8>s?s:8;var i=R.T,o={};R.T=o,uo(e,!1,t,a);try{var l=r(),c=R.S;if(null!==c&&c(o,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)co(e,t,function(e,t){var a=[],n={status:"pending",value:null,reason:null,then:function(e){a.push(e)}};return e.then(function(){n.status="fulfilled",n.value=t;for(var e=0;e<a.length;e++)(0,a[e])(t)},function(e){for(n.status="rejected",n.reason=e,e=0;e<a.length;e++)(0,a[e])(void 0)}),n}(l,n),Kc());else co(e,t,n,Kc())}catch(d){co(e,t,{then:function(){},status:"rejected",reason:d},Kc())}finally{O.p=s,null!==i&&null!==o.types&&(i.types=o.types),R.T=i}}function Zi(){}function eo(e,t,a,n){if(5!==e.tag)throw Error(i(476));var r=to(e).queue;Xi(e,r,t,D,null===a?Zi:function(){return ao(e),a(n)})}function to(e){var t=e.memoizedState;if(null!==t)return t;var a={};return(t={memoizedState:D,baseState:D,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:D},next:null}).next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:a},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function ao(e){var t=to(e);null===t.next&&(t=e.alternate.memoizedState),co(e,t.next.queue,{},Kc())}function no(){return Er(dm)}function ro(){return li().memoizedState}function so(){return li().memoizedState}function io(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var a=Kc(),n=bs(t,e=ys(a),a);return null!==n&&(Yc(n,t,a),xs(n,t,a)),t={cache:qr()},void(e.payload=t)}t=t.return}}function oo(e,t,a){var n=Kc();a={lane:n,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null},mo(e)?ho(t,a):null!==(a=En(e,t,a,n))&&(Yc(a,e,n),po(a,t,n))}function lo(e,t,a){co(e,t,a,Kc())}function co(e,t,a,n){var r={lane:n,revertLane:0,gesture:null,action:a,hasEagerState:!1,eagerState:null,next:null};if(mo(e))ho(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=s(i,a);if(r.hasEagerState=!0,r.eagerState=o,$a(o,i))return Pn(e,t,r,0),null===pc&&Mn(),!1}catch(l){}if(null!==(a=En(e,t,r,n)))return Yc(a,e,n),po(a,t,n),!0}return!1}function uo(e,t,a,n){if(n={lane:2,revertLane:Gd(),gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},mo(e)){if(t)throw Error(i(479))}else null!==(t=En(e,a,n,2))&&Yc(t,e,2)}function mo(e){var t=e.alternate;return e===Gs||null!==t&&t===Gs}function ho(e,t){Ks=Hs=!0;var a=e.pending;null===a?t.next=t:(t.next=a.next,a.next=t),e.pending=t}function po(e,t,a){if(0!==(4194048&a)){var n=t.lanes;a|=n&=e.pendingLanes,t.lanes=a,Re(e,a)}}var fo={readContext:Er,use:di,useCallback:Xs,useContext:Xs,useEffect:Xs,useImperativeHandle:Xs,useLayoutEffect:Xs,useInsertionEffect:Xs,useMemo:Xs,useReducer:Xs,useRef:Xs,useState:Xs,useDebugValue:Xs,useDeferredValue:Xs,useTransition:Xs,useSyncExternalStore:Xs,useId:Xs,useHostTransitionStatus:Xs,useFormState:Xs,useActionState:Xs,useOptimistic:Xs,useMemoCache:Xs,useCacheRefresh:Xs};fo.useEffectEvent=Xs;var go={readContext:Er,use:di,useCallback:function(e,t){return oi().memoizedState=[e,void 0===t?null:t],e},useContext:Er,useEffect:Ui,useImperativeHandle:function(e,t,a){a=null!==a&&void 0!==a?a.concat([e]):null,Li(4194308,4,Hi.bind(null,t,e),a)},useLayoutEffect:function(e,t){return Li(4194308,4,e,t)},useInsertionEffect:function(e,t){Li(4,2,e,t)},useMemo:function(e,t){var a=oi();t=void 0===t?null:t;var n=e();if(Ws){be(!0);try{e()}finally{be(!1)}}return a.memoizedState=[n,t],n},useReducer:function(e,t,a){var n=oi();if(void 0!==a){var r=a(t);if(Ws){be(!0);try{a(t)}finally{be(!1)}}}else r=t;return n.memoizedState=n.baseState=r,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},n.queue=e,e=e.dispatch=oo.bind(null,Gs,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},oi().memoizedState=e},useState:function(e){var t=(e=Si(e)).queue,a=lo.bind(null,Gs,t);return t.dispatch=a,[e.memoizedState,a]},useDebugValue:Wi,useDeferredValue:function(e,t){return Qi(oi(),e,t)},useTransition:function(){var e=Si(!1);return e=Xi.bind(null,Gs,e.queue,!0,!1),oi().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,a){var n=Gs,r=oi();if(ur){if(void 0===a)throw Error(i(407));a=a()}else{if(a=t(),null===pc)throw Error(i(349));0!==(127&gc)||vi(n,t,a)}r.memoizedState=a;var s={value:a,getSnapshot:t};return r.queue=s,Ui(bi.bind(null,n,s,e),[e]),n.flags|=2048,Di(9,{destroy:void 0},yi.bind(null,n,s,a,t),null),a},useId:function(){var e=oi(),t=pc.identifierPrefix;if(ur){var a=nr;t="_"+t+"R_"+(a=(ar&~(1<<32-xe(ar)-1)).toString(32)+a),0<(a=Ys++)&&(t+="H"+a.toString(32)),t+="_"}else t="_"+t+"r_"+(a=$s++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:no,useFormState:Pi,useActionState:Pi,useOptimistic:function(e){var t=oi();t.memoizedState=t.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=a,t=uo.bind(null,Gs,!0,a),a.dispatch=t,[e,t]},useMemoCache:ui,useCacheRefresh:function(){return oi().memoizedState=io.bind(null,Gs)},useEffectEvent:function(e){var t=oi(),a={impl:e};return t.memoizedState=a,function(){if(0!==(2&hc))throw Error(i(440));return a.impl.apply(void 0,arguments)}}},vo={readContext:Er,use:di,useCallback:Yi,useContext:Er,useEffect:Bi,useImperativeHandle:Ki,useInsertionEffect:zi,useLayoutEffect:Vi,useMemo:Ji,useReducer:hi,useRef:Fi,useState:function(){return hi(mi)},useDebugValue:Wi,useDeferredValue:function(e,t){return $i(li(),zs.memoizedState,e,t)},useTransition:function(){var e=hi(mi)[0],t=li().memoizedState;return["boolean"===typeof e?e:ci(e),t]},useSyncExternalStore:gi,useId:ro,useHostTransitionStatus:no,useFormState:Ei,useActionState:Ei,useOptimistic:function(e,t){return ki(li(),0,e,t)},useMemoCache:ui,useCacheRefresh:so};vo.useEffectEvent=Gi;var yo={readContext:Er,use:di,useCallback:Yi,useContext:Er,useEffect:Bi,useImperativeHandle:Ki,useInsertionEffect:zi,useLayoutEffect:Vi,useMemo:Ji,useReducer:fi,useRef:Fi,useState:function(){return fi(mi)},useDebugValue:Wi,useDeferredValue:function(e,t){var a=li();return null===zs?Qi(a,e,t):$i(a,zs.memoizedState,e,t)},useTransition:function(){var e=fi(mi)[0],t=li().memoizedState;return["boolean"===typeof e?e:ci(e),t]},useSyncExternalStore:gi,useId:ro,useHostTransitionStatus:no,useFormState:Oi,useActionState:Oi,useOptimistic:function(e,t){var a=li();return null!==zs?ki(a,0,e,t):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:ui,useCacheRefresh:so};function bo(e,t,a,n){a=null===(a=a(n,t=e.memoizedState))||void 0===a?t:h({},t,a),e.memoizedState=a,0===e.lanes&&(e.updateQueue.baseState=a)}yo.useEffectEvent=Gi;var xo={enqueueSetState:function(e,t,a){e=e._reactInternals;var n=Kc(),r=ys(n);r.payload=t,void 0!==a&&null!==a&&(r.callback=a),null!==(t=bs(e,r,n))&&(Yc(t,e,n),xs(t,e,n))},enqueueReplaceState:function(e,t,a){e=e._reactInternals;var n=Kc(),r=ys(n);r.tag=1,r.payload=t,void 0!==a&&null!==a&&(r.callback=a),null!==(t=bs(e,r,n))&&(Yc(t,e,n),xs(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var a=Kc(),n=ys(a);n.tag=2,void 0!==t&&null!==t&&(n.callback=t),null!==(t=bs(e,n,a))&&(Yc(t,e,a),xs(t,e,a))}};function wo(e,t,a,n,r,s,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,s,i):!t.prototype||!t.prototype.isPureReactComponent||(!Xa(a,n)||!Xa(r,s))}function So(e,t,a,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(a,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(a,n),t.state!==e&&xo.enqueueReplaceState(t,t.state,null)}function ko(e,t){var a=t;if("ref"in t)for(var n in a={},t)"ref"!==n&&(a[n]=t[n]);if(e=e.defaultProps)for(var r in a===t&&(a=h({},a)),e)void 0===a[r]&&(a[r]=e[r]);return a}function No(e){Tn(e)}function jo(e){console.error(e)}function To(e){Tn(e)}function Ao(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(a){setTimeout(function(){throw a})}}function _o(e,t,a){try{(0,e.onCaughtError)(a.value,{componentStack:a.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(n){setTimeout(function(){throw n})}}function Co(e,t,a){return(a=ys(a)).tag=3,a.payload={element:null},a.callback=function(){Ao(e,t)},a}function Mo(e){return(e=ys(e)).tag=3,e}function Po(e,t,a,n){var r=a.type.getDerivedStateFromError;if("function"===typeof r){var s=n.value;e.payload=function(){return r(s)},e.callback=function(){_o(t,a,n)}}var i=a.stateNode;null!==i&&"function"===typeof i.componentDidCatch&&(e.callback=function(){_o(t,a,n),"function"!==typeof r&&(null===Dc?Dc=new Set([this]):Dc.add(this));var e=n.stack;this.componentDidCatch(n.value,{componentStack:null!==e?e:""})})}var Eo=Error(i(461)),Io=!1;function Ro(e,t,a,n){t.child=null===e?ps(t,null,a,n):hs(t,e.child,a,n)}function Oo(e,t,a,n,r){a=a.render;var s=t.ref;if("ref"in n){var i={};for(var o in n)"ref"!==o&&(i[o]=n[o])}else i=n;return Pr(t),n=ei(e,t,a,i,s,r),o=ri(),null===e||Io?(ur&&o&&ir(t),t.flags|=1,Ro(e,t,n,r),t.child):(si(e,t,r),rl(e,t,r))}function Do(e,t,a,n,r){if(null===e){var s=a.type;return"function"!==typeof s||qn(s)||void 0!==s.defaultProps||null!==a.compare?((e=Gn(a.type,null,n,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Fo(e,t,s,n,r))}if(s=e.child,!sl(e,r)){var i=s.memoizedProps;if((a=null!==(a=a.compare)?a:Xa)(i,n)&&e.ref===t.ref)return rl(e,t,r)}return t.flags|=1,(e=Un(s,n)).ref=t.ref,e.return=t,t.child=e}function Fo(e,t,a,n,r){if(null!==e){var s=e.memoizedProps;if(Xa(s,n)&&e.ref===t.ref){if(Io=!1,t.pendingProps=n=s,!sl(e,r))return t.lanes=e.lanes,rl(e,t,r);0!==(131072&e.flags)&&(Io=!0)}}return Vo(e,t,a,n,r)}function Lo(e,t,a,n){var r=n.children,s=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===n.mode){if(0!==(128&t.flags)){if(s=null!==s?s.baseLanes|a:a,null!==e){for(n=t.child=e.child,r=0;null!==n;)r=r|n.lanes|n.childLanes,n=n.sibling;n=r&~s}else n=0,t.child=null;return Uo(e,t,s,a,n)}if(0===(536870912&a))return n=t.lanes=536870912,Uo(e,t,null!==s?s.baseLanes|a:a,a,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Jr(0,null!==s?s.cachePool:null),null!==s?Cs(t,s):Ms(),Ds(t)}else null!==s?(Jr(0,s.cachePool),Cs(t,s),Fs(),t.memoizedState=null):(null!==e&&Jr(0,null),Ms(),Fs());return Ro(e,t,r,a),t.child}function qo(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Uo(e,t,a,n,r){var s=Yr();return s=null===s?null:{parent:Lr._currentValue,pool:s},t.memoizedState={baseLanes:a,cachePool:s},null!==e&&Jr(0,null),Ms(),Ds(t),null!==e&&Cr(e,t,n,!0),t.childLanes=r,null}function Bo(e,t){return(t=Zo({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function Go(e,t,a){return hs(t,e.child,null,a),(e=Bo(t,t.pendingProps)).flags|=2,Ls(t),t.memoizedState=null,e}function zo(e,t){var a=t.ref;if(null===a)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof a&&"object"!==typeof a)throw Error(i(284));null!==e&&e.ref===a||(t.flags|=4194816)}}function Vo(e,t,a,n,r){return Pr(t),a=ei(e,t,a,n,void 0,r),n=ri(),null===e||Io?(ur&&n&&ir(t),t.flags|=1,Ro(e,t,a,r),t.child):(si(e,t,r),rl(e,t,r))}function Ho(e,t,a,n,r,s){return Pr(t),t.updateQueue=null,a=ai(t,n,a,r),ti(e),n=ri(),null===e||Io?(ur&&n&&ir(t),t.flags|=1,Ro(e,t,a,s),t.child):(si(e,t,s),rl(e,t,s))}function Ko(e,t,a,n,r){if(Pr(t),null===t.stateNode){var s=Dn,i=a.contextType;"object"===typeof i&&null!==i&&(s=Er(i)),s=new a(n,s),t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,s.updater=xo,t.stateNode=s,s._reactInternals=t,(s=t.stateNode).props=n,s.state=t.memoizedState,s.refs={},gs(t),i=a.contextType,s.context="object"===typeof i&&null!==i?Er(i):Dn,s.state=t.memoizedState,"function"===typeof(i=a.getDerivedStateFromProps)&&(bo(t,a,i,n),s.state=t.memoizedState),"function"===typeof a.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(i=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),i!==s.state&&xo.enqueueReplaceState(s,s.state,null),Ns(t,n,s,r),ks(),s.state=t.memoizedState),"function"===typeof s.componentDidMount&&(t.flags|=4194308),n=!0}else if(null===e){s=t.stateNode;var o=t.memoizedProps,l=ko(a,o);s.props=l;var c=s.context,d=a.contextType;i=Dn,"object"===typeof d&&null!==d&&(i=Er(d));var u=a.getDerivedStateFromProps;d="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate,o=t.pendingProps!==o,d||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o||c!==i)&&So(t,s,n,i),fs=!1;var m=t.memoizedState;s.state=m,Ns(t,n,s,r),ks(),c=t.memoizedState,o||m!==c||fs?("function"===typeof u&&(bo(t,a,u,n),c=t.memoizedState),(l=fs||wo(t,a,l,n,m,c,i))?(d||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),s.props=n,s.state=c,s.context=i,n=l):("function"===typeof s.componentDidMount&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,vs(e,t),d=ko(a,i=t.memoizedProps),s.props=d,u=t.pendingProps,m=s.context,c=a.contextType,l=Dn,"object"===typeof c&&null!==c&&(l=Er(c)),(c="function"===typeof(o=a.getDerivedStateFromProps)||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(i!==u||m!==l)&&So(t,s,n,l),fs=!1,m=t.memoizedState,s.state=m,Ns(t,n,s,r),ks();var h=t.memoizedState;i!==u||m!==h||fs||null!==e&&null!==e.dependencies&&Mr(e.dependencies)?("function"===typeof o&&(bo(t,a,o,n),h=t.memoizedState),(d=fs||wo(t,a,d,n,m,h,l)||null!==e&&null!==e.dependencies&&Mr(e.dependencies))?(c||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(n,h,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(n,h,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=h),s.props=n,s.state=h,s.context=l,n=d):("function"!==typeof s.componentDidUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return s=n,zo(e,t),n=0!==(128&t.flags),s||n?(s=t.stateNode,a=n&&"function"!==typeof a.getDerivedStateFromError?null:s.render(),t.flags|=1,null!==e&&n?(t.child=hs(t,e.child,null,r),t.child=hs(t,null,a,r)):Ro(e,t,a,r),t.memoizedState=s.state,e=t.child):e=rl(e,t,r),e}function Wo(e,t,a,n){return br(),t.flags|=256,Ro(e,t,a,n),t.child}var Yo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Jo(e){return{baseLanes:e,cachePool:Qr()}}function Qo(e,t,a){return e=null!==e?e.childLanes&~a:0,t&&(e|=Ac),e}function $o(e,t,a){var n,r=t.pendingProps,s=!1,o=0!==(128&t.flags);if((n=o)||(n=(null===e||null!==e.memoizedState)&&0!==(2&qs.current)),n&&(s=!0,t.flags&=-129),n=0!==(32&t.flags),t.flags&=-33,null===e){if(ur){if(s?Rs(t):Fs(),(e=dr)?null!==(e=null!==(e=Mu(e,hr))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==tr?{id:ar,overflow:nr}:null,retryLane:536870912,hydrationErrors:null},(a=Hn(e)).return=t,t.child=a,cr=t,dr=null):e=null,null===e)throw fr(t);return Eu(e)?t.lanes=32:t.lanes=536870912,null}var l=r.children;return r=r.fallback,s?(Fs(),l=Zo({mode:"hidden",children:l},s=t.mode),r=zn(r,s,a,null),l.return=t,r.return=t,l.sibling=r,t.child=l,(r=t.child).memoizedState=Jo(a),r.childLanes=Qo(e,n,a),t.memoizedState=Yo,qo(null,r)):(Rs(t),Xo(t,l))}var c=e.memoizedState;if(null!==c&&null!==(l=c.dehydrated)){if(o)256&t.flags?(Rs(t),t.flags&=-257,t=el(e,t,a)):null!==t.memoizedState?(Fs(),t.child=e.child,t.flags|=128,t=null):(Fs(),l=r.fallback,s=t.mode,r=Zo({mode:"visible",children:r.children},s),(l=zn(l,s,a,null)).flags|=2,r.return=t,l.return=t,r.sibling=l,t.child=r,hs(t,e.child,null,a),(r=t.child).memoizedState=Jo(a),r.childLanes=Qo(e,n,a),t.memoizedState=Yo,t=qo(null,r));else if(Rs(t),Eu(l)){if(n=l.nextSibling&&l.nextSibling.dataset)var d=n.dgst;n=d,(r=Error(i(419))).stack="",r.digest=n,wr({value:r,source:null,stack:null}),t=el(e,t,a)}else if(Io||Cr(e,t,a,!1),n=0!==(a&e.childLanes),Io||n){if(null!==(n=pc)&&(0!==(r=Oe(n,a))&&r!==c.retryLane))throw c.retryLane=r,In(e,r),Yc(n,e,r),Eo;Pu(l)||id(),t=el(e,t,a)}else Pu(l)?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,dr=Iu(l.nextSibling),cr=t,ur=!0,mr=null,hr=!1,null!==e&&lr(t,e),(t=Xo(t,r.children)).flags|=4096);return t}return s?(Fs(),l=r.fallback,s=t.mode,d=(c=e.child).sibling,(r=Un(c,{mode:"hidden",children:r.children})).subtreeFlags=65011712&c.subtreeFlags,null!==d?l=Un(d,l):(l=zn(l,s,a,null)).flags|=2,l.return=t,r.return=t,r.sibling=l,t.child=r,qo(null,r),r=t.child,null===(l=e.child.memoizedState)?l=Jo(a):(null!==(s=l.cachePool)?(c=Lr._currentValue,s=s.parent!==c?{parent:c,pool:c}:s):s=Qr(),l={baseLanes:l.baseLanes|a,cachePool:s}),r.memoizedState=l,r.childLanes=Qo(e,n,a),t.memoizedState=Yo,qo(e.child,r)):(Rs(t),e=(a=e.child).sibling,(a=Un(a,{mode:"visible",children:r.children})).return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a)}function Xo(e,t){return(t=Zo({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Zo(e,t){return(e=Ln(22,e,null,t)).lanes=0,e}function el(e,t,a){return hs(t,e.child,null,a),(e=Xo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function tl(e,t,a){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Ar(e.return,t,a)}function al(e,t,a,n,r,s){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:a,tailMode:r,treeForkCount:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=a,i.tailMode=r,i.treeForkCount=s)}function nl(e,t,a){var n=t.pendingProps,r=n.revealOrder,s=n.tail;n=n.children;var i=qs.current,o=0!==(2&i);if(o?(i=1&i|2,t.flags|=128):i&=1,B(qs,i),Ro(e,t,n,a),n=ur?Xn:0,!o&&null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&tl(e,a,t);else if(19===e.tag)tl(e,a,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(r){case"forwards":for(a=t.child,r=null;null!==a;)null!==(e=a.alternate)&&null===Us(e)&&(r=a),a=a.sibling;null===(a=r)?(r=t.child,t.child=null):(r=a.sibling,a.sibling=null),al(t,!1,r,a,s,n);break;case"backwards":case"unstable_legacy-backwards":for(a=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===Us(e)){t.child=r;break}e=r.sibling,r.sibling=a,a=r,r=e}al(t,!0,a,null,s,n);break;case"together":al(t,!1,null,null,void 0,n);break;default:t.memoizedState=null}return t.child}function rl(e,t,a){if(null!==e&&(t.dependencies=e.dependencies),Nc|=t.lanes,0===(a&t.childLanes)){if(null===e)return null;if(Cr(e,t,a,!1),0===(a&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(a=Un(e=t.child,e.pendingProps),t.child=a,a.return=t;null!==e.sibling;)e=e.sibling,(a=a.sibling=Un(e,e.pendingProps)).return=t;a.sibling=null}return t.child}function sl(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Mr(e))}function il(e,t,a){if(null!==e)if(e.memoizedProps!==t.pendingProps)Io=!0;else{if(!sl(e,a)&&0===(128&t.flags))return Io=!1,function(e,t,a){switch(t.tag){case 3:Y(t,t.stateNode.containerInfo),jr(0,Lr,e.memoizedState.cache),br();break;case 27:case 5:Q(t);break;case 4:Y(t,t.stateNode.containerInfo);break;case 10:jr(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Os(t),null;break;case 13:var n=t.memoizedState;if(null!==n)return null!==n.dehydrated?(Rs(t),t.flags|=128,null):0!==(a&t.child.childLanes)?$o(e,t,a):(Rs(t),null!==(e=rl(e,t,a))?e.sibling:null);Rs(t);break;case 19:var r=0!==(128&e.flags);if((n=0!==(a&t.childLanes))||(Cr(e,t,a,!1),n=0!==(a&t.childLanes)),r){if(n)return nl(e,t,a);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),B(qs,qs.current),n)break;return null;case 22:return t.lanes=0,Lo(e,t,a,t.pendingProps);case 24:jr(0,Lr,e.memoizedState.cache)}return rl(e,t,a)}(e,t,a);Io=0!==(131072&e.flags)}else Io=!1,ur&&0!==(1048576&t.flags)&&sr(t,Xn,t.index);switch(t.lanes=0,t.tag){case 16:e:{var n=t.pendingProps;if(e=ns(t.elementType),t.type=e,"function"!==typeof e){if(void 0!==e&&null!==e){var r=e.$$typeof;if(r===S){t.tag=11,t=Oo(null,t,e,n,a);break e}if(r===j){t.tag=14,t=Do(null,t,e,n,a);break e}}throw t=E(e)||e,Error(i(306,t,""))}qn(e)?(n=ko(e,n),t.tag=1,t=Ko(null,t,e,n,a)):(t.tag=0,t=Vo(null,t,e,n,a))}return t;case 0:return Vo(e,t,t.type,t.pendingProps,a);case 1:return Ko(e,t,n=t.type,r=ko(n,t.pendingProps),a);case 3:e:{if(Y(t,t.stateNode.containerInfo),null===e)throw Error(i(387));n=t.pendingProps;var s=t.memoizedState;r=s.element,vs(e,t),Ns(t,n,null,a);var o=t.memoizedState;if(n=o.cache,jr(0,Lr,n),n!==s.cache&&_r(t,[Lr],a,!0),ks(),n=o.element,s.isDehydrated){if(s={element:n,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Wo(e,t,n,a);break e}if(n!==r){wr(r=Yn(Error(i(424)),t)),t=Wo(e,t,n,a);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(dr=Iu(e.firstChild),cr=t,ur=!0,mr=null,hr=!0,a=ps(t,null,n,a),t.child=a;a;)a.flags=-3&a.flags|4096,a=a.sibling}else{if(br(),n===r){t=rl(e,t,a);break e}Ro(e,t,n,a)}t=t.child}return t;case 26:return zo(e,t),null===e?(a=Hu(t.type,null,t.pendingProps,null))?t.memoizedState=a:ur||(a=t.type,e=t.pendingProps,(n=gu(K.current).createElement(a))[Be]=t,n[Ge]=e,mu(n,a,e),et(n),t.stateNode=n):t.memoizedState=Hu(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Q(t),null===e&&ur&&(n=t.stateNode=Fu(t.type,t.pendingProps,K.current),cr=t,hr=!0,r=dr,Tu(t.type)?(Ru=r,dr=Iu(n.firstChild)):dr=r),Ro(e,t,t.pendingProps.children,a),zo(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&ur&&((r=n=dr)&&(null!==(n=function(e,t,a,n){for(;1===e.nodeType;){var r=a;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!n&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(n){if(!e[Ye])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(s=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(s!==r.rel||e.getAttribute("href")!==(null==r.href||""===r.href?null:r.href)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin)||e.getAttribute("title")!==(null==r.title?null:r.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((s=e.getAttribute("src"))!==(null==r.src?null:r.src)||e.getAttribute("type")!==(null==r.type?null:r.type)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin))&&s&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var s=null==r.name?null:""+r.name;if("hidden"===r.type&&e.getAttribute("name")===s)return e}if(null===(e=Iu(e.nextSibling)))break}return null}(n,t.type,t.pendingProps,hr))?(t.stateNode=n,cr=t,dr=Iu(n.firstChild),hr=!1,r=!0):r=!1),r||fr(t)),Q(t),r=t.type,s=t.pendingProps,o=null!==e?e.memoizedProps:null,n=s.children,bu(r,s)?n=null:null!==o&&bu(r,o)&&(t.flags|=32),null!==t.memoizedState&&(r=ei(e,t,ni,null,null,a),dm._currentValue=r),zo(e,t),Ro(e,t,n,a),t.child;case 6:return null===e&&ur&&((e=a=dr)&&(null!==(a=function(e,t,a){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!a)return null;if(null===(e=Iu(e.nextSibling)))return null}return e}(a,t.pendingProps,hr))?(t.stateNode=a,cr=t,dr=null,e=!0):e=!1),e||fr(t)),null;case 13:return $o(e,t,a);case 4:return Y(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=hs(t,null,n,a):Ro(e,t,n,a),t.child;case 11:return Oo(e,t,t.type,t.pendingProps,a);case 7:return Ro(e,t,t.pendingProps,a),t.child;case 8:case 12:return Ro(e,t,t.pendingProps.children,a),t.child;case 10:return n=t.pendingProps,jr(0,t.type,n.value),Ro(e,t,n.children,a),t.child;case 9:return r=t.type._context,n=t.pendingProps.children,Pr(t),n=n(r=Er(r)),t.flags|=1,Ro(e,t,n,a),t.child;case 14:return Do(e,t,t.type,t.pendingProps,a);case 15:return Fo(e,t,t.type,t.pendingProps,a);case 19:return nl(e,t,a);case 31:return function(e,t,a){var n=t.pendingProps,r=0!==(128&t.flags);if(t.flags&=-129,null===e){if(ur){if("hidden"===n.mode)return e=Bo(t,n),t.lanes=536870912,qo(null,e);if(Os(t),(e=dr)?null!==(e=null!==(e=Mu(e,hr))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==tr?{id:ar,overflow:nr}:null,retryLane:536870912,hydrationErrors:null},(a=Hn(e)).return=t,t.child=a,cr=t,dr=null):e=null,null===e)throw fr(t);return t.lanes=536870912,null}return Bo(t,n)}var s=e.memoizedState;if(null!==s){var o=s.dehydrated;if(Os(t),r)if(256&t.flags)t.flags&=-257,t=Go(e,t,a);else{if(null===t.memoizedState)throw Error(i(558));t.child=e.child,t.flags|=128,t=null}else if(Io||Cr(e,t,a,!1),r=0!==(a&e.childLanes),Io||r){if(null!==(n=pc)&&0!==(o=Oe(n,a))&&o!==s.retryLane)throw s.retryLane=o,In(e,o),Yc(n,e,o),Eo;id(),t=Go(e,t,a)}else e=s.treeContext,dr=Iu(o.nextSibling),cr=t,ur=!0,mr=null,hr=!1,null!==e&&lr(t,e),(t=Bo(t,n)).flags|=4096;return t}return(e=Un(e.child,{mode:n.mode,children:n.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,a);case 22:return Lo(e,t,a,t.pendingProps);case 24:return Pr(t),n=Er(Lr),null===e?(null===(r=Yr())&&(r=pc,s=qr(),r.pooledCache=s,s.refCount++,null!==s&&(r.pooledCacheLanes|=a),r=s),t.memoizedState={parent:n,cache:r},gs(t),jr(0,Lr,r)):(0!==(e.lanes&a)&&(vs(e,t),Ns(t,null,null,a),ks()),r=e.memoizedState,s=t.memoizedState,r.parent!==n?(r={parent:n,cache:n},t.memoizedState=r,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=r),jr(0,Lr,n)):(n=s.cache,jr(0,Lr,n),n!==r.cache&&_r(t,[Lr],a,!0))),Ro(e,t,t.pendingProps.children,a),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function ol(e){e.flags|=4}function ll(e,t,a,n,r){if((t=0!==(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&r)===r)if(e.stateNode.complete)e.flags|=8192;else{if(!nd())throw rs=es,Xr;e.flags|=8192}}else e.flags&=-16777217}function cl(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!rm(t)){if(!nd())throw rs=es,Xr;e.flags|=8192}}function dl(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Me():536870912,e.lanes|=t,_c|=t)}function ul(e,t){if(!ur)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;null!==t;)null!==t.alternate&&(a=t),t=t.sibling;null===a?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var n=null;null!==a;)null!==a.alternate&&(n=a),a=a.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ml(e){var t=null!==e.alternate&&e.alternate.child===e.child,a=0,n=0;if(t)for(var r=e.child;null!==r;)a|=r.lanes|r.childLanes,n|=65011712&r.subtreeFlags,n|=65011712&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)a|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=n,e.childLanes=a,t}function hl(e,t,a){var n=t.pendingProps;switch(or(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return ml(t),null;case 3:return a=t.stateNode,n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Tr(Lr),J(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),null!==e&&null!==e.child||(yr(t)?ol(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,xr())),ml(t),null;case 26:var r=t.type,s=t.memoizedState;return null===e?(ol(t),null!==s?(ml(t),cl(t,s)):(ml(t),ll(t,r,0,0,a))):s?s!==e.memoizedState?(ol(t),ml(t),cl(t,s)):(ml(t),t.flags&=-16777217):((e=e.memoizedProps)!==n&&ol(t),ml(t),ll(t,r,0,0,a)),null;case 27:if($(t),a=K.current,r=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==n&&ol(t);else{if(!n){if(null===t.stateNode)throw Error(i(166));return ml(t),null}e=V.current,yr(t)?gr(t):(e=Fu(r,n,a),t.stateNode=e,ol(t))}return ml(t),null;case 5:if($(t),r=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==n&&ol(t);else{if(!n){if(null===t.stateNode)throw Error(i(166));return ml(t),null}if(s=V.current,yr(t))gr(t);else{var o=gu(K.current);switch(s){case 1:s=o.createElementNS("http://www.w3.org/2000/svg",r);break;case 2:s=o.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;default:switch(r){case"svg":s=o.createElementNS("http://www.w3.org/2000/svg",r);break;case"math":s=o.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;case"script":(s=o.createElement("div")).innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s="string"===typeof n.is?o.createElement("select",{is:n.is}):o.createElement("select"),n.multiple?s.multiple=!0:n.size&&(s.size=n.size);break;default:s="string"===typeof n.is?o.createElement(r,{is:n.is}):o.createElement(r)}}s[Be]=t,s[Ge]=n;e:for(o=t.child;null!==o;){if(5===o.tag||6===o.tag)s.appendChild(o.stateNode);else if(4!==o.tag&&27!==o.tag&&null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break e;for(;null===o.sibling;){if(null===o.return||o.return===t)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}t.stateNode=s;e:switch(mu(s,r,n),r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&ol(t)}}return ml(t),ll(t,t.type,null===e||e.memoizedProps,t.pendingProps,a),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==n&&ol(t);else{if("string"!==typeof n&&null===t.stateNode)throw Error(i(166));if(e=K.current,yr(t)){if(e=t.stateNode,a=t.memoizedProps,n=null,null!==(r=cr))switch(r.tag){case 27:case 5:n=r.memoizedProps}e[Be]=t,(e=!!(e.nodeValue===a||null!==n&&!0===n.suppressHydrationWarning||cu(e.nodeValue,a)))||fr(t,!0)}else(e=gu(e).createTextNode(n))[Be]=t,t.stateNode=e}return ml(t),null;case 31:if(a=t.memoizedState,null===e||null!==e.memoizedState){if(n=yr(t),null!==a){if(null===e){if(!n)throw Error(i(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(i(557));e[Be]=t}else br(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;ml(t),e=!1}else a=xr(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=a),e=!0;if(!e)return 256&t.flags?(Ls(t),t):(Ls(t),null);if(0!==(128&t.flags))throw Error(i(558))}return ml(t),null;case 13:if(n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(r=yr(t),null!==n&&null!==n.dehydrated){if(null===e){if(!r)throw Error(i(318));if(!(r=null!==(r=t.memoizedState)?r.dehydrated:null))throw Error(i(317));r[Be]=t}else br(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;ml(t),r=!1}else r=xr(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=r),r=!0;if(!r)return 256&t.flags?(Ls(t),t):(Ls(t),null)}return Ls(t),0!==(128&t.flags)?(t.lanes=a,t):(a=null!==n,e=null!==e&&null!==e.memoizedState,a&&(r=null,null!==(n=t.child).alternate&&null!==n.alternate.memoizedState&&null!==n.alternate.memoizedState.cachePool&&(r=n.alternate.memoizedState.cachePool.pool),s=null,null!==n.memoizedState&&null!==n.memoizedState.cachePool&&(s=n.memoizedState.cachePool.pool),s!==r&&(n.flags|=2048)),a!==e&&a&&(t.child.flags|=8192),dl(t,t.updateQueue),ml(t),null);case 4:return J(),null===e&&Zd(t.stateNode.containerInfo),ml(t),null;case 10:return Tr(t.type),ml(t),null;case 19:if(U(qs),null===(n=t.memoizedState))return ml(t),null;if(r=0!==(128&t.flags),null===(s=n.rendering))if(r)ul(n,!1);else{if(0!==kc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=Us(e))){for(t.flags|=128,ul(n,!1),e=s.updateQueue,t.updateQueue=e,dl(t,e),t.subtreeFlags=0,e=a,a=t.child;null!==a;)Bn(a,e),a=a.sibling;return B(qs,1&qs.current|2),ur&&rr(t,n.treeForkCount),t.child}e=e.sibling}null!==n.tail&&le()>Rc&&(t.flags|=128,r=!0,ul(n,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=Us(s))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,dl(t,e),ul(n,!0),null===n.tail&&"hidden"===n.tailMode&&!s.alternate&&!ur)return ml(t),null}else 2*le()-n.renderingStartTime>Rc&&536870912!==a&&(t.flags|=128,r=!0,ul(n,!1),t.lanes=4194304);n.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=n.last)?e.sibling=s:t.child=s,n.last=s)}return null!==n.tail?(e=n.tail,n.rendering=e,n.tail=e.sibling,n.renderingStartTime=le(),e.sibling=null,a=qs.current,B(qs,r?1&a|2:1&a),ur&&rr(t,n.treeForkCount),e):(ml(t),null);case 22:case 23:return Ls(t),Ps(),n=null!==t.memoizedState,null!==e?null!==e.memoizedState!==n&&(t.flags|=8192):n&&(t.flags|=8192),n?0!==(536870912&a)&&0===(128&t.flags)&&(ml(t),6&t.subtreeFlags&&(t.flags|=8192)):ml(t),null!==(a=t.updateQueue)&&dl(t,a.retryQueue),a=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(a=e.memoizedState.cachePool.pool),n=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(n=t.memoizedState.cachePool.pool),n!==a&&(t.flags|=2048),null!==e&&U(Wr),null;case 24:return a=null,null!==e&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),Tr(Lr),ml(t),null;case 25:case 30:return null}throw Error(i(156,t.tag))}function pl(e,t){switch(or(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Tr(Lr),J(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return $(t),null;case 31:if(null!==t.memoizedState){if(Ls(t),null===t.alternate)throw Error(i(340));br()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(Ls(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));br()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return U(qs),null;case 4:return J(),null;case 10:return Tr(t.type),null;case 22:case 23:return Ls(t),Ps(),null!==e&&U(Wr),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Tr(Lr),null;default:return null}}function fl(e,t){switch(or(t),t.tag){case 3:Tr(Lr),J();break;case 26:case 27:case 5:$(t);break;case 4:J();break;case 31:null!==t.memoizedState&&Ls(t);break;case 13:Ls(t);break;case 19:U(qs);break;case 10:Tr(t.type);break;case 22:case 23:Ls(t),Ps(),null!==e&&U(Wr);break;case 24:Tr(Lr)}}function gl(e,t){try{var a=t.updateQueue,n=null!==a?a.lastEffect:null;if(null!==n){var r=n.next;a=r;do{if((a.tag&e)===e){n=void 0;var s=a.create,i=a.inst;n=s(),i.destroy=n}a=a.next}while(a!==r)}}catch(o){kd(t,t.return,o)}}function vl(e,t,a){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var s=r.next;n=s;do{if((n.tag&e)===e){var i=n.inst,o=i.destroy;if(void 0!==o){i.destroy=void 0,r=t;var l=a,c=o;try{c()}catch(d){kd(r,l,d)}}}n=n.next}while(n!==s)}}catch(d){kd(t,t.return,d)}}function yl(e){var t=e.updateQueue;if(null!==t){var a=e.stateNode;try{Ts(t,a)}catch(n){kd(e,e.return,n)}}}function bl(e,t,a){a.props=ko(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(n){kd(e,t,n)}}function xl(e,t){try{var a=e.ref;if(null!==a){switch(e.tag){case 26:case 27:case 5:var n=e.stateNode;break;default:n=e.stateNode}"function"===typeof a?e.refCleanup=a(n):a.current=n}}catch(r){kd(e,t,r)}}function wl(e,t){var a=e.ref,n=e.refCleanup;if(null!==a)if("function"===typeof n)try{n()}catch(r){kd(e,t,r)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof a)try{a(null)}catch(s){kd(e,t,s)}else a.current=null}function Sl(e){var t=e.type,a=e.memoizedProps,n=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":a.autoFocus&&n.focus();break e;case"img":a.src?n.src=a.src:a.srcSet&&(n.srcset=a.srcSet)}}catch(r){kd(e,e.return,r)}}function kl(e,t,a){try{var n=e.stateNode;!function(e,t,a,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,s=null,o=null,l=null,c=null,d=null,u=null;for(p in a){var m=a[p];if(a.hasOwnProperty(p)&&null!=m)switch(p){case"checked":case"value":break;case"defaultValue":c=m;default:n.hasOwnProperty(p)||du(e,t,p,null,n,m)}}for(var h in n){var p=n[h];if(m=a[h],n.hasOwnProperty(h)&&(null!=p||null!=m))switch(h){case"type":s=p;break;case"name":r=p;break;case"checked":d=p;break;case"defaultChecked":u=p;break;case"value":o=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(i(137,t));break;default:p!==m&&du(e,t,h,p,n,m)}}return void yt(e,o,l,c,d,u,s,r);case"select":for(s in p=o=l=h=null,a)if(c=a[s],a.hasOwnProperty(s)&&null!=c)switch(s){case"value":break;case"multiple":p=c;default:n.hasOwnProperty(s)||du(e,t,s,null,n,c)}for(r in n)if(s=n[r],c=a[r],n.hasOwnProperty(r)&&(null!=s||null!=c))switch(r){case"value":h=s;break;case"defaultValue":l=s;break;case"multiple":o=s;default:s!==c&&du(e,t,r,s,n,c)}return t=l,a=o,n=p,void(null!=h?wt(e,!!a,h,!1):!!n!==!!a&&(null!=t?wt(e,!!a,t,!0):wt(e,!!a,a?[]:"",!1)));case"textarea":for(l in p=h=null,a)if(r=a[l],a.hasOwnProperty(l)&&null!=r&&!n.hasOwnProperty(l))switch(l){case"value":case"children":break;default:du(e,t,l,null,n,r)}for(o in n)if(r=n[o],s=a[o],n.hasOwnProperty(o)&&(null!=r||null!=s))switch(o){case"value":h=r;break;case"defaultValue":p=r;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=r)throw Error(i(91));break;default:r!==s&&du(e,t,o,r,n,s)}return void St(e,h,p);case"option":for(var f in a)if(h=a[f],a.hasOwnProperty(f)&&null!=h&&!n.hasOwnProperty(f))if("selected"===f)e.selected=!1;else du(e,t,f,null,n,h);for(c in n)if(h=n[c],p=a[c],n.hasOwnProperty(c)&&h!==p&&(null!=h||null!=p))if("selected"===c)e.selected=h&&"function"!==typeof h&&"symbol"!==typeof h;else du(e,t,c,h,n,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in a)h=a[g],a.hasOwnProperty(g)&&null!=h&&!n.hasOwnProperty(g)&&du(e,t,g,null,n,h);for(d in n)if(h=n[d],p=a[d],n.hasOwnProperty(d)&&h!==p&&(null!=h||null!=p))switch(d){case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(i(137,t));break;default:du(e,t,d,h,n,p)}return;default:if(_t(t)){for(var v in a)h=a[v],a.hasOwnProperty(v)&&void 0!==h&&!n.hasOwnProperty(v)&&uu(e,t,v,void 0,n,h);for(u in n)h=n[u],p=a[u],!n.hasOwnProperty(u)||h===p||void 0===h&&void 0===p||uu(e,t,u,h,n,p);return}}for(var y in a)h=a[y],a.hasOwnProperty(y)&&null!=h&&!n.hasOwnProperty(y)&&du(e,t,y,null,n,h);for(m in n)h=n[m],p=a[m],!n.hasOwnProperty(m)||h===p||null==h&&null==p||du(e,t,m,h,n,p)}(n,e.type,a,t),n[Ge]=t}catch(r){kd(e,e.return,r)}}function Nl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Tu(e.type)||4===e.tag}function jl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Nl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Tu(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Tl(e,t,a){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?(9===a.nodeType?a.body:"HTML"===a.nodeName?a.ownerDocument.body:a).insertBefore(e,t):((t=9===a.nodeType?a.body:"HTML"===a.nodeName?a.ownerDocument.body:a).appendChild(e),null!==(a=a._reactRootContainer)&&void 0!==a||null!==t.onclick||(t.onclick=Et));else if(4!==n&&(27===n&&Tu(e.type)&&(a=e.stateNode,t=null),null!==(e=e.child)))for(Tl(e,t,a),e=e.sibling;null!==e;)Tl(e,t,a),e=e.sibling}function Al(e,t,a){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?a.insertBefore(e,t):a.appendChild(e);else if(4!==n&&(27===n&&Tu(e.type)&&(a=e.stateNode),null!==(e=e.child)))for(Al(e,t,a),e=e.sibling;null!==e;)Al(e,t,a),e=e.sibling}function _l(e){var t=e.stateNode,a=e.memoizedProps;try{for(var n=e.type,r=t.attributes;r.length;)t.removeAttributeNode(r[0]);mu(t,n,a),t[Be]=e,t[Ge]=a}catch(s){kd(e,e.return,s)}}var Cl=!1,Ml=!1,Pl=!1,El="function"===typeof WeakSet?WeakSet:Set,Il=null;function Rl(e,t,a){var n=a.flags;switch(a.tag){case 0:case 11:case 15:Yl(e,a),4&n&&gl(5,a);break;case 1:if(Yl(e,a),4&n)if(e=a.stateNode,null===t)try{e.componentDidMount()}catch(i){kd(a,a.return,i)}else{var r=ko(a.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}catch(o){kd(a,a.return,o)}}64&n&&yl(a),512&n&&xl(a,a.return);break;case 3:if(Yl(e,a),64&n&&null!==(e=a.updateQueue)){if(t=null,null!==a.child)switch(a.child.tag){case 27:case 5:case 1:t=a.child.stateNode}try{Ts(e,t)}catch(i){kd(a,a.return,i)}}break;case 27:null===t&&4&n&&_l(a);case 26:case 5:Yl(e,a),null===t&&4&n&&Sl(a),512&n&&xl(a,a.return);break;case 12:Yl(e,a);break;case 31:Yl(e,a),4&n&&Ul(e,a);break;case 13:Yl(e,a),4&n&&Bl(e,a),64&n&&(null!==(e=a.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var a=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==a.readyState)t();else{var n=function(){t(),a.removeEventListener("DOMContentLoaded",n)};a.addEventListener("DOMContentLoaded",n),e._reactRetry=n}}(e,a=Ad.bind(null,a))));break;case 22:if(!(n=null!==a.memoizedState||Cl)){t=null!==t&&null!==t.memoizedState||Ml,r=Cl;var s=Ml;Cl=n,(Ml=t)&&!s?Ql(e,a,0!==(8772&a.subtreeFlags)):Yl(e,a),Cl=r,Ml=s}break;case 30:break;default:Yl(e,a)}}function Ol(e){var t=e.alternate;null!==t&&(e.alternate=null,Ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Je(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Dl=null,Fl=!1;function Ll(e,t,a){for(a=a.child;null!==a;)ql(e,t,a),a=a.sibling}function ql(e,t,a){if(ye&&"function"===typeof ye.onCommitFiberUnmount)try{ye.onCommitFiberUnmount(ve,a)}catch(s){}switch(a.tag){case 26:Ml||wl(a,t),Ll(e,t,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode).parentNode.removeChild(a);break;case 27:Ml||wl(a,t);var n=Dl,r=Fl;Tu(a.type)&&(Dl=a.stateNode,Fl=!1),Ll(e,t,a),Lu(a.stateNode),Dl=n,Fl=r;break;case 5:Ml||wl(a,t);case 6:if(n=Dl,r=Fl,Dl=null,Ll(e,t,a),Fl=r,null!==(Dl=n))if(Fl)try{(9===Dl.nodeType?Dl.body:"HTML"===Dl.nodeName?Dl.ownerDocument.body:Dl).removeChild(a.stateNode)}catch(i){kd(a,t,i)}else try{Dl.removeChild(a.stateNode)}catch(i){kd(a,t,i)}break;case 18:null!==Dl&&(Fl?(Au(9===(e=Dl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,a.stateNode),Vm(e)):Au(Dl,a.stateNode));break;case 4:n=Dl,r=Fl,Dl=a.stateNode.containerInfo,Fl=!0,Ll(e,t,a),Dl=n,Fl=r;break;case 0:case 11:case 14:case 15:vl(2,a,t),Ml||vl(4,a,t),Ll(e,t,a);break;case 1:Ml||(wl(a,t),"function"===typeof(n=a.stateNode).componentWillUnmount&&bl(a,t,n)),Ll(e,t,a);break;case 21:Ll(e,t,a);break;case 22:Ml=(n=Ml)||null!==a.memoizedState,Ll(e,t,a),Ml=n;break;default:Ll(e,t,a)}}function Ul(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Vm(e)}catch(a){kd(t,t.return,a)}}}function Bl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Vm(e)}catch(a){kd(t,t.return,a)}}function Gl(e,t){var a=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new El),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new El),t;default:throw Error(i(435,e.tag))}}(e);t.forEach(function(t){if(!a.has(t)){a.add(t);var n=_d.bind(null,e,t);t.then(n,n)}})}function zl(e,t){var a=t.deletions;if(null!==a)for(var n=0;n<a.length;n++){var r=a[n],s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 27:if(Tu(l.type)){Dl=l.stateNode,Fl=!1;break e}break;case 5:Dl=l.stateNode,Fl=!1;break e;case 3:case 4:Dl=l.stateNode.containerInfo,Fl=!0;break e}l=l.return}if(null===Dl)throw Error(i(160));ql(s,o,r),Dl=null,Fl=!1,null!==(s=r.alternate)&&(s.return=null),r.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Hl(t,e),t=t.sibling}var Vl=null;function Hl(e,t){var a=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:zl(t,e),Kl(e),4&n&&(vl(3,e,e.return),gl(3,e),vl(5,e,e.return));break;case 1:zl(t,e),Kl(e),512&n&&(Ml||null===a||wl(a,a.return)),64&n&&Cl&&(null!==(e=e.updateQueue)&&(null!==(n=e.callbacks)&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===a?n:a.concat(n))));break;case 26:var r=Vl;if(zl(t,e),Kl(e),512&n&&(Ml||null===a||wl(a,a.return)),4&n){var s=null!==a?a.memoizedState:null;if(n=e.memoizedState,null===a)if(null===n)if(null===e.stateNode){e:{n=e.type,a=e.memoizedProps,r=r.ownerDocument||r;t:switch(n){case"title":(!(s=r.getElementsByTagName("title")[0])||s[Ye]||s[Be]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=r.createElement(n),r.head.insertBefore(s,r.querySelector("head > title"))),mu(s,n,a),s[Be]=e,et(s),n=s;break e;case"link":var o=am("link","href",r).get(n+(a.href||""));if(o)for(var l=0;l<o.length;l++)if((s=o[l]).getAttribute("href")===(null==a.href||""===a.href?null:a.href)&&s.getAttribute("rel")===(null==a.rel?null:a.rel)&&s.getAttribute("title")===(null==a.title?null:a.title)&&s.getAttribute("crossorigin")===(null==a.crossOrigin?null:a.crossOrigin)){o.splice(l,1);break t}mu(s=r.createElement(n),n,a),r.head.appendChild(s);break;case"meta":if(o=am("meta","content",r).get(n+(a.content||"")))for(l=0;l<o.length;l++)if((s=o[l]).getAttribute("content")===(null==a.content?null:""+a.content)&&s.getAttribute("name")===(null==a.name?null:a.name)&&s.getAttribute("property")===(null==a.property?null:a.property)&&s.getAttribute("http-equiv")===(null==a.httpEquiv?null:a.httpEquiv)&&s.getAttribute("charset")===(null==a.charSet?null:a.charSet)){o.splice(l,1);break t}mu(s=r.createElement(n),n,a),r.head.appendChild(s);break;default:throw Error(i(468,n))}s[Be]=e,et(s),n=s}e.stateNode=n}else nm(r,e.type,e.stateNode);else e.stateNode=$u(r,n,e.memoizedProps);else s!==n?(null===s?null!==a.stateNode&&(a=a.stateNode).parentNode.removeChild(a):s.count--,null===n?nm(r,e.type,e.stateNode):$u(r,n,e.memoizedProps)):null===n&&null!==e.stateNode&&kl(e,e.memoizedProps,a.memoizedProps)}break;case 27:zl(t,e),Kl(e),512&n&&(Ml||null===a||wl(a,a.return)),null!==a&&4&n&&kl(e,e.memoizedProps,a.memoizedProps);break;case 5:if(zl(t,e),Kl(e),512&n&&(Ml||null===a||wl(a,a.return)),32&e.flags){r=e.stateNode;try{Nt(r,"")}catch(f){kd(e,e.return,f)}}4&n&&null!=e.stateNode&&kl(e,r=e.memoizedProps,null!==a?a.memoizedProps:r),1024&n&&(Pl=!0);break;case 6:if(zl(t,e),Kl(e),4&n){if(null===e.stateNode)throw Error(i(162));n=e.memoizedProps,a=e.stateNode;try{a.nodeValue=n}catch(f){kd(e,e.return,f)}}break;case 3:if(tm=null,r=Vl,Vl=Bu(t.containerInfo),zl(t,e),Vl=r,Kl(e),4&n&&null!==a&&a.memoizedState.isDehydrated)try{Vm(t.containerInfo)}catch(f){kd(e,e.return,f)}Pl&&(Pl=!1,Wl(e));break;case 4:n=Vl,Vl=Bu(e.stateNode.containerInfo),zl(t,e),Kl(e),Vl=n;break;case 12:default:zl(t,e),Kl(e);break;case 31:case 19:zl(t,e),Kl(e),4&n&&(null!==(n=e.updateQueue)&&(e.updateQueue=null,Gl(e,n)));break;case 13:zl(t,e),Kl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==a&&null!==a.memoizedState)&&(Ec=le()),4&n&&(null!==(n=e.updateQueue)&&(e.updateQueue=null,Gl(e,n)));break;case 22:r=null!==e.memoizedState;var c=null!==a&&null!==a.memoizedState,d=Cl,u=Ml;if(Cl=d||r,Ml=u||c,zl(t,e),Ml=u,Cl=d,Kl(e),8192&n)e:for(t=e.stateNode,t._visibility=r?-2&t._visibility:1|t._visibility,r&&(null===a||c||Cl||Ml||Jl(e)),a=null,t=e;;){if(5===t.tag||26===t.tag){if(null===a){c=a=t;try{if(s=c.stateNode,r)"function"===typeof(o=s.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{l=c.stateNode;var m=c.memoizedProps.style,h=void 0!==m&&null!==m&&m.hasOwnProperty("display")?m.display:null;l.style.display=null==h||"boolean"===typeof h?"":(""+h).trim()}}catch(f){kd(c,c.return,f)}}}else if(6===t.tag){if(null===a){c=t;try{c.stateNode.nodeValue=r?"":c.memoizedProps}catch(f){kd(c,c.return,f)}}}else if(18===t.tag){if(null===a){c=t;try{var p=c.stateNode;r?_u(p,!0):_u(c.stateNode,!1)}catch(f){kd(c,c.return,f)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;a===t&&(a=null),t=t.return}a===t&&(a=null),t.sibling.return=t.return,t=t.sibling}4&n&&(null!==(n=e.updateQueue)&&(null!==(a=n.retryQueue)&&(n.retryQueue=null,Gl(e,a))));case 30:case 21:}}function Kl(e){var t=e.flags;if(2&t){try{for(var a,n=e.return;null!==n;){if(Nl(n)){a=n;break}n=n.return}if(null==a)throw Error(i(160));switch(a.tag){case 27:var r=a.stateNode;Al(e,jl(e),r);break;case 5:var s=a.stateNode;32&a.flags&&(Nt(s,""),a.flags&=-33),Al(e,jl(e),s);break;case 3:case 4:var o=a.stateNode.containerInfo;Tl(e,jl(e),o);break;default:throw Error(i(161))}}catch(l){kd(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Wl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Wl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Yl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Rl(e,t.alternate,t),t=t.sibling}function Jl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:vl(4,t,t.return),Jl(t);break;case 1:wl(t,t.return);var a=t.stateNode;"function"===typeof a.componentWillUnmount&&bl(t,t.return,a),Jl(t);break;case 27:Lu(t.stateNode);case 26:case 5:wl(t,t.return),Jl(t);break;case 22:null===t.memoizedState&&Jl(t);break;default:Jl(t)}e=e.sibling}}function Ql(e,t,a){for(a=a&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var n=t.alternate,r=e,s=t,i=s.flags;switch(s.tag){case 0:case 11:case 15:Ql(r,s,a),gl(4,s);break;case 1:if(Ql(r,s,a),"function"===typeof(r=(n=s).stateNode).componentDidMount)try{r.componentDidMount()}catch(c){kd(n,n.return,c)}if(null!==(r=(n=s).updateQueue)){var o=n.stateNode;try{var l=r.shared.hiddenCallbacks;if(null!==l)for(r.shared.hiddenCallbacks=null,r=0;r<l.length;r++)js(l[r],o)}catch(c){kd(n,n.return,c)}}a&&64&i&&yl(s),xl(s,s.return);break;case 27:_l(s);case 26:case 5:Ql(r,s,a),a&&null===n&&4&i&&Sl(s),xl(s,s.return);break;case 12:Ql(r,s,a);break;case 31:Ql(r,s,a),a&&4&i&&Ul(r,s);break;case 13:Ql(r,s,a),a&&4&i&&Bl(r,s);break;case 22:null===s.memoizedState&&Ql(r,s,a),xl(s,s.return);break;case 30:break;default:Ql(r,s,a)}t=t.sibling}}function $l(e,t){var a=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(a=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==a&&(null!=e&&e.refCount++,null!=a&&Ur(a))}function Xl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ur(e))}function Zl(e,t,a,n){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)ec(e,t,a,n),t=t.sibling}function ec(e,t,a,n){var r=t.flags;switch(t.tag){case 0:case 11:case 15:Zl(e,t,a,n),2048&r&&gl(9,t);break;case 1:case 31:case 13:default:Zl(e,t,a,n);break;case 3:Zl(e,t,a,n),2048&r&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ur(e)));break;case 12:if(2048&r){Zl(e,t,a,n),e=t.stateNode;try{var s=t.memoizedProps,i=s.id,o=s.onPostCommit;"function"===typeof o&&o(i,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){kd(t,t.return,l)}}else Zl(e,t,a,n);break;case 23:break;case 22:s=t.stateNode,i=t.alternate,null!==t.memoizedState?2&s._visibility?Zl(e,t,a,n):ac(e,t):2&s._visibility?Zl(e,t,a,n):(s._visibility|=2,tc(e,t,a,n,0!==(10256&t.subtreeFlags)||!1)),2048&r&&$l(i,t);break;case 24:Zl(e,t,a,n),2048&r&&Xl(t.alternate,t)}}function tc(e,t,a,n,r){for(r=r&&(0!==(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var s=e,i=t,o=a,l=n,c=i.flags;switch(i.tag){case 0:case 11:case 15:tc(s,i,o,l,r),gl(8,i);break;case 23:break;case 22:var d=i.stateNode;null!==i.memoizedState?2&d._visibility?tc(s,i,o,l,r):ac(s,i):(d._visibility|=2,tc(s,i,o,l,r)),r&&2048&c&&$l(i.alternate,i);break;case 24:tc(s,i,o,l,r),r&&2048&c&&Xl(i.alternate,i);break;default:tc(s,i,o,l,r)}t=t.sibling}}function ac(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var a=e,n=t,r=n.flags;switch(n.tag){case 22:ac(a,n),2048&r&&$l(n.alternate,n);break;case 24:ac(a,n),2048&r&&Xl(n.alternate,n);break;default:ac(a,n)}t=t.sibling}}var nc=8192;function rc(e,t,a){if(e.subtreeFlags&nc)for(e=e.child;null!==e;)sc(e,t,a),e=e.sibling}function sc(e,t,a){switch(e.tag){case 26:rc(e,t,a),e.flags&nc&&null!==e.memoizedState&&function(e,t,a,n){if("stylesheet"===a.type&&("string"!==typeof n.media||!1!==matchMedia(n.media).matches)&&0===(4&a.state.loading)){if(null===a.instance){var r=Ku(n.href),s=t.querySelector(Wu(r));if(s)return null!==(t=s._p)&&"object"===typeof t&&"function"===typeof t.then&&(e.count++,e=im.bind(e),t.then(e,e)),a.state.loading|=4,a.instance=s,void et(s);s=t.ownerDocument||t,n=Yu(n),(r=qu.get(r))&&Zu(n,r),et(s=s.createElement("link"));var i=s;i._p=new Promise(function(e,t){i.onload=e,i.onerror=t}),mu(s,"link",n),a.instance=s}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(a,t),(t=a.state.preload)&&0===(3&a.state.loading)&&(e.count++,a=im.bind(e),t.addEventListener("load",a),t.addEventListener("error",a))}}(a,Vl,e.memoizedState,e.memoizedProps);break;case 5:default:rc(e,t,a);break;case 3:case 4:var n=Vl;Vl=Bu(e.stateNode.containerInfo),rc(e,t,a),Vl=n;break;case 22:null===e.memoizedState&&(null!==(n=e.alternate)&&null!==n.memoizedState?(n=nc,nc=16777216,rc(e,t,a),nc=n):rc(e,t,a))}}function ic(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function oc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var a=0;a<t.length;a++){var n=t[a];Il=n,dc(n,e)}ic(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)lc(e),e=e.sibling}function lc(e){switch(e.tag){case 0:case 11:case 15:oc(e),2048&e.flags&&vl(9,e,e.return);break;case 3:case 12:default:oc(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,cc(e)):oc(e)}}function cc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var a=0;a<t.length;a++){var n=t[a];Il=n,dc(n,e)}ic(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:vl(8,t,t.return),cc(t);break;case 22:2&(a=t.stateNode)._visibility&&(a._visibility&=-3,cc(t));break;default:cc(t)}e=e.sibling}}function dc(e,t){for(;null!==Il;){var a=Il;switch(a.tag){case 0:case 11:case 15:vl(8,a,t);break;case 23:case 22:if(null!==a.memoizedState&&null!==a.memoizedState.cachePool){var n=a.memoizedState.cachePool.pool;null!=n&&n.refCount++}break;case 24:Ur(a.memoizedState.cache)}if(null!==(n=a.child))n.return=a,Il=n;else e:for(a=e;null!==Il;){var r=(n=Il).sibling,s=n.return;if(Ol(n),n===a){Il=null;break e}if(null!==r){r.return=s,Il=r;break e}Il=s}}}var uc={getCacheForType:function(e){var t=Er(Lr),a=t.data.get(e);return void 0===a&&(a=e(),t.data.set(e,a)),a},cacheSignal:function(){return Er(Lr).controller.signal}},mc="function"===typeof WeakMap?WeakMap:Map,hc=0,pc=null,fc=null,gc=0,vc=0,yc=null,bc=!1,xc=!1,wc=!1,Sc=0,kc=0,Nc=0,jc=0,Tc=0,Ac=0,_c=0,Cc=null,Mc=null,Pc=!1,Ec=0,Ic=0,Rc=1/0,Oc=null,Dc=null,Fc=0,Lc=null,qc=null,Uc=0,Bc=0,Gc=null,zc=null,Vc=0,Hc=null;function Kc(){return 0!==(2&hc)&&0!==gc?gc&-gc:null!==R.T?Gd():Le()}function Wc(){if(0===Ac)if(0===(536870912&gc)||ur){var e=Ne;0===(3932160&(Ne<<=1))&&(Ne=262144),Ac=e}else Ac=536870912;return null!==(e=Es.current)&&(e.flags|=32),Ac}function Yc(e,t,a){(e!==pc||2!==vc&&9!==vc)&&null===e.cancelPendingCommit||(td(e,0),Xc(e,gc,Ac,!1)),Ee(e,a),0!==(2&hc)&&e===pc||(e===pc&&(0===(2&hc)&&(jc|=a),4===kc&&Xc(e,gc,Ac,!1)),Od(e))}function Jc(e,t,a){if(0!==(6&hc))throw Error(i(327));for(var n=!a&&0===(127&t)&&0===(t&e.expiredLanes)||_e(e,t),r=n?function(e,t){var a=hc;hc|=2;var n=rd(),r=sd();pc!==e||gc!==t?(Oc=null,Rc=le()+500,td(e,t)):xc=_e(e,t);e:for(;;)try{if(0!==vc&&null!==fc){t=fc;var s=yc;t:switch(vc){case 1:vc=0,yc=null,md(e,t,s,1);break;case 2:case 9:if(ts(s)){vc=0,yc=null,ud(t);break}t=function(){2!==vc&&9!==vc||pc!==e||(vc=7),Od(e)},s.then(t,t);break e;case 3:vc=7;break e;case 4:vc=5;break e;case 7:ts(s)?(vc=0,yc=null,ud(t)):(vc=0,yc=null,md(e,t,s,7));break;case 5:var o=null;switch(fc.tag){case 26:o=fc.memoizedState;case 5:case 27:var l=fc;if(o?rm(o):l.stateNode.complete){vc=0,yc=null;var c=l.sibling;if(null!==c)fc=c;else{var d=l.return;null!==d?(fc=d,hd(d)):fc=null}break t}}vc=0,yc=null,md(e,t,s,5);break;case 6:vc=0,yc=null,md(e,t,s,6);break;case 8:ed(),kc=6;break e;default:throw Error(i(462))}}cd();break}catch(u){ad(e,u)}return Nr=kr=null,R.H=n,R.A=r,hc=a,null!==fc?0:(pc=null,gc=0,Mn(),kc)}(e,t):od(e,t,!0),s=n;;){if(0===r){xc&&!n&&Xc(e,t,0,!1);break}if(a=e.current.alternate,!s||$c(a)){if(2===r){if(s=t,e.errorRecoveryDisabledLanes&s)var o=0;else o=0!==(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;r=Cc;var c=l.current.memoizedState.isDehydrated;if(c&&(td(l,o).flags|=256),2!==(o=od(l,o,!1))){if(wc&&!c){l.errorRecoveryDisabledLanes|=s,jc|=s,r=4;break e}s=Mc,Mc=r,null!==s&&(null===Mc?Mc=s:Mc.push.apply(Mc,s))}r=o}if(s=!1,2!==r)continue}}if(1===r){td(e,0),Xc(e,t,0,!0);break}e:{switch(n=e,s=r){case 0:case 1:throw Error(i(345));case 4:if((4194048&t)!==t)break;case 6:Xc(n,t,Ac,!bc);break e;case 2:Mc=null;break;case 3:case 5:break;default:throw Error(i(329))}if((62914560&t)===t&&10<(r=Ec+300-le())){if(Xc(n,t,Ac,!bc),0!==Ae(n,0,!0))break e;Uc=t,n.timeoutHandle=wu(Qc.bind(null,n,a,Mc,Oc,Pc,t,Ac,jc,_c,bc,s,"Throttled",-0,0),r)}else Qc(n,a,Mc,Oc,Pc,t,Ac,jc,_c,bc,s,null,-0,0)}break}r=od(e,t,!1),s=!1}Od(e)}function Qc(e,t,a,n,r,s,i,o,l,c,d,u,m,h){if(e.timeoutHandle=-1,8192&(u=t.subtreeFlags)||16785408===(16785408&u)){sc(t,s,u={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Et});var p=(62914560&s)===s?Ec-le():(4194048&s)===s?Ic-le():0;if(null!==(p=function(e,t){return e.stylesheets&&0===e.count&&lm(e,e.stylesheets),0<e.count||0<e.imgCount?function(a){var n=setTimeout(function(){if(e.stylesheets&&lm(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===sm&&(sm=62500*function(){if("function"===typeof performance.getEntriesByType){for(var e=0,t=0,a=performance.getEntriesByType("resource"),n=0;n<a.length;n++){var r=a[n],s=r.transferSize,i=r.initiatorType,o=r.duration;if(s&&o&&hu(i)){for(i=0,o=r.responseEnd,n+=1;n<a.length;n++){var l=a[n],c=l.startTime;if(c>o)break;var d=l.transferSize,u=l.initiatorType;d&&hu(u)&&(i+=d*((l=l.responseEnd)<o?1:(o-c)/(l-c)))}if(--n,t+=8*(s+i)/(r.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"===typeof(e=navigator.connection.downlink)?e:5}());var r=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&lm(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>sm?50:800)+t);return e.unsuspend=a,function(){e.unsuspend=null,clearTimeout(n),clearTimeout(r)}}:null}(u,p)))return Uc=s,e.cancelPendingCommit=p(fd.bind(null,e,t,s,a,n,r,i,o,l,d,u,null,m,h)),void Xc(e,s,i,!c)}fd(e,t,s,a,n,r,i,o,l)}function $c(e){for(var t=e;;){var a=t.tag;if((0===a||11===a||15===a)&&16384&t.flags&&(null!==(a=t.updateQueue)&&null!==(a=a.stores)))for(var n=0;n<a.length;n++){var r=a[n],s=r.getSnapshot;r=r.value;try{if(!$a(s(),r))return!1}catch(i){return!1}}if(a=t.child,16384&t.subtreeFlags&&null!==a)a.return=t,t=a;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Xc(e,t,a,n){t&=~Tc,t&=~jc,e.suspendedLanes|=t,e.pingedLanes&=~t,n&&(e.warmLanes|=t),n=e.expirationTimes;for(var r=t;0<r;){var s=31-xe(r),i=1<<s;n[s]=-1,r&=~i}0!==a&&Ie(e,a,t)}function Zc(){return 0!==(6&hc)||(Dd(0,!1),!1)}function ed(){if(null!==fc){if(0===vc)var e=fc.return;else Nr=kr=null,ii(e=fc),os=null,ls=0,e=fc;for(;null!==e;)fl(e.alternate,e),e=e.return;fc=null}}function td(e,t){var a=e.timeoutHandle;-1!==a&&(e.timeoutHandle=-1,Su(a)),null!==(a=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,a()),Uc=0,ed(),pc=e,fc=a=Un(e.current,null),gc=t,vc=0,yc=null,bc=!1,xc=_e(e,t),wc=!1,_c=Ac=Tc=jc=Nc=kc=0,Mc=Cc=null,Pc=!1,0!==(8&t)&&(t|=32&t);var n=e.entangledLanes;if(0!==n)for(e=e.entanglements,n&=t;0<n;){var r=31-xe(n),s=1<<r;t|=e[r],n&=~s}return Sc=t,Mn(),a}function ad(e,t){Gs=null,R.H=fo,t===$r||t===Zr?(t=ss(),vc=3):t===Xr?(t=ss(),vc=4):vc=t===Eo?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,yc=t,null===fc&&(kc=1,Ao(e,Yn(t,e.current)))}function nd(){var e=Es.current;return null===e||((4194048&gc)===gc?null===Is:((62914560&gc)===gc||0!==(536870912&gc))&&e===Is)}function rd(){var e=R.H;return R.H=fo,null===e?fo:e}function sd(){var e=R.A;return R.A=uc,e}function id(){kc=4,bc||(4194048&gc)!==gc&&null!==Es.current||(xc=!0),0===(134217727&Nc)&&0===(134217727&jc)||null===pc||Xc(pc,gc,Ac,!1)}function od(e,t,a){var n=hc;hc|=2;var r=rd(),s=sd();pc===e&&gc===t||(Oc=null,td(e,t)),t=!1;var i=kc;e:for(;;)try{if(0!==vc&&null!==fc){var o=fc,l=yc;switch(vc){case 8:ed(),i=6;break e;case 3:case 2:case 9:case 6:null===Es.current&&(t=!0);var c=vc;if(vc=0,yc=null,md(e,o,l,c),a&&xc){i=0;break e}break;default:c=vc,vc=0,yc=null,md(e,o,l,c)}}ld(),i=kc;break}catch(d){ad(e,d)}return t&&e.shellSuspendCounter++,Nr=kr=null,hc=n,R.H=r,R.A=s,null===fc&&(pc=null,gc=0,Mn()),i}function ld(){for(;null!==fc;)dd(fc)}function cd(){for(;null!==fc&&!ie();)dd(fc)}function dd(e){var t=il(e.alternate,e,Sc);e.memoizedProps=e.pendingProps,null===t?hd(e):fc=t}function ud(e){var t=e,a=t.alternate;switch(t.tag){case 15:case 0:t=Ho(a,t,t.pendingProps,t.type,void 0,gc);break;case 11:t=Ho(a,t,t.pendingProps,t.type.render,t.ref,gc);break;case 5:ii(t);default:fl(a,t),t=il(a,t=fc=Bn(t,Sc),Sc)}e.memoizedProps=e.pendingProps,null===t?hd(e):fc=t}function md(e,t,a,n){Nr=kr=null,ii(t),os=null,ls=0;var r=t.return;try{if(function(e,t,a,n,r){if(a.flags|=32768,null!==n&&"object"===typeof n&&"function"===typeof n.then){if(null!==(t=a.alternate)&&Cr(t,a,r,!0),null!==(a=Es.current)){switch(a.tag){case 31:case 13:return null===Is?id():null===a.alternate&&0===kc&&(kc=3),a.flags&=-257,a.flags|=65536,a.lanes=r,n===es?a.flags|=16384:(null===(t=a.updateQueue)?a.updateQueue=new Set([n]):t.add(n),Nd(e,n,r)),!1;case 22:return a.flags|=65536,n===es?a.flags|=16384:(null===(t=a.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([n])},a.updateQueue=t):null===(a=t.retryQueue)?t.retryQueue=new Set([n]):a.add(n),Nd(e,n,r)),!1}throw Error(i(435,a.tag))}return Nd(e,n,r),id(),!1}if(ur)return null!==(t=Es.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=r,n!==pr&&wr(Yn(e=Error(i(422),{cause:n}),a))):(n!==pr&&wr(Yn(t=Error(i(423),{cause:n}),a)),(e=e.current.alternate).flags|=65536,r&=-r,e.lanes|=r,n=Yn(n,a),ws(e,r=Co(e.stateNode,n,r)),4!==kc&&(kc=2)),!1;var s=Error(i(520),{cause:n});if(s=Yn(s,a),null===Cc?Cc=[s]:Cc.push(s),4!==kc&&(kc=2),null===t)return!0;n=Yn(n,a),a=t;do{switch(a.tag){case 3:return a.flags|=65536,e=r&-r,a.lanes|=e,ws(a,e=Co(a.stateNode,n,e)),!1;case 1:if(t=a.type,s=a.stateNode,0===(128&a.flags)&&("function"===typeof t.getDerivedStateFromError||null!==s&&"function"===typeof s.componentDidCatch&&(null===Dc||!Dc.has(s))))return a.flags|=65536,r&=-r,a.lanes|=r,Po(r=Mo(r),e,a,n),ws(a,r),!1}a=a.return}while(null!==a);return!1}(e,r,t,a,gc))return kc=1,Ao(e,Yn(a,e.current)),void(fc=null)}catch(s){if(null!==r)throw fc=r,s;return kc=1,Ao(e,Yn(a,e.current)),void(fc=null)}32768&t.flags?(ur||1===n?e=!0:xc||0!==(536870912&gc)?e=!1:(bc=e=!0,(2===n||9===n||3===n||6===n)&&(null!==(n=Es.current)&&13===n.tag&&(n.flags|=16384))),pd(t,e)):hd(t)}function hd(e){var t=e;do{if(0!==(32768&t.flags))return void pd(t,bc);e=t.return;var a=hl(t.alternate,t,Sc);if(null!==a)return void(fc=a);if(null!==(t=t.sibling))return void(fc=t);fc=t=e}while(null!==t);0===kc&&(kc=5)}function pd(e,t){do{var a=pl(e.alternate,e);if(null!==a)return a.flags&=32767,void(fc=a);if(null!==(a=e.return)&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!t&&null!==(e=e.sibling))return void(fc=e);fc=e=a}while(null!==e);kc=6,fc=null}function fd(e,t,a,n,r,s,o,l,c){e.cancelPendingCommit=null;do{xd()}while(0!==Fc);if(0!==(6&hc))throw Error(i(327));if(null!==t){if(t===e.current)throw Error(i(177));if(s=t.lanes|t.childLanes,function(e,t,a,n,r,s){var i=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(a=i&~a;0<a;){var d=31-xe(a),u=1<<d;o[d]=0,l[d]=-1;var m=c[d];if(null!==m)for(c[d]=null,d=0;d<m.length;d++){var h=m[d];null!==h&&(h.lane&=-536870913)}a&=~u}0!==n&&Ie(e,n,0),0!==s&&0===r&&0!==e.tag&&(e.suspendedLanes|=s&~(i&~t))}(e,a,s|=Cn,o,l,c),e===pc&&(fc=pc=null,gc=0),qc=t,Lc=e,Uc=a,Bc=s,Gc=r,zc=n,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,re(me,function(){return wd(),null})):(e.callbackNode=null,e.callbackPriority=0),n=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||n){n=R.T,R.T=null,r=O.p,O.p=2,o=hc,hc|=4;try{!function(e,t){if(e=e.containerInfo,pu=bm,nn(e=an(e))){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(a=(a=e.ownerDocument)&&a.defaultView||window).getSelection&&a.getSelection();if(n&&0!==n.rangeCount){a=n.anchorNode;var r=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{a.nodeType,s.nodeType}catch(g){a=null;break e}var o=0,l=-1,c=-1,d=0,u=0,m=e,h=null;t:for(;;){for(var p;m!==a||0!==r&&3!==m.nodeType||(l=o+r),m!==s||0!==n&&3!==m.nodeType||(c=o+n),3===m.nodeType&&(o+=m.nodeValue.length),null!==(p=m.firstChild);)h=m,m=p;for(;;){if(m===e)break t;if(h===a&&++d===r&&(l=o),h===s&&++u===n&&(c=o),null!==(p=m.nextSibling))break;h=(m=h).parentNode}m=p}a=-1===l||-1===c?null:{start:l,end:c}}else a=null}a=a||{start:0,end:0}}else a=null;for(fu={focusedElem:e,selectionRange:a},bm=!1,Il=t;null!==Il;)if(e=(t=Il).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Il=e;else for(;null!==Il;){switch(s=(t=Il).alternate,e=t.flags,t.tag){case 0:if(0!==(4&e)&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(a=0;a<e.length;a++)(r=e[a]).ref.impl=r.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==s){e=void 0,a=t,r=s.memoizedProps,s=s.memoizedState,n=a.stateNode;try{var f=ko(a.type,r);e=n.getSnapshotBeforeUpdate(f,s),n.__reactInternalSnapshotBeforeUpdate=e}catch(v){kd(a,a.return,v)}}break;case 3:if(0!==(1024&e))if(9===(a=(e=t.stateNode.containerInfo).nodeType))Cu(e);else if(1===a)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Cu(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(i(163))}if(null!==(e=t.sibling)){e.return=t.return,Il=e;break}Il=t.return}}(e,t)}finally{hc=o,O.p=r,R.T=n}}Fc=1,gd(),vd(),yd()}}function gd(){if(1===Fc){Fc=0;var e=Lc,t=qc,a=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||a){a=R.T,R.T=null;var n=O.p;O.p=2;var r=hc;hc|=4;try{Hl(t,e);var s=fu,i=an(e.containerInfo),o=s.focusedElem,l=s.selectionRange;if(i!==o&&o&&o.ownerDocument&&tn(o.ownerDocument.documentElement,o)){if(null!==l&&nn(o)){var c=l.start,d=l.end;if(void 0===d&&(d=c),"selectionStart"in o)o.selectionStart=c,o.selectionEnd=Math.min(d,o.value.length);else{var u=o.ownerDocument||document,m=u&&u.defaultView||window;if(m.getSelection){var h=m.getSelection(),p=o.textContent.length,f=Math.min(l.start,p),g=void 0===l.end?f:Math.min(l.end,p);!h.extend&&f>g&&(i=g,g=f,f=i);var v=en(o,f),y=en(o,g);if(v&&y&&(1!==h.rangeCount||h.anchorNode!==v.node||h.anchorOffset!==v.offset||h.focusNode!==y.node||h.focusOffset!==y.offset)){var b=u.createRange();b.setStart(v.node,v.offset),h.removeAllRanges(),f>g?(h.addRange(b),h.extend(y.node,y.offset)):(b.setEnd(y.node,y.offset),h.addRange(b))}}}}for(u=[],h=o;h=h.parentNode;)1===h.nodeType&&u.push({element:h,left:h.scrollLeft,top:h.scrollTop});for("function"===typeof o.focus&&o.focus(),o=0;o<u.length;o++){var x=u[o];x.element.scrollLeft=x.left,x.element.scrollTop=x.top}}bm=!!pu,fu=pu=null}finally{hc=r,O.p=n,R.T=a}}e.current=t,Fc=2}}function vd(){if(2===Fc){Fc=0;var e=Lc,t=qc,a=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||a){a=R.T,R.T=null;var n=O.p;O.p=2;var r=hc;hc|=4;try{Rl(e,t.alternate,t)}finally{hc=r,O.p=n,R.T=a}}Fc=3}}function yd(){if(4===Fc||3===Fc){Fc=0,oe();var e=Lc,t=qc,a=Uc,n=zc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Fc=5:(Fc=0,qc=Lc=null,bd(e,e.pendingLanes));var r=e.pendingLanes;if(0===r&&(Dc=null),Fe(a),t=t.stateNode,ye&&"function"===typeof ye.onCommitFiberRoot)try{ye.onCommitFiberRoot(ve,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==n){t=R.T,r=O.p,O.p=2,R.T=null;try{for(var s=e.onRecoverableError,i=0;i<n.length;i++){var o=n[i];s(o.value,{componentStack:o.stack})}}finally{R.T=t,O.p=r}}0!==(3&Uc)&&xd(),Od(e),r=e.pendingLanes,0!==(261930&a)&&0!==(42&r)?e===Hc?Vc++:(Vc=0,Hc=e):Vc=0,Dd(0,!1)}}function bd(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Ur(t)))}function xd(){return gd(),vd(),yd(),wd()}function wd(){if(5!==Fc)return!1;var e=Lc,t=Bc;Bc=0;var a=Fe(Uc),n=R.T,r=O.p;try{O.p=32>a?32:a,R.T=null,a=Gc,Gc=null;var s=Lc,o=Uc;if(Fc=0,qc=Lc=null,Uc=0,0!==(6&hc))throw Error(i(331));var l=hc;if(hc|=4,lc(s.current),ec(s,s.current,o,a),hc=l,Dd(0,!1),ye&&"function"===typeof ye.onPostCommitFiberRoot)try{ye.onPostCommitFiberRoot(ve,s)}catch(c){}return!0}finally{O.p=r,R.T=n,bd(e,t)}}function Sd(e,t,a){t=Yn(a,t),null!==(e=bs(e,t=Co(e.stateNode,t,2),2))&&(Ee(e,2),Od(e))}function kd(e,t,a){if(3===e.tag)Sd(e,e,a);else for(;null!==t;){if(3===t.tag){Sd(t,e,a);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Dc||!Dc.has(n))){e=Yn(a,e),null!==(n=bs(t,a=Mo(2),2))&&(Po(a,n,t,e),Ee(n,2),Od(n));break}}t=t.return}}function Nd(e,t,a){var n=e.pingCache;if(null===n){n=e.pingCache=new mc;var r=new Set;n.set(t,r)}else void 0===(r=n.get(t))&&(r=new Set,n.set(t,r));r.has(a)||(wc=!0,r.add(a),e=jd.bind(null,e,t,a),t.then(e,e))}function jd(e,t,a){var n=e.pingCache;null!==n&&n.delete(t),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,pc===e&&(gc&a)===a&&(4===kc||3===kc&&(62914560&gc)===gc&&300>le()-Ec?0===(2&hc)&&td(e,0):Tc|=a,_c===gc&&(_c=0)),Od(e)}function Td(e,t){0===t&&(t=Me()),null!==(e=In(e,t))&&(Ee(e,t),Od(e))}function Ad(e){var t=e.memoizedState,a=0;null!==t&&(a=t.retryLane),Td(e,a)}function _d(e,t){var a=0;switch(e.tag){case 31:case 13:var n=e.stateNode,r=e.memoizedState;null!==r&&(a=r.retryLane);break;case 19:n=e.stateNode;break;case 22:n=e.stateNode._retryCache;break;default:throw Error(i(314))}null!==n&&n.delete(t),Td(e,a)}var Cd=null,Md=null,Pd=!1,Ed=!1,Id=!1,Rd=0;function Od(e){e!==Md&&null===e.next&&(null===Md?Cd=Md=e:Md=Md.next=e),Ed=!0,Pd||(Pd=!0,Nu(function(){0!==(6&hc)?re(de,Fd):Ld()}))}function Dd(e,t){if(!Id&&Ed){Id=!0;do{for(var a=!1,n=Cd;null!==n;){if(!t)if(0!==e){var r=n.pendingLanes;if(0===r)var s=0;else{var i=n.suspendedLanes,o=n.pingedLanes;s=(1<<31-xe(42|e)+1)-1,s=201326741&(s&=r&~(i&~o))?201326741&s|1:s?2|s:0}0!==s&&(a=!0,Bd(n,s))}else s=gc,0===(3&(s=Ae(n,n===pc?s:0,null!==n.cancelPendingCommit||-1!==n.timeoutHandle)))||_e(n,s)||(a=!0,Bd(n,s));n=n.next}}while(a);Id=!1}}function Fd(){Ld()}function Ld(){Ed=Pd=!1;var e=0;0!==Rd&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==xu&&(xu=e,!0);return xu=null,!1}()&&(e=Rd);for(var t=le(),a=null,n=Cd;null!==n;){var r=n.next,s=qd(n,t);0===s?(n.next=null,null===a?Cd=r:a.next=r,null===r&&(Md=a)):(a=n,(0!==e||0!==(3&s))&&(Ed=!0)),n=r}0!==Fc&&5!==Fc||Dd(e,!1),0!==Rd&&(Rd=0)}function qd(e,t){for(var a=e.suspendedLanes,n=e.pingedLanes,r=e.expirationTimes,s=-62914561&e.pendingLanes;0<s;){var i=31-xe(s),o=1<<i,l=r[i];-1===l?0!==(o&a)&&0===(o&n)||(r[i]=Ce(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}if(a=gc,a=Ae(e,e===(t=pc)?a:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),n=e.callbackNode,0===a||e===t&&(2===vc||9===vc)||null!==e.cancelPendingCommit)return null!==n&&null!==n&&se(n),e.callbackNode=null,e.callbackPriority=0;if(0===(3&a)||_e(e,a)){if((t=a&-a)===e.callbackPriority)return t;switch(null!==n&&se(n),Fe(a)){case 2:case 8:a=ue;break;case 32:default:a=me;break;case 268435456:a=pe}return n=Ud.bind(null,e),a=re(a,n),e.callbackPriority=t,e.callbackNode=a,t}return null!==n&&null!==n&&se(n),e.callbackPriority=2,e.callbackNode=null,2}function Ud(e,t){if(0!==Fc&&5!==Fc)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(xd()&&e.callbackNode!==a)return null;var n=gc;return 0===(n=Ae(e,e===pc?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Jc(e,n,t),qd(e,le()),null!=e.callbackNode&&e.callbackNode===a?Ud.bind(null,e):null)}function Bd(e,t){if(xd())return null;Jc(e,t,!0)}function Gd(){if(0===Rd){var e=zr;0===e&&(e=ke,0===(261888&(ke<<=1))&&(ke=256)),Rd=e}return Rd}function zd(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Pt(""+e)}function Vd(e,t){var a=t.ownerDocument.createElement("input");return a.name=t.name,a.value=t.value,e.id&&a.setAttribute("form",e.id),t.parentNode.insertBefore(a,t),e=new FormData(e),a.parentNode.removeChild(a),e}for(var Hd=0;Hd<Nn.length;Hd++){var Kd=Nn[Hd];jn(Kd.toLowerCase(),"on"+(Kd[0].toUpperCase()+Kd.slice(1)))}jn(gn,"onAnimationEnd"),jn(vn,"onAnimationIteration"),jn(yn,"onAnimationStart"),jn("dblclick","onDoubleClick"),jn("focusin","onFocus"),jn("focusout","onBlur"),jn(bn,"onTransitionRun"),jn(xn,"onTransitionStart"),jn(wn,"onTransitionCancel"),jn(Sn,"onTransitionEnd"),rt("onMouseEnter",["mouseout","mouseover"]),rt("onMouseLeave",["mouseout","mouseover"]),rt("onPointerEnter",["pointerout","pointerover"]),rt("onPointerLeave",["pointerout","pointerover"]),nt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),nt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),nt("onBeforeInput",["compositionend","keypress","textInput","paste"]),nt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),nt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),nt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Yd=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Wd));function Jd(e,t){t=0!==(4&t);for(var a=0;a<e.length;a++){var n=e[a],r=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&r.isPropagationStopped())break e;s=o,r.currentTarget=c;try{s(r)}catch(d){Tn(d)}r.currentTarget=null,s=l}else for(i=0;i<n.length;i++){if(l=(o=n[i]).instance,c=o.currentTarget,o=o.listener,l!==s&&r.isPropagationStopped())break e;s=o,r.currentTarget=c;try{s(r)}catch(d){Tn(d)}r.currentTarget=null,s=l}}}}function Qd(e,t){var a=t[Ve];void 0===a&&(a=t[Ve]=new Set);var n=e+"__bubble";a.has(n)||(eu(t,e,2,!1),a.add(n))}function $d(e,t,a){var n=0;t&&(n|=4),eu(a,e,n,t)}var Xd="_reactListening"+Math.random().toString(36).slice(2);function Zd(e){if(!e[Xd]){e[Xd]=!0,tt.forEach(function(t){"selectionchange"!==t&&(Yd.has(t)||$d(t,!1,e),$d(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Xd]||(t[Xd]=!0,$d("selectionchange",!1,t))}}function eu(e,t,a,n){switch(Tm(t)){case 2:var r=xm;break;case 8:r=wm;break;default:r=Sm}a=r.bind(null,t,a,e),r=void 0,!Gt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),n?void 0!==r?e.addEventListener(t,a,{capture:!0,passive:r}):e.addEventListener(t,a,!0):void 0!==r?e.addEventListener(t,a,{passive:r}):e.addEventListener(t,a,!1)}function tu(e,t,a,n,r){var s=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var i=n.tag;if(3===i||4===i){var o=n.stateNode.containerInfo;if(o===r)break;if(4===i)for(i=n.return;null!==i;){var c=i.tag;if((3===c||4===c)&&i.stateNode.containerInfo===r)return;i=i.return}for(;null!==o;){if(null===(i=Qe(o)))return;if(5===(c=i.tag)||6===c||26===c||27===c){n=s=i;continue e}o=o.parentNode}}n=n.return}qt(function(){var n=s,r=Rt(a),i=[];e:{var o=kn.get(e);if(void 0!==o){var c=aa,d=e;switch(e){case"keypress":if(0===Yt(a))break e;case"keydown":case"keyup":c=va;break;case"focusin":d="focus",c=la;break;case"focusout":d="blur",c=la;break;case"beforeblur":case"afterblur":c=la;break;case"click":if(2===a.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=ia;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=oa;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=ba;break;case gn:case vn:case yn:c=ca;break;case Sn:c=xa;break;case"scroll":case"scrollend":c=ra;break;case"wheel":c=wa;break;case"copy":case"cut":case"paste":c=da;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=ya;break;case"toggle":case"beforetoggle":c=Sa}var u=0!==(4&t),m=!u&&("scroll"===e||"scrollend"===e),h=u?null!==o?o+"Capture":null:o;u=[];for(var p,f=n;null!==f;){var g=f;if(p=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===p||null===h||null!=(g=Ut(f,h))&&u.push(au(f,g,p)),m)break;f=f.return}0<u.length&&(o=new c(o,d,null,a,r),i.push({event:o,listeners:u}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||a===It||!(d=a.relatedTarget||a.fromElement)||!Qe(d)&&!d[ze])&&(c||o)&&(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=n,null!==(d=(d=a.relatedTarget||a.toElement)?Qe(d):null)&&(m=l(d),u=d.tag,d!==m||5!==u&&27!==u&&6!==u)&&(d=null)):(c=null,d=n),c!==d)){if(u=ia,g="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=ya,g="onPointerLeave",h="onPointerEnter",f="pointer"),m=null==c?o:Xe(c),p=null==d?o:Xe(d),(o=new u(g,f+"leave",c,a,r)).target=m,o.relatedTarget=p,g=null,Qe(r)===n&&((u=new u(h,f+"enter",d,a,r)).target=p,u.relatedTarget=m,g=u),m=g,c&&d)e:{for(u=ru,f=d,p=0,g=h=c;g;g=u(g))p++;g=0;for(var v=f;v;v=u(v))g++;for(;0<p-g;)h=u(h),p--;for(;0<g-p;)f=u(f),g--;for(;p--;){if(h===f||null!==f&&h===f.alternate){u=h;break e}h=u(h),f=u(f)}u=null}else u=null;null!==c&&su(i,o,c,u,!1),null!==d&&null!==m&&su(i,m,d,u,!0)}if("select"===(c=(o=n?Xe(n):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var y=Ua;else if(Ra(o))if(Ba)y=Qa;else{y=Ya;var b=Wa}else!(c=o.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?n&&_t(n.elementType)&&(y=Ua):y=Ja;switch(y&&(y=y(e,n))?Oa(i,y,a,r):(b&&b(e,o,n),"focusout"===e&&n&&"number"===o.type&&null!=n.memoizedProps.value&&xt(o,"number",o.value)),b=n?Xe(n):window,e){case"focusin":(Ra(b)||"true"===b.contentEditable)&&(sn=b,on=n,ln=null);break;case"focusout":ln=on=sn=null;break;case"mousedown":cn=!0;break;case"contextmenu":case"mouseup":case"dragend":cn=!1,dn(i,a,r);break;case"selectionchange":if(rn)break;case"keydown":case"keyup":dn(i,a,r)}var x;if(Na)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Ea?Ma(e,a)&&(w="onCompositionEnd"):"keydown"===e&&229===a.keyCode&&(w="onCompositionStart");w&&(Aa&&"ko"!==a.locale&&(Ea||"onCompositionStart"!==w?"onCompositionEnd"===w&&Ea&&(x=Wt()):(Ht="value"in(Vt=r)?Vt.value:Vt.textContent,Ea=!0)),0<(b=nu(n,w)).length&&(w=new ua(w,e,null,a,r),i.push({event:w,listeners:b}),x?w.data=x:null!==(x=Pa(a))&&(w.data=x))),(x=Ta?function(e,t){switch(e){case"compositionend":return Pa(t);case"keypress":return 32!==t.which?null:(Ca=!0,_a);case"textInput":return(e=t.data)===_a&&Ca?null:e;default:return null}}(e,a):function(e,t){if(Ea)return"compositionend"===e||!Na&&Ma(e,t)?(e=Wt(),Kt=Ht=Vt=null,Ea=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Aa&&"ko"!==t.locale?null:t.data}}(e,a))&&(0<(w=nu(n,"onBeforeInput")).length&&(b=new ua("onBeforeInput","beforeinput",null,a,r),i.push({event:b,listeners:w}),b.data=x)),function(e,t,a,n,r){if("submit"===t&&a&&a.stateNode===r){var s=zd((r[Ge]||null).action),i=n.submitter;i&&null!==(t=(t=i[Ge]||null)?zd(t.formAction):i.getAttribute("formAction"))&&(s=t,i=null);var o=new aa("action","action",null,n,r);e.push({event:o,listeners:[{instance:null,listener:function(){if(n.defaultPrevented){if(0!==Rd){var e=i?Vd(r,i):new FormData(r);eo(a,{pending:!0,data:e,method:r.method,action:s},null,e)}}else"function"===typeof s&&(o.preventDefault(),e=i?Vd(r,i):new FormData(r),eo(a,{pending:!0,data:e,method:r.method,action:s},s,e))},currentTarget:r}]})}}(i,e,n,a,r)}Jd(i,t)})}function au(e,t,a){return{instance:e,listener:t,currentTarget:a}}function nu(e,t){for(var a=t+"Capture",n=[];null!==e;){var r=e,s=r.stateNode;if(5!==(r=r.tag)&&26!==r&&27!==r||null===s||(null!=(r=Ut(e,a))&&n.unshift(au(e,r,s)),null!=(r=Ut(e,t))&&n.push(au(e,r,s))),3===e.tag)return n;e=e.return}return[]}function ru(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function su(e,t,a,n,r){for(var s=t._reactName,i=[];null!==a&&a!==n;){var o=a,l=o.alternate,c=o.stateNode;if(o=o.tag,null!==l&&l===n)break;5!==o&&26!==o&&27!==o||null===c||(l=c,r?null!=(c=Ut(a,s))&&i.unshift(au(a,c,l)):r||null!=(c=Ut(a,s))&&i.push(au(a,c,l))),a=a.return}0!==i.length&&e.push({event:t,listeners:i})}var iu=/\r\n?/g,ou=/\u0000|\uFFFD/g;function lu(e){return("string"===typeof e?e:""+e).replace(iu,"\n").replace(ou,"")}function cu(e,t){return t=lu(t),lu(e)===t}function du(e,t,a,n,r,s){switch(a){case"children":"string"===typeof n?"body"===t||"textarea"===t&&""===n||Nt(e,n):("number"===typeof n||"bigint"===typeof n)&&"body"!==t&&Nt(e,""+n);break;case"className":ct(e,"class",n);break;case"tabIndex":ct(e,"tabindex",n);break;case"dir":case"role":case"viewBox":case"width":case"height":ct(e,a,n);break;case"style":At(e,n,s);break;case"data":if("object"!==t){ct(e,"data",n);break}case"src":case"href":if(""===n&&("a"!==t||"href"!==a)){e.removeAttribute(a);break}if(null==n||"function"===typeof n||"symbol"===typeof n||"boolean"===typeof n){e.removeAttribute(a);break}n=Pt(""+n),e.setAttribute(a,n);break;case"action":case"formAction":if("function"===typeof n){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof s&&("formAction"===a?("input"!==t&&du(e,t,"name",r.name,r,null),du(e,t,"formEncType",r.formEncType,r,null),du(e,t,"formMethod",r.formMethod,r,null),du(e,t,"formTarget",r.formTarget,r,null)):(du(e,t,"encType",r.encType,r,null),du(e,t,"method",r.method,r,null),du(e,t,"target",r.target,r,null))),null==n||"symbol"===typeof n||"boolean"===typeof n){e.removeAttribute(a);break}n=Pt(""+n),e.setAttribute(a,n);break;case"onClick":null!=n&&(e.onclick=Et);break;case"onScroll":null!=n&&Qd("scroll",e);break;case"onScrollEnd":null!=n&&Qd("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=n){if("object"!==typeof n||!("__html"in n))throw Error(i(61));if(null!=(a=n.__html)){if(null!=r.children)throw Error(i(60));e.innerHTML=a}}break;case"multiple":e.multiple=n&&"function"!==typeof n&&"symbol"!==typeof n;break;case"muted":e.muted=n&&"function"!==typeof n&&"symbol"!==typeof n;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==n||"function"===typeof n||"boolean"===typeof n||"symbol"===typeof n){e.removeAttribute("xlink:href");break}a=Pt(""+n),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=n&&"function"!==typeof n&&"symbol"!==typeof n?e.setAttribute(a,""+n):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":n&&"function"!==typeof n&&"symbol"!==typeof n?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":!0===n?e.setAttribute(a,""):!1!==n&&null!=n&&"function"!==typeof n&&"symbol"!==typeof n?e.setAttribute(a,n):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":null!=n&&"function"!==typeof n&&"symbol"!==typeof n&&!isNaN(n)&&1<=n?e.setAttribute(a,n):e.removeAttribute(a);break;case"rowSpan":case"start":null==n||"function"===typeof n||"symbol"===typeof n||isNaN(n)?e.removeAttribute(a):e.setAttribute(a,n);break;case"popover":Qd("beforetoggle",e),Qd("toggle",e),lt(e,"popover",n);break;case"xlinkActuate":dt(e,"http://www.w3.org/1999/xlink","xlink:actuate",n);break;case"xlinkArcrole":dt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",n);break;case"xlinkRole":dt(e,"http://www.w3.org/1999/xlink","xlink:role",n);break;case"xlinkShow":dt(e,"http://www.w3.org/1999/xlink","xlink:show",n);break;case"xlinkTitle":dt(e,"http://www.w3.org/1999/xlink","xlink:title",n);break;case"xlinkType":dt(e,"http://www.w3.org/1999/xlink","xlink:type",n);break;case"xmlBase":dt(e,"http://www.w3.org/XML/1998/namespace","xml:base",n);break;case"xmlLang":dt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",n);break;case"xmlSpace":dt(e,"http://www.w3.org/XML/1998/namespace","xml:space",n);break;case"is":lt(e,"is",n);break;case"innerText":case"textContent":break;default:(!(2<a.length)||"o"!==a[0]&&"O"!==a[0]||"n"!==a[1]&&"N"!==a[1])&&lt(e,a=Ct.get(a)||a,n)}}function uu(e,t,a,n,r,s){switch(a){case"style":At(e,n,s);break;case"dangerouslySetInnerHTML":if(null!=n){if("object"!==typeof n||!("__html"in n))throw Error(i(61));if(null!=(a=n.__html)){if(null!=r.children)throw Error(i(60));e.innerHTML=a}}break;case"children":"string"===typeof n?Nt(e,n):("number"===typeof n||"bigint"===typeof n)&&Nt(e,""+n);break;case"onScroll":null!=n&&Qd("scroll",e);break;case"onScrollEnd":null!=n&&Qd("scrollend",e);break;case"onClick":null!=n&&(e.onclick=Et);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:at.hasOwnProperty(a)||("o"!==a[0]||"n"!==a[1]||(r=a.endsWith("Capture"),t=a.slice(2,r?a.length-7:void 0),"function"===typeof(s=null!=(s=e[Ge]||null)?s[a]:null)&&e.removeEventListener(t,s,r),"function"!==typeof n)?a in e?e[a]=n:!0===n?e.setAttribute(a,""):lt(e,a,n):("function"!==typeof s&&null!==s&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(t,n,r)))}}function mu(e,t,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Qd("error",e),Qd("load",e);var n,r=!1,s=!1;for(n in a)if(a.hasOwnProperty(n)){var o=a[n];if(null!=o)switch(n){case"src":r=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:du(e,t,n,o,a,null)}}return s&&du(e,t,"srcSet",a.srcSet,a,null),void(r&&du(e,t,"src",a.src,a,null));case"input":Qd("invalid",e);var l=n=o=s=null,c=null,d=null;for(r in a)if(a.hasOwnProperty(r)){var u=a[r];if(null!=u)switch(r){case"name":s=u;break;case"type":o=u;break;case"checked":c=u;break;case"defaultChecked":d=u;break;case"value":n=u;break;case"defaultValue":l=u;break;case"children":case"dangerouslySetInnerHTML":if(null!=u)throw Error(i(137,t));break;default:du(e,t,r,u,a,null)}}return void bt(e,n,l,c,d,o,s,!1);case"select":for(s in Qd("invalid",e),r=o=n=null,a)if(a.hasOwnProperty(s)&&null!=(l=a[s]))switch(s){case"value":n=l;break;case"defaultValue":o=l;break;case"multiple":r=l;default:du(e,t,s,l,a,null)}return t=n,a=o,e.multiple=!!r,void(null!=t?wt(e,!!r,t,!1):null!=a&&wt(e,!!r,a,!0));case"textarea":for(o in Qd("invalid",e),n=s=r=null,a)if(a.hasOwnProperty(o)&&null!=(l=a[o]))switch(o){case"value":r=l;break;case"defaultValue":s=l;break;case"children":n=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(i(91));break;default:du(e,t,o,l,a,null)}return void kt(e,r,s,n);case"option":for(c in a)if(a.hasOwnProperty(c)&&null!=(r=a[c]))if("selected"===c)e.selected=r&&"function"!==typeof r&&"symbol"!==typeof r;else du(e,t,c,r,a,null);return;case"dialog":Qd("beforetoggle",e),Qd("toggle",e),Qd("cancel",e),Qd("close",e);break;case"iframe":case"object":Qd("load",e);break;case"video":case"audio":for(r=0;r<Wd.length;r++)Qd(Wd[r],e);break;case"image":Qd("error",e),Qd("load",e);break;case"details":Qd("toggle",e);break;case"embed":case"source":case"link":Qd("error",e),Qd("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(d in a)if(a.hasOwnProperty(d)&&null!=(r=a[d]))switch(d){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:du(e,t,d,r,a,null)}return;default:if(_t(t)){for(u in a)a.hasOwnProperty(u)&&(void 0!==(r=a[u])&&uu(e,t,u,r,a,void 0));return}}for(l in a)a.hasOwnProperty(l)&&(null!=(r=a[l])&&du(e,t,l,r,a,null))}function hu(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var pu=null,fu=null;function gu(e){return 9===e.nodeType?e:e.ownerDocument}function vu(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function yu(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function bu(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var xu=null;var wu="function"===typeof setTimeout?setTimeout:void 0,Su="function"===typeof clearTimeout?clearTimeout:void 0,ku="function"===typeof Promise?Promise:void 0,Nu="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ku?function(e){return ku.resolve(null).then(e).catch(ju)}:wu;function ju(e){setTimeout(function(){throw e})}function Tu(e){return"head"===e}function Au(e,t){var a=t,n=0;do{var r=a.nextSibling;if(e.removeChild(a),r&&8===r.nodeType)if("/$"===(a=r.data)||"/&"===a){if(0===n)return e.removeChild(r),void Vm(t);n--}else if("$"===a||"$?"===a||"$~"===a||"$!"===a||"&"===a)n++;else if("html"===a)Lu(e.ownerDocument.documentElement);else if("head"===a){Lu(a=e.ownerDocument.head);for(var s=a.firstChild;s;){var i=s.nextSibling,o=s.nodeName;s[Ye]||"SCRIPT"===o||"STYLE"===o||"LINK"===o&&"stylesheet"===s.rel.toLowerCase()||a.removeChild(s),s=i}}else"body"===a&&Lu(e.ownerDocument.body);a=r}while(a);Vm(t)}function _u(e,t){var a=e;e=0;do{var n=a.nextSibling;if(1===a.nodeType?t?(a._stashedDisplay=a.style.display,a.style.display="none"):(a.style.display=a._stashedDisplay||"",""===a.getAttribute("style")&&a.removeAttribute("style")):3===a.nodeType&&(t?(a._stashedText=a.nodeValue,a.nodeValue=""):a.nodeValue=a._stashedText||""),n&&8===n.nodeType)if("/$"===(a=n.data)){if(0===e)break;e--}else"$"!==a&&"$?"!==a&&"$~"!==a&&"$!"!==a||e++;a=n}while(a)}function Cu(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var a=t;switch(t=t.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":Cu(a),Je(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===a.rel.toLowerCase())continue}e.removeChild(a)}}function Mu(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Iu(e.nextSibling)))return null}return e}function Pu(e){return"$?"===e.data||"$~"===e.data}function Eu(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Iu(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Ru=null;function Ou(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var a=e.data;if("/$"===a||"/&"===a){if(0===t)return Iu(e.nextSibling);t--}else"$"!==a&&"$!"!==a&&"$?"!==a&&"$~"!==a&&"&"!==a||t++}e=e.nextSibling}return null}function Du(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var a=e.data;if("$"===a||"$!"===a||"$?"===a||"$~"===a||"&"===a){if(0===t)return e;t--}else"/$"!==a&&"/&"!==a||t++}e=e.previousSibling}return null}function Fu(e,t,a){switch(t=gu(a),e){case"html":if(!(e=t.documentElement))throw Error(i(452));return e;case"head":if(!(e=t.head))throw Error(i(453));return e;case"body":if(!(e=t.body))throw Error(i(454));return e;default:throw Error(i(451))}}function Lu(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Je(e)}var qu=new Map,Uu=new Set;function Bu(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Gu=O.d;O.d={f:function(){var e=Gu.f(),t=Zc();return e||t},r:function(e){var t=$e(e);null!==t&&5===t.tag&&"form"===t.type?ao(t):Gu.r(e)},D:function(e){Gu.D(e),Vu("dns-prefetch",e,null)},C:function(e,t){Gu.C(e,t),Vu("preconnect",e,t)},L:function(e,t,a){Gu.L(e,t,a);var n=zu;if(n&&e&&t){var r='link[rel="preload"][as="'+vt(t)+'"]';"image"===t&&a&&a.imageSrcSet?(r+='[imagesrcset="'+vt(a.imageSrcSet)+'"]',"string"===typeof a.imageSizes&&(r+='[imagesizes="'+vt(a.imageSizes)+'"]')):r+='[href="'+vt(e)+'"]';var s=r;switch(t){case"style":s=Ku(e);break;case"script":s=Ju(e)}qu.has(s)||(e=h({rel:"preload",href:"image"===t&&a&&a.imageSrcSet?void 0:e,as:t},a),qu.set(s,e),null!==n.querySelector(r)||"style"===t&&n.querySelector(Wu(s))||"script"===t&&n.querySelector(Qu(s))||(mu(t=n.createElement("link"),"link",e),et(t),n.head.appendChild(t)))}},m:function(e,t){Gu.m(e,t);var a=zu;if(a&&e){var n=t&&"string"===typeof t.as?t.as:"script",r='link[rel="modulepreload"][as="'+vt(n)+'"][href="'+vt(e)+'"]',s=r;switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=Ju(e)}if(!qu.has(s)&&(e=h({rel:"modulepreload",href:e},t),qu.set(s,e),null===a.querySelector(r))){switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Qu(s)))return}mu(n=a.createElement("link"),"link",e),et(n),a.head.appendChild(n)}}},X:function(e,t){Gu.X(e,t);var a=zu;if(a&&e){var n=Ze(a).hoistableScripts,r=Ju(e),s=n.get(r);s||((s=a.querySelector(Qu(r)))||(e=h({src:e,async:!0},t),(t=qu.get(r))&&em(e,t),et(s=a.createElement("script")),mu(s,"link",e),a.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},n.set(r,s))}},S:function(e,t,a){Gu.S(e,t,a);var n=zu;if(n&&e){var r=Ze(n).hoistableStyles,s=Ku(e);t=t||"default";var i=r.get(s);if(!i){var o={loading:0,preload:null};if(i=n.querySelector(Wu(s)))o.loading=5;else{e=h({rel:"stylesheet",href:e,"data-precedence":t},a),(a=qu.get(s))&&Zu(e,a);var l=i=n.createElement("link");et(l),mu(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){o.loading|=1}),l.addEventListener("error",function(){o.loading|=2}),o.loading|=4,Xu(i,t,n)}i={type:"stylesheet",instance:i,count:1,state:o},r.set(s,i)}}},M:function(e,t){Gu.M(e,t);var a=zu;if(a&&e){var n=Ze(a).hoistableScripts,r=Ju(e),s=n.get(r);s||((s=a.querySelector(Qu(r)))||(e=h({src:e,async:!0,type:"module"},t),(t=qu.get(r))&&em(e,t),et(s=a.createElement("script")),mu(s,"link",e),a.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},n.set(r,s))}}};var zu="undefined"===typeof document?null:document;function Vu(e,t,a){var n=zu;if(n&&"string"===typeof t&&t){var r=vt(t);r='link[rel="'+e+'"][href="'+r+'"]',"string"===typeof a&&(r+='[crossorigin="'+a+'"]'),Uu.has(r)||(Uu.add(r),e={rel:e,crossOrigin:a,href:t},null===n.querySelector(r)&&(mu(t=n.createElement("link"),"link",e),et(t),n.head.appendChild(t)))}}function Hu(e,t,a,n){var r,s,o,l,c=(c=K.current)?Bu(c):null;if(!c)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof a.precedence&&"string"===typeof a.href?(t=Ku(a.href),(n=(a=Ze(c).hoistableStyles).get(t))||(n={type:"style",instance:null,count:0,state:null},a.set(t,n)),n):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===a.rel&&"string"===typeof a.href&&"string"===typeof a.precedence){e=Ku(a.href);var d=Ze(c).hoistableStyles,u=d.get(e);if(u||(c=c.ownerDocument||c,u={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(e,u),(d=c.querySelector(Wu(e)))&&!d._p&&(u.instance=d,u.state.loading=5),qu.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},qu.set(e,a),d||(r=c,s=e,o=a,l=u.state,r.querySelector('link[rel="preload"][as="style"]['+s+"]")?l.loading=1:(s=r.createElement("link"),l.preload=s,s.addEventListener("load",function(){return l.loading|=1}),s.addEventListener("error",function(){return l.loading|=2}),mu(s,"link",o),et(s),r.head.appendChild(s))))),t&&null===n)throw Error(i(528,""));return u}if(t&&null!==n)throw Error(i(529,""));return null;case"script":return t=a.async,"string"===typeof(a=a.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Ju(a),(n=(a=Ze(c).hoistableScripts).get(t))||(n={type:"script",instance:null,count:0,state:null},a.set(t,n)),n):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function Ku(e){return'href="'+vt(e)+'"'}function Wu(e){return'link[rel="stylesheet"]['+e+"]"}function Yu(e){return h({},e,{"data-precedence":e.precedence,precedence:null})}function Ju(e){return'[src="'+vt(e)+'"]'}function Qu(e){return"script[async]"+e}function $u(e,t,a){if(t.count++,null===t.instance)switch(t.type){case"style":var n=e.querySelector('style[data-href~="'+vt(a.href)+'"]');if(n)return t.instance=n,et(n),n;var r=h({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return et(n=(e.ownerDocument||e).createElement("style")),mu(n,"style",r),Xu(n,a.precedence,e),t.instance=n;case"stylesheet":r=Ku(a.href);var s=e.querySelector(Wu(r));if(s)return t.state.loading|=4,t.instance=s,et(s),s;n=Yu(a),(r=qu.get(r))&&Zu(n,r),et(s=(e.ownerDocument||e).createElement("link"));var o=s;return o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),mu(s,"link",n),t.state.loading|=4,Xu(s,a.precedence,e),t.instance=s;case"script":return s=Ju(a.src),(r=e.querySelector(Qu(s)))?(t.instance=r,et(r),r):(n=a,(r=qu.get(s))&&em(n=h({},a),r),et(r=(e=e.ownerDocument||e).createElement("script")),mu(r,"link",n),e.head.appendChild(r),t.instance=r);case"void":return null;default:throw Error(i(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(n=t.instance,t.state.loading|=4,Xu(n,a.precedence,e));return t.instance}function Xu(e,t,a){for(var n=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=n.length?n[n.length-1]:null,s=r,i=0;i<n.length;i++){var o=n[i];if(o.dataset.precedence===t)s=o;else if(s!==r)break}s?s.parentNode.insertBefore(e,s.nextSibling):(t=9===a.nodeType?a.head:a).insertBefore(e,t.firstChild)}function Zu(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function em(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var tm=null;function am(e,t,a){if(null===tm){var n=new Map,r=tm=new Map;r.set(a,n)}else(n=(r=tm).get(a))||(n=new Map,r.set(a,n));if(n.has(e))return n;for(n.set(e,null),a=a.getElementsByTagName(e),r=0;r<a.length;r++){var s=a[r];if(!(s[Ye]||s[Be]||"link"===e&&"stylesheet"===s.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==s.namespaceURI){var i=s.getAttribute(t)||"";i=e+i;var o=n.get(i);o?o.push(s):n.set(i,[s])}}return n}function nm(e,t,a){(e=e.ownerDocument||e).head.insertBefore(a,"title"===t?e.querySelector("head > title"):null)}function rm(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var sm=0;function im(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)lm(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var om=null;function lm(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,om=new Map,t.forEach(cm,e),om=null,im.call(e))}function cm(e,t){if(!(4&t.state.loading)){var a=om.get(e);if(a)var n=a.get(null);else{a=new Map,om.set(e,a);for(var r=e.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<r.length;s++){var i=r[s];"LINK"!==i.nodeName&&"not all"===i.getAttribute("media")||(a.set(i.dataset.precedence,i),n=i)}n&&a.set(null,n)}i=(r=t.instance).getAttribute("data-precedence"),(s=a.get(i)||n)===n&&a.set(null,r),a.set(i,r),this.count++,n=im.bind(this),r.addEventListener("load",n),r.addEventListener("error",n),s?s.parentNode.insertBefore(r,s.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(r,e.firstChild),t.state.loading|=4}}var dm={$$typeof:w,Provider:null,Consumer:null,_currentValue:D,_currentValue2:D,_threadCount:0};function um(e,t,a,n,r,s,i,o,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Pe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pe(0),this.hiddenUpdates=Pe(null),this.identifierPrefix=n,this.onUncaughtError=r,this.onCaughtError=s,this.onRecoverableError=i,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function mm(e,t,a,n,r,s,i,o,l,c,d,u){return e=new um(e,t,a,i,l,c,d,u,o),t=1,!0===s&&(t|=24),s=Ln(3,null,null,t),e.current=s,s.stateNode=e,(t=qr()).refCount++,e.pooledCache=t,t.refCount++,s.memoizedState={element:n,isDehydrated:a,cache:t},gs(s),e}function hm(e){return e?e=Dn:Dn}function pm(e,t,a,n,r,s){r=hm(r),null===n.context?n.context=r:n.pendingContext=r,(n=ys(t)).payload={element:a},null!==(s=void 0===s?null:s)&&(n.callback=s),null!==(a=bs(e,n,t))&&(Yc(a,0,t),xs(a,e,t))}function fm(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var a=e.retryLane;e.retryLane=0!==a&&a<t?a:t}}function gm(e,t){fm(e,t),(e=e.alternate)&&fm(e,t)}function vm(e){if(13===e.tag||31===e.tag){var t=In(e,67108864);null!==t&&Yc(t,0,67108864),gm(e,67108864)}}function ym(e){if(13===e.tag||31===e.tag){var t=Kc(),a=In(e,t=De(t));null!==a&&Yc(a,0,t),gm(e,t)}}var bm=!0;function xm(e,t,a,n){var r=R.T;R.T=null;var s=O.p;try{O.p=2,Sm(e,t,a,n)}finally{O.p=s,R.T=r}}function wm(e,t,a,n){var r=R.T;R.T=null;var s=O.p;try{O.p=8,Sm(e,t,a,n)}finally{O.p=s,R.T=r}}function Sm(e,t,a,n){if(bm){var r=km(n);if(null===r)tu(e,t,n,Nm,a),Om(e,n);else if(function(e,t,a,n,r){switch(t){case"focusin":return _m=Dm(_m,e,t,a,n,r),!0;case"dragenter":return Cm=Dm(Cm,e,t,a,n,r),!0;case"mouseover":return Mm=Dm(Mm,e,t,a,n,r),!0;case"pointerover":var s=r.pointerId;return Pm.set(s,Dm(Pm.get(s)||null,e,t,a,n,r)),!0;case"gotpointercapture":return s=r.pointerId,Em.set(s,Dm(Em.get(s)||null,e,t,a,n,r)),!0}return!1}(r,e,t,a,n))n.stopPropagation();else if(Om(e,n),4&t&&-1<Rm.indexOf(e)){for(;null!==r;){var s=$e(r);if(null!==s)switch(s.tag){case 3:if((s=s.stateNode).current.memoizedState.isDehydrated){var i=Te(s.pendingLanes);if(0!==i){var o=s;for(o.pendingLanes|=2,o.entangledLanes|=2;i;){var l=1<<31-xe(i);o.entanglements[1]|=l,i&=~l}Od(s),0===(6&hc)&&(Rc=le()+500,Dd(0,!1))}}break;case 31:case 13:null!==(o=In(s,2))&&Yc(o,0,2),Zc(),gm(s,2)}if(null===(s=km(n))&&tu(e,t,n,Nm,a),s===r)break;r=s}null!==r&&n.stopPropagation()}else tu(e,t,n,null,a)}}function km(e){return jm(e=Rt(e))}var Nm=null;function jm(e){if(Nm=null,null!==(e=Qe(e))){var t=l(e);if(null===t)e=null;else{var a=t.tag;if(13===a){if(null!==(e=c(t)))return e;e=null}else if(31===a){if(null!==(e=d(t)))return e;e=null}else if(3===a){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Nm=e,null}function Tm(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case de:return 2;case ue:return 8;case me:case he:return 32;case pe:return 268435456;default:return 32}default:return 32}}var Am=!1,_m=null,Cm=null,Mm=null,Pm=new Map,Em=new Map,Im=[],Rm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Om(e,t){switch(e){case"focusin":case"focusout":_m=null;break;case"dragenter":case"dragleave":Cm=null;break;case"mouseover":case"mouseout":Mm=null;break;case"pointerover":case"pointerout":Pm.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Em.delete(t.pointerId)}}function Dm(e,t,a,n,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:a,eventSystemFlags:n,nativeEvent:s,targetContainers:[r]},null!==t&&(null!==(t=$e(t))&&vm(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Fm(e){var t=Qe(e.target);if(null!==t){var a=l(t);if(null!==a)if(13===(t=a.tag)){if(null!==(t=c(a)))return e.blockedOn=t,void qe(e.priority,function(){ym(a)})}else if(31===t){if(null!==(t=d(a)))return e.blockedOn=t,void qe(e.priority,function(){ym(a)})}else if(3===t&&a.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===a.tag?a.stateNode.containerInfo:null)}e.blockedOn=null}function Lm(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var a=km(e.nativeEvent);if(null!==a)return null!==(t=$e(a))&&vm(t),e.blockedOn=a,!1;var n=new(a=e.nativeEvent).constructor(a.type,a);It=n,a.target.dispatchEvent(n),It=null,t.shift()}return!0}function qm(e,t,a){Lm(e)&&a.delete(t)}function Um(){Am=!1,null!==_m&&Lm(_m)&&(_m=null),null!==Cm&&Lm(Cm)&&(Cm=null),null!==Mm&&Lm(Mm)&&(Mm=null),Pm.forEach(qm),Em.forEach(qm)}function Bm(e,t){e.blockedOn===t&&(e.blockedOn=null,Am||(Am=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Um)))}var Gm=null;function zm(e){Gm!==e&&(Gm=e,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Gm===e&&(Gm=null);for(var t=0;t<e.length;t+=3){var a=e[t],n=e[t+1],r=e[t+2];if("function"!==typeof n){if(null===jm(n||a))continue;break}var s=$e(a);null!==s&&(e.splice(t,3),t-=3,eo(s,{pending:!0,data:r,method:a.method,action:n},n,r))}}))}function Vm(e){function t(t){return Bm(t,e)}null!==_m&&Bm(_m,e),null!==Cm&&Bm(Cm,e),null!==Mm&&Bm(Mm,e),Pm.forEach(t),Em.forEach(t);for(var a=0;a<Im.length;a++){var n=Im[a];n.blockedOn===e&&(n.blockedOn=null)}for(;0<Im.length&&null===(a=Im[0]).blockedOn;)Fm(a),null===a.blockedOn&&Im.shift();if(null!=(a=(e.ownerDocument||e).$$reactFormReplay))for(n=0;n<a.length;n+=3){var r=a[n],s=a[n+1],i=r[Ge]||null;if("function"===typeof s)i||zm(a);else if(i){var o=null;if(s&&s.hasAttribute("formAction")){if(r=s,i=s[Ge]||null)o=i.formAction;else if(null!==jm(r))continue}else o=i.action;"function"===typeof o?a[n+1]=o:(a.splice(n,3),n-=3),zm(a)}}}function Hm(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return r=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==r&&(r(),r=null),n||setTimeout(a,20)}function a(){if(!n&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"===typeof navigation){var n=!1,r=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(a,100),function(){n=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==r&&(r(),r=null)}}}function Km(e){this._internalRoot=e}function Wm(e){this._internalRoot=e}Wm.prototype.render=Km.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));pm(t.current,Kc(),e,t,null,null)},Wm.prototype.unmount=Km.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;pm(e.current,2,null,e,null,null),Zc(),t[ze]=null}},Wm.prototype.unstable_scheduleHydration=function(e){if(e){var t=Le();e={blockedOn:null,target:e,priority:t};for(var a=0;a<Im.length&&0!==t&&t<Im[a].priority;a++);Im.splice(a,0,e),0===a&&Fm(e)}};var Ym=r.version;if("19.2.3"!==Ym)throw Error(i(527,Ym,"19.2.3"));O.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(i(188));return t!==e?null:e}for(var a=e,n=t;;){var r=a.return;if(null===r)break;var s=r.alternate;if(null===s){if(null!==(n=r.return)){a=n;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===a)return u(r),e;if(s===n)return u(r),t;s=s.sibling}throw Error(i(188))}if(a.return!==n.return)a=r,n=s;else{for(var o=!1,c=r.child;c;){if(c===a){o=!0,a=r,n=s;break}if(c===n){o=!0,n=r,a=s;break}c=c.sibling}if(!o){for(c=s.child;c;){if(c===a){o=!0,a=s,n=r;break}if(c===n){o=!0,n=s,a=r;break}c=c.sibling}if(!o)throw Error(i(189))}}if(a.alternate!==n)throw Error(i(190))}if(3!==a.tag)throw Error(i(188));return a.stateNode.current===a?e:t}(t),e=null===(e=null!==e?m(e):null)?null:e.stateNode};var Jm={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:R,reconcilerVersion:"19.2.3"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Qm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qm.isDisabled&&Qm.supportsFiber)try{ve=Qm.inject(Jm),ye=Qm}catch(Xm){}}t.createRoot=function(e,t){if(!o(e))throw Error(i(299));var a=!1,n="",r=No,s=jo,l=To;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(a=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onUncaughtError&&(r=t.onUncaughtError),void 0!==t.onCaughtError&&(s=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError)),t=mm(e,1,!1,null,0,a,n,null,r,s,l,Hm),e[ze]=t.current,Zd(e),new Km(t)},t.hydrateRoot=function(e,t,a){if(!o(e))throw Error(i(299));var n=!1,r="",s=No,l=jo,c=To,d=null;return null!==a&&void 0!==a&&(!0===a.unstable_strictMode&&(n=!0),void 0!==a.identifierPrefix&&(r=a.identifierPrefix),void 0!==a.onUncaughtError&&(s=a.onUncaughtError),void 0!==a.onCaughtError&&(l=a.onCaughtError),void 0!==a.onRecoverableError&&(c=a.onRecoverableError),void 0!==a.formState&&(d=a.formState)),(t=mm(e,1,!0,t,0,n,r,d,s,l,c,Hm)).context=hm(null),a=t.current,(r=ys(n=De(n=Kc()))).callback=null,bs(a,r,n),a=n,t.current.lanes=a,Ee(t,a),Od(t),e[ze]=t.current,Zd(e),new Wm(t)},t.version="19.2.3"},672(e,t,a){"use strict";var n=a(43);function r(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var i={d:{f:s,r:function(){throw Error(r(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},o=Symbol.for("react.portal");var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,t.createPortal=function(e,t){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(r(299));return function(e,t,a){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:o,key:null==n?null:""+n,children:e,containerInfo:t,implementation:a}}(e,t,null,a)},t.flushSync=function(e){var t=l.T,a=i.p;try{if(l.T=null,i.p=2,e)return e()}finally{l.T=t,i.p=a,i.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,i.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&i.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var a=t.as,n=c(a,t.crossOrigin),r="string"===typeof t.integrity?t.integrity:void 0,s="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===a?i.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:n,integrity:r,fetchPriority:s}):"script"===a&&i.d.X(e,{crossOrigin:n,integrity:r,fetchPriority:s,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var a=c(t.as,t.crossOrigin);i.d.M(e,{crossOrigin:a,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&i.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var a=t.as,n=c(a,t.crossOrigin);i.d.L(e,a,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var a=c(t.as,t.crossOrigin);i.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:a,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else i.d.m(e)},t.requestFormReset=function(e){i.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,a){return l.H.useFormState(e,t,a)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.2.3"},391(e,t,a){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=a(4)},950(e,t,a){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=a(672)},799(e,t){"use strict";var a=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function r(e,t,n){var r=null;if(void 0!==n&&(r=""+n),void 0!==t.key&&(r=""+t.key),"key"in t)for(var s in n={},t)"key"!==s&&(n[s]=t[s]);else n=t;return t=n.ref,{$$typeof:a,type:e,key:r,ref:void 0!==t?t:null,props:n}}t.Fragment=n,t.jsx=r,t.jsxs=r},288(e,t){"use strict";var a=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),h=Symbol.for("react.activity"),p=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,v={};function y(e,t,a){this.props=e,this.context=t,this.refs=v,this.updater=a||f}function b(){}function x(e,t,a){this.props=e,this.context=t,this.refs=v,this.updater=a||f}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=y.prototype;var w=x.prototype=new b;w.constructor=x,g(w,y.prototype),w.isPureReactComponent=!0;var S=Array.isArray;function k(){}var N={H:null,A:null,T:null,S:null},j=Object.prototype.hasOwnProperty;function T(e,t,n){var r=n.ref;return{$$typeof:a,type:e,key:t,ref:void 0!==r?r:null,props:n}}function A(e){return"object"===typeof e&&null!==e&&e.$$typeof===a}var _=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function M(e,t,r,s,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l,c,d=!1;if(null===e)d=!0;else switch(o){case"bigint":case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case a:case n:d=!0;break;case m:return M((d=e._init)(e._payload),t,r,s,i)}}if(d)return i=i(e),d=""===s?"."+C(e,0):s,S(i)?(r="",null!=d&&(r=d.replace(_,"$&/")+"/"),M(i,t,r,"",function(e){return e})):null!=i&&(A(i)&&(l=i,c=r+(null==i.key||e&&e.key===i.key?"":(""+i.key).replace(_,"$&/")+"/")+d,i=T(l.type,c,l.props)),t.push(i)),1;d=0;var u,h=""===s?".":s+":";if(S(e))for(var f=0;f<e.length;f++)d+=M(s=e[f],t,r,o=h+C(s,f),i);else if("function"===typeof(f=null===(u=e)||"object"!==typeof u?null:"function"===typeof(u=p&&u[p]||u["@@iterator"])?u:null))for(e=f.call(e),f=0;!(s=e.next()).done;)d+=M(s=s.value,t,r,o=h+C(s,f++),i);else if("object"===o){if("function"===typeof e.then)return M(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(k,k):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,r,s,i);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return d}function P(e,t,a){if(null==e)return e;var n=[],r=0;return M(e,n,"","",function(e){return t.call(a,e,r++)}),n}function E(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},R={map:P,forEach:function(e,t,a){P(e,function(){t.apply(this,arguments)},a)},count:function(e){var t=0;return P(e,function(){t++}),t},toArray:function(e){return P(e,function(e){return e})||[]},only:function(e){if(!A(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=h,t.Children=R,t.Component=y,t.Fragment=r,t.Profiler=i,t.PureComponent=x,t.StrictMode=s,t.Suspense=d,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return N.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,a){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var n=g({},e.props),r=e.key;if(null!=t)for(s in void 0!==t.key&&(r=""+t.key),t)!j.call(t,s)||"key"===s||"__self"===s||"__source"===s||"ref"===s&&void 0===t.ref||(n[s]=t[s]);var s=arguments.length-2;if(1===s)n.children=a;else if(1<s){for(var i=Array(s),o=0;o<s;o++)i[o]=arguments[o+2];n.children=i}return T(e.type,r,n)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:o,_context:e},e},t.createElement=function(e,t,a){var n,r={},s=null;if(null!=t)for(n in void 0!==t.key&&(s=""+t.key),t)j.call(t,n)&&"key"!==n&&"__self"!==n&&"__source"!==n&&(r[n]=t[n]);var i=arguments.length-2;if(1===i)r.children=a;else if(1<i){for(var o=Array(i),l=0;l<i;l++)o[l]=arguments[l+2];r.children=o}if(e&&e.defaultProps)for(n in i=e.defaultProps)void 0===r[n]&&(r[n]=i[n]);return T(e,s,r)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:m,_payload:{_status:-1,_result:e},_init:E}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=N.T,a={};N.T=a;try{var n=e(),r=N.S;null!==r&&r(a,n),"object"===typeof n&&null!==n&&"function"===typeof n.then&&n.then(k,I)}catch(s){I(s)}finally{null!==t&&null!==a.types&&(t.types=a.types),N.T=t}},t.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},t.use=function(e){return N.H.use(e)},t.useActionState=function(e,t,a){return N.H.useActionState(e,t,a)},t.useCallback=function(e,t){return N.H.useCallback(e,t)},t.useContext=function(e){return N.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return N.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return N.H.useEffect(e,t)},t.useEffectEvent=function(e){return N.H.useEffectEvent(e)},t.useId=function(){return N.H.useId()},t.useImperativeHandle=function(e,t,a){return N.H.useImperativeHandle(e,t,a)},t.useInsertionEffect=function(e,t){return N.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return N.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return N.H.useMemo(e,t)},t.useOptimistic=function(e,t){return N.H.useOptimistic(e,t)},t.useReducer=function(e,t,a){return N.H.useReducer(e,t,a)},t.useRef=function(e){return N.H.useRef(e)},t.useState=function(e){return N.H.useState(e)},t.useSyncExternalStore=function(e,t,a){return N.H.useSyncExternalStore(e,t,a)},t.useTransition=function(){return N.H.useTransition()},t.version="19.2.3"},43(e,t,a){"use strict";e.exports=a(288)},579(e,t,a){"use strict";e.exports=a(799)},896(e,t){"use strict";function a(e,t){var a=e.length;e.push(t);e:for(;0<a;){var n=a-1>>>1,r=e[n];if(!(0<s(r,t)))break e;e[n]=t,e[a]=r,a=n}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],a=e.pop();if(a!==t){e[0]=a;e:for(var n=0,r=e.length,i=r>>>1;n<i;){var o=2*(n+1)-1,l=e[o],c=o+1,d=e[c];if(0>s(l,a))c<r&&0>s(d,l)?(e[n]=d,e[c]=a,n=c):(e[n]=l,e[o]=a,n=o);else{if(!(c<r&&0>s(d,a)))break e;e[n]=d,e[c]=a,n=c}}}return t}function s(e,t){var a=e.sortIndex-t.sortIndex;return 0!==a?a:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,m=null,h=3,p=!1,f=!1,g=!1,v=!1,y="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,x="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=n(d);null!==t;){if(null===t.callback)r(d);else{if(!(t.startTime<=e))break;r(d),t.sortIndex=t.expirationTime,a(c,t)}t=n(d)}}function S(e){if(g=!1,w(e),!f)if(null!==n(c))f=!0,N||(N=!0,k());else{var t=n(d);null!==t&&E(S,t.startTime-e)}}var k,N=!1,j=-1,T=5,A=-1;function _(){return!!v||!(t.unstable_now()-A<T)}function C(){if(v=!1,N){var e=t.unstable_now();A=e;var a=!0;try{e:{f=!1,g&&(g=!1,b(j),j=-1),p=!0;var s=h;try{t:{for(w(e),m=n(c);null!==m&&!(m.expirationTime>e&&_());){var i=m.callback;if("function"===typeof i){m.callback=null,h=m.priorityLevel;var o=i(m.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof o){m.callback=o,w(e),a=!0;break t}m===n(c)&&r(c),w(e)}else r(c);m=n(c)}if(null!==m)a=!0;else{var l=n(d);null!==l&&E(S,l.startTime-e),a=!1}}break e}finally{m=null,h=s,p=!1}a=void 0}}finally{a?k():N=!1}}}if("function"===typeof x)k=function(){x(C)};else if("undefined"!==typeof MessageChannel){var M=new MessageChannel,P=M.port2;M.port1.onmessage=C,k=function(){P.postMessage(null)}}else k=function(){y(C,0)};function E(e,a){j=y(function(){e(t.unstable_now())},a)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var a=h;h=t;try{return e()}finally{h=a}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var a=h;h=e;try{return t()}finally{h=a}},t.unstable_scheduleCallback=function(e,r,s){var i=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?i+s:i:s=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:r,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>i?(e.sortIndex=s,a(d,e),null===n(c)&&e===n(d)&&(g?(b(j),j=-1):g=!0,E(S,s-i))):(e.sortIndex=o,a(c,e),f||p||(f=!0,N||(N=!0,k()))),e},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(e){var t=h;return function(){var a=h;h=t;try{return e.apply(this,arguments)}finally{h=a}}}},853(e,t,a){"use strict";e.exports=a(896)},330(e,t,a){"use strict";var n=a(43);var r="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},s=n.useState,i=n.useEffect,o=n.useLayoutEffect,l=n.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!r(e,a)}catch(n){return!0}}var d="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var a=t(),n=s({inst:{value:a,getSnapshot:t}}),r=n[0].inst,d=n[1];return o(function(){r.value=a,r.getSnapshot=t,c(r)&&d({inst:r})},[e,a,t]),i(function(){return c(r)&&d({inst:r}),e(function(){c(r)&&d({inst:r})})},[e]),l(a),a};t.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:d},461(e,t,a){"use strict";e.exports=a(330)},844(e){e.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}},555(e,t,a){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}function s(e,t,a){return(t=r(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach(function(t){s(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}a.d(t,{A:()=>o})}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,a),s.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="https://sportwizard.se/",(()=>{"use strict";var e=a(43),t=a(391),n=a(555);const r=e=>"string"===typeof e,s=()=>{let e,t;const a=new Promise((a,n)=>{e=a,t=n});return a.resolve=e,a.reject=t,a},i=e=>null==e?"":""+e,o=/###/g,l=e=>e&&e.indexOf("###")>-1?e.replace(o,"."):e,c=e=>!e||r(e),d=(e,t,a)=>{const n=r(t)?t.split("."):t;let s=0;for(;s<n.length-1;){if(c(e))return{};const t=l(n[s]);!e[t]&&a&&(e[t]=new a),e=Object.prototype.hasOwnProperty.call(e,t)?e[t]:{},++s}return c(e)?{}:{obj:e,k:l(n[s])}},u=(e,t,a)=>{const{obj:n,k:r}=d(e,t,Object);if(void 0!==n||1===t.length)return void(n[r]=a);let s=t[t.length-1],i=t.slice(0,t.length-1),o=d(e,i,Object);for(;void 0===o.obj&&i.length;){var l;s="".concat(i[i.length-1],".").concat(s),i=i.slice(0,i.length-1),o=d(e,i,Object),null!==(l=o)&&void 0!==l&&l.obj&&"undefined"!==typeof o.obj["".concat(o.k,".").concat(s)]&&(o.obj=void 0)}o.obj["".concat(o.k,".").concat(s)]=a},m=(e,t)=>{const{obj:a,k:n}=d(e,t);if(a&&Object.prototype.hasOwnProperty.call(a,n))return a[n]},h=(e,t,a)=>{for(const n in t)"__proto__"!==n&&"constructor"!==n&&(n in e?r(e[n])||e[n]instanceof String||r(t[n])||t[n]instanceof String?a&&(e[n]=t[n]):h(e[n],t[n],a):e[n]=t[n]);return e},p=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var f={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const g=e=>r(e)?e.replace(/[&<>"'\/]/g,e=>f[e]):e;const v=[" ",",","?","!",";"],y=new class{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(void 0!==t)return t;const a=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,a),this.regExpQueue.push(e),a}}(20),b=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(!e)return;if(e[t]){if(!Object.prototype.hasOwnProperty.call(e,t))return;return e[t]}const n=t.split(a);let r=e;for(let s=0;s<n.length;){if(!r||"object"!==typeof r)return;let e,t="";for(let i=s;i<n.length;++i)if(i!==s&&(t+=a),t+=n[i],e=r[t],void 0!==e){if(["string","number","boolean"].indexOf(typeof e)>-1&&i<n.length-1)continue;s+=i-s+1;break}r=e}return r},x=e=>null===e||void 0===e?void 0:e.replace("_","-"),w={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){var a,n;null===(a=console)||void 0===a||null===(a=a[e])||void 0===a||null===(n=a.apply)||void 0===n||n.call(a,console,t)}};class S{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.init(e,t)}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||w,this.options=t,this.debug=t.debug}log(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return this.forward(t,"log","",!0)}warn(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return this.forward(t,"warn","",!0)}error(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return this.forward(t,"error","")}deprecate(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,a,n){return n&&!this.debug?null:(r(e[0])&&(e[0]="".concat(a).concat(this.prefix," ").concat(e[0])),this.logger[t](e))}create(e){return new S(this.logger,(0,n.A)((0,n.A)({},{prefix:"".concat(this.prefix,":").concat(e,":")}),this.options))}clone(e){return(e=e||this.options).prefix=e.prefix||this.prefix,new S(this.logger,e)}}var k=new S;class N{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(e=>{this.observers[e]||(this.observers[e]=new Map);const a=this.observers[e].get(t)||0;this.observers[e].set(t,a+1)}),this}off(e,t){this.observers[e]&&(t?this.observers[e].delete(t):delete this.observers[e])}emit(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];if(this.observers[e]){Array.from(this.observers[e].entries()).forEach(e=>{let[t,n]=e;for(let r=0;r<n;r++)t(...a)})}if(this.observers["*"]){Array.from(this.observers["*"].entries()).forEach(t=>{let[n,r]=t;for(let s=0;s<r;s++)n.apply(n,[e,...a])})}}}class j extends N{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,a){var n;let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=void 0!==s.keySeparator?s.keySeparator:this.options.keySeparator,o=void 0!==s.ignoreJSONStructure?s.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;e.indexOf(".")>-1?l=e.split("."):(l=[e,t],a&&(Array.isArray(a)?l.push(...a):r(a)&&i?l.push(...a.split(i)):l.push(a)));const c=m(this.data,l);return!c&&!t&&!a&&e.indexOf(".")>-1&&(e=l[0],t=l[1],a=l.slice(2).join(".")),!c&&o&&r(a)?b(null===(n=this.data)||void 0===n||null===(n=n[e])||void 0===n?void 0:n[t],a,i):c}addResource(e,t,a,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1};const s=void 0!==r.keySeparator?r.keySeparator:this.options.keySeparator;let i=[e,t];a&&(i=i.concat(s?a.split(s):a)),e.indexOf(".")>-1&&(i=e.split("."),n=t,t=i[1]),this.addNamespaces(t),u(this.data,i,n),r.silent||this.emit("added",e,t,a,n)}addResources(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(const s in a)(r(a[s])||Array.isArray(a[s]))&&this.addResource(e,t,s,a[s],{silent:!0});n.silent||this.emit("added",e,t,a)}addResourceBundle(e,t,a,r,s){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1,skipCopy:!1},o=[e,t];e.indexOf(".")>-1&&(o=e.split("."),r=a,a=t,t=o[1]),this.addNamespaces(t);let l=m(this.data,o)||{};i.skipCopy||(a=JSON.parse(JSON.stringify(a))),r?h(l,a,s):l=(0,n.A)((0,n.A)({},l),a),u(this.data,o,l),i.silent||this.emit("added",e,t,a)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return void 0!==this.getResource(e,t)}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(e=>t[e]&&Object.keys(t[e]).length>0)}toJSON(){return this.data}}var T={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,a,n,r){return e.forEach(e=>{var s,i;t=null!==(s=null===(i=this.processors[e])||void 0===i?void 0:i.process(t,a,n,r))&&void 0!==s?s:t}),t}};const A=Symbol("i18next/PATH_KEY");function _(e,t){var a;const{[A]:n}=e(function(){const e=[],t=Object.create(null);let a;return t.get=(n,r)=>{var s,i;return null===(s=a)||void 0===s||null===(i=s.revoke)||void 0===i||i.call(s),r===A?e:(e.push(r),a=Proxy.revocable(n,t),a.proxy)},Proxy.revocable(Object.create(null),t).proxy}());return n.join(null!==(a=null===t||void 0===t?void 0:t.keySeparator)&&void 0!==a?a:".")}const C={},M=e=>!r(e)&&"boolean"!==typeof e&&"number"!==typeof e;class P extends N{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),((e,t,a)=>{e.forEach(e=>{t[e]&&(a[e]=t[e])})})(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=k.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};const a=(0,n.A)({},t);if(null==e)return!1;const r=this.resolve(e,a);if(void 0===(null===r||void 0===r?void 0:r.res))return!1;const s=M(r.res);return!1!==a.returnObjects||!s}extractFromKey(e,t){let a=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===a&&(a=":");const n=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator;let s=t.ns||this.options.defaultNS||[];const i=a&&e.indexOf(a)>-1,o=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!((e,t,a)=>{t=t||"",a=a||"";const n=v.filter(e=>t.indexOf(e)<0&&a.indexOf(e)<0);if(0===n.length)return!0;const r=y.getRegExp("(".concat(n.map(e=>"?"===e?"\\?":e).join("|"),")"));let s=!r.test(e);if(!s){const t=e.indexOf(a);t>0&&!r.test(e.substring(0,t))&&(s=!0)}return s})(e,a,n);if(i&&!o){const t=e.match(this.interpolator.nestingRegexp);if(t&&t.length>0)return{key:e,namespaces:r(s)?[s]:s};const i=e.split(a);(a!==n||a===n&&this.options.ns.indexOf(i[0])>-1)&&(s=i.shift()),e=i.join(n)}return{key:e,namespaces:r(s)?[s]:s}}translate(e,t,a){let s="object"===typeof t?(0,n.A)({},t):t;if("object"!==typeof s&&this.options.overloadTranslationOptionHandler&&(s=this.options.overloadTranslationOptionHandler(arguments)),"object"===typeof s&&(s=(0,n.A)({},s)),s||(s={}),null==e)return"";"function"===typeof e&&(e=_(e,(0,n.A)((0,n.A)({},this.options),s))),Array.isArray(e)||(e=[String(e)]);const i=void 0!==s.returnDetails?s.returnDetails:this.options.returnDetails,o=void 0!==s.keySeparator?s.keySeparator:this.options.keySeparator,{key:l,namespaces:c}=this.extractFromKey(e[e.length-1],s),d=c[c.length-1];let u=void 0!==s.nsSeparator?s.nsSeparator:this.options.nsSeparator;void 0===u&&(u=":");const m=s.lng||this.language,h=s.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if("cimode"===(null===m||void 0===m?void 0:m.toLowerCase()))return h?i?{res:"".concat(d).concat(u).concat(l),usedKey:l,exactUsedKey:l,usedLng:m,usedNS:d,usedParams:this.getUsedParamsDetails(s)}:"".concat(d).concat(u).concat(l):i?{res:l,usedKey:l,exactUsedKey:l,usedLng:m,usedNS:d,usedParams:this.getUsedParamsDetails(s)}:l;const p=this.resolve(e,s);let f=null===p||void 0===p?void 0:p.res;const g=(null===p||void 0===p?void 0:p.usedKey)||l,v=(null===p||void 0===p?void 0:p.exactUsedKey)||l,y=void 0!==s.joinArrays?s.joinArrays:this.options.joinArrays,b=!this.i18nFormat||this.i18nFormat.handleAsObject,x=void 0!==s.count&&!r(s.count),w=P.hasDefaultValue(s),S=x?this.pluralResolver.getSuffix(m,s.count,s):"",k=s.ordinal&&x?this.pluralResolver.getSuffix(m,s.count,{ordinal:!1}):"",N=x&&!s.ordinal&&0===s.count,j=N&&s["defaultValue".concat(this.options.pluralSeparator,"zero")]||s["defaultValue".concat(S)]||s["defaultValue".concat(k)]||s.defaultValue;let T=f;b&&!f&&w&&(T=j);const A=M(T),C=Object.prototype.toString.apply(T);if(!(b&&T&&A&&["[object Number]","[object Function]","[object RegExp]"].indexOf(C)<0)||r(y)&&Array.isArray(T))if(b&&r(y)&&Array.isArray(f))f=f.join(y),f&&(f=this.extendTranslation(f,e,s,a));else{let t=!1,r=!1;!this.isValidLookup(f)&&w&&(t=!0,f=j),this.isValidLookup(f)||(r=!0,f=l);const i=(s.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&r?void 0:f,c=w&&j!==f&&this.options.updateMissing;if(r||t||c){if(this.logger.log(c?"updateKey":"missingKey",m,d,l,c?j:f),o){const e=this.resolve(l,(0,n.A)((0,n.A)({},s),{},{keySeparator:!1}));e&&e.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let e=[];const t=this.languageUtils.getFallbackCodes(this.options.fallbackLng,s.lng||this.language);if("fallback"===this.options.saveMissingTo&&t&&t[0])for(let n=0;n<t.length;n++)e.push(t[n]);else"all"===this.options.saveMissingTo?e=this.languageUtils.toResolveHierarchy(s.lng||this.language):e.push(s.lng||this.language);const a=(e,t,a)=>{var n;const r=w&&a!==f?a:i;this.options.missingKeyHandler?this.options.missingKeyHandler(e,d,t,r,c,s):null!==(n=this.backendConnector)&&void 0!==n&&n.saveMissing&&this.backendConnector.saveMissing(e,d,t,r,c,s),this.emit("missingKey",e,d,t,f)};this.options.saveMissing&&(this.options.saveMissingPlurals&&x?e.forEach(e=>{const t=this.pluralResolver.getSuffixes(e,s);N&&s["defaultValue".concat(this.options.pluralSeparator,"zero")]&&t.indexOf("".concat(this.options.pluralSeparator,"zero"))<0&&t.push("".concat(this.options.pluralSeparator,"zero")),t.forEach(t=>{a([e],l+t,s["defaultValue".concat(t)]||j)})}):a(e,l,j))}f=this.extendTranslation(f,e,s,p,a),r&&f===l&&this.options.appendNamespaceToMissingKey&&(f="".concat(d).concat(u).concat(l)),(r||t)&&this.options.parseMissingKeyHandler&&(f=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?"".concat(d).concat(u).concat(l):l,t?f:void 0,s))}else{if(!s.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const e=this.options.returnedObjectHandler?this.options.returnedObjectHandler(g,T,(0,n.A)((0,n.A)({},s),{},{ns:c})):"key '".concat(l," (").concat(this.language,")' returned an object instead of string.");return i?(p.res=e,p.usedParams=this.getUsedParamsDetails(s),p):e}if(o){const e=Array.isArray(T),t=e?[]:{},a=e?v:g;for(const r in T)if(Object.prototype.hasOwnProperty.call(T,r)){const e="".concat(a).concat(o).concat(r);t[r]=w&&!f?this.translate(e,(0,n.A)((0,n.A)({},s),{},{defaultValue:M(j)?j[r]:void 0},{joinArrays:!1,ns:c})):this.translate(e,(0,n.A)((0,n.A)({},s),{joinArrays:!1,ns:c})),t[r]===e&&(t[r]=T[r])}f=t}}return i?(p.res=f,p.usedParams=this.getUsedParamsDetails(s),p):f}extendTranslation(e,t,a,s,i){var o,l=this;if(null!==(o=this.i18nFormat)&&void 0!==o&&o.parse)e=this.i18nFormat.parse(e,(0,n.A)((0,n.A)({},this.options.interpolation.defaultVariables),a),a.lng||this.language||s.usedLng,s.usedNS,s.usedKey,{resolved:s});else if(!a.skipInterpolation){var c;a.interpolation&&this.interpolator.init((0,n.A)((0,n.A)({},a),{interpolation:(0,n.A)((0,n.A)({},this.options.interpolation),a.interpolation)}));const o=r(e)&&(void 0!==(null===a||void 0===a||null===(c=a.interpolation)||void 0===c?void 0:c.skipOnVariables)?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let d;if(o){const t=e.match(this.interpolator.nestingRegexp);d=t&&t.length}let u=a.replace&&!r(a.replace)?a.replace:a;if(this.options.interpolation.defaultVariables&&(u=(0,n.A)((0,n.A)({},this.options.interpolation.defaultVariables),u)),e=this.interpolator.interpolate(e,u,a.lng||this.language||s.usedLng,a),o){const t=e.match(this.interpolator.nestingRegexp);d<(t&&t.length)&&(a.nest=!1)}!a.lng&&s&&s.res&&(a.lng=this.language||s.usedLng),!1!==a.nest&&(e=this.interpolator.nest(e,function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(null===i||void 0===i?void 0:i[0])!==n[0]||a.context?l.translate(...n,t):(l.logger.warn("It seems you are nesting recursively key: ".concat(n[0]," in key: ").concat(t[0])),null)},a)),a.interpolation&&this.interpolator.reset()}const d=a.postProcess||this.options.postProcess,u=r(d)?[d]:d;return null!=e&&null!==u&&void 0!==u&&u.length&&!1!==a.applyPostProcessor&&(e=T.handle(u,e,t,this.options&&this.options.postProcessPassResolved?(0,n.A)({i18nResolved:(0,n.A)((0,n.A)({},s),{},{usedParams:this.getUsedParamsDetails(a)})},a):a,this)),e}resolve(e){let t,a,n,s,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(e)&&(e=[e]),e.forEach(e=>{if(this.isValidLookup(t))return;const l=this.extractFromKey(e,o),c=l.key;a=c;let d=l.namespaces;this.options.fallbackNS&&(d=d.concat(this.options.fallbackNS));const u=void 0!==o.count&&!r(o.count),m=u&&!o.ordinal&&0===o.count,h=void 0!==o.context&&(r(o.context)||"number"===typeof o.context)&&""!==o.context,p=o.lngs?o.lngs:this.languageUtils.toResolveHierarchy(o.lng||this.language,o.fallbackLng);d.forEach(e=>{var r,l;this.isValidLookup(t)||(i=e,C["".concat(p[0],"-").concat(e)]||null===(r=this.utils)||void 0===r||!r.hasLoadedNamespace||null!==(l=this.utils)&&void 0!==l&&l.hasLoadedNamespace(i)||(C["".concat(p[0],"-").concat(e)]=!0,this.logger.warn('key "'.concat(a,'" for languages "').concat(p.join(", "),'" won\'t get resolved as namespace "').concat(i,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),p.forEach(a=>{var r;if(this.isValidLookup(t))return;s=a;const i=[c];if(null!==(r=this.i18nFormat)&&void 0!==r&&r.addLookupKeys)this.i18nFormat.addLookupKeys(i,c,a,e,o);else{let e;u&&(e=this.pluralResolver.getSuffix(a,o.count,o));const t="".concat(this.options.pluralSeparator,"zero"),n="".concat(this.options.pluralSeparator,"ordinal").concat(this.options.pluralSeparator);if(u&&(o.ordinal&&0===e.indexOf(n)&&i.push(c+e.replace(n,this.options.pluralSeparator)),i.push(c+e),m&&i.push(c+t)),h){const a="".concat(c).concat(this.options.contextSeparator||"_").concat(o.context);i.push(a),u&&(o.ordinal&&0===e.indexOf(n)&&i.push(a+e.replace(n,this.options.pluralSeparator)),i.push(a+e),m&&i.push(a+t))}}let l;for(;l=i.pop();)this.isValidLookup(t)||(n=l,t=this.getResource(a,e,l,o))}))})}),{res:t,usedKey:a,exactUsedKey:n,usedLng:s,usedNS:i}}isValidLookup(e){return void 0!==e&&!(!this.options.returnNull&&null===e)&&!(!this.options.returnEmptyString&&""===e)}getResource(e,t,a){var n;let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return null!==(n=this.i18nFormat)&&void 0!==n&&n.getResource?this.i18nFormat.getResource(e,t,a,r):this.resourceStore.getResource(e,t,a,r)}getUsedParamsDetails(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],a=e.replace&&!r(e.replace);let s=a?e.replace:e;if(a&&"undefined"!==typeof e.count&&(s.count=e.count),this.options.interpolation.defaultVariables&&(s=(0,n.A)((0,n.A)({},this.options.interpolation.defaultVariables),s)),!a){s=(0,n.A)({},s);for(const e of t)delete s[e]}return s}static hasDefaultValue(e){const t="defaultValue";for(const a in e)if(Object.prototype.hasOwnProperty.call(e,a)&&t===a.substring(0,12)&&void 0!==e[a])return!0;return!1}}class E{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=k.create("languageUtils")}getScriptPartFromCode(e){if(!(e=x(e))||e.indexOf("-")<0)return null;const t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}getLanguagePartFromCode(e){if(!(e=x(e))||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(r(e)&&e.indexOf("-")>-1){let a;try{a=Intl.getCanonicalLocales(e)[0]}catch(t){}return a&&this.options.lowerCaseLng&&(a=a.toLowerCase()),a||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(e=>{if(t)return;const a=this.formatLanguageCode(e);this.options.supportedLngs&&!this.isSupportedCode(a)||(t=a)}),!t&&this.options.supportedLngs&&e.forEach(e=>{if(t)return;const a=this.getScriptPartFromCode(e);if(this.isSupportedCode(a))return t=a;const n=this.getLanguagePartFromCode(e);if(this.isSupportedCode(n))return t=n;t=this.options.supportedLngs.find(e=>e===n?e:e.indexOf("-")<0&&n.indexOf("-")<0?void 0:e.indexOf("-")>0&&n.indexOf("-")<0&&e.substring(0,e.indexOf("-"))===n||0===e.indexOf(n)&&n.length>1?e:void 0)}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if("function"===typeof e&&(e=e(t)),r(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let a=e[t];return a||(a=e[this.getScriptPartFromCode(t)]),a||(a=e[this.formatLanguageCode(t)]),a||(a=e[this.getLanguagePartFromCode(t)]),a||(a=e.default),a||[]}toResolveHierarchy(e,t){const a=this.getFallbackCodes((!1===t?[]:t)||this.options.fallbackLng||[],e),n=[],s=e=>{e&&(this.isSupportedCode(e)?n.push(e):this.logger.warn("rejecting language code not found in supportedLngs: ".concat(e)))};return r(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?("languageOnly"!==this.options.load&&s(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&s(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&s(this.getLanguagePartFromCode(e))):r(e)&&s(this.formatLanguageCode(e)),a.forEach(e=>{n.indexOf(e)<0&&s(this.formatLanguageCode(e))}),n}}const I={zero:0,one:1,two:2,few:3,many:4,other:5},R={select:e=>1===e?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class O{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.languageUtils=e,this.options=t,this.logger=k.create("pluralResolver"),this.pluralRulesCache={}}clearCache(){this.pluralRulesCache={}}getRule(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=x("dev"===e?"en":e),n=t.ordinal?"ordinal":"cardinal",r=JSON.stringify({cleanedCode:a,type:n});if(r in this.pluralRulesCache)return this.pluralRulesCache[r];let s;try{s=new Intl.PluralRules(a,{type:n})}catch(i){if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),R;if(!e.match(/-|_/))return R;const a=this.languageUtils.getLanguagePartFromCode(e);s=this.getRule(a,t)}return this.pluralRulesCache[r]=s,s}needsPlural(e){var t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getRule(e,a);return n||(n=this.getRule("dev",a)),(null===(t=n)||void 0===t?void 0:t.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(e,a).map(e=>"".concat(t).concat(e))}getSuffixes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=this.getRule(e,t);return a||(a=this.getRule("dev",t)),a?a.resolvedOptions().pluralCategories.sort((e,t)=>I[e]-I[t]).map(e=>"".concat(this.options.prepend).concat(t.ordinal?"ordinal".concat(this.options.prepend):"").concat(e)):[]}getSuffix(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=this.getRule(e,a);return n?"".concat(this.options.prepend).concat(a.ordinal?"ordinal".concat(this.options.prepend):"").concat(n.select(t)):(this.logger.warn("no plural rule found for: ".concat(e)),this.getSuffix("dev",t,a))}}const D=function(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=((e,t,a)=>{const n=m(e,a);return void 0!==n?n:m(t,a)})(e,t,a);return!i&&s&&r(a)&&(i=b(e,a,n),void 0===i&&(i=b(t,a,n))),i},F=e=>e.replace(/\$/g,"$$$$");class L{constructor(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=k.create("interpolator"),this.options=t,this.format=(null===t||void 0===t||null===(e=t.interpolation)||void 0===e?void 0:e.format)||(e=>e),this.init(t)}init(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:a,useRawValueToEscape:n,prefix:r,prefixEscaped:s,suffix:i,suffixEscaped:o,formatSeparator:l,unescapeSuffix:c,unescapePrefix:d,nestingPrefix:u,nestingPrefixEscaped:m,nestingSuffix:h,nestingSuffixEscaped:f,nestingOptionsSeparator:v,maxReplaces:y,alwaysFormat:b}=e.interpolation;this.escape=void 0!==t?t:g,this.escapeValue=void 0===a||a,this.useRawValueToEscape=void 0!==n&&n,this.prefix=r?p(r):s||"{{",this.suffix=i?p(i):o||"}}",this.formatSeparator=l||",",this.unescapePrefix=c?"":d||"-",this.unescapeSuffix=this.unescapePrefix?"":c||"",this.nestingPrefix=u?p(u):m||p("$t("),this.nestingSuffix=h?p(h):f||p(")"),this.nestingOptionsSeparator=v||",",this.maxReplaces=y||1e3,this.alwaysFormat=void 0!==b&&b,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(e,t)=>(null===e||void 0===e?void 0:e.source)===t?(e.lastIndex=0,e):new RegExp(t,"g");this.regexp=e(this.regexp,"".concat(this.prefix,"(.+?)").concat(this.suffix)),this.regexpUnescape=e(this.regexpUnescape,"".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix)),this.nestingRegexp=e(this.nestingRegexp,"".concat(this.nestingPrefix,"((?:[^()\"']+|\"[^\"]*\"|'[^']*'|\\((?:[^()]|\"[^\"]*\"|'[^']*')*\\))*?)").concat(this.nestingSuffix))}interpolate(e,t,a,s){var o;let l,c,d;const u=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},m=e=>{if(e.indexOf(this.formatSeparator)<0){const r=D(t,u,e,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(r,void 0,a,(0,n.A)((0,n.A)((0,n.A)({},s),t),{},{interpolationkey:e})):r}const r=e.split(this.formatSeparator),i=r.shift().trim(),o=r.join(this.formatSeparator).trim();return this.format(D(t,u,i,this.options.keySeparator,this.options.ignoreJSONStructure),o,a,(0,n.A)((0,n.A)((0,n.A)({},s),t),{},{interpolationkey:i}))};this.resetRegExp();const h=(null===s||void 0===s?void 0:s.missingInterpolationHandler)||this.options.missingInterpolationHandler,p=void 0!==(null===s||void 0===s||null===(o=s.interpolation)||void 0===o?void 0:o.skipOnVariables)?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:e=>F(e)},{regex:this.regexp,safeValue:e=>this.escapeValue?F(this.escape(e)):F(e)}].forEach(t=>{for(d=0;l=t.regex.exec(e);){const a=l[1].trim();if(c=m(a),void 0===c)if("function"===typeof h){const t=h(e,l,s);c=r(t)?t:""}else if(s&&Object.prototype.hasOwnProperty.call(s,a))c="";else{if(p){c=l[0];continue}this.logger.warn("missed to pass in variable ".concat(a," for interpolating ").concat(e)),c=""}else r(c)||this.useRawValueToEscape||(c=i(c));const n=t.safeValue(c);if(e=e.replace(l[0],n),p?(t.regex.lastIndex+=c.length,t.regex.lastIndex-=l[0].length):t.regex.lastIndex=0,d++,d>=this.maxReplaces)break}}),e}nest(e,t){let a,s,o,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const c=(e,t)=>{var a;const r=this.nestingOptionsSeparator;if(e.indexOf(r)<0)return e;const s=e.split(new RegExp("".concat(r,"[ ]*{")));let i="{".concat(s[1]);e=s[0],i=this.interpolate(i,o);const l=i.match(/'/g),c=i.match(/"/g);((null!==(a=null===l||void 0===l?void 0:l.length)&&void 0!==a?a:0)%2===0&&!c||c.length%2!==0)&&(i=i.replace(/'/g,'"'));try{o=JSON.parse(i),t&&(o=(0,n.A)((0,n.A)({},t),o))}catch(d){return this.logger.warn("failed parsing options string in nesting for key ".concat(e),d),"".concat(e).concat(r).concat(i)}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,e};for(;a=this.nestingRegexp.exec(e);){let d=[];o=(0,n.A)({},l),o=o.replace&&!r(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;const u=/{.*}/.test(a[1])?a[1].lastIndexOf("}")+1:a[1].indexOf(this.formatSeparator);if(-1!==u&&(d=a[1].slice(u).split(this.formatSeparator).map(e=>e.trim()).filter(Boolean),a[1]=a[1].slice(0,u)),s=t(c.call(this,a[1].trim(),o),o),s&&a[0]===e&&!r(s))return s;r(s)||(s=i(s)),s||(this.logger.warn("missed to resolve ".concat(a[1]," for nesting ").concat(e)),s=""),d.length&&(s=d.reduce((e,t)=>this.format(e,t,l.lng,(0,n.A)((0,n.A)({},l),{},{interpolationkey:a[1].trim()})),s.trim())),e=e.replace(a[0],s),this.regexp.lastIndex=0}return e}}const q=e=>{const t={};return(a,r,s)=>{let i=s;s&&s.interpolationkey&&s.formatParams&&s.formatParams[s.interpolationkey]&&s[s.interpolationkey]&&(i=(0,n.A)((0,n.A)({},i),{},{[s.interpolationkey]:void 0}));const o=r+JSON.stringify(i);let l=t[o];return l||(l=e(x(r),s),t[o]=l),l(a)}},U=e=>(t,a,n)=>e(x(a),n)(t);class B{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=k.create("formatter"),this.options=e,this.init(e)}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};this.formatSeparator=t.interpolation.formatSeparator||",";const a=t.cacheInBuiltFormats?q:U;this.formats={number:a((e,t)=>{const a=new Intl.NumberFormat(e,(0,n.A)({},t));return e=>a.format(e)}),currency:a((e,t)=>{const a=new Intl.NumberFormat(e,(0,n.A)((0,n.A)({},t),{},{style:"currency"}));return e=>a.format(e)}),datetime:a((e,t)=>{const a=new Intl.DateTimeFormat(e,(0,n.A)({},t));return e=>a.format(e)}),relativetime:a((e,t)=>{const a=new Intl.RelativeTimeFormat(e,(0,n.A)({},t));return e=>a.format(e,t.range||"day")}),list:a((e,t)=>{const a=new Intl.ListFormat(e,(0,n.A)({},t));return e=>a.format(e)})}}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=q(t)}format(e,t,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const s=t.split(this.formatSeparator);if(s.length>1&&s[0].indexOf("(")>1&&s[0].indexOf(")")<0&&s.find(e=>e.indexOf(")")>-1)){const e=s.findIndex(e=>e.indexOf(")")>-1);s[0]=[s[0],...s.splice(1,e)].join(this.formatSeparator)}return s.reduce((e,t)=>{const{formatName:s,formatOptions:i}=(e=>{let t=e.toLowerCase().trim();const a={};if(e.indexOf("(")>-1){const n=e.split("(");t=n[0].toLowerCase().trim();const r=n[1].substring(0,n[1].length-1);"currency"===t&&r.indexOf(":")<0?a.currency||(a.currency=r.trim()):"relativetime"===t&&r.indexOf(":")<0?a.range||(a.range=r.trim()):r.split(";").forEach(e=>{if(e){const[t,...n]=e.split(":"),r=n.join(":").trim().replace(/^'+|'+$/g,""),s=t.trim();a[s]||(a[s]=r),"false"===r&&(a[s]=!1),"true"===r&&(a[s]=!0),isNaN(r)||(a[s]=parseInt(r,10))}})}return{formatName:t,formatOptions:a}})(t);if(this.formats[s]){let t=e;try{var o;const l=(null===r||void 0===r||null===(o=r.formatParams)||void 0===o?void 0:o[r.interpolationkey])||{},c=l.locale||l.lng||r.locale||r.lng||a;t=this.formats[s](e,c,(0,n.A)((0,n.A)((0,n.A)({},i),r),l))}catch(l){this.logger.warn(l)}return t}return this.logger.warn("there was no format function for ".concat(s)),e},e)}}class G extends N{constructor(e,t,a){var n,r;let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(),this.backend=e,this.store=t,this.services=a,this.languageUtils=a.languageUtils,this.options=s,this.logger=k.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=s.maxParallelReads||10,this.readingCalls=0,this.maxRetries=s.maxRetries>=0?s.maxRetries:5,this.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,this.state={},this.queue=[],null===(n=this.backend)||void 0===n||null===(r=n.init)||void 0===r||r.call(n,a,s.backend,s)}queueLoad(e,t,a,n){const r={},s={},i={},o={};return e.forEach(e=>{let n=!0;t.forEach(t=>{const i="".concat(e,"|").concat(t);!a.reload&&this.store.hasResourceBundle(e,t)?this.state[i]=2:this.state[i]<0||(1===this.state[i]?void 0===s[i]&&(s[i]=!0):(this.state[i]=1,n=!1,void 0===s[i]&&(s[i]=!0),void 0===r[i]&&(r[i]=!0),void 0===o[t]&&(o[t]=!0)))}),n||(i[e]=!0)}),(Object.keys(r).length||Object.keys(s).length)&&this.queue.push({pending:s,pendingCount:Object.keys(s).length,loaded:{},errors:[],callback:n}),{toLoad:Object.keys(r),pending:Object.keys(s),toLoadLanguages:Object.keys(i),toLoadNamespaces:Object.keys(o)}}loaded(e,t,a){const n=e.split("|"),r=n[0],s=n[1];t&&this.emit("failedLoading",r,s,t),!t&&a&&this.store.addResourceBundle(r,s,a,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&a&&(this.state[e]=0);const i={};this.queue.forEach(a=>{((e,t,a)=>{const{obj:n,k:r}=d(e,t,Object);n[r]=n[r]||[],n[r].push(a)})(a.loaded,[r],s),((e,t)=>{void 0!==e.pending[t]&&(delete e.pending[t],e.pendingCount--)})(a,e),t&&a.errors.push(t),0!==a.pendingCount||a.done||(Object.keys(a.loaded).forEach(e=>{i[e]||(i[e]={});const t=a.loaded[e];t.length&&t.forEach(t=>{void 0===i[e][t]&&(i[e][t]=!0)})}),a.done=!0,a.errors.length?a.callback(a.errors):a.callback())}),this.emit("loaded",i),this.queue=this.queue.filter(e=>!e.done)}read(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,s=arguments.length>5?arguments[5]:void 0;if(!e.length)return s(null,{});if(this.readingCalls>=this.maxParallelReads)return void this.waitingReads.push({lng:e,ns:t,fcName:a,tried:n,wait:r,callback:s});this.readingCalls++;const i=(i,o)=>{if(this.readingCalls--,this.waitingReads.length>0){const e=this.waitingReads.shift();this.read(e.lng,e.ns,e.fcName,e.tried,e.wait,e.callback)}i&&o&&n<this.maxRetries?setTimeout(()=>{this.read.call(this,e,t,a,n+1,2*r,s)},r):s(i,o)},o=this.backend[a].bind(this.backend);if(2!==o.length)return o(e,t,i);try{const a=o(e,t);a&&"function"===typeof a.then?a.then(e=>i(null,e)).catch(i):i(null,a)}catch(l){i(l)}}prepareLoading(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),n&&n();r(e)&&(e=this.languageUtils.toResolveHierarchy(e)),r(t)&&(t=[t]);const s=this.queueLoad(e,t,a,n);if(!s.toLoad.length)return s.pending.length||n(),null;s.toLoad.forEach(e=>{this.loadOne(e)})}load(e,t,a){this.prepareLoading(e,t,{},a)}reload(e,t,a){this.prepareLoading(e,t,{reload:!0},a)}loadOne(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const a=e.split("|"),n=a[0],r=a[1];this.read(n,r,"read",void 0,void 0,(a,s)=>{a&&this.logger.warn("".concat(t,"loading namespace ").concat(r," for language ").concat(n," failed"),a),!a&&s&&this.logger.log("".concat(t,"loaded namespace ").concat(r," for language ").concat(n),s),this.loaded(e,a,s)})}saveMissing(e,t,a,r,s){var i,o,l;let c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:()=>{};if(null===(i=this.services)||void 0===i||null===(i=i.utils)||void 0===i||!i.hasLoadedNamespace||null!==(o=this.services)&&void 0!==o&&null!==(o=o.utils)&&void 0!==o&&o.hasLoadedNamespace(t)){if(void 0!==a&&null!==a&&""!==a){if(null!==(l=this.backend)&&void 0!==l&&l.create){const i=(0,n.A)((0,n.A)({},c),{},{isUpdate:s}),o=this.backend.create.bind(this.backend);if(o.length<6)try{let n;n=5===o.length?o(e,t,a,r,i):o(e,t,a,r),n&&"function"===typeof n.then?n.then(e=>d(null,e)).catch(d):d(null,n)}catch(u){d(u)}else o(e,t,a,r,d,i)}e&&e[0]&&this.store.addResource(e[0],t,a,r)}}else this.logger.warn('did not save key "'.concat(a,'" as the namespace "').concat(t,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")}}const z=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if("object"===typeof e[1]&&(t=e[1]),r(e[1])&&(t.defaultValue=e[1]),r(e[2])&&(t.tDescription=e[2]),"object"===typeof e[2]||"object"===typeof e[3]){const a=e[3]||e[2];Object.keys(a).forEach(e=>{t[e]=a[e]})}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),V=e=>{var t,a;return r(e.ns)&&(e.ns=[e.ns]),r(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),r(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),(null===(t=e.supportedLngs)||void 0===t||null===(a=t.indexOf)||void 0===a?void 0:a.call(t,"cimode"))<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),"boolean"===typeof e.initImmediate&&(e.initAsync=e.initImmediate),e},H=()=>{};class K extends N{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;var a;if(super(),this.options=V(e),this.services={},this.logger=k,this.modules={external:[]},a=this,Object.getOwnPropertyNames(Object.getPrototypeOf(a)).forEach(e=>{"function"===typeof a[e]&&(a[e]=a[e].bind(a))}),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,"function"===typeof t&&(a=t,t={}),null==t.defaultNS&&t.ns&&(r(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const i=z();this.options=(0,n.A)((0,n.A)((0,n.A)({},i),this.options),V(t)),this.options.interpolation=(0,n.A)((0,n.A)({},i.interpolation),this.options.interpolation),void 0!==t.keySeparator&&(this.options.userDefinedKeySeparator=t.keySeparator),void 0!==t.nsSeparator&&(this.options.userDefinedNsSeparator=t.nsSeparator),"function"!==typeof this.options.overloadTranslationOptionHandler&&(this.options.overloadTranslationOptionHandler=i.overloadTranslationOptionHandler),!1===this.options.showSupportNotice||(e=>{var t,a,n;return(null===e||void 0===e||null===(t=e.modules)||void 0===t||null===(t=t.backend)||void 0===t||null===(t=t.name)||void 0===t?void 0:t.indexOf("Locize"))>0||(null===e||void 0===e||null===(a=e.modules)||void 0===a||null===(a=a.backend)||void 0===a||null===(a=a.constructor)||void 0===a||null===(a=a.name)||void 0===a?void 0:a.indexOf("Locize"))>0||!(null===e||void 0===e||null===(n=e.options)||void 0===n||null===(n=n.backend)||void 0===n||!n.backends||!e.options.backend.backends.some(e=>{var t,a;return(null===e||void 0===e||null===(t=e.name)||void 0===t?void 0:t.indexOf("Locize"))>0||(null===e||void 0===e||null===(a=e.constructor)||void 0===a||null===(a=a.name)||void 0===a?void 0:a.indexOf("Locize"))>0}))})(this)||"undefined"!==typeof console&&"undefined"!==typeof console.info&&console.info("\ud83c\udf10 i18next is maintained with support from locize.com \u2014 consider powering your project with managed localization (AI, CDN, integrations): https://locize.com \ud83d\udc99");const o=e=>e?"function"===typeof e?new e:e:null;if(!this.options.isClone){let t;this.modules.logger?k.init(o(this.modules.logger),this.options):k.init(null,this.options),t=this.modules.formatter?this.modules.formatter:B;const a=new E(this.options);this.store=new j(this.options.resources,this.options);const n=this.services;n.logger=k,n.resourceStore=this.store,n.languageUtils=a,n.pluralResolver=new O(a,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix});this.options.interpolation.format&&this.options.interpolation.format!==i.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),!t||this.options.interpolation.format&&this.options.interpolation.format!==i.interpolation.format||(n.formatter=o(t),n.formatter.init&&n.formatter.init(n,this.options),this.options.interpolation.format=n.formatter.format.bind(n.formatter)),n.interpolator=new L(this.options),n.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},n.backendConnector=new G(o(this.modules.backend),n.resourceStore,n,this.options),n.backendConnector.on("*",function(t){for(var a=arguments.length,n=new Array(a>1?a-1:0),r=1;r<a;r++)n[r-1]=arguments[r];e.emit(t,...n)}),this.modules.languageDetector&&(n.languageDetector=o(this.modules.languageDetector),n.languageDetector.init&&n.languageDetector.init(n,this.options.detection,this.options)),this.modules.i18nFormat&&(n.i18nFormat=o(this.modules.i18nFormat),n.i18nFormat.init&&n.i18nFormat.init(this)),this.translator=new P(this.services,this.options),this.translator.on("*",function(t){for(var a=arguments.length,n=new Array(a>1?a-1:0),r=1;r<a;r++)n[r-1]=arguments[r];e.emit(t,...n)}),this.modules.external.forEach(e=>{e.init&&e.init(this)})}if(this.format=this.options.interpolation.format,a||(a=H),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const e=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);e.length>0&&"dev"!==e[0]&&(this.options.lng=e[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(t=>{this[t]=function(){return e.store[t](...arguments)}});["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(t=>{this[t]=function(){return e.store[t](...arguments),e}});const l=s(),c=()=>{const e=(e,t)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(t),a(e,t)};if(this.languages&&!this.isInitialized)return e(null,this.t.bind(this));this.changeLanguage(this.options.lng,e)};return this.options.resources||!this.options.initAsync?c():setTimeout(c,0),l}loadResources(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:H;const a=r(e)?e:this.language;if("function"===typeof e&&(t=e),!this.options.resources||this.options.partialBundledLanguages){var n,s;if("cimode"===(null===a||void 0===a?void 0:a.toLowerCase())&&(!this.options.preload||0===this.options.preload.length))return t();const e=[],r=t=>{if(!t)return;if("cimode"===t)return;this.services.languageUtils.toResolveHierarchy(t).forEach(t=>{"cimode"!==t&&e.indexOf(t)<0&&e.push(t)})};if(a)r(a);else{this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(e=>r(e))}null===(n=this.options.preload)||void 0===n||null===(s=n.forEach)||void 0===s||s.call(n,e=>r(e)),this.services.backendConnector.load(e,this.options.ns,e=>{e||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),t(e)})}else t(null)}reloadResources(e,t,a){const n=s();return"function"===typeof e&&(a=e,e=void 0),"function"===typeof t&&(a=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),a||(a=H),this.services.backendConnector.reload(e,t,e=>{n.resolve(),a(e)}),n}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&T.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}setResolvedLanguage(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1)){for(let e=0;e<this.languages.length;e++){const t=this.languages[e];if(!(["cimode","dev"].indexOf(t)>-1)&&this.store.hasLanguageSomeTranslations(t)){this.resolvedLanguage=t;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,t){var a=this;this.isLanguageChangingTo=e;const n=s();this.emit("languageChanging",e);const i=e=>{this.language=e,this.languages=this.services.languageUtils.toResolveHierarchy(e),this.resolvedLanguage=void 0,this.setResolvedLanguage(e)},o=(r,s)=>{s?this.isLanguageChangingTo===e&&(i(s),this.translator.changeLanguage(s),this.isLanguageChangingTo=void 0,this.emit("languageChanged",s),this.logger.log("languageChanged",s)):this.isLanguageChangingTo=void 0,n.resolve(function(){return a.t(...arguments)}),t&&t(r,function(){return a.t(...arguments)})},l=t=>{e||t||!this.services.languageDetector||(t=[]);const a=r(t)?t:t&&t[0],n=this.store.hasLanguageSomeTranslations(a)?a:this.services.languageUtils.getBestMatchFromCodes(r(t)?[t]:t);var s,l;n&&(this.language||i(n),this.translator.language||this.translator.changeLanguage(n),null===(s=this.services.languageDetector)||void 0===s||null===(l=s.cacheUserLanguage)||void 0===l||l.call(s,n));this.loadResources(n,e=>{o(e,n)})};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(l):this.services.languageDetector.detect(l):l(e):l(this.services.languageDetector.detect()),n}getFixedT(e,t,a){var s=this;const i=function(e,t){let r;if("object"!==typeof t){for(var o=arguments.length,l=new Array(o>2?o-2:0),c=2;c<o;c++)l[c-2]=arguments[c];r=s.options.overloadTranslationOptionHandler([e,t].concat(l))}else r=(0,n.A)({},t);r.lng=r.lng||i.lng,r.lngs=r.lngs||i.lngs,r.ns=r.ns||i.ns,""!==r.keyPrefix&&(r.keyPrefix=r.keyPrefix||a||i.keyPrefix);const d=s.options.keySeparator||".";let u;return r.keyPrefix&&Array.isArray(e)?u=e.map(e=>("function"===typeof e&&(e=_(e,(0,n.A)((0,n.A)({},s.options),t))),"".concat(r.keyPrefix).concat(d).concat(e))):("function"===typeof e&&(e=_(e,(0,n.A)((0,n.A)({},s.options),t))),u=r.keyPrefix?"".concat(r.keyPrefix).concat(d).concat(e):e),s.t(u,r)};return r(e)?i.lng=e:i.lngs=e,i.ns=t,i.keyPrefix=a,i}t(){for(var e,t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return null===(e=this.translator)||void 0===e?void 0:e.translate(...a)}exists(){for(var e,t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return null===(e=this.translator)||void 0===e?void 0:e.exists(...a)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const a=t.lng||this.resolvedLanguage||this.languages[0],n=!!this.options&&this.options.fallbackLng,r=this.languages[this.languages.length-1];if("cimode"===a.toLowerCase())return!0;const s=(e,t)=>{const a=this.services.backendConnector.state["".concat(e,"|").concat(t)];return-1===a||0===a||2===a};if(t.precheck){const e=t.precheck(this,s);if(void 0!==e)return e}return!!this.hasResourceBundle(a,e)||(!(this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages))||!(!s(a,e)||n&&!s(r,e)))}loadNamespaces(e,t){const a=s();return this.options.ns?(r(e)&&(e=[e]),e.forEach(e=>{this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}),this.loadResources(e=>{a.resolve(),t&&t(e)}),a):(t&&t(),Promise.resolve())}loadLanguages(e,t){const a=s();r(e)&&(e=[e]);const n=this.options.preload||[],i=e.filter(e=>n.indexOf(e)<0&&this.services.languageUtils.isSupportedCode(e));return i.length?(this.options.preload=n.concat(i),this.loadResources(e=>{a.resolve(),t&&t(e)}),a):(t&&t(),Promise.resolve())}dir(e){var t,a;if(e||(e=this.resolvedLanguage||((null===(t=this.languages)||void 0===t?void 0:t.length)>0?this.languages[0]:this.language)),!e)return"rtl";try{const t=new Intl.Locale(e);if(t&&t.getTextInfo){const e=t.getTextInfo();if(e&&e.direction)return e.direction}}catch(r){}const n=(null===(a=this.services)||void 0===a?void 0:a.languageUtils)||new E(z());return e.toLowerCase().indexOf("-latn")>1?"ltr":["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(n.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){const e=new K(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1?arguments[1]:void 0);return e.createInstance=K.createInstance,e}cloneInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:H;const a=e.forkResourceStore;a&&delete e.forkResourceStore;const r=(0,n.A)((0,n.A)((0,n.A)({},this.options),e),{isClone:!0}),s=new K(r);void 0===e.debug&&void 0===e.prefix||(s.logger=s.logger.clone(e));if(["store","services","language"].forEach(e=>{s[e]=this[e]}),s.services=(0,n.A)({},this.services),s.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},a){const e=Object.keys(this.store.data).reduce((e,t)=>(e[t]=(0,n.A)({},this.store.data[t]),e[t]=Object.keys(e[t]).reduce((a,r)=>(a[r]=(0,n.A)({},e[t][r]),a),e[t]),e),{});s.store=new j(e,r),s.services.resourceStore=s.store}if(e.interpolation){const t=z(),a=(0,n.A)((0,n.A)((0,n.A)({},t.interpolation),this.options.interpolation),e.interpolation),i=(0,n.A)((0,n.A)({},r),{},{interpolation:a});s.services.interpolator=new L(i)}return s.translator=new P(s.services,r),s.translator.on("*",function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];s.emit(e,...a)}),s.init(r,t),s.translator.options=r,s.translator.backendConnector.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},s}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const W=K.createInstance();W.createInstance,W.dir,W.init,W.loadResources,W.reloadResources,W.use,W.changeLanguage,W.getFixedT,W.t,W.exists,W.setDefaultNamespace,W.hasLoadedNamespace,W.loadNamespaces,W.loadLanguages;a(844);Object.create(null);const Y=(e,t,a,r)=>{var s,i,o;const l=[a,(0,n.A)({code:t},r||{})];if(null!==e&&void 0!==e&&null!==(s=e.services)&&void 0!==s&&null!==(s=s.logger)&&void 0!==s&&s.forward)return e.services.logger.forward(l,"warn","react-i18next::",!0);ee(l[0])&&(l[0]="react-i18next:: ".concat(l[0])),null!==e&&void 0!==e&&null!==(i=e.services)&&void 0!==i&&null!==(i=i.logger)&&void 0!==i&&i.warn?e.services.logger.warn(...l):null!==(o=console)&&void 0!==o&&o.warn&&console.warn(...l)},J={},Q=(e,t,a,n)=>{ee(a)&&J[a]||(ee(a)&&(J[a]=new Date),Y(e,t,a,n))},$=(e,t)=>()=>{if(e.isInitialized)t();else{const a=()=>{setTimeout(()=>{e.off("initialized",a)},0),t()};e.on("initialized",a)}},X=(e,t,a)=>{e.loadNamespaces(t,$(e,a))},Z=(e,t,a,n)=>{if(ee(a)&&(a=[a]),e.options.preload&&e.options.preload.indexOf(t)>-1)return X(e,a,n);a.forEach(t=>{e.options.ns.indexOf(t)<0&&e.options.ns.push(t)}),e.loadLanguages(t,$(e,n))},ee=e=>"string"===typeof e,te=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,ae={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"\xa9","&#169;":"\xa9","&reg;":"\xae","&#174;":"\xae","&hellip;":"\u2026","&#8230;":"\u2026","&#x2F;":"/","&#47;":"/"},ne=e=>ae[e];let re={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:e=>e.replace(te,ne),transDefaultProps:void 0};let se;const ie=()=>se,oe={type:"3rdParty",init(e){!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};re=(0,n.A)((0,n.A)({},re),e)}(e.options.react),(e=>{se=e})(e)}};const le=(0,e.createContext)();class ce{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(e=>{this.usedNamespaces[e]||(this.usedNamespaces[e]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}class de extends Error{constructor(e,t,a){super(e),this.name="TranslationParserError",this.position=t,this.translationString=a,Error.captureStackTrace&&Error.captureStackTrace(this,de)}}const ue={"&nbsp;":"\xa0","&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&copy;":"\xa9","&reg;":"\xae","&trade;":"\u2122","&hellip;":"\u2026","&ndash;":"\u2013","&mdash;":"\u2014","&lsquo;":"\u2018","&rsquo;":"\u2019","&sbquo;":"\u201a","&ldquo;":"\u201c","&rdquo;":"\u201d","&bdquo;":"\u201e","&dagger;":"\u2020","&Dagger;":"\u2021","&bull;":"\u2022","&prime;":"\u2032","&Prime;":"\u2033","&lsaquo;":"\u2039","&rsaquo;":"\u203a","&sect;":"\xa7","&para;":"\xb6","&middot;":"\xb7","&ensp;":"\u2002","&emsp;":"\u2003","&thinsp;":"\u2009","&euro;":"\u20ac","&pound;":"\xa3","&yen;":"\xa5","&cent;":"\xa2","&curren;":"\xa4","&times;":"\xd7","&divide;":"\xf7","&minus;":"\u2212","&plusmn;":"\xb1","&ne;":"\u2260","&le;":"\u2264","&ge;":"\u2265","&asymp;":"\u2248","&equiv;":"\u2261","&infin;":"\u221e","&int;":"\u222b","&sum;":"\u2211","&prod;":"\u220f","&radic;":"\u221a","&part;":"\u2202","&permil;":"\u2030","&deg;":"\xb0","&micro;":"\xb5","&larr;":"\u2190","&uarr;":"\u2191","&rarr;":"\u2192","&darr;":"\u2193","&harr;":"\u2194","&crarr;":"\u21b5","&lArr;":"\u21d0","&uArr;":"\u21d1","&rArr;":"\u21d2","&dArr;":"\u21d3","&hArr;":"\u21d4","&alpha;":"\u03b1","&beta;":"\u03b2","&gamma;":"\u03b3","&delta;":"\u03b4","&epsilon;":"\u03b5","&zeta;":"\u03b6","&eta;":"\u03b7","&theta;":"\u03b8","&iota;":"\u03b9","&kappa;":"\u03ba","&lambda;":"\u03bb","&mu;":"\u03bc","&nu;":"\u03bd","&xi;":"\u03be","&omicron;":"\u03bf","&pi;":"\u03c0","&rho;":"\u03c1","&sigma;":"\u03c3","&tau;":"\u03c4","&upsilon;":"\u03c5","&phi;":"\u03c6","&chi;":"\u03c7","&psi;":"\u03c8","&omega;":"\u03c9","&Alpha;":"\u0391","&Beta;":"\u0392","&Gamma;":"\u0393","&Delta;":"\u0394","&Epsilon;":"\u0395","&Zeta;":"\u0396","&Eta;":"\u0397","&Theta;":"\u0398","&Iota;":"\u0399","&Kappa;":"\u039a","&Lambda;":"\u039b","&Mu;":"\u039c","&Nu;":"\u039d","&Xi;":"\u039e","&Omicron;":"\u039f","&Pi;":"\u03a0","&Rho;":"\u03a1","&Sigma;":"\u03a3","&Tau;":"\u03a4","&Upsilon;":"\u03a5","&Phi;":"\u03a6","&Chi;":"\u03a7","&Psi;":"\u03a8","&Omega;":"\u03a9","&Agrave;":"\xc0","&Aacute;":"\xc1","&Acirc;":"\xc2","&Atilde;":"\xc3","&Auml;":"\xc4","&Aring;":"\xc5","&AElig;":"\xc6","&Ccedil;":"\xc7","&Egrave;":"\xc8","&Eacute;":"\xc9","&Ecirc;":"\xca","&Euml;":"\xcb","&Igrave;":"\xcc","&Iacute;":"\xcd","&Icirc;":"\xce","&Iuml;":"\xcf","&ETH;":"\xd0","&Ntilde;":"\xd1","&Ograve;":"\xd2","&Oacute;":"\xd3","&Ocirc;":"\xd4","&Otilde;":"\xd5","&Ouml;":"\xd6","&Oslash;":"\xd8","&Ugrave;":"\xd9","&Uacute;":"\xda","&Ucirc;":"\xdb","&Uuml;":"\xdc","&Yacute;":"\xdd","&THORN;":"\xde","&szlig;":"\xdf","&agrave;":"\xe0","&aacute;":"\xe1","&acirc;":"\xe2","&atilde;":"\xe3","&auml;":"\xe4","&aring;":"\xe5","&aelig;":"\xe6","&ccedil;":"\xe7","&egrave;":"\xe8","&eacute;":"\xe9","&ecirc;":"\xea","&euml;":"\xeb","&igrave;":"\xec","&iacute;":"\xed","&icirc;":"\xee","&iuml;":"\xef","&eth;":"\xf0","&ntilde;":"\xf1","&ograve;":"\xf2","&oacute;":"\xf3","&ocirc;":"\xf4","&otilde;":"\xf5","&ouml;":"\xf6","&oslash;":"\xf8","&ugrave;":"\xf9","&uacute;":"\xfa","&ucirc;":"\xfb","&uuml;":"\xfc","&yacute;":"\xfd","&thorn;":"\xfe","&yuml;":"\xff","&iexcl;":"\xa1","&iquest;":"\xbf","&fnof;":"\u0192","&circ;":"\u02c6","&tilde;":"\u02dc","&OElig;":"\u0152","&oelig;":"\u0153","&Scaron;":"\u0160","&scaron;":"\u0161","&Yuml;":"\u0178","&ordf;":"\xaa","&ordm;":"\xba","&macr;":"\xaf","&acute;":"\xb4","&cedil;":"\xb8","&sup1;":"\xb9","&sup2;":"\xb2","&sup3;":"\xb3","&frac14;":"\xbc","&frac12;":"\xbd","&frac34;":"\xbe","&spades;":"\u2660","&clubs;":"\u2663","&hearts;":"\u2665","&diams;":"\u2666","&loz;":"\u25ca","&oline;":"\u203e","&frasl;":"\u2044","&weierp;":"\u2118","&image;":"\u2111","&real;":"\u211c","&alefsym;":"\u2135"},me=new RegExp(Object.keys(ue).map(e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("|"),"g");function he(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;a[n]=e[n]}return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],-1===t.indexOf(a)&&{}.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}const pe=["children"],fe=function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t)return[];const n=(e=>{const t=[];let a=0,n="";const r=()=>{n&&(t.push({type:"Text",value:n,position:a-n.length}),n="")};for(;a<e.length;){const s=e[a];if("<"===s){const i=e.slice(a).match(/^<(\d+)>/);if(i)r(),t.push({type:"TagOpen",value:i[0],position:a,tagNumber:parseInt(i[1],10)}),a+=i[0].length;else{const i=e.slice(a).match(/^<\/(\d+)>/);i?(r(),t.push({type:"TagClose",value:i[0],position:a,tagNumber:parseInt(i[1],10)}),a+=i[0].length):(n+=s,a+=1)}}else n+=s,a+=1}return r(),t})(t),r=[],s=[],i=new Set;if(n.forEach(n=>{switch(n.type){case"Text":{const e=n.value.replace(me,e=>ue[e]).replace(/&#(\d+);/g,(e,t)=>String.fromCharCode(parseInt(t,10))).replace(/&#x([0-9a-fA-F]+);/g,(e,t)=>String.fromCharCode(parseInt(t,16)));(s.length>0?s[s.length-1].children:r).push(e)}break;case"TagOpen":{const{tagNumber:e}=n,t=(()=>{var e;if(0===s.length)return a;const t=s[s.length-1];return null!==(e=t.declaration.props)&&void 0!==e&&e.children&&Array.isArray(t.declaration.props.children)?t.declaration.props.children:t.declarations})(),o=t[e];if(!o){i.add(e);const t="<".concat(e,">");(s.length>0?s[s.length-1].children:r).push(t);break}s.push({tagNumber:e,children:[],position:n.position,declaration:o,declarations:t})}break;case"TagClose":{const{tagNumber:a}=n;if(i.has(a)){const e="</".concat(a,">");(s.length>0?s[s.length-1].children:r).push(e),i.delete(a);break}if(0===s.length)throw new de("Unexpected closing tag </".concat(a,"> at position ").concat(n.position),n.position,t);const o=s.pop();if(o.tagNumber!==a)throw new de("Mismatched tags: expected </".concat(o.tagNumber,"> but got </").concat(a,"> at position ").concat(n.position),n.position,t);const l=((t,a,n)=>{const{type:r,props:s={}}=t;if(s.children&&Array.isArray(s.children)&&n){const{children:t}=s,n=he(s,pe);return e.createElement(r,n,...a)}return 0===a.length?e.createElement(r,s):1===a.length?e.createElement(r,s,a[0]):e.createElement(r,s,...a)})(o.declaration,o.children,o.declarations);(s.length>0?s[s.length-1].children:r).push(l)}}}),s.length>0){const e=s[s.length-1];throw new de("Unclosed tag <".concat(e.tagNumber,"> at position ").concat(e.position),e.position,t)}return r};function ge(t){var a,r,s;let{i18nKey:i,defaultTranslation:o,content:l,ns:c,values:d={},i18n:u,t:m}=t;const h=u||ie();if(!h)return Q(h,"NO_I18NEXT_INSTANCE","IcuTrans: You need to pass in an i18next instance using i18nextReactModule",{i18nKey:i}),e.createElement(e.Fragment,{},o);const p=m||(null===(a=h.t)||void 0===a?void 0:a.bind(h))||(e=>e);let f=c||p.ns||(null===(r=h.options)||void 0===r?void 0:r.defaultNS);f=ee(f)?[f]:f||["translation"];let g=d;null!==(s=h.options)&&void 0!==s&&null!==(s=s.interpolation)&&void 0!==s&&s.defaultVariables&&(g=d&&Object.keys(d).length>0?(0,n.A)((0,n.A)({},d),h.options.interpolation.defaultVariables):(0,n.A)({},h.options.interpolation.defaultVariables));const v=p(i,(0,n.A)((0,n.A)({defaultValue:o},g),{},{ns:f}));try{const t=fe(v,l);return e.createElement(e.Fragment,{},...t)}catch(y){return Y(h,"ICU_TRANS_RENDER_ERROR",'IcuTrans component error for key "'.concat(i,'": ').concat(y.message),{i18nKey:i,error:y}),e.createElement(e.Fragment,{},v)}}ge.displayName="IcuTransWithoutContext";var ve=a(461);const ye={t:(e,t)=>{return ee(t)?t:"object"===typeof(a=t)&&null!==a&&ee(t.defaultValue)?t.defaultValue:Array.isArray(e)?e[e.length-1]:e;var a},ready:!1},be=()=>()=>{},xe=function(t){var a,r,s;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{i18n:o}=i,{i18n:l,defaultNS:c}=(0,e.useContext)(le)||{},d=o||l||ie();d&&!d.reportNamespaces&&(d.reportNamespaces=new ce),d||Q(d,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const u=(0,e.useMemo)(()=>{var e;return(0,n.A)((0,n.A)((0,n.A)({},re),null===d||void 0===d||null===(e=d.options)||void 0===e?void 0:e.react),i)},[d,i]),{useSuspense:m,keyPrefix:h}=u,p=t||c||(null===d||void 0===d||null===(a=d.options)||void 0===a?void 0:a.defaultNS),f=ee(p)?[p]:p||["translation"],g=(0,e.useMemo)(()=>f,f);null===d||void 0===d||null===(r=d.reportNamespaces)||void 0===r||null===(s=r.addUsedNamespaces)||void 0===s||s.call(r,g);const v=(0,e.useRef)(0),y=(0,e.useCallback)(e=>{if(!d)return be;const{bindI18n:t,bindI18nStore:a}=u,n=()=>{v.current+=1,e()};return t&&d.on(t,n),a&&d.store.on(a,n),()=>{t&&t.split(" ").forEach(e=>d.off(e,n)),a&&a.split(" ").forEach(e=>d.store.off(e,n))}},[d,u]),b=(0,e.useRef)(),x=(0,e.useCallback)(()=>{if(!d)return ye;const e=!(!d.isInitialized&&!d.initializedStoreOnce)&&g.every(e=>function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.languages&&t.languages.length?t.hasLoadedNamespace(e,{lng:a.lng,precheck:(t,n)=>{if(a.bindI18n&&a.bindI18n.indexOf("languageChanging")>-1&&t.services.backendConnector.backend&&t.isLanguageChangingTo&&!n(t.isLanguageChangingTo,e))return!1}}):(Q(t,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:t.languages}),!0)}(e,d,u)),t=i.lng||d.language,a=v.current,n=b.current;if(n&&n.ready===e&&n.lng===t&&n.keyPrefix===h&&n.revision===a)return n;const r={t:d.getFixedT(t,"fallback"===u.nsMode?g:g[0],h),ready:e,lng:t,keyPrefix:h,revision:a};return b.current=r,r},[d,g,h,u,i.lng]),[w,S]=(0,e.useState)(0),{t:k,ready:N}=(0,ve.useSyncExternalStore)(y,x,x);(0,e.useEffect)(()=>{if(d&&!N&&!m){const e=()=>S(e=>e+1);i.lng?Z(d,i.lng,g,e):X(d,g,e)}},[d,i.lng,g,N,m,w]);const j=d||{},T=(0,e.useRef)(null),A=(0,e.useRef)(),_=e=>{const t=Object.getOwnPropertyDescriptors(e);t.__original&&delete t.__original;const a=Object.create(Object.getPrototypeOf(e),t);if(!Object.prototype.hasOwnProperty.call(a,"__original"))try{Object.defineProperty(a,"__original",{value:e,writable:!1,enumerable:!1,configurable:!1})}catch(n){}return a},C=(0,e.useMemo)(()=>{const e=j,t=null===e||void 0===e?void 0:e.language;let a=e;e&&(T.current&&T.current.__original===e?A.current!==t?(a=_(e),T.current=a,A.current=t):a=T.current:(a=_(e),T.current=a,A.current=t));const n=[k,a,N];return n.t=k,n.i18n=a,n.ready=N,n},[k,j,N,j.resolvedLanguage,j.language,j.languages]);if(d&&m&&!N)throw new Promise(e=>{const t=()=>e();i.lng?Z(d,i.lng,g,t):X(d,g,t)});return C};const we=JSON.parse('{"buttons":{"save":"Save","cancel":"Cancel","delete":"Delete","edit":"Edit","add":"Add","close":"Close","confirm":"Confirm"},"alerts":{"noAlerts":"No alerts"},"errors":{"invalidMatchId":"Invalid match ID","unknownView":"Unknown view","unknownPlayer":"Unknown Player","supabaseConfigMissing":"Supabase configuration missing. Please check environment variables.","failedToLoadPlayerStats":"Failed to load player stats","failedToLoadMatchDefaults":"Failed to load match defaults.","failedToLoadOpponentNames":"Unable to load previous opponent names.","matchCreationFailed":"Failed to create match: Missing match identifier from database response.","playerStatsUpdateFailed":"Failed to update player match stats","matchUpdateFailed":"Match update failed: Match not in running state or not found","matchNotFinished":"Match must be finished before updates can be applied.","fairPlayAwardFailed":"Unable to assign fair play award for this match.","fairPlayNoStats":"No player statistics were updated with the fair play award. Ensure the player participated in this match.","matchNotFound":"Match not found","configRequired":"Initial configuration is required","matchNotFoundOrDeleted":"Match not found or already deleted","invalidPlayerStats":"Player stats must be an array","noValidPlayerStats":"No valid player stats to update","loanPlayerRequired":"At least one player is required","loanTeamNameRequired":"Receiving team name is required","loanTeamNameTooLong":"Receiving team name must be 200 characters or less","loanDateRequired":"Loan date is required","loanRecordFailed":"Failed to record player loans","noTeamSelected":"No current team selected. Please create or select a team first.","matchSavedSuccess":"Match saved to your history successfully!","failedToLoadAttendanceStats":"Failed to load attendance stats","failedToLoadConnectors":"Failed to load connectors","failedToConnectProvider":"Failed to connect provider","failedToDisconnectProvider":"Failed to disconnect provider","failedToTriggerSync":"Failed to trigger sync","failedToRetryConnector":"Failed to retry connector","validationFailed":"Validation failed","unexpectedError":"An unexpected error occurred. Please try again."},"footer":{"copyright":"\xa9 {{year}} Coach App by Codewizard"}}'),Se=JSON.parse('{"header":{"title":"Game & Squad Configuration"},"squad":{"selectTitle":"Select Squad (5-15 Players) - Selected: {{count}}","addPlayerTitle":"Add Players to Your Team","selectAll":"Select All","allSelected":"All Selected","addPlayer":"Add Player","temporaryLabel":"(Temporary)","noPlayers":{"title":"No Players Added Yet","description":"Your team roster is empty. Add players to start setting up your game."},"exceededFormat":"You have selected {{count}} players, which exceeds the {{format}} limit of {{max}}. Update the match format or adjust the squad selection."},"matchDetails":{"opponentLabel":"Opponent Team Name","opponentPlaceholder":"Enter opponent team name (optional)","matchTypeLabel":"Match Type","venueLabel":"Venue","opponentSuggestions":{"ariaLabel":"Previous opponent suggestions","noMatches":"No previous opponents match \\"{{query}}\\""}},"gameSettings":{"periodsLabel":"Number of Periods","durationLabel":"Period Duration (minutes)","alertLabel":"Substitution Alert"},"formation":{"header":"Match Format & Formation","formatLabel":"Match Format","formationLabel":"Tactical Formation","formatExceeded":"You have selected {{count}} players, which exceeds the {{format}} limit of {{max}}. Update the match format or adjust the squad before configuring formations.","comingSoonSuffix":"(Coming soon - Select to up-vote)"},"goalies":{"header":"Assign Goalies","periodLabel":"Period {{period}} Goalie","placeholder":"Select Goalie"},"captain":{"header":"Assign Captain","label":"Team Captain","hint":"Optional - select a team captain for this game","noCaptain":"No Captain"},"buttons":{"saveConfig":"Save Configuration","savingConfig":"Saving...","getLiveLink":"Get Live Match Link","creatingLink":"Creating Link...","proceedToPeriod":"Proceed to Period Setup","randomize":"\ud83c\udfb2 Randomize Configuration (Debug)"},"sync":{"syncing":"Syncing team roster...","syncSuccess":"\u2705 {{message}}","syncFailed":"Sync failed: {{error}}","syncError":"Sync error: {{error}}"},"addPlayerModal":{"title":"Add Player","message":"Choose how you\'d like to add a player.","addToTeam":"Add Player to Team","addTemporary":"Add Temporary Player","cancel":"Cancel"},"liveLinkNotifications":{"authRequired":"Authentication Required","authRequiredMessage":"You must be signed in with a team to share a live match link.","creating":"Creating live match link...","linkCopied":"Link Copied!","linkCopiedMessage":"Live match link copied to clipboard!","liveMatchUrl":"Live Match URL","failed":"Failed to create live match link","failedWithError":"Failed to create live match link: {{error}}"},"matchTypes":{"league":{"label":"League","description":"Official league/conference game"},"friendly":{"label":"Friendly","description":"Practice or non-competitive game"},"cup":{"label":"Cup","description":"Tournament or cup competition game"},"tournament":{"label":"Tournament","description":"Tournament bracket or playoff game"},"internal":{"label":"Internal","description":"Team scrimmage or internal practice"}},"venueTypes":{"home":{"label":"Home","description":"Match is played on our home field with familiar surroundings."},"away":{"label":"Away","description":"Match is played at the opponent\'s venue."},"neutral":{"label":"Neutral","description":"Match is played on a neutral field for both teams."}},"pendingMatch":{"errors":{"checkFailed":"Failed to check for pending matches. Please check your internet connection and try again.","title":"Failed to Check Pending Matches","retrying":"Retrying...","tryAgain":"Try Again"}},"teamBanner":{"label":"Team: {{clubName}} {{teamName}}"},"cloudSync":{"available":"Cloud Sync Available","description":"Keep your data safe across devices","featureDescription":"Save your team, configurations and match data. Access your data from any device and unlock season statistics."},"dataMigration":{"title":"Migrate Local Data","description":"We found match history saved locally. Would you like to sync it to your cloud account?","migrating":"Migrating...","migratingFull":"Migrating local data to cloud...","migrateButton":"Migrate Data","laterButton":"Later","failed":"Migration failed","failedWithError":"Migration failed: {{error}}"},"saveConfig":{"saving":"Saving configuration...","savedSuccess":"{{message}}","savedSuccessDefault":"Configuration saved successfully","errors":{"failed":"Failed to save configuration","failedWithMessage":"Failed to save configuration: {{error}}","noMatchId":"No match ID returned from save operation"}},"positionRecommendations":{"title":"Recommended Starting Positions","timeframe":"Last 6 months","loading":"Calculating position recommendations...","error":"Unable to calculate position recommendations.","description":"Fair position assignments based on recent role distribution.","noRecommendations":"No position recommendations available.","unknown":"Unknown","dismiss":"Dismiss","acceptAll":"Accept All","reasons":{"noMatchHistory":"No match history","roleTimePercentage":"{{percentage}}% {{role}} time"}},"formationVoting":{"description":"By voting, you help us prioritize which formations to build next. Only one vote per user per formation will be counted.","errors":{"loginRequired":"You must be logged in to vote for formations","submitFailed":"Failed to submit vote. Please try again.","voteSubmissionFailed":"Vote submission failed"},"messages":{"duplicateVote":"You\'ve already voted for the {{formation}} formation in {{format}} format.","voteRecorded":"Your vote for the {{formation}} formation has been recorded!"}},"formationPreview":{"formations":{"2-2":{"name":"2-2 Formation","description":"2 defenders, 2 attackers"},"1-2-1":{"name":"1-2-1 Formation","description":"1 defender, 2 midfielders, 1 attacker"},"2-2-2":{"name":"2-2-2 Formation","description":"2 defenders, 2 midfielders, 2 attackers"},"2-3-1":{"name":"2-3-1 Formation","description":"2 defenders, 3 midfielders, 1 attacker"}},"positions":{"leftAttacker":"Left Attacker","rightAttacker":"Right Attacker","attacker":"Attacker","leftDefender":"Left Defender","rightDefender":"Right Defender","defender":"Defender","leftMid":"Left Mid","rightMid":"Right Mid","leftMidfielder":"Left Midfielder","rightMidfielder":"Right Midfielder","centerMidfielder":"Center Midfielder","goalie":"Goalie"},"roles":{"defenders":"Defenders","defender":"Defender","attackers":"Attackers","attacker":"Attacker","midfielders":"Midfielders"}},"periodSetup":{"header":{"title":"Period {{period}} Team Selection"},"score":{"title":"Current Score","opponent":"Opponent"},"substituteRecommendations":{"title":"Recommended Substitutes","timeframe":"Last 6 months","loading":"Loading substitute recommendations...","error":"Unable to load substitute recommendations right now.","description":"Players who have rarely started as substitutes recently. Consider giving them a substitute start.","noEligible":"No eligible substitutes to recommend.","dismiss":"Dismiss","accept":"Accept"},"goalie":{"header":"Goalie for Period {{period}}","headerInactive":"Goalie for Period {{period}} (Inactive - needs activation)","placeholder":"Select Goalie for this Period"},"saveStatus":{"saving":"Saving period configuration...","success":"\u2705 {{message}}","error":"\u274c {{message}}","defaultSuccess":"Period configuration saved successfully","defaultError":"Failed to save period configuration"},"buttons":{"enterGame":"Enter Game","saveConfig":"Save Configuration","saving":"Saving...","backToConfig":"Back to Configuration","randomize":"\ud83c\udfb2 Randomize Formation (Debug)"},"modals":{"inactiveGoalie":{"title":"Inactive Goalie Detected","message":"{{playerName}} is currently inactive but selected as goalie for next period. Do you want to continue with {{playerName}} as goalie?","confirm":"Activate & Continue","cancel":"Choose Different Goalie"},"recommendationRerun":{"title":"Re-run Formation Recommendations?","message":"You\'ve changed the goalie from {{formerGoalie}} to {{newGoalie}}. Would you like to re-run the formation recommendations with the new goalie?","confirm":"Yes, Re-run Recommendations","cancel":"No, Keep Current Formation"},"activatePlayer":{"title":"Activate Player","message":"Put {{playerName}} back into rotation?","confirm":"Activate","cancel":"Cancel"}},"alerts":{"selectGoalieFirst":"Please select a goalie first before randomizing the formation.","noPlayersAvailable":"No players available for positioning.","randomizeFailed":"Failed to generate random formation.","alreadyAssigned":"{{playerName}} is already assigned. Choose a different player."},"fallbacks":{"substituteTitle":"Substitute","unknownPlayer":"Unknown","selectPosition":"Select {{title}}"},"positions":{"goalie":"Goalie","leftDefender":"Left","rightDefender":"Right","leftAttacker":"Left","rightAttacker":"Right","defender":"Defender","left":"Left","right":"Right","attacker":"Attacker","leftMidfielder":"Left","rightMidfielder":"Right","centerMidfielder":"Center","substitute":"Substitute"},"roleGroups":{"offence":"Offence","midfield":"Midfield","defence":"Defence","substitutes":"Substitutes"}}}'),ke=JSON.parse('{"authModal":{"titles":{"login":"Sign In","signup":"Create Account","reset":"Reset Password","verify":"Verify Email"},"closeModal":"Close modal"},"login":{"header":{"title":"Welcome Back","subtitle":"Sign in to your account"},"form":{"emailLabel":"Email Address","emailPlaceholder":"Enter your email","passwordLabel":"Password","passwordPlaceholder":"Enter your password","submitButton":"Sign In","submittingButton":"Signing In..."},"links":{"forgotPassword":"Forgot your password?","noAccount":"Don\'t have an account?","signUp":"Sign up"},"errors":{"unexpected":"An unexpected error occurred. Please try again."}},"signup":{"header":{"title":"Create Account","subtitle":"Get started with email verification"},"form":{"emailLabel":"Email Address","emailPlaceholder":"Enter your email","passwordLabel":"Password","passwordPlaceholder":"Create a secure password","passwordRequirements":"Password must be at least 8 characters long","confirmPasswordLabel":"Confirm Password","confirmPasswordPlaceholder":"Confirm your password","submitButton":"Create Account","submittingButton":"Creating Account..."},"links":{"hasAccount":"Already have an account?","signIn":"Sign in"},"errors":{"unexpected":"An unexpected error occurred. Please try again."}},"passwordReset":{"email":{"header":{"title":"Reset Password","subtitle":"Enter your email address and we\'ll send you a verification code to reset your password"},"form":{"emailLabel":"Email Address","emailPlaceholder":"Enter your email address","submitButton":"Send Reset Email","submittingButton":"Sending Reset Email..."},"info":{"title":"What happens next?","steps":["We\'ll send a password reset email to your address","The email contains a 6-digit verification code","Enter the code in the verification form","Choose a new password and confirm the change"]},"links":{"backToLogin":"Back to Sign In"}},"code":{"success":{"title":"Check Your Email","sentTo":"We\'ve sent a password reset email to","instructions":"Enter the 6-digit verification code from the email below.","spamNote":"Don\'t see the email? Check your spam folder."},"form":{"codeLabel":"6-Digit Verification Code","codePlaceholder":"Enter 6-digit code","codeHint":"Check your email for the 6-digit verification code","submitButton":"Verify Code","submittingButton":"Verifying Code..."},"links":{"resend":"Send another reset email","close":"Close"}},"update":{"header":{"title":"Set New Password","subtitle":"Choose a strong password for your account"},"form":{"newPasswordLabel":"New Password","newPasswordPlaceholder":"Enter your new password","confirmPasswordLabel":"Confirm New Password","confirmPasswordPlaceholder":"Confirm your new password","submitButton":"Update Password","submittingButton":"Updating Password..."},"requirements":{"title":"Password Requirements:","items":["At least 8 characters long","Use a mix of letters, numbers, and symbols","Avoid common passwords or personal information"]},"success":{"title":"Password Updated!","messageWithUser":"Password updated successfully. You can now continue using the app.","messageWithoutUser":"Password updated successfully. You can now sign in with your new password.","continueButton":"Continue","signInButton":"Sign In Now","closeButton":"Close"}},"errors":{"emailRequired":"Email is required","emailInvalid":"Please enter a valid email address","newPasswordRequired":"New password is required","newPasswordTooShort":"Password must be at least 8 characters long","confirmPasswordRequired":"Please confirm your password","passwordsMismatch":"Passwords do not match","unexpected":"An unexpected error occurred. Please try again."}},"sessionExpiry":{"title":"Session Expiring Soon","expired":"Expired","seconds":"{{count}} seconds","message":"Your session will expire in {{time}}. Would you like to extend your session to continue working?","autoSaveInfo":"Your work will be saved automatically when you extend your session.","extendButton":"Extend Session","extendingButton":"Extending...","continueButton":"Continue Without Extending","signOutButton":"Sign Out Now"},"authButtons":{"signIn":"Sign In","signUp":"Sign Up","createAccount":"Create Account","signOut":"Sign Out"},"profileCompletion":{"welcome":"Welcome!","subtitle":"Let\'s complete your profile to get started","benefitsTitle":"Complete your profile to:","benefits":{"personalize":"Personalize your coaching experience","displayName":"Display your name in team reports","preferences":"Set up your coaching preferences"},"completeButton":"Complete Profile","skipButton":"Skip for now","finePrint":"You can complete this later from the profile section"},"anonymousAlert":{"defaultFeature":"this feature","defaultDescription":"Sign in to access enhanced features and save your data across devices.","completeProfile":"Complete Your Profile","signInToUse":"Sign in to use {{feature}}","signUpButton":"Sign Up","createAccountButton":"Create Account","createFreeAccountButton":"Create Free Account","benefitsTitle":"What you\'ll get:","finePrint":"Free forever \u2022 No credit card required \u2022 Your data stays private","defaultBenefits":{"saveData":"Save your team data across devices","accessHistory":"Access match history and statistics","manageTeams":"Create and manage multiple teams","neverLose":"Never lose your progress"},"teamManagement":{"feature":"team management","title":"Manage Your Teams","description":"Create and manage team rosters, save player information, and track team performance across multiple matches.","benefits":{"createRosters":"Create multiple team rosters","savePlayerInfo":"Save player information and jersey numbers","trackPerformance":"Track team performance over time","accessHistory":"Access match history and analytics","syncDevices":"Sync data across all your devices"}},"matchHistory":{"feature":"match history","title":"Save Your Match History","description":"Keep track of all your matches with detailed statistics, player performance data, and game analytics.","benefits":{"saveReports":"Save detailed match reports","trackStats":"Track player statistics over time","viewPatterns":"View formation and substitution patterns","comparePerformance":"Compare team performance across matches","neverLoseData":"Never lose important game data"}},"cloudSync":{"feature":"cloud sync","title":"Sync Across Devices","description":"Access your teams and match data from any device. Your information is automatically backed up and synchronized.","benefits":{"accessAnywhere":"Access from phone, tablet, or computer","autoBackup":"Automatic cloud backup","neverLose":"Never lose your data","shareInfo":"Share team information with other coaches","realTimeSync":"Real-time synchronization"}}},"authGuard":{"loading":"Loading...","defaultFeature":"this feature","defaultDescription":"Sign in to access enhanced features and save your data across devices."},"featureGate":{"authRequired":"Authentication Required","message":"You must be signed in to access this feature.","button":"Sign In","loading":"Loading...","defaultFeature":"this feature","defaultDescription":"Sign in to unlock this feature","defaultActionText":"Sign in for a better experience","signInRequired":"Sign in required","unlock":"Unlock {{feature}}","signUp":"Sign Up","learnMore":"Learn more about the benefits","cancel":"Cancel","buttonGate":{"defaultFeature":"this feature","defaultDescription":"Sign in to use this feature"},"linkGate":{"defaultFeature":"this feature","defaultDescription":"Sign in to access this feature"}},"invitation":{"title":"Team Invitation","subtitle":"You\'ve been invited to join a team!","loadingTeam":"Loading team details...","teamLabel":"Team","roleLabel":"Role","errors":{"passwordMismatch":"Passwords do not match","setupFailed":"Failed to set up account","signOutFailed":"Failed to sign out. Please try again."},"passwordSuccess":{"title":"Password Set Successfully!","message":"Your account is ready. To complete your team invitation and ensure secure access, please sign in with your new password.","nextStepsTitle":"What happens next:","step1":"You\'ll be signed out for security","step2":"Sign in with: {{email}}","step3":"Your team invitation will be processed automatically","button":"Continue to Sign In","buttonProcessing":"Signing you out..."},"accountSetup":{"statusTitle":"Almost there!","statusMessage":"Set up your password to complete your account and join the team.","passwordLabel":"Create Password","passwordPlaceholder":"Enter your password","confirmLabel":"Confirm Password","confirmPlaceholder":"Confirm your password","submitButton":"Complete Account Setup","submittingButton":"Setting up account...","passwordRequirements":"Must be at least 8 characters with letters and at least one number"},"readyToJoin":{"statusTitle":"Ready to join!","statusMessage":"Click below to accept your invitation and join the team.","acceptButton":"Accept Invitation","processingButton":"Joining team..."},"signInRequired":{"message":"Please sign in or create an account to accept this invitation.","closeInstruction":"Close this modal to access the sign-in options"},"validity":"This invitation will remain valid until you accept it or it expires.","statusMessages":{"accountSetup":"Complete your account setup to join the team","signInRequired":"Sign in to accept your team invitation","processing":"Processing your team invitation..."}},"emailVerification":{"header":{"title":"Check Your Email","sentTo":"We sent a 6-digit code to"},"form":{"codeLabel":"Verification Code","codePlaceholder":"Enter 6-digit code","codeHint":"Enter the 6-digit code from your email","submitButton":"Verify Email","submittingButton":"Verifying..."},"expiry":{"title":"Your verification code has expired","description":"Verification codes are valid for 60 minutes. Please request a new code to continue.","sendNewButton":"Send New Verification Code","sendingButton":"Sending...","cooldownButton":"Send New Code ({{seconds}}s)","confirmMessage":"A new 6-digit code will be sent to"},"help":{"toggleButton":"Didn\'t receive an email?","toggleButtonHide":"Hide troubleshooting help","toggleButtonShow":"Show troubleshooting help","resendButton":"Resend verification code","resendCooldown":"Resend code again in {{seconds}}s","title":"Troubleshooting tips:","tips":{"spam":"Check your spam/junk folder - automated emails sometimes end up there","wait":"Wait a few minutes - email delivery can take 2-5 minutes","checkEmail":"Check that {{email}} is correct","provider":"Some email providers (especially corporate) may block automated emails"},"enumeration":{"title":"Account already exists?","description":"If an account with your email already exists, you won\'t receive a signup email. This is intentional security behavior.","whyTitle":"Why not just say the email is in use?","whyDescription":"This protects your privacy by preventing bad actors from discovering which email addresses are registered with us.","signInLink":"Try signing in instead \u2192"}},"footer":{"hasAccount":"Already have an account?","signInLink":"Sign in","closeButton":"Close"},"errors":{"unexpected":"An unexpected error occurred. Please try again.","resendFailed":"Failed to resend code. Please try again."}},"validation":{"email":{"required":"Email is required","invalid":"Please enter a valid email address"},"password":{"required":"Password is required","tooShort":"Password must be at least 8 characters","missingNumber":"Password must contain at least one number","missingSpecialChar":"Password must contain at least one special character"},"confirmPassword":{"required":"Please confirm your password","mismatch":"Passwords do not match"},"otp":{"required":"Verification code is required","invalid":"Please enter a valid 6-digit code","tooShort":"Verification code must be 6 digits","notNumeric":"Verification code must contain only numbers"},"general":{"unexpected":"An unexpected error occurred. Please try again."}},"signUp":{"checkEmailMessage":"Please check your email for confirmation link","failedToSignUp":"Failed to sign up"},"errors":{"invalidCredentials":"Invalid email or password. Please check your credentials and try again.","emailNotConfirmed":"Please verify your email with the 6-digit code we sent you.","userAlreadyRegistered":"An account with this email already exists. Please sign in instead.","passwordTooShort":"Password must be at least 6 characters long.","invalidPassword":"Please enter a valid password.","invalidEmail":"Please enter a valid email address.","emailNotFound":"No account found with this email address.","tooManyRequests":"Too many attempts. Please wait a moment before trying again.","connectionError":"Connection error. Please check your internet connection and try again.","networkError":"Network error. Please try again.","unknownError":"Unknown error","operationTimedOut":"Operation timed out"},"passwordRequirements":{"atLeastChars":"at least {{count}} characters","uppercaseAndLowercase":"uppercase and lowercase letters","uppercase":"uppercase letters","lowercase":"lowercase letters","letters":"letters","atLeastOneNumber":"at least one number","atLeastOneSpecialChar":"at least one special character","mustBe":"Must be {{requirements}}"},"changePassword":{"modalTitle":"Change Password","closeModal":"Close modal","header":{"title":"Change Your Password","subtitle":"Enter your current password to verify your identity, then set a new password"},"form":{"currentPasswordLabel":"Current Password","currentPasswordPlaceholder":"Enter your current password","newPasswordLabel":"New Password","newPasswordPlaceholder":"Enter your new password","confirmPasswordLabel":"Confirm New Password","confirmPasswordPlaceholder":"Confirm your new password","submitButton":"Change Password","submittingButton":"Changing Password..."},"requirements":{"title":"Password Requirements:","items":{"minLength":"At least 8 characters long","different":"Must be different from your current password","mix":"Use a mix of letters, numbers, and symbols"}},"success":{"title":"Password Changed!","button":"Done"},"errors":{"currentPasswordRequired":"Current password is required","newPasswordRequired":"New password is required","newPasswordTooShort":"New password must be at least 8 characters long","newPasswordSame":"New password must be different from current password","confirmPasswordRequired":"Please confirm your new password","passwordsMismatch":"Passwords do not match","unexpected":"An unexpected error occurred. Please try again."}}}'),Ne=JSON.parse('{"header":{"title":"Profile Settings"},"form":{"nameLabel":"Display Name","namePlaceholder":"Enter your name","emailLabel":"Email Address","languageLabel":"Language","languageEnglish":"English","languageSwedish":"Svenska","saveButton":"Save Changes","savingButton":"Saving..."},"validation":{"nameRequired":"Name is required","nameTooShort":"Name must be at least 2 characters","nameInvalidChars":"Name contains invalid characters. Please use only letters, numbers, spaces, hyphens, apostrophes, and periods."},"messages":{"updateSuccess":"Profile updated successfully!","updateError":"Failed to update profile","unexpectedError":"An unexpected error occurred. Please try again."},"screen":{"title":"Profile","back":"Back"},"personalInfo":{"title":"Personal Information","fullName":"Full Name","emailAddress":"Email Address","password":"Password","namePlaceholder":"Enter your full name","readOnly":"(Read-only)","changePassword":"Change Password","passwordHint":"Regularly updating your password helps keep your account secure","emailVerified":"Email verified"},"accountInfo":{"title":"Account Information","created":"Account Created","updated":"Last Updated","userId":"User ID","emailStatus":"Email Status","verified":"Verified","pendingVerification":"Pending verification"},"teamManagement":{"title":"Team Management","loading":"Loading your clubs and teams...","currentTeam":"Current Team","yourClubs":"Your Clubs ({{count}})","yourTeams":"Your Teams ({{count}})","member":"Member","inactive":"Inactive","switch":"Switch","leave":"Leave","leaving":"Leaving..."},"emptyStates":{"noClubs":{"title":"No clubs yet","description":"You haven\'t joined any clubs yet. Create a club or join an existing club.","action":"Create or join a club"},"noTeams":{"title":"No Teams Yet","description":"You haven\'t joined any teams yet. Create your first team or ask a coach to invite you.","action":"Create or Join a Team"}},"modals":{"leaveClub":{"title":"Leave club","message":"Are you sure you want to leave {{clubName}}?","confirm":"Leave club"},"leaveTeam":{"title":"Leave team","message":"Are you sure you want to leave {{teamName}}?","confirm":"Leave team"},"cantLeaveClub":{"title":"Can\'t leave club","lastMember":"You\'re the last member of {{teamName}}. Delete the team instead?","deleteButton":"Delete Team","deletingButton":"Deleting..."},"cantLeaveTeam":{"title":"Can\'t leave team","lastMember":"You\'re the last member of {{teamName}}. Delete the team instead?","lastAdmin":"You\'re the last admin of {{teamName}}. Delete the team instead?"}},"buttons":{"save":"Save","saving":"Saving...","cancel":"Cancel","edit":"Edit"},"formatting":{"notAvailable":"N/A","invalidDate":"Invalid date","defaultUser":"User","unknownClub":"Unknown club","unknownTeam":"Unknown team","thisTeam":"this team"}}'),je=JSON.parse('{"period":{"label":"Period {{number}}","ordinal":{"1st":"1st","2nd":"2nd","3rd":"3rd","4th":"4th","nth":"{{number}}th"}},"startScreen":{"startMatch":"Start Match","startPeriod":"Start {{ordinal}} Period","instructions":"Tap to begin the period and start timers","backToSetup":"Back to Setup"},"timers":{"matchClock":"Match Clock","substitutionTimer":"Substitution Timer","pauseTooltip":"Pause substitution timer","resumeTooltip":"Resume substitution timer"},"score":{"instructions":"Tap team name to add goal \u2022 Hold score to edit"},"substitution":{"button":"SUB NOW","buttonSingle":"SUB 1 PLAYER","buttonMultiple":"SUB {{count}} PLAYERS","makeSubstitution":"Make substitution","cannotSubstitute":"All substitutes are inactive - cannot substitute","undoTooltip":"Undo last substitution","undoDisabled":"No substitution to undo","decreaseCount":"Decrease number of players to substitute","increaseCount":"Increase number of players to substitute","undoModal":{"title":"Undo Substitution","message":"Are you sure you want to undo the last substitution? This will reverse player positions and time tracking.","confirm":"Undo","cancel":"Cancel"}},"actions":{"endPeriod":"End Period"},"modals":{"fieldPlayer":{"setNext":"Set as Next","removeFromNext":"Remove from Next","subNow":"Sub Now","changePosition":"Change Position","cancel":"Cancel"},"substitute":{"inactivate":"Inactivate","activate":"Activate","cancel":"Cancel"},"goalie":{"switchGoalie":"Switch Goalie","cancel":"Cancel"}},"formation":{"noConfig":"No team configuration available","invalidConfig":"Invalid team configuration","inactive":"(Inactive)","positions":{"goalie":"Goalie","leftDefender":"Left Defender","rightDefender":"Right Defender","leftAttacker":"Left Attacker","rightAttacker":"Right Attacker","defender":"Defender","left":"Left Mid","right":"Right Mid","attacker":"Attacker","leftMidfielder":"Left Midfielder","rightMidfielder":"Right Midfielder","centerMidfielder":"Center Midfielder","substitute":"Substitute"},"inactiveStatus":"Inactive"},"finished":{"title":"Match Complete!","subtitle":"Great game! Here\'s the summary:","finalScore":"Final Score","matchTime":"Match Time","periods":"Periods","fairPlay":"Fair Play Award","fairPlayDescription":"Most balanced playing time","topScorer":"Top Scorer","topScorerGoals":"{{count}} goal","topScorerGoals_other":"{{count}} goals","noGoals":"No goals scored","viewReport":"View Full Report","newMatch":"New Match"},"validation":{"selectPlayersCount":"Please select between {{min}} and {{max}} players for the squad.","assignGoaliePerPeriod":"Please assign a goalie for each period.","invalidFormation":"Invalid formation detected. Please ensure all positions are properly assigned.","completeFormation":"Please complete the team formation with 1 goalie and {{count}} unique outfield players.","completeFormationAssignment":"Please complete the formation assignment.","assignAllPositions":"Please assign all positions including goalie.","noActiveMatch":"No active match to save.","teamContextRequired":"Team context required for saving configuration."},"helpMessages":{"fieldPlayerOptions":"Hold for options","substituteToggleActivate":"Hold to activate","substituteToggleInactivate":"Hold to inactivate"},"persistence":{"retrying":"Retrying save (attempt {{attempt}}/{{maxAttempts}})...","failedAfterRetries":"Failed to save match after {{maxAttempts}} attempts","failedToSaveMatch":"Failed to save match","cannotRetry":"Cannot retry: No pending match data found.","cannotSaveNoMatchId":"Cannot save match: No match ID.","cannotSaveNoPlayerData":"Cannot save match: No player data available.","cannotSaveMissingStartTime":"Cannot save match: Missing start time.","cannotSaveIncompleteData":"Cannot save match: Incomplete match data ({{fields}})","cannotSaveNoParticipants":"Cannot save match: No participating players found.","playerStatsFailed":"Player stats failed for: {{names}}","playerStatsFailedCount":"Player stats failed for {{count}} player(s)","configSaved":"Configuration saved","configSavedWithWarnings":"Configuration saved (with warnings)","failedToSaveConfig":"Failed to save configuration","failedToSaveConfigError":"Failed to save configuration: {{error}}"},"stats":{"title":"Game Finished - Statistics","opponent":"Opponent","fairPlayAward":"Fair Play Award","notAwarded":"Not awarded","fairPlayWinner":"FAIR PLAY WINNER","savingSelection":"Saving selection...","selectionSavesAutomatically":"Selection saves automatically","matchSaved":"Match saved to history","viewMatchReport":"View Match Report","startNewGame":"Start New Game","errors":{"noMatchId":"No match ID found. Please restart the match to enable saving.","signInRequired":"Please sign in to save match updates.","saveFailed":"Failed to save match updates"}}}'),Te=JSON.parse('{"tabs":{"team":"Team","player":"Player","attendance":"Attendance","history":"History"},"teamStats":{"title":"Team Statistics","totalMatches":"Total Matches","winRate":"Win Rate","avgGoalsScored":"Avg. Goals Scored","avgGoalsConceded":"Avg. Goals Conceded","activePlayers":"Active players","perMatch":"Per match","wins":"Wins","draws":"Draws","losses":"Losses","loading":"Loading team statistics...","error":"Error loading team statistics","noStats":"No team statistics available","failedToLoadMatchData":"Failed to load match data","noMatchesFiltered":"No matches found with the selected filters","adjustFilters":"Try adjusting your filter criteria","victories":"victories","totalGoals":"total goals","sections":{"goals":"Goals","matchOutcomes":"Match Outcomes","recentMatches":"Recent Matches","homeRecord":"Home Record","awayRecord":"Away Record","cleanSheets":"Clean Sheets"},"labels":{"matchesWon":"Matches Won","matchesDrawn":"Matches Drawn","matchesLost":"Matches Lost","goalsScored":"Goals Scored","goalsConceded":"Goals Conceded","goalDifference":"Goal Difference","matches":"matches","total":"total","ofTotal":"of total"},"outcomes":{"win":"Win","draw":"Draw","loss":"Loss"},"record":{"wins":"wins","draws":"draws","loss":"loss","losses":"losses"},"summaryRecord":"{{wins}}W {{draws}}D {{losses}}L"},"playerStats":{"title":"Player Statistics","totalPlayers":"Total Players","avgPlayingTime":"Avg. Playing Time","avgGoals":"Average goals","topScorer":"Top Scorer","noStats":"No player statistics available","adjustTimeRange":"Add matches or adjust the selected time range","loading":"Loading player statistics...","error":"Error loading player statistics","errorDetails":"Failed to load player statistics","failedToLoadMatches":"Failed to load matches","failedToLoadLoanMatches":"Failed to load loan matches","unnamedPlayer":"Unnamed Player","noMatchesAvailable":"No player statistics available","addMatchesOrAdjust":"Add matches or adjust the selected time range.","noMatchesFiltered":"No matches found with the selected filters","adjustFilters":"Try adjusting the filter criteria.","noStatsRecorded":"No player statistics recorded for the selected filters","activePlayers":"Active players","perMatch":"Per match","totalGoalsLabel":"Total goals:","goals":"goals","noData":"No data","tableSubtitle":"Click column headers to sort or drag to reorder. Loan matches are weighted at {{weight}}.","columns":{"player":"Player","matches":"Matches","loanMatches":"Loan Matches","goals":"Goals","avgTime":"Avg Time","outfieldTime":"Outfield Time","startedAsSub":"Started as Sub","defender":"Defender","midfielder":"Midfielder","attacker":"Attacker","goalkeeper":"Goalkeeper","captain":"Captain","fairPlay":"Fair Play"}},"attendanceStats":{"title":"Attendance Statistics","totalPlayers":"Total Players","trackedPlayers":"Tracked players","totalPractices":"Total Practices","inSelectedPeriod":"In selected period","avgAttendanceRate":"Avg. Attendance Rate","acrossAllPlayers":"Across all players","topAttendee":"Top Attendee","failedToLoadAttendance":"Failed to load attendance statistics","failedToLoadLoanMatches":"Failed to load loan matches","noData":"No attendance data available","noDataTimeRange":"No attendance data available for the selected time range","adjustTimeFilter":"Try adjusting the time filter or wait for the next sync.","loading":"Loading attendance statistics...","error":"Error loading attendance statistics","noConnector":{"title":"No attendance data available","description":"Set up a Connector in the Team Management Connectors tab to collect attendance data from:","platforms":{"sportadmin":"SportAdmin","svenskalag":"Svenska Lag","myclub":"MyClub"},"connectButton":"Connect Now"},"table":{"player":"Player","practicesPerMatch":"Practices/Match","practicesAttended":"Practices attended","attendanceRate":"Attendance rate","matchesPlayed":"Matches played","matchesLoaned":"Matches loaned","sortInstruction":"Click column headers to sort or drag to reorder."}},"matchHistory":{"title":"Match History","noMatches":"No matches yet","addMatches":"Matches you play will appear here","loading":"Loading match history...","error":"Error loading match history","errorDetails":"Failed to load match history","addMatch":"Add Match","matchesFound":"{{count}} matches found. Click on a match to view detailed statistics.","noMatchesFiltered":"No matches found with the selected filters.","adjustFilters":"Try adjusting your filter criteria.","venues":{"home":"Home","away":"Away","neutral":"Neutral"},"outcomes":{"win":"Win","draw":"Draw","loss":"Loss"}},"matchDetails":{"title":"Match Details","newMatch":"New Match","opponent":"Opponent","opponentName":"Opponent name","venue":"Venue","matchType":"Match Type","type":"Type","format":"Format","formation":"Formation","periods":"Periods","periodDuration":"Period Duration","totalTime":"Total Time","duration":"Duration","finalScore":"Final Score","saving":"Saving...","saveChanges":"Save Changes","cancel":"Cancel","editMatch":"Edit Match","deleting":"Deleting...","delete":"Delete Match","deleteTitle":"Delete Match","deleteConfirm":"Are you sure you want to delete this match from history? This action cannot be undone.","deletingEllipsis":"Deleting...","deleteSuccess":"Match deleted successfully","deleteError":"Failed to delete match","errorSaving":"Error saving changes:","errorDeleting":"Error deleting match:","loading":"Loading match details...","notFound":"Match not found","noMatchId":"No match ID provided","failedToLoadDetails":"Failed to load match details","teamRequired":"A team must be selected before adding a match.","failedToCreate":"Failed to create match","failedToUpdateDetails":"Failed to update match details","failedToUpdatePlayerStats":"Failed to update player stats","failedToDelete":"Failed to delete match","unknownType":"Unknown","unnamedPlayer":"Unnamed Player","outcomes":{"win":"Win","draw":"Draw","loss":"Loss"},"venues":{"home":"Home","away":"Away","neutral":"Neutral"},"playerStats":{"title":"Player Statistics","subtitle":"Individual player performance for this match","player":"Player","goals":"Goals","outfieldTime":"Outfield Time","defender":"Defender","midfielder":"Midfielder","attacker":"Attacker","goalkeeper":"Goalkeeper","substitute":"Substitute","startingRole":"Starting Role","captain":"Captain","fairPlay":"Fair Play","actions":"Actions","addPlayer":"Add Player","remove":"Remove","selectPlayer":"Select player","allPlayersIncluded":"All players included","exceedsMatchDuration":"Exceeds match duration","goalWarning":"Player goals ({{playerGoals}}) exceed team total ({{teamGoals}}).","roleWarning":"Starting role inconsistency: {{issues}}.","goalkeeperCountIssue":"{{count}} goalkeepers (expected 1)","outfieldCountIssue":"{{count}} outfield players (expected {{expected}} for {{format}})"}},"matchSummary":{"scheduled":"Scheduled:","noStartTime":"No start time recorded","durationUnknown":"Duration unknown","wins":"{{teamName}} wins","tied":"Match tied","periodsFormat":"{{periods}} \xd7 {{duration}}min"},"filters":{"title":"Filter","clearAll":"Clear All","all":"All","timeRange":"Time Range","matchType":"Match Type","type":"Type","outcome":"Outcome","venue":"Venue","opponent":"Opponent","withPlayer":"With Player","format":"Format","outcomes":{"win":"Win","draw":"Draw","loss":"Loss"},"venues":{"home":"Home","away":"Away","neutral":"Neutral"}},"timeFilter":{"allTime":"All time","last30Days":"Last 30 Days","last3Months":"Last 3 Months","last6Months":"Last 6 Months","lastYear":"Last Year","custom":"Custom","customRange":"Custom range...","selectTimeRange":"Select Time Range","startDate":"Start Date","endDate":"End Date","apply":"Apply","cancel":"Cancel","from":"From {{date}}","until":"Until {{date}}","dateRange":"{{start}} - {{end}}","invalidStartDate":"Invalid start date","invalidEndDate":"Invalid end date","startBeforeEnd":"Start date must be before end date","startDateTooFar":"Start date cannot be more than a year in the future","endDateTooFar":"End date cannot be more than a year in the future","presets":{"last-30-days":"Last 30 days","last-3-months":"Last 3 months","last-6-months":"Last 6 months","last-12-months":"Last 12 months","year-to-date":"Year to Date","all-time":"All time"}},"table":{"player":"Player","matches":"Matches","playingTime":"Playing Time","goals":"Goals","assists":"Assists","attendance":"Attendance","sortBy":"Sort by"},"loading":"Loading statistics...","error":"Unable to load statistics","empty":{"title":"No Data Available","description":"Statistics will appear once you\'ve played matches"},"screen":{"title":"Statistics","loadingSubtitle":"Loading statistics...","fetchingData":"Fetching the latest data...","signInSubtitle":"Stay close to the action","signInBody":"Sign in with your parent account to explore match history, player stats, and team trends.","signIn":"Sign In","createAccount":"Create Account","selectTeamSubtitle":"Select a team to continue","noTeamSubtitle":"No team membership detected","selectTeamBody":"Choose a team from the main dashboard to view its statistics.","noTeamBody":"You need a team membership before you can view statistics. Ask a coach or admin to add you to the team.","roleUpdateSubtitle":"Role update required","roleUpdateBody":"Statistics are available for parent accounts. Ask your team administrator to upgrade your access.","tabs":{"teamStats":"Team Stats","teamStatsDescription":"Team performance overview","playerMatchStats":"Player Match Stats","playerMatchStatsDescription":"Individual player match statistics","attendanceStats":"Attendance Stats","attendanceStatsDescription":"Practice attendance tracking","matchHistory":"Match History","matchHistoryDescription":"Complete match history"}}}'),Ae=JSON.parse('{"management":{"title":"Team Management","tabs":{"overview":"Overview","roster":"Roster","loans":"Loans","access":"Access Management","connectors":"Connectors","preferences":"Preferences"}},"roster":{"title":"Team Roster","addPlayer":"Add Player","editPlayer":"Edit Player","deletePlayer":"Delete Player","noPlayers":"No players in roster","addPlayersToStart":"Add players to get started"},"player":{"name":"Name","number":"Number","position":"Preferred Position","status":"Status","active":"Active","inactive":"Inactive","temporary":"Temporary"},"addPlayer":{"title":"Add Player","addToTeam":"Add Player to Team","addTemporary":"Add Temporary Player","cancel":"Cancel"},"editPlayer":{"title":"Edit Player","save":"Save Changes","cancel":"Cancel"},"deletePlayer":{"title":"Delete Player","confirm":"Are you sure you want to delete {{playerName}} from the team?","delete":"Delete","cancel":"Cancel"},"loans":{"title":"Player Loans","loanDate":"Loan Date","receivingTeam":"Receiving Team","players":"Players","noLoans":"No active loans","addLoan":"Add Loan"},"access":{"title":"Team Access","role":"Role","admin":"Admin","coach":"Coach","viewer":"Viewer","invite":"Invite Member","remove":"Remove"},"invite":{"title":"Invite Team Member","email":"Email Address","role":"Role","send":"Send Invitation","cancel":"Cancel"},"creation":{"title":"Create Team","teamName":"Team Name","clubName":"Club Name","ageGroup":"Age Group","create":"Create Team","cancel":"Cancel"},"selector":{"title":"Select Team","noTeams":"No teams available","createTeam":"Create Team"},"addRosterPlayerModal":{"header":{"title":"Add Player","subtitle":"Add a new player to {{teamName}}"},"form":{"labels":{"firstName":"First Name *","lastName":"Last Name","displayName":"Display Name *","jerseyNumber":"Jersey Number"},"placeholders":{"firstName":"Enter first name","lastName":"Enter last name (optional)","displayName":"Enter display name"},"helperText":{"displayName":"This is the name displayed in the app (auto-fills from first name)"}},"validation":{"firstNameRequired":"First name is required","firstNameMinLength":"First name must be at least 2 characters","firstNameMaxLength":"First name must be at most 50 characters","lastNameMaxLength":"Last name must be at most 50 characters","displayNameRequired":"Display name is required","displayNameMinLength":"Display name must be at least 2 characters","displayNameMaxLength":"Display name must be at most 50 characters","jerseyNumberInvalid":"Please select a valid jersey number","failedToAdd":"Failed to add player"},"jerseyNumber":{"noNumber":"No jersey number","allTaken":"All jersey numbers (1-100) are taken"},"buttons":{"addPlayer":"Add Player","adding":"Adding...","cancel":"Cancel"},"success":{"playerAdded":"{{playerName}} added successfully!"}},"editRosterPlayerModal":{"header":{"title":"Edit Player","subtitle":"Update {{playerName}}\'s information"},"form":{"labels":{"firstName":"First Name *","lastName":"Last Name","displayName":"Display Name *","jerseyNumber":"Jersey Number","onRoster":"Active on roster"},"placeholders":{"firstName":"Enter first name","lastName":"Enter last name (optional)","displayName":"Enter display name"},"helperText":{"displayName":"This is the name displayed in the app"}},"validation":{"firstNameRequired":"First name is required","firstNameMinLength":"First name must be at least 2 characters","firstNameMaxLength":"First name must be at most 50 characters","lastNameMaxLength":"Last name must be at most 50 characters","displayNameRequired":"Display name is required","displayNameMinLength":"Display name must be at least 2 characters","displayNameMaxLength":"Display name must be at most 50 characters","jerseyNumberRange":"Jersey number must be between 1 and 99","jerseyNumberTaken":"This jersey number is already taken","failedToUpdate":"Failed to update player"},"jerseyNumber":{"noNumber":"No jersey number","currentLabel":"#{{number}} (current)","allTaken":"All jersey numbers (1-99) are taken"},"playerInfo":{"header":"Player Information","created":"Created:","lastUpdated":"Last Updated:","unknown":"Unknown"},"buttons":{"updatePlayer":"Update Player","updating":"Updating...","cancel":"Cancel"}},"wizard":{"clubSelection":{"title":"Select Your Club","description":"Search for your club or create a new one","placeholder":"Type your club name...","cancel":"Cancel"},"clubCreation":{"title":"Create New Club","description":"Set up your club information","fullNameLabel":"Full Club Name *","fullNamePlaceholder":"e.g., Sample Football Club","displayNameLabel":"Display Name *","displayNamePlaceholder":"Enter club name","shortNameLabel":"Short Name (optional)","shortNamePlaceholder":"e.g., DIF","shortNameHelper":"Used for abbreviations and quick identification","creating":"Creating...","createButton":"Create Club"},"teamSelection":{"title":"Select Team","description":"Search for your team or create a new one in <strong>{{clubName}}</strong>","placeholder":"Type your team name...","existingTeamsHeader":"Existing Teams","createButton":"Create New Team"},"teamCreation":{"title":"Create New Team","description":"Set up your team for <strong>{{clubName}}</strong>","teamNameLabel":"Team Name *","teamNamePlaceholder":"Enter team name","teamNameHelper":"e.g., \\"F16-6\\", \\"U16 Boys\\", \\"Junior Team\\"","creating":"Creating...","createButton":"Create Team"},"playerCreation":{"title":"Add Players","description":"Add players to <strong>{{teamName}}</strong>","playerNamePlaceholder":"Player display name","addButton":"Add","addedPlayersHeader":"Added Players ({{count}})","laterNote":"You can add more players later from the team management screen.","completeButton":"Complete Setup"},"complete":{"title":"Team Setup Complete!","description":"Your team <strong>{{teamName}}</strong> has been created successfully."},"validation":{"clubNameRequired":"Club name is required","teamNameRequired":"Team name is required","playerNameRequired":"Player name is required"}},"inviteModal":{"header":{"title":"Invite Team Member","closeLabel":"Close modal","teamFallback":"Team"},"form":{"labels":{"email":"Email Address","role":"Team Role","message":"Personal Message"},"placeholders":{"email":"Enter email address","message":"Add a personal message to include with the invitation..."},"hints":{"role":"Choose the appropriate role for this team member","messageOptional":"(optional)","characterCount":"{{count}}/500 characters"},"roles":{"coach":"Coach","parent":"Parent","player":"Player","admin":"Admin"}},"buttons":{"send":"Send Invitation","sending":"Sending Invitation...","refresh":"Refresh","delete":"Delete"},"validation":{"emailRequired":"Email address is required","emailInvalid":"Please enter a valid email address","roleRequired":"Please select a role","messageTooLong":"Message must be less than 500 characters","sendFailed":"Failed to send invitation. Please try again."},"success":{"invitationSent":"Invitation sent successfully!","invitationRefreshed":"Invitation refreshed successfully!","invitationDeleted":"Invitation deleted successfully!"},"invitations":{"pendingHeader":"Pending Invitations","expiredHeader":"Expired Invitations","countLabel":"({{count}})","noPending":"No pending invitations","loading":"Loading invitations...","status":{"pending":"Pending","expired":"Expired"},"details":{"sent":"Sent: {{date}}","remaining":"{{time}} remaining","hoursMinutesRemaining":"{{hours}}h {{minutes}}m remaining","minutesRemaining":"{{minutes}}m remaining"}},"info":{"title":"What happens next?","steps":{"emailSent":"The invitee will receive an email with a secure invitation link","accountSetup":"They can create an account or sign in if they already have one","autoAdded":"Once accepted, they\'ll be automatically added to your team","manageRoles":"You can manage their role and permissions anytime"}}},"loanModal":{"header":{"titleNew":"Record Loan","titleEdit":"Edit Loan","subtitleNew":"Track a player appearance for another team","subtitleEdit":"Update loan appearance details","closeLabel":"Close"},"form":{"labels":{"players":"Player(s)","receivingTeam":"Receiving Team","loanDate":"Loan Date"},"placeholders":{"players":"Select one or more players","receivingTeam":"Enter receiving team name"}},"validation":{"playersRequired":"Select at least one player","receivingTeamRequired":"Receiving team is required","receivingTeamMaxLength":"Receiving team must be 200 characters or less","loanDateRequired":"Loan date is required","saveFailed":"Failed to save loan record"},"buttons":{"cancel":"Cancel","saving":"Saving...","recordLoan":"Record Loan","saveChanges":"Save Changes"}},"loansView":{"header":{"title":"Player Loans","newLoanButton":"New Loan"},"filters":{"title":"Filters","expandLabel":"Expand filters","collapseLabel":"Collapse filters","clearButton":"Clear filters","labels":{"players":"Players","teams":"Teams","status":"Status","timePeriod":"Time Period"},"placeholders":{"allPlayers":"All players","allTeams":"All teams"},"statusOptions":{"all":"All","upcoming":"Upcoming","past":"Past"}},"match":{"upcomingBadge":"Upcoming","playersLabel":"Players ({{count}}):","editLabel":"Edit match","deleteLabel":"Delete match"},"emptyStates":{"noLoans":{"title":"No loan matches recorded yet","description":"Track when your players appear for other teams.","button":"Record First Match"},"noResults":{"title":"No loans found","description":"Try adjusting your filters.","button":"Clear Filters"},"loading":"Loading loan matches..."},"messages":{"retry":"Retry","loanRecordedSingle":"Loan match recorded for 1 player.","loanRecordedMultiple":"Loan match recorded for {{count}} players.","loanUpdatedSingle":"Loan match updated for 1 player.","loanUpdatedMultiple":"Loan match updated for {{count}} players.","loanDeleted":"Removed {{count}} player(s) from loan match.","loadFailed":"Failed to load player loans","rosterLoadFailed":"Failed to load roster for loans","deleteFailed":"Failed to delete loan match"},"deleteConfirmation":{"title":"Delete loan match","message":"Remove {{count}} player(s) from the loan match {{teamName}} on {{date}}?","confirmButton":"Delete Match","cancelButton":"Cancel"},"fallback":{"unknownTeam":"Unknown Team","unknownPlayerDeleted":"Unknown Player (deleted)"}},"teamManagement":{"header":{"title":"Team Management","teamSetup":"Team Setup","back":"Back"},"loading":{"teamInfo":"Loading team information..."},"success":{"teamCreated":"Team created successfully!","accessProcessed":"Access request processed successfully!"},"tabs":{"overview":{"label":"Overview","description":"Team information and members"},"roster":{"label":"Roster","description":"Manage team players"},"loans":{"label":"Loans","description":"Track player loan matches"},"access":{"label":"Access Management","description":"Approve requests and invite users"},"connectors":{"label":"Connectors","description":"Manage external provider integrations"},"preferences":{"label":"Preferences","description":"Team settings and preferences"}},"teamHeader":{"noClub":"No club","roleAdmin":"Team Admin","roleCoach":"Coach","roleUser":"Team User","users":"user","usersPlural":"users"},"overview":{"title":"Team Information","teamName":"Team Name","club":"Club","teamCreated":"Team Created","unknown":"Unknown","teamUsers":"Team Users","unknownUser":"Unknown User","noUsers":"No team users found"},"access":{"title":"Access Management","manageAccess":"Manage Access","pendingRequests":"{{count}} pending access request","pendingRequestsPlural":"{{count}} pending access requests","reviewDescription":"Review and approve new team member requests","noPendingDescription":"No pending requests at this time","reviewRequests":"Review Requests","inviteUsers":"Invite Users","inviteDescription":"Send invitations to new team members","invitations":"Invitations","memberRoles":"Member Roles","rolesDescription":"Manage team member permissions","manageRoles":"Manage Roles"},"roster":{"title":"Roster Management","playersCount":"{{count}} players","addPlayer":"Add Player","loadingRoster":"Loading roster...","showFormer":"Show Former Players","hideFormer":"Hide Former Players","noPlayersYet":"No Players Yet","buildRoster":"Start building your team roster by adding players.","addFirstPlayer":"Add First Player","noActivePlayers":"No active players found.","table":{"player":"Player","connectionStatus":"Connection Status","number":"#","actions":"Actions"},"ghost":{"from":"From {{provider}}","accept":"Accept","adding":"Adding...","dismiss":"Dismiss","dismissing":"Dismissing..."},"player":{"former":"Former","editTitle":"Edit player","loanTitle":"Record Loan","removeTitle":"Remove player"},"connection":{"connectedProviders":"Connected Providers:","matchedAs":"Matched as:","needsMatching":"Needs Matching","notMatched":"This player is not matched to any provider data yet.","matchPlayer":"Match Player"},"success":{"playerMatched":"Player successfully matched to attendance data","ghostAdded":"{{playerName}} added to roster","ghostDismissed":"{{playerName}} dismissed","playerDeactivated":"{{playerName}} has been deactivated but kept in records due to game history.","playerRemoved":"{{playerName}} has been removed from the roster.","loanRecorded":"{{playerName}} loan match recorded.","loanRecordedMultiple":"{{count}} players loan match recorded."},"error":{"loadFailed":"Failed to load team roster","addFailed":"Failed to add player to roster","dismissFailed":"Failed to dismiss player"}},"preferences":{"title":"Team Preferences","loadingPreferences":"Loading preferences...","matchSettings":"Match Settings","matchFormat":"Match Format","formation":"Formation","comingSoon":"Coming Soon","timeSettings":"Time Settings","periodLength":"Period Length (minutes)","numPeriods":"Number of Periods","period":"Period","periods":"Periods","substitutionSettings":"Substitution Settings","alternateRoles":"Alternate roles fairly over time","alternateRolesTooltip":{"title":"Fair Role Rotation","description":"When enabled, the app will suggest substitutions that ensure all players experience similar time in each role (defender, midfielder, attacker) over the course of the season."},"substitutionLogic":"Substitution Logic","substitutionOptions":{"equalTime":"Equal Time in Each Role","sameRole":"Keep Same Role"},"gameFeatures":"Game Features","trackGoalScorer":"Track Goal Scorers","fairPlayAward":"Fair Play Award","fairPlayOptions":{"none":"No Awards","leagueOnly":"Only League","competitive":"League, Cup and Tournament","allGames":"All Games"},"teamCaptain":"Team Captain","teamCaptainOptions":{"none":"No Team Captain","permanent":"Permanent Team Captain","assignEach":"Assign Each Match"},"permanentCaptain":"Permanent Team Captain","selectCaptain":"Select Team Captain","loadingPlayers":"Loading players...","addPlayersForCaptain":"Add players to your roster to choose a team captain.","statistics":"Statistics","loanMatchWeight":"Loan Match Weight","loanWeightOptions":{"full":"Full Match (1.0)","half":"Half Match (0.5)","none":"No Credit (0.0)"},"loanWeightDescription":"Controls how loan matches count toward season statistics.","unnamedPlayer":"Unnamed Player","previousCaptain":"Previously selected captain","errors":{"selectCaptain":"Please select a player to serve as the permanent team captain.","unsupportedFormat":"Only 5v5 and 7v7 formats are currently supported. Please select a supported format before saving.","saveFailed":"Failed to save preferences. Please try again.","loadFailed":"Failed to load preferences","loadRosterFailed":"Failed to load team roster"},"success":{"saved":"Preferences saved successfully"}}},"roleManagement":{"title":"Manage Team Roles","managePermissions":"Manage roles and permissions for {{count}} team member","managePermissionsPlural":"Manage roles and permissions for {{count}} team members","security":{"title":"Security Restrictions","cannotModifySelf":"You cannot modify your own role or remove yourself","adminProtected":"Admin roles are protected from modification by other admins","lastAdmin":"At least one admin must remain on the team"},"roles":{"admin":"Admin","adminDescription":"Full team management access","coach":"Coach","coachDescription":"Manage team and players","player":"Player","playerDescription":"Basic team member","parent":"Parent","parentDescription":"View team information"},"badges":{"you":"You","lastAdmin":"Last Admin"},"errors":{"coachCannotPromote":"Coaches cannot promote members to admin role","cannotModifySelf":"You cannot modify your own role","cannotModifyAdmin":"Admins cannot modify other admin roles","lastAdminDemotion":"Cannot demote the last admin. At least one admin must remain.","noChanges":"No changes to save","updateFailed":"Failed to update member roles","cannotRemoveSelf":"You cannot remove yourself from the team","cannotRemoveAdmin":"Admin users cannot be removed. Demote them first, then remove.","removeFailed":"Failed to remove team member"},"success":{"rolesUpdated":"Successfully updated {{count}} member role(s)","memberRemoved":"Successfully removed {{name}} from the team"},"pendingChange":"Role will change from {{from}} to {{to}}","unsavedChanges":"{{count}} unsaved change(s)","confirmRemove":"Are you sure you want to remove {{name}} from the team?","buttons":{"cancel":"Cancel","close":"Close","saving":"Saving...","saveChanges":"Save Changes"},"tooltips":{"cannotRemoveSelf":"Cannot remove yourself","cannotRemoveAdmin":"Cannot remove admin users","removeFromTeam":"Remove from team"},"noMembers":"No team members found","unknownUser":"Unknown User"},"deletePlayerModal":{"title":"Remove Player","subtitleDelete":"This player will be permanently deleted","subtitleDeactivate":"This player will be deactivated","status":{"active":"Active","inactive":"Inactive"},"warning":{"title":"Are you sure you want to remove this player?","permanentDelete":"permanently deleted","permanentDeleteFull":"Player has no game history and will be permanently deleted","cannotUndo":"This action cannot be undone","deactivated":"deactivated","deactivatedFull":"Player has game history and will be deactivated (set as inactive)"},"whatHappensNext":"What happens next","deleteConsequences":{"jerseyAvailable":"Jersey number will become available for other players"},"deactivateConsequences":{"statsPreserved":"All match statistics and history will be preserved","jerseyAvailable":"Jersey number will become available for other players","canReactivate":"Player can be reactivated later if needed"},"buttons":{"deletePlayer":"Delete Player","deactivatePlayer":"Deactivate Player","cancel":"Cancel"},"unknownPlayer":"Unknown Player"},"invitationNotification":{"title":"Team Invitations","closeLabel":"Close","successJoined":"Successfully joined {{teamName}}!","inviteDescription":"You have been invited to join a team. Choose to accept or decline each invitation below.","inviteDescriptionPlural":"You have been invited to join {{count}} teams. Choose to accept or decline each invitation below.","role":"Role: {{role}}","expires":"Expires: {{date}}","invitedBy":"Invited by {{name}}","buttons":{"declining":"Declining...","decline":"Decline","accepting":"Accepting...","accept":"Accept","decideLater":"I\'ll decide later"}},"clubAutocomplete":{"placeholder":"Search for your club...","createNewClub":"Create new club","noClubsFound":"No clubs found for \\"{{query}}\\""},"teamAutocomplete":{"placeholder":"Search for a team...","createNewTeam":"Create new team","noTeamsFound":"No teams found for \\"{{query}}\\""},"playerMatching":{"title":"Match Player to Provider","subtitle":"Link roster player to attendance data","rosterPlayer":"Roster Player","selectProvider":"Select a player from provider...","selectProviderLabel":"Match to Provider Player *","selectProviderHelp":"Select which player from the connected providers matches this roster player.","errors":{"selectPlayer":"Please select a player from the provider","matchFailed":"Failed to match player"},"buttons":{"cancel":"Cancel","matching":"Matching...","matchPlayer":"Match Player"}},"clubJoin":{"title":"Join Club","successTitle":"Successfully Joined!","successMessage":"You have joined {{clubName}}. You can now access teams within this club.","joinBenefitsTitle":"Join this club to:","benefits":{"accessTeams":"Access teams within the club","requestJoin":"Request to join existing teams","createTeams":"Create new teams for the club"},"buttons":{"cancel":"Cancel","joining":"Joining...","joinClub":"Join Club"}},"clubMembership":{"title":"Club Management","subtitle":"Manage your club memberships and discover new clubs","tabs":{"myClubs":"My Clubs","findClubs":"Find Clubs","requests":"Requests"},"myClubs":{"title":"My Clubs","empty":"You\'re not a member of any clubs yet","emptyHint":"Search for clubs to request membership","joined":"Joined {{date}}"},"search":{"title":"Find Clubs","placeholder":"Search for clubs...","searching":"Searching...","searchButton":"Search","resultsTitle":"Search Results","joined":"Joined","joinClub":"Join Club","noResults":"No clubs found matching \\"{{query}}\\"","noResultsHint":"Try a different search term or ask a club admin to invite you"},"requests":{"title":"Pending Requests","empty":"No pending membership requests","wantsToJoin":"wants to join {{clubName}}","requested":"Requested {{date}}","reject":"Reject","approve":"Approve"}},"teamSelector":{"title":"Select Your Team","newTeam":"New Team","current":"Current","availableTeams":"Available Teams ({{count}})","role":"Role: {{role}}","loading":"Loading teams...","noTeamsTitle":"No Teams Found","noTeamsMessage":"You don\'t have access to any teams yet. Create your first team to get started.","createOrJoin":"Create or Join a Team"},"teamMatches":{"title":"Team Matches","back":"Back","loading":"Loading matches...","error":{"loadFailed":"Failed to load matches","loadUpcomingFailed":"Failed to load upcoming matches","tryAgain":"Try Again","copyFailed":"Failed to copy link","deleteFailed":"Failed to delete pending match"},"empty":{"title":"No Active Matches","description":"Your team has no pending or running matches at the moment."},"states":{"running":"Running","pending":"Pending","upcoming":"Upcoming"},"notifications":{"linkCopied":"Link Copied","linkCopiedMessage":"Live match link copied to clipboard!","liveMatchUrl":"Live Match URL","couldNotCopy":"Could not copy link","error":"Error","matchDeleted":"Match Deleted","matchDeletedMessage":"Pending match deleted."},"timestamps":{"noDate":"No date","today":"Today at {{time}}","yesterday":"Yesterday at {{time}}","dateTbd":"Date TBD"},"buttons":{"resumeSetup":"Resume Setup","openLive":"Open Live","copying":"Copying...","copyLink":"Copy Link","deleting":"Deleting...","delete":"Delete","plan":"Plan"},"upcoming":{"title":"Upcoming Matches","description":"Future matches from connected schedules. Not planned yet.","notPlanned":"Not planned yet"},"planModal":{"title":"Plan Matches","cancel":"Cancel","planSelected":"Plan Selected"}},"planMatches":{"title":"Plan Matches","back":"Back","teamRequired":"Team context required.","noMatches":"No matches selected.","toolbar":{"sortByPractices":"Sort by practices per match","sortByAttendance":"Sort by attendance percentage","statsLoading":"Stats...","recommend":"Recommend"},"autoSelect":{"title":"Auto Select","squadSizeMulti":"Squad size per match","squadSizeSingle":"Squad size for this match","ensureCoverage":"Each player plays at least one match?","prioritizePractices":"Prioritize practices/match score","prioritizeAttendance":"Prioritize attendance %","cancel":"Cancel","apply":"Apply"},"matchCard":{"saving":"Saving...","saved":"Saved","save":"Save","roster":"Roster","selected":"Selected","empty":"Empty.","reset":"Reset"},"playerSelector":{"noPlayers":"No roster players.","markAvailable":"Mark available","markUnavailable":"Mark unavailable","providerUnavailable":"Unavailable (reported)","practicesTooltip":"Practices per match"},"notifications":{"noPlayersTitle":"No players selected","noPlayersMessage":"Select players before planning this match.","matchPlanned":"Match planned","pendingCreated":"Pending match created.","planningFailed":"Planning failed","planningFailedMessage":"Failed to plan match."},"unknownPlayer":"Unknown Player"},"accessRequestModal":{"header":{"title":"Team Access"},"tabs":{"request":"Request Access","manageRequests":"Manage Requests","teamManagement":"Team Management"},"request":{"header":{"title":"Request Team Access","subtitle":"Request to join"},"form":{"roleLabel":"Requested Role *","roleHint":"The team coach will review and assign your final role","messageLabel":"Message to Team Coach","messagePlaceholder":"Introduce yourself and explain why you\'d like to join this team...","characterCount":"{{count}}/500 characters","roles":{"coach":"Coach","parent":"Parent","admin":"Admin"}},"buttons":{"cancel":"Cancel","sending":"Sending...","sendRequest":"Send Request","close":"Close"},"success":{"submitted":"Request submitted successfully! The team admin will review your request."},"warnings":{"pendingTitle":"Request Pending","pendingMessage":"You already have a pending request for this team"},"yourRequests":{"title":"Your Requests","role":"Role: {{role}}","messageLabel":"Message:","reviewLabel":"Review:","cancel":"Cancel"},"status":{"pending":"pending","approved":"approved","rejected":"rejected"}},"manage":{"header":{"title":"Manage Team Requests","badgeAdmin":"Admin","badgeCoach":"Coach","subtitle":"Review access requests for","adminPrivileges":"You have full admin privileges for this team"},"empty":{"title":"No pending requests","description":"New team access requests will appear here"},"privacyNotice":"\ud83d\udce7 Email addresses are shown to help identify requesters and are only visible to team administrators.","request":{"unnamedUser":"Unnamed User","requestedRole":"Requested role:","messageLabel":"Message:","statusPending":"Pending","atTime":"at"},"buttons":{"reject":"Reject","approve":"Approve as {{role}}","rejectReason":"Request declined by team coach"},"members":{"title":"Team Members ({{count}})","empty":"No team members found","joined":"Joined {{date}}","remove":"Remove","cannotRemoveAdmin":"Cannot remove admin","removeMember":"Remove member","confirmRemove":"Are you sure you want to remove this member from the team?","removed":"Member removed from team"}},"success":{"requestApproved":"Request approved successfully"}},"errors":{"loadTeams":"Failed to load teams","loginRequired":"Must be logged in to continue","createClub":"Failed to create club","createTeam":"Failed to create team","teamNameExists":"A team with this name already exists in this club. Please request to join the existing team.","noTeamSelected":"No team selected","createPlayer":"Failed to create player","teamNotFound":"Team not found","initUserData":"Failed to initialize user data","checkClubMembership":"Failed to check club membership","alreadyClubMember":"You are already a member of this club","joinClub":"Failed to join club","clubMembershipNotFound":"Club membership not found","loginRequiredLeaveClub":"Must be logged in to leave club","leaveClub":"Failed to leave club","teamMembershipNotFound":"Team membership not found","loginRequiredLeaveTeam":"Must be logged in to leave team","leaveTeam":"Failed to leave team","loginRequiredDeleteTeam":"Must be logged in to delete team","deleteTeam":"Failed to delete team","approveClubMembership":"Failed to approve club membership","rejectClubMembership":"Failed to reject club membership","loginRequiredInvite":"Must be authenticated to send invitations","noPermissionInvite":"You do not have permission to invite users to this team","coachCannotInviteAdmin":"Coaches cannot invite users as administrators","sendInvitation":"Failed to send invitation","cancelInvitation":"Failed to cancel invitation","loginRequiredAccept":"Must be authenticated to accept invitations","acceptInvitation":"Failed to accept invitation","loadInvitations":"Failed to load pending invitations","loginRequiredDecline":"Must be authenticated to decline invitations","declineInvitation":"Failed to decline invitation","loginRequiredRefresh":"Must be authenticated to refresh invitations","refreshInvitation":"Failed to refresh invitation","loginRequiredDelete":"Must be authenticated to delete invitations","deleteInvitation":"Failed to delete invitation","pendingRequestExists":"You already have a pending request for this team. Please wait for the current request to be reviewed, or cancel it first to submit a new one.","requestTeamAccess":"Failed to request team access","fetchRequestDetails":"Failed to fetch request details","addUserToTeam":"Failed to add user to team","updateRequestStatus":"Failed to update request status","approveTeamAccess":"Failed to approve team access","rejectTeamAccess":"Failed to reject team access","cancelRequest":"Failed to cancel request","updateMemberRole":"Failed to update member role","removeTeamMember":"Failed to remove team member","genericError":"An unexpected error occurred","loginRequiredCreateTeam":"User must be authenticated to create a team","loginRequiredCreateClub":"Must be logged in to create club"},"context":{"invitationSentTo":"Invitation sent successfully to {{email}}","welcomeToTeam":"Welcome to the team! You have been successfully added.","invitationDeclined":"Invitation declined successfully","invitationDeleted":"Invitation deleted successfully","teamFallbackName":"Team","teamAdminFallback":"Team Admin"}}'),_e=JSON.parse('{"multiSelect":{"allSelected":"All selected","selected":"selected","noOptions":"No options available","clearSelection":"Clear selection","done":"Done"},"badges":{"comingSoon":"Coming Soon","new":"New","beta":"Beta"},"loading":"Loading...","error":"An error occurred","retry":"Retry","close":"Close","ok":"OK","back":"Back","inactive":"Inactive","opponent":"Opponent","user":"User"}'),Ce=JSON.parse('{"abandonMatch":{"titleRunning":"Abandon Active Match?","titleNotRunning":"Start New Game?","messageRunning":"You have an active match in progress. All match data, player statistics, and game history will be permanently lost if you start a new game.","messageNotRunning":"This will reset your current session and take you back to the configuration screen.","subtitleRunning":"Data will be permanently lost","subtitleNotRunning":"Current session will be reset","cancel":"Cancel","abandonMatch":"Abandon Match","startNewGame":"Start New Game"},"matchRecovery":{"title":"Save Match?","subtitle":"Found a finished match that wasn\'t saved","matchDetails":"Match Details","unknownDate":"Unknown date","unknownDuration":"Unknown duration","unknown":"Unknown","wonScore":"Won {{score}}","lostScore":"Lost {{score}}","drewScore":"Drew {{score}}","vsOpponent":"vs {{opponent}}","formatInfo":"Format: {{format}} \u2022 Formation: {{formation}}","explanation":"This match was completed but not saved to your match history. You can either save it now to preserve the statistics, or delete it permanently.","savingMatch":"Saving Match...","saveToHistory":"Save to Match History","deletingMatch":"Deleting Match...","deleteMatchPermanently":"Delete Match Permanently","tip":"Saving to history preserves player statistics and performance data"},"pendingMatchResume":{"title":"Resume Match Setup","noMatchesFound":"No saved matches found","matchesFound":"{{count}} saved match found","matchesFound_other":"{{count}} saved matches found","noPendingMatches":"No Pending Matches","noPendingDescription":"You don\'t have any saved match configurations.","continueToConfigureNew":"Continue to Configure New Match","vsOpponent":"vs {{opponent}}","unknownOpponent":"Unknown Opponent","createdBy":"Created by {{name}}","typeLabel":"Type:","formatLabel":"Format:","periodsFormat":"{{periods}} \xd7 {{duration}} min periods","squadLabel":"Squad:","squadInfo":"{{size}} players, {{formation}} formation","resuming":"Resuming...","resumeSetup":"Resume Setup","deleting":"Deleting...","delete":"Delete","configureNewMatch":"Configure New Match","cancel":"Cancel","tip":"Resume Setup takes you to the Configuration Screen where you can review and modify settings","processing":"Processing...","dateAtTime":"{{date}} at {{time}}","unknownFormation":"Unknown"},"addPlayer":{"title":"Add Player","message":"Choose how you\'d like to add a player.","addToTeam":"Add Player to Team","addTemporary":"Add Temporary Player","cancel":"Cancel"},"addTemporaryPlayer":{"title":"Add Temporary Player","description":"This player will only appear in the current match and won\'t be added to the team roster.","playerNameLabel":"Player Name","playerNamePlaceholder":"Enter player name","cancel":"Cancel","addPlayer":"Add Player"},"goalScorer":{"title":"Who Scored?","selectPlayer":"Select the player who scored","noPlayers":"No eligible players","cancel":"Cancel","correctGoalScorer":"Correct Goal Scorer","goalInformation":"Goal Information","goalAt":"Goal at {{time}}","scoredGoalAt":"Scored goal at {{time}}","concededGoalAt":"Conceded goal at {{time}}","updateScorer":"Update Scorer","confirmScorer":"Confirm Scorer","currentScorer":"Current Scorer","noScorerRecorded":"No scorer recorded","selectNewScorer":"Select New Scorer:","selectScorer":"Select Scorer:","noSpecificScorer":"No specific scorer","goalDetails":"Goal Details:","team":"Team","scored":"Scored","conceded":"Conceded","time":"Time","period":"Period","scorer":"Scorer","unknown":"Unknown","readOnlyNotice":"This goal information is read-only. Use the correction mode to make changes."},"fieldPlayer":{"title":"Field Player Options","changePositionTitle":"Change Position","message":"What would you like to do with {{playerName}}?","selectPositionSwitch":"Select which player to switch positions with {{playerName}}:","cancel":"Cancel","back":"Back","removeFromNext":"Remove from next to go off","setToGoOffNext":"Set to go off next","substituteNow":"Substitute now","changePosition":"Change position","tooltipCannotModify":"All substitutes are inactive - cannot modify rotation","tooltipCannotSetNext":"All substitutes are inactive - cannot set as next","tooltipCannotSubstitute":"All substitutes are inactive - cannot substitute"},"substitute":{"title":"Substitute Options","changeNextPositionTitle":"Change Next Position","message":"What would you like to do with {{playerName}}?","selectNextPosition":"Select which position {{playerName}} should take when coming in:","cancel":"Cancel","back":"Back","changeNextPosition":"Change next position","setToGoInNext":"Set to go in next","putBackInRotation":"Put {{playerName}} back into rotation","takeOutOfRotation":"Take {{playerName}} out of rotation"},"goalie":{"title":"Replace Goalie","message":"Select a new goalie to replace {{goalieName}}:","cancel":"Cancel","inactive":"(Inactive)"},"scoreEdit":{"title":"Edit Score","cancel":"Cancel","saveScore":"Save Score"},"scoreManager":{"title":"Manage Score","goalsScored":"Goals Scored","noGoalsRecorded":"No goals recorded yet","opponent":"Opponent","edit":"Edit","delete":"Delete","addGoal":"Add Goal","close":"Close","unknownScorer":"Unknown scorer","scorerNotTracked":"Scorer not tracked"},"substituteSelection":{"title":"Select Substitute","message":"Select which substitute to bring on for {{fieldPlayerName}}:","cancel":"Cancel"},"preferences":{"title":"Preferences","loadingPreferences":"Loading preferences...","substitutionAlerts":"Substitution Alerts","enableAudioAlerts":"Enable Audio Alerts","enableAudioDescription":"Play sound when substitution timer reaches alert time","disableAudioLabel":"Disable audio alerts","enableAudioLabel":"Enable audio alerts","alertSound":"Alert Sound","loadingSound":"Loading sound...","previewSound":"Preview selected sound","unableToPreview":"Unable to preview sound: {{error}}","playingPreview":"Playing preview...","volume":"Volume","noteLabel":"Note:","audioNote":"Audio alerts work alongside vibration alerts. If your browser blocks audio playback, only vibration will be used. The alert timing is configured in the game setup screen.","language":"Language","applicationLanguage":"Application Language","moreLanguages":"More languages coming soon!","uiTheme":"UI Theme","colorTheme":"Color Theme","moreThemes":"More themes coming soon!","cancel":"Cancel","saveChanges":"Save Changes"},"featureVote":{"voteRecorded":"Vote Recorded!","voteAlreadyRecorded":"Vote Already Recorded","voteFailed":"Vote Failed","featureComingSoon":"Feature Coming Soon!","featureDescription":"The \\"{{featureName}}\\" formation is not yet implemented. You can vote for it to be prioritized.","close":"Close","cancel":"Cancel","signInToVote":"Sign In to Vote","submitting":"Submitting...","voteFor":"Vote for {{featureName}}"},"confirmations":{"areYouSure":"Are you sure?","cannotUndo":"This action cannot be undone.","confirm":"Confirm","cancel":"Cancel"},"endPeriodEarly":{"title":"End Period Early?","message":"There are still {{timeString}} remaining in this period. Are you sure you want to end the period early?"},"signOutDuringMatch":{"title":"Sign Out During Active Match?","message":"You have a match currently running. Signing out now may stop tracking this match. Are you sure you want to sign out?","confirmSignOut":"Sign Out","cancelStayLoggedIn":"Stay Logged In"},"unableToSaveMatch":{"title":"Unable to Save Match","retrying":"Retrying...","retry":"Retry","continueWithoutSaving":"Continue without saving"},"newGame":{"title":"Start a new game?","message":"Are you sure you want to start a new game? This will reset all progress and take you back to the configuration screen.","stayOnPage":"Stay on page","yesStartNewGame":"Yes, start new game","leaveSportWizard":"Leave Sport Wizard"}}'),Me=JSON.parse('{"header":{"title":"Match Report","noStartTime":"No start time recorded","durationUnknown":"Duration unknown"},"navigation":{"summary":"Summary","timeline":"Timeline","playerStats":"Player Stats"},"timeline":{"title":"Game Events","noEvents":"No events recorded","toggleSubstitutions":"Substitutions","eventTypes":{"goal":"Goal","substitution":"Substitution","periodStart":"Period Start","periodEnd":"Period End"}},"playerStats":{"title":"Player Statistics","name":"Player","playingTime":"Playing Time","goals":"Goals","position":"Position","timeAsGoalie":"Time as Goalie","timeAsDefender":"Time as Defender","timeAsMidfielder":"Time as Midfielder","timeAsAttacker":"Time as Attacker","noStats":"No player statistics available"},"table":{"columns":{"player":"Player","startingRole":"Starting Role","outfield":"Outfield","defender":"Defender","midfielder":"Midfielder","attacker":"Attacker","goalie":"Goalie","substitute":"Substitute","goals":"Goals"},"roles":{"goalie":"Goalie","defender":"Defender","midfielder":"Midfielder","attacker":"Attacker","substitute":"Sub","field":"Field","none":"--"},"noStats":"No player statistics available"},"summary":{"finalScore":"Final Score","duration":"Duration","periods":"Periods","totalGoals":"Total Goals","ourGoals":"Our Goals","opponentGoals":"Opponent Goals"},"events":{"matchStarted":"Match started","matchEnded":"Match ended","periodStarted":"Period {{period}} started","periodEnded":"Period {{period}} ended","goalScoredWithScore":"{{ownScore}}-{{opponentScore}} {{team}} Scored","goalFor":"Goal for {{team}} - {{scorer}}","goalForTeam":"Goal for {{team}}","unknownScorer":"Unknown scorer","substitution":"Substitution","out":"Out","in":"In","unknown":"Unknown","unknownPlayer":"Unknown player","unknownPosition":"Unknown position","from":"from","newGoalie":"New goalie","oldGoalie":"Old goalie","leavesGoal":"leaves goal","otherSwitches":"Other switches","playerIsGoalie":"{{name}} is goalie","goalieAssigned":"Goalie assigned","positionSwitch":"Position switch","positionChange":"Position change","playerInactivated":"{{name}} inactivated","playerActivated":"{{name}} re-activated","fairPlayAward":"Fair Play Award","timerPaused":"Timer paused","timerResumed":"Timer resumed","periodPaused":"Period paused","periodResumed":"Period resumed","intermission":"Intermission","goalCorrected":"Goal corrected","goalUndone":"Goal undone","substitutionUndone":"Substitution undone","technicalTimeout":"Technical timeout","undone":"UNDONE","clickToEditScorer":"Click to edit scorer"},"details":{"period":"Period","score":"Score","awardedTo":"Awarded to","undone":"Undone","userAction":"user action","undoneAt":"Undone at","relatedTo":"Related to","positionChanges":"Position changes","startingPositions":"Starting positions"},"controls":{"eventCount":"{{count}} events","player":"Player","allPlayers":"All Players","newestFirst":"Newest first","oldestFirst":"Oldest first","periodLabel":"Period {{period}}"}}'),Pe=JSON.parse('{"section":{"title":"External Connectors","description":"Connect to external platforms to sync your roster"},"card":{"connected":"Connected","disconnected":"Not Connected","verifying":"Verifying...","error":"Connection Error","retrying":"Retrying...","connect":"Connect","disconnect":"Disconnect","configure":"Configure"},"sportAdmin":{"title":"SportAdmin","description":"Sync your team roster from SportAdmin","modal":{"title":"Connect to SportAdmin","email":"SportAdmin Email","emailPlaceholder":"Enter your SportAdmin email","password":"SportAdmin Password","passwordPlaceholder":"Enter your SportAdmin password","teamId":"Team ID","teamIdPlaceholder":"Enter your SportAdmin team ID","connect":"Connect","cancel":"Cancel","connecting":"Connecting..."}},"disconnect":{"title":"Disconnect {{provider}}?","subtitle":"This will stop automatic synchronization","confirmMessage":"Are you sure you want to disconnect {{provider}}?","warningAutoSync":"Automatic data synchronization will stop","warningCredentials":"Stored credentials will be removed","reassureData":"Existing attendance and match data will be preserved","reassureReconnect":"You can reconnect at any time","disconnecting":"Disconnecting...","disconnect":"Disconnect","cancel":"Cancel","errorFallback":"Failed to disconnect provider"},"status":{"syncing":"Syncing roster...","lastSync":"Last synced: {{time}}","neverSynced":"Never synced","syncSuccess":"Roster synced successfully","syncError":"Failed to sync roster"},"sportAdminConnect":{"header":{"title":"Connect SportAdmin","subtitle":"Sync attendance and match data"},"info":{"description":"Enter your SportAdmin credentials to enable automatic synchronization.","security":"Your credentials will be encrypted and stored securely."},"form":{"labels":{"username":"Username","password":"Password"},"placeholders":{"username":"Your SportAdmin username","password":"Your SportAdmin password"}},"validation":{"usernameRequired":"Username is required","usernameMaxLength":"Username must be 100 characters or less","passwordRequired":"Password is required","passwordMaxLength":"Password must be 200 characters or less","connectionFailed":"Failed to connect SportAdmin. Please check your credentials and try again."},"buttons":{"connect":"Connect","connecting":"Connecting...","cancel":"Cancel"}},"connectorsSection":{"title":"Connectors","infoBanner":"Connect external team management platforms to automatically sync practice attendance and match schedules.","loadingConnectors":"Loading connectors...","connectedProviders":"Connected Providers","availableProviders":"Available Providers","connected":"Connected","connect":"Connect","dismiss":"Dismiss","connectedSuccess":"SportAdmin connected successfully! Verification in progress (takes up to 5 minutes)...","syncStarted":"Sync started successfully!","disconnectedSuccess":"Provider disconnected successfully!","retryingConnection":"Retrying connection...","immediateSyncFailed":"Immediate sync failed, will run on schedule."},"onboarding":{"syncTitle":"Sync Players from External Platforms","syncDescription":"Connect to your team management platform to automatically sync your roster and practice attendance."},"unmappedBanner":{"title":"Players Available to Match","description":"You have unmapped players from {{providerName}} waiting to be matched to your roster."},"providerLogo":{"fallbackLabel":"Connector","logoAlt":"{{providerName}} logo","logoPlaceholder":"{{label}} logo placeholder"},"connectorCard":{"lastVerified":"Last verified:","lastSync":"Last sync:","never":"Never","connectionCreated":"Connection Created","errorPrefix":"Error:","connectionError":"Connection Error","buttons":{"retryConnection":"Retry Connection","manualSync":"Manual Sync","syncing":"Syncing...","disconnect":"Disconnect"}},"providers":{"sportadmin":{"description":"Swedish team management platform","features":{"practiceAttendance":"Practice Attendance","upcomingMatches":"Upcoming Matches"}},"svenska_lag":{"description":"Swedish team management platform","features":{"comingSoon":"Coming Soon"}},"myclub":{"description":"Team management platform","features":{"comingSoon":"Coming Soon"}}},"statusLabels":{"connected":"Connected","verifying":"Verifying","error":"Error","disconnected":"Disconnected","unknown":"Unknown"},"syncStatusLabels":{"completed":"Completed","running":"Running","waiting":"Waiting","retrying":"Retrying","failed":"Failed","cancelled":"Cancelled","unknown":"Unknown"}}'),Ee=JSON.parse('{"screen":{"title":"Tactical Board","instructions":"Drag and drop players and chips to plan your tactics"},"controls":{"back":"Back","undo":"Undo","clear":"Clear","clearAll":"Clear All","drag":"Drag","draw":"Draw","full":"Full","half":"Half"},"palette":{"title":"Chips","players":"Players","ball":"Ball","cones":"Cones","clear":"Clear Board","dragInstruction":"Drag chips onto the pitch \u2022 Double-tap to delete","drawModeHint":"Switch back to Drag mode to add or move chips."},"chip":{"player":"Player","ball":"Ball","cone":"Cone"}}'),Ie=JSON.parse('{"screen":{"title":"Live Match","spectatorView":"Spectator View","loading":"Loading match...","notFound":"Match not found","ended":"This match has ended"},"status":{"waitingToStart":"Waiting for match to start","inProgress":"Match in progress","paused":"Paused","ended":"Ended","matchNotStarted":"Match Not Started","liveMatch":"LIVE Match","matchFinished":"Match Finished"},"info":{"period":"Period {{number}}","periodWithMinute":"Period {{period}} - {{minute}}\'","score":"Score","time":"Time","lastUpdated":"Last updated: {{time}}","loadingEvents":"Loading match events...","errorLoadingMatch":"Error Loading Match","noEventsFound":"No match events found","matchSummary":"Match Summary","gameEvents":"Game Events","substitutions":"Substitutions"}}'),Re=JSON.parse('{"back":"Back","backTo":{"setup":"Back to Setup","matchHistory":"Back to Match History","signIn":"Back to Sign In"},"goTo":{"rosterManagement":"Go to Roster Management","connectors":"Go to Connectors"},"return":{"toApp":"Return to app"},"menu":{"ariaLabel":"Menu","profile":"Profile","preferences":"Preferences","teamManagement":"Team Management","createTeam":"Create Team","teamMatches":"Team Matches","statistics":"Statistics","tacticalBoard":"Tactical Board","addPlayer":"Add Player","getLiveMatchLink":"Get Live Match Link","newGame":"New Game","signIn":"Sign In","signOut":"Sign Out","createAccount":"Create Account","signInToUnlock":"Sign in to unlock:","cloudSync":"Cloud Sync"},"liveMatchLink":{"linkCopied":"Link Copied","linkCopiedMessage":"Live match link copied to clipboard!","liveMatchUrl":"Live Match URL","error":"Error","errorMessage":"Failed to generate live match link"}}'),Oe=JSON.parse('{"buttons":{"save":"Spara","cancel":"Avbryt","delete":"Ta bort","edit":"Redigera","add":"L\xe4gg till","close":"St\xe4ng","confirm":"Bekr\xe4fta"},"alerts":{"noAlerts":"Inga varningar"},"errors":{"invalidMatchId":"Ogiltigt match-ID","unknownView":"Ok\xe4nd vy","unknownPlayer":"Ok\xe4nd Spelare","supabaseConfigMissing":"Supabase-konfiguration saknas. Kontrollera milj\xf6variablerna.","failedToLoadPlayerStats":"Kunde inte ladda spelarstatistik","failedToLoadMatchDefaults":"Kunde inte ladda matchinst\xe4llningar.","failedToLoadOpponentNames":"Kunde inte ladda tidigare motst\xe5ndarnamn.","matchCreationFailed":"Kunde inte skapa match: Saknar matchidentifierare fr\xe5n databassvaret.","playerStatsUpdateFailed":"Kunde inte uppdatera spelarstatistik","matchUpdateFailed":"Matchuppdatering misslyckades: Matchen \xe4r inte aktiv eller hittades inte","matchNotFinished":"Matchen m\xe5ste vara avslutad innan uppdateringar kan till\xe4mpas.","fairPlayAwardFailed":"Kunde inte tilldela fair play-utm\xe4rkelse f\xf6r denna match.","fairPlayNoStats":"Ingen spelarstatistik uppdaterades med fair play-utm\xe4rkelsen. S\xe4kerst\xe4ll att spelaren deltog i matchen.","matchNotFound":"Match hittades inte","configRequired":"Startkonfiguration kr\xe4vs","matchNotFoundOrDeleted":"Match hittades inte eller \xe4r redan borttagen","invalidPlayerStats":"Spelarstatistik m\xe5ste vara en lista","noValidPlayerStats":"Ingen giltig spelarstatistik att uppdatera","loanPlayerRequired":"Minst en spelare kr\xe4vs","loanTeamNameRequired":"Mottagande lagnamn kr\xe4vs","loanTeamNameTooLong":"Mottagande lagnamn f\xe5r vara max 200 tecken","loanDateRequired":"Utl\xe5ningsdatum kr\xe4vs","loanRecordFailed":"Kunde inte registrera spelarutl\xe5ning","noTeamSelected":"Inget lag valt. Skapa eller v\xe4lj ett lag f\xf6rst.","matchSavedSuccess":"Matchen sparades i din historik!","failedToLoadAttendanceStats":"Kunde inte ladda n\xe4rvarostatistik","failedToLoadConnectors":"Kunde inte ladda kopplingar","failedToConnectProvider":"Kunde inte ansluta leverant\xf6r","failedToDisconnectProvider":"Kunde inte koppla bort leverant\xf6r","failedToTriggerSync":"Kunde inte starta synkronisering","failedToRetryConnector":"Kunde inte f\xf6rs\xf6ka ansluta igen","validationFailed":"Validering misslyckades","unexpectedError":"Ett ov\xe4ntat fel uppstod. F\xf6rs\xf6k igen."},"footer":{"copyright":"\xa9 {{year}} Coach App av Codewizard"}}'),De=JSON.parse('{"header":{"title":"Matchkonfiguration"},"squad":{"selectTitle":"V\xe4lj Trupp (5-15 Spelare) - Valda: {{count}}","addPlayerTitle":"L\xe4gg till Spelare i Ditt Lag","selectAll":"V\xe4lj alla","allSelected":"Alla Valda","addPlayer":"L\xe4gg till Spelare","temporaryLabel":"(Tillf\xe4llig)","noPlayers":{"title":"Inga Spelare Tillagda \xc4n","description":"Din laglista \xe4r tom. L\xe4gg till spelare f\xf6r att b\xf6rja st\xe4lla in ditt spel."},"exceededFormat":"Du har valt {{count}} spelare, vilket \xf6verstiger {{format}}-gr\xe4nsen p\xe5 {{max}}. Uppdatera matchformatet eller justera truppen."},"matchDetails":{"opponentLabel":"Motst\xe5ndare","opponentPlaceholder":"Ange motst\xe5ndarlags namn (valfritt)","matchTypeLabel":"Matchtyp","venueLabel":"Arena","opponentSuggestions":{"ariaLabel":"Tidigare motst\xe5ndarf\xf6rslag","noMatches":"Inga tidigare motst\xe5ndare matchar \\"{{query}}\\""}},"gameSettings":{"periodsLabel":"Antal Perioder","durationLabel":"Periodl\xe4ngd (minuter)","alertLabel":"Bytesnotis"},"formation":{"header":"Matchformat & Formation","formatLabel":"Matchformat","formationLabel":"Spelsystem","formatExceeded":"Du har valt {{count}} spelare, vilket \xf6verstiger {{format}}-gr\xe4nsen p\xe5 {{max}}. Uppdatera matchformatet eller justera truppen innan du konfigurerar formationer.","comingSoonSuffix":"(Kommer snart - V\xe4lj f\xf6r att r\xf6sta fram)"},"goalies":{"header":"M\xe5lvakter","periodLabel":"Period {{period}} M\xe5lvakt","placeholder":"V\xe4lj M\xe5lvakt"},"captain":{"header":"Kapten","label":"Lagkapten","hint":"V\xe4lj en lagkapten f\xf6r denna match","noCaptain":"Ingen Kapten"},"buttons":{"saveConfig":"Spara","savingConfig":"Sparar...","getLiveLink":"Live Match-l\xe4nk","creatingLink":"Skapar L\xe4nk...","proceedToPeriod":"Forts\xe4tt","randomize":"\ud83c\udfb2 Slumpa Konfiguration (Debug)"},"sync":{"syncing":"Synkroniserar laglista...","syncSuccess":"\u2705 {{message}}","syncFailed":"Synkronisering misslyckades: {{error}}","syncError":"Synkroniseringsfel: {{error}}"},"addPlayerModal":{"title":"L\xe4gg till Spelare","message":"V\xe4lj hur du vill l\xe4gga till en spelare.","addToTeam":"L\xe4gg till Spelare i Laget","addTemporary":"L\xe4gg till Tillf\xe4llig Spelare","cancel":"Avbryt"},"liveLinkNotifications":{"authRequired":"Autentisering Kr\xe4vs","authRequiredMessage":"Du m\xe5ste vara inloggad med ett lag f\xf6r att dela en live match-l\xe4nk.","creating":"Skapar live match-l\xe4nk...","linkCopied":"L\xe4nk Kopierad!","linkCopiedMessage":"Live match-l\xe4nk kopierad till urklipp!","liveMatchUrl":"Live Match-URL","failed":"Misslyckades med att skapa live match-l\xe4nk","failedWithError":"Misslyckades med att skapa live match-l\xe4nk: {{error}}"},"matchTypes":{"league":{"label":"Serie","description":"Officiell seriematch"},"friendly":{"label":"Tr\xe4ningsmatch","description":"Tr\xe4ningsmatch eller v\xe4nskapsmatch"},"cup":{"label":"Cup","description":"Turnering eller cupmatch"},"tournament":{"label":"Turnering","description":"Turneringsmatch eller slutspel"},"internal":{"label":"Internmatch","description":"Intern tr\xe4ningsmatch"}},"venueTypes":{"home":{"label":"Hemma","description":"Matchen spelas p\xe5 hemmaplan med bekanta omgivningar."},"away":{"label":"Borta","description":"Matchen spelas p\xe5 motst\xe5ndarens arena."},"neutral":{"label":"Neutral","description":"Matchen spelas p\xe5 neutral plan f\xf6r b\xe5da lagen."}},"pendingMatch":{"errors":{"checkFailed":"Misslyckades med att kontrollera p\xe5g\xe5ende matcher. Kontrollera din internetanslutning och f\xf6rs\xf6k igen.","title":"Misslyckades med att Kontrollera P\xe5g\xe5ende Matcher","retrying":"F\xf6rs\xf6ker igen...","tryAgain":"F\xf6rs\xf6k Igen"}},"teamBanner":{"label":"Lag: {{clubName}} {{teamName}}"},"cloudSync":{"available":"Molnsynkronisering Tillg\xe4nglig","description":"H\xe5ll din data s\xe4ker p\xe5 alla enheter","featureDescription":"Spara ditt lag, konfigurationer och matchdata. Kom \xe5t din data fr\xe5n vilken enhet som helst och l\xe5s upp s\xe4songsstatistik."},"dataMigration":{"title":"Migrera Lokal Data","description":"Vi hittade matchhistorik sparad lokalt. Vill du synkronisera den till ditt molnkonto?","migrating":"Migrerar...","migratingFull":"Migrerar lokal data till molnet...","migrateButton":"Migrera Data","laterButton":"Senare","failed":"Migrering misslyckades","failedWithError":"Migrering misslyckades: {{error}}"},"saveConfig":{"saving":"Sparar konfiguration...","savedSuccess":"{{message}}","savedSuccessDefault":"Konfiguration sparad","errors":{"failed":"Misslyckades med att spara konfiguration","failedWithMessage":"Misslyckades med att spara konfiguration: {{error}}","noMatchId":"Inget match-ID returnerades fr\xe5n sparoperationen"}},"positionRecommendations":{"title":"Rekommenderade Startpositioner","timeframe":"Senaste 6 m\xe5naderna","loading":"Ber\xe4knar positionsrekommendationer...","error":"Kan inte ber\xe4kna positionsrekommendationer.","description":"R\xe4ttvisa positionstilldelningar baserat p\xe5 senaste rollf\xf6rdelning.","noRecommendations":"Inga positionsrekommendationer tillg\xe4ngliga.","unknown":"Ok\xe4nd","dismiss":"Avf\xe4rda","acceptAll":"Acceptera Alla","reasons":{"noMatchHistory":"Ingen matchhistorik","roleTimePercentage":"{{percentage}}% {{role}}-tid"}},"formationVoting":{"description":"Genom att r\xf6sta hj\xe4lper du oss att prioritera vilka formationer vi ska bygga h\xe4rn\xe4st. Endast en r\xf6st per anv\xe4ndare och formation r\xe4knas.","errors":{"loginRequired":"Du m\xe5ste vara inloggad f\xf6r att r\xf6sta p\xe5 formationer","submitFailed":"Misslyckades skicka r\xf6st. F\xf6rs\xf6k igen.","voteSubmissionFailed":"Misslyckades registrera r\xf6st"},"messages":{"duplicateVote":"Du har redan r\xf6stat p\xe5 {{formation}}-formationen i {{format}}-format.","voteRecorded":"Din r\xf6st f\xf6r {{formation}}-formationen har registrerats!"}},"formationPreview":{"formations":{"2-2":{"name":"2-2 Formation","description":"2 backar, 2 forwards"},"1-2-1":{"name":"1-2-1 Formation","description":"1 back, 2 mittf\xe4lt, 1 forward"},"2-2-2":{"name":"2-2-2 Formation","description":"2 backar, 2 mittf\xe4lt, 2 forwards"},"2-3-1":{"name":"2-3-1 Formation","description":"2 backar, 3 mittf\xe4lt, 1 forward"}},"positions":{"leftAttacker":"V\xe4nsterforward","rightAttacker":"H\xf6gerforward","attacker":"Forward","leftDefender":"V\xe4nsterback","rightDefender":"H\xf6gerback","defender":"Back","leftMid":"V\xe4nster Mitt","rightMid":"H\xf6ger Mitt","leftMidfielder":"V\xe4nster Mittf\xe4lt","rightMidfielder":"H\xf6ger Mittf\xe4lt","centerMidfielder":"Mittf\xe4lt Center","goalie":"M\xe5lvakt"},"roles":{"defenders":"Backar","defender":"Back","attackers":"Forwards","attacker":"Forward","midfielders":"Mittf\xe4lt"}},"periodSetup":{"header":{"title":"Period {{period}} Laguppst\xe4llning"},"score":{"title":"Nuvarande St\xe4llning","opponent":"Motst\xe5ndare"},"substituteRecommendations":{"title":"Rekommenderade Avbytare","timeframe":"Senaste 6 m\xe5naderna","loading":"Laddar rekommendationer f\xf6r avbytare...","error":"Kan inte ladda rekommendationer f\xf6r avbytare just nu.","description":"Spelare som s\xe4llan startat som avbytare nyligen. \xd6verv\xe4g att ge dem en start som avbytare.","noEligible":"Inga avbytare att rekommendera.","dismiss":"Avf\xe4rda","accept":"Acceptera"},"goalie":{"header":"M\xe5lvakt f\xf6r Period {{period}}","headerInactive":"M\xe5lvakt f\xf6r Period {{period}} (Inaktiv - beh\xf6ver aktiveras)","placeholder":"V\xe4lj M\xe5lvakt f\xf6r denna Period"},"saveStatus":{"saving":"Sparar periodkonfiguration...","success":"\u2705 {{message}}","error":"\u274c {{message}}","defaultSuccess":"Periodkonfiguration sparad","defaultError":"Misslyckades med att spara periodkonfiguration"},"buttons":{"enterGame":"Starta Match","saveConfig":"Spara Konfiguration","saving":"Sparar...","backToConfig":"Tillbaka till Konfiguration","randomize":"\ud83c\udfb2 Slumpa Formation (Debug)"},"modals":{"inactiveGoalie":{"title":"Inaktiv M\xe5lvakt Uppt\xe4ckt","message":"{{playerName}} \xe4r inaktiv men vald som m\xe5lvakt f\xf6r n\xe4sta period. Vill du forts\xe4tta med {{playerName}} som m\xe5lvakt?","confirm":"Aktivera & Forts\xe4tt","cancel":"V\xe4lj Annan M\xe5lvakt"},"recommendationRerun":{"title":"K\xf6r Om Formationsrekommendationer?","message":"Du har bytt m\xe5lvakt fr\xe5n {{formerGoalie}} till {{newGoalie}}. Vill du k\xf6ra om formationsrekommendationerna med den nya m\xe5lvakten?","confirm":"Ja, K\xf6r Om Rekommendationer","cancel":"Nej, Beh\xe5ll Nuvarande Formation"},"activatePlayer":{"title":"Aktivera Spelare","message":"S\xe4tt tillbaka {{playerName}} i rotation?","confirm":"Aktivera","cancel":"Avbryt"}},"alerts":{"selectGoalieFirst":"V\xe4lj en m\xe5lvakt f\xf6rst innan du slumpar formationen.","noPlayersAvailable":"Inga spelare tillg\xe4ngliga f\xf6r positionering.","randomizeFailed":"Misslyckades med att generera slumpm\xe4ssig formation.","alreadyAssigned":"{{playerName}} \xe4r redan tilldelad. V\xe4lj en annan spelare."},"fallbacks":{"substituteTitle":"Avbytare","unknownPlayer":"Ok\xe4nd","selectPosition":"V\xe4lj {{title}}"},"positions":{"goalie":"M\xe5lvakt","leftDefender":"V\xe4nster","rightDefender":"H\xf6ger","leftAttacker":"V\xe4nster","rightAttacker":"H\xf6ger","defender":"Back","left":"V\xe4nster","right":"H\xf6ger","attacker":"Forward","leftMidfielder":"V\xe4nster","rightMidfielder":"H\xf6ger","centerMidfielder":"Mitt","substitute":"Avbytare"},"roleGroups":{"offence":"Anfall","midfield":"Mittf\xe4lt","defence":"F\xf6rsvar","substitutes":"Avbytare"}}}'),Fe=JSON.parse('{"authModal":{"titles":{"login":"Logga In","signup":"Skapa Konto","reset":"\xc5terst\xe4ll L\xf6senord","verify":"Verifiera E-post"},"closeModal":"St\xe4ng dialog"},"login":{"header":{"title":"V\xe4lkommen Tillbaka","subtitle":"Logga in p\xe5 ditt konto"},"form":{"emailLabel":"E-postadress","emailPlaceholder":"Ange din e-postadress","passwordLabel":"L\xf6senord","passwordPlaceholder":"Ange ditt l\xf6senord","submitButton":"Logga In","submittingButton":"Loggar In..."},"links":{"forgotPassword":"Gl\xf6mt ditt l\xf6senord?","noAccount":"Har du inget konto?","signUp":"Registrera dig"},"errors":{"unexpected":"Ett ov\xe4ntat fel uppstod. F\xf6rs\xf6k igen."}},"signup":{"header":{"title":"Skapa Konto","subtitle":"Kom ig\xe5ng med e-postverifiering"},"form":{"emailLabel":"E-postadress","emailPlaceholder":"Ange din e-postadress","passwordLabel":"L\xf6senord","passwordPlaceholder":"Skapa ett s\xe4kert l\xf6senord","passwordRequirements":"L\xf6senordet m\xe5ste vara minst 8 tecken l\xe5ngt","confirmPasswordLabel":"Bekr\xe4fta L\xf6senord","confirmPasswordPlaceholder":"Bekr\xe4fta ditt l\xf6senord","submitButton":"Skapa Konto","submittingButton":"Skapar Konto..."},"links":{"hasAccount":"Har du redan ett konto?","signIn":"Logga in"},"errors":{"unexpected":"Ett ov\xe4ntat fel uppstod. F\xf6rs\xf6k igen."}},"passwordReset":{"email":{"header":{"title":"\xc5terst\xe4ll L\xf6senord","subtitle":"Ange din e-postadress s\xe5 skickar vi en verifieringskod f\xf6r att \xe5terst\xe4lla ditt l\xf6senord"},"form":{"emailLabel":"E-postadress","emailPlaceholder":"Ange din e-postadress","submitButton":"Skicka E-post","submittingButton":"Skickar E-post..."},"info":{"title":"Vad h\xe4nder nu?","steps":["Vi skickar ett e-postmeddelande f\xf6r l\xf6senords\xe5terst\xe4llning till din adress","E-postmeddelandet inneh\xe5ller en 6-siffrig verifieringskod","Ange koden i verifieringsformul\xe4ret","V\xe4lj ett nytt l\xf6senord och bekr\xe4fta \xe4ndringen"]},"links":{"backToLogin":"Tillbaka till Inloggning"}},"code":{"success":{"title":"Kolla Din E-post","sentTo":"Vi har skickat ett e-postmeddelande f\xf6r l\xf6senords\xe5terst\xe4llning till","instructions":"Ange den 6-siffriga verifieringskoden fr\xe5n e-postmeddelandet nedan.","spamNote":"Ser du inte e-postmeddelandet? Kontrollera din skr\xe4ppost."},"form":{"codeLabel":"6-siffrig Verifieringskod","codePlaceholder":"Ange 6-siffrig kod","codeHint":"Kontrollera din e-post f\xf6r den 6-siffriga verifieringskoden","submitButton":"Verifiera Kod","submittingButton":"Verifierar Kod..."},"links":{"resend":"Skicka ytterligare e-post f\xf6r \xe5terst\xe4llning","close":"St\xe4ng"}},"update":{"header":{"title":"Ange Nytt L\xf6senord","subtitle":"V\xe4lj ett starkt l\xf6senord f\xf6r ditt konto"},"form":{"newPasswordLabel":"Nytt L\xf6senord","newPasswordPlaceholder":"Ange ditt nya l\xf6senord","confirmPasswordLabel":"Bekr\xe4fta Nytt L\xf6senord","confirmPasswordPlaceholder":"Bekr\xe4fta ditt nya l\xf6senord","submitButton":"Uppdatera L\xf6senord","submittingButton":"Uppdaterar L\xf6senord..."},"requirements":{"title":"L\xf6senordskrav:","items":["Minst 8 tecken l\xe5ngt","Anv\xe4nd en blandning av bokst\xe4ver, siffror och symboler","Undvik vanliga l\xf6senord eller personlig information"]},"success":{"title":"L\xf6senord Uppdaterat!","messageWithUser":"L\xf6senordet har uppdaterats. Du kan nu forts\xe4tta anv\xe4nda appen.","messageWithoutUser":"L\xf6senordet har uppdaterats. Du kan nu logga in med ditt nya l\xf6senord.","continueButton":"Forts\xe4tt","signInButton":"Logga In Nu","closeButton":"St\xe4ng"}},"errors":{"emailRequired":"E-postadress kr\xe4vs","emailInvalid":"Ange en giltig e-postadress","newPasswordRequired":"Nytt l\xf6senord kr\xe4vs","newPasswordTooShort":"L\xf6senordet m\xe5ste vara minst 8 tecken l\xe5ngt","confirmPasswordRequired":"Bekr\xe4fta ditt l\xf6senord","passwordsMismatch":"L\xf6senorden matchar inte","unexpected":"Ett ov\xe4ntat fel uppstod. F\xf6rs\xf6k igen."}},"sessionExpiry":{"title":"Sessionen G\xe5r Snart Ut","expired":"Utg\xe5ngen","seconds":"{{count}} sekunder","message":"Din session g\xe5r ut om {{time}}. Vill du f\xf6rl\xe4nga din session f\xf6r att forts\xe4tta arbeta?","autoSaveInfo":"Ditt arbete sparas automatiskt n\xe4r du f\xf6rl\xe4nger sessionen.","extendButton":"F\xf6rl\xe4ng Session","extendingButton":"F\xf6rl\xe4nger...","continueButton":"Forts\xe4tt Utan att F\xf6rl\xe4nga","signOutButton":"Logga Ut Nu"},"authButtons":{"signIn":"Logga In","signUp":"Registrera Dig","createAccount":"Skapa Konto","signOut":"Logga Ut"},"profileCompletion":{"welcome":"V\xe4lkommen!","subtitle":"L\xe5t oss slutf\xf6ra din profil f\xf6r att komma ig\xe5ng","benefitsTitle":"Slutf\xf6r din profil f\xf6r att:","benefits":{"personalize":"Anpassa din tr\xe4narupplevelse","displayName":"Visa ditt namn i lagrapporter","preferences":"St\xe4ll in dina tr\xe4narinst\xe4llningar"},"completeButton":"Slutf\xf6r Profil","skipButton":"Hoppa \xf6ver nu","finePrint":"Du kan slutf\xf6ra detta senare fr\xe5n profilsektionen"},"anonymousAlert":{"defaultFeature":"denna funktion","defaultDescription":"Logga in f\xf6r att f\xe5 tillg\xe5ng till f\xf6rb\xe4ttrade funktioner och spara din data p\xe5 alla enheter.","completeProfile":"Slutf\xf6r Din Profil","signInToUse":"Logga in f\xf6r att anv\xe4nda {{feature}}","signUpButton":"Registrera Dig","createAccountButton":"Skapa Konto","createFreeAccountButton":"Skapa Gratis Konto","benefitsTitle":"Vad du f\xe5r:","finePrint":"Gratis f\xf6r alltid \u2022 Inget kreditkort kr\xe4vs \u2022 Din data f\xf6rblir privat","defaultBenefits":{"saveData":"Spara din lagdata p\xe5 alla enheter","accessHistory":"F\xe5 tillg\xe5ng till matchhistorik och statistik","manageTeams":"Skapa och hantera flera lag","neverLose":"F\xf6rlora aldrig dina framsteg"},"teamManagement":{"feature":"laghantering","title":"Hantera Dina Lag","description":"Skapa och hantera laguppst\xe4llningar, spara spelarinformation och f\xf6lj lagets prestation \xf6ver flera matcher.","benefits":{"createRosters":"Skapa flera laguppst\xe4llningar","savePlayerInfo":"Spara spelarinformation och tr\xf6jnummer","trackPerformance":"F\xf6lj lagets prestation \xf6ver tid","accessHistory":"F\xe5 tillg\xe5ng till matchhistorik och analys","syncDevices":"Synkronisera data p\xe5 alla dina enheter"}},"matchHistory":{"feature":"matchhistorik","title":"Spara Din Matchhistorik","description":"H\xe5ll koll p\xe5 alla dina matcher med detaljerad statistik, spelarprestationer och matchanalys.","benefits":{"saveReports":"Spara detaljerade matchrapporter","trackStats":"F\xf6lj spelarstatistik \xf6ver tid","viewPatterns":"Visa formationer och byten","comparePerformance":"J\xe4mf\xf6r lagets prestation mellan matcher","neverLoseData":"F\xf6rlora aldrig viktig matchdata"}},"cloudSync":{"feature":"molnsynkronisering","title":"Synkronisera Mellan Enheter","description":"F\xe5 tillg\xe5ng till dina lag och matchdata fr\xe5n vilken enhet som helst. Din information s\xe4kerhetskopieras och synkroniseras automatiskt.","benefits":{"accessAnywhere":"F\xe5 tillg\xe5ng fr\xe5n telefon, surfplatta eller dator","autoBackup":"Automatisk s\xe4kerhetskopiering i molnet","neverLose":"F\xf6rlora aldrig din data","shareInfo":"Dela laginformation med andra tr\xe4nare","realTimeSync":"Synkronisering i realtid"}}},"authGuard":{"loading":"Laddar...","defaultFeature":"denna funktion","defaultDescription":"Logga in f\xf6r att f\xe5 tillg\xe5ng till f\xf6rb\xe4ttrade funktioner och spara din data p\xe5 alla enheter."},"featureGate":{"authRequired":"Autentisering Kr\xe4vs","message":"Du m\xe5ste vara inloggad f\xf6r att f\xe5 tillg\xe5ng till denna funktion.","button":"Logga In","loading":"Laddar...","defaultFeature":"denna funktion","defaultDescription":"Logga in f\xf6r att l\xe5sa upp denna funktion","defaultActionText":"Logga in f\xf6r en b\xe4ttre upplevelse","signInRequired":"Inloggning kr\xe4vs","unlock":"L\xe5s upp {{feature}}","signUp":"Registrera Dig","learnMore":"L\xe4s mer om f\xf6rdelarna","cancel":"Avbryt","buttonGate":{"defaultFeature":"denna funktion","defaultDescription":"Logga in f\xf6r att anv\xe4nda denna funktion"},"linkGate":{"defaultFeature":"denna funktion","defaultDescription":"Logga in f\xf6r att f\xe5 tillg\xe5ng till denna funktion"}},"invitation":{"title":"Laginbjudan","subtitle":"Du har blivit inbjuden att g\xe5 med i ett lag!","loadingTeam":"Laddar lagdetaljer...","teamLabel":"Lag","roleLabel":"Roll","errors":{"passwordMismatch":"L\xf6senorden matchar inte","setupFailed":"Misslyckades med att konfigurera konto","signOutFailed":"Misslyckades med att logga ut. F\xf6rs\xf6k igen."},"passwordSuccess":{"title":"L\xf6senord Inst\xe4llt!","message":"Ditt konto \xe4r klart. F\xf6r att slutf\xf6ra din laginbjudan och s\xe4kerst\xe4lla s\xe4ker \xe5tkomst, logga in med ditt nya l\xf6senord.","nextStepsTitle":"Vad h\xe4nder nu:","step1":"Du kommer att loggas ut av s\xe4kerhetssk\xe4l","step2":"Logga in med: {{email}}","step3":"Din laginbjudan kommer att behandlas automatiskt","button":"Forts\xe4tt till Inloggning","buttonProcessing":"Loggar ut dig..."},"accountSetup":{"statusTitle":"N\xe4stan klar!","statusMessage":"St\xe4ll in ditt l\xf6senord f\xf6r att slutf\xf6ra ditt konto och g\xe5 med i laget.","passwordLabel":"Skapa L\xf6senord","passwordPlaceholder":"Ange ditt l\xf6senord","confirmLabel":"Bekr\xe4fta L\xf6senord","confirmPlaceholder":"Bekr\xe4fta ditt l\xf6senord","submitButton":"Slutf\xf6r Kontoinst\xe4llning","submittingButton":"St\xe4ller in konto...","passwordRequirements":"M\xe5ste vara minst 8 tecken med bokst\xe4ver och minst en siffra"},"readyToJoin":{"statusTitle":"Redo att g\xe5 med!","statusMessage":"Klicka nedan f\xf6r att acceptera din inbjudan och g\xe5 med i laget.","acceptButton":"Acceptera Inbjudan","processingButton":"G\xe5r med i lag..."},"signInRequired":{"message":"Logga in eller skapa ett konto f\xf6r att acceptera denna inbjudan.","closeInstruction":"St\xe4ng denna dialog f\xf6r att f\xe5 tillg\xe5ng till inloggningsalternativen"},"validity":"Denna inbjudan f\xf6rblir giltig tills du accepterar den eller den g\xe5r ut.","statusMessages":{"accountSetup":"Slutf\xf6r ditt konto f\xf6r att g\xe5 med i laget","signInRequired":"Logga in f\xf6r att acceptera din laginbjudan","processing":"Bearbetar din laginbjudan..."}},"emailVerification":{"header":{"title":"Kolla Din E-post","sentTo":"Vi skickade en 6-siffrig kod till"},"form":{"codeLabel":"Verifieringskod","codePlaceholder":"Ange 6-siffrig kod","codeHint":"Ange den 6-siffriga koden fr\xe5n din e-post","submitButton":"Verifiera E-post","submittingButton":"Verifierar..."},"expiry":{"title":"Din verifieringskod har g\xe5tt ut","description":"Verifieringskoder \xe4r giltiga i 60 minuter. Beg\xe4r en ny kod f\xf6r att forts\xe4tta.","sendNewButton":"Skicka Ny Verifieringskod","sendingButton":"Skickar...","cooldownButton":"Skicka Ny Kod ({{seconds}}s)","confirmMessage":"En ny 6-siffrig kod kommer att skickas till"},"help":{"toggleButton":"Fick du inget e-postmeddelande?","toggleButtonHide":"D\xf6lj fels\xf6kningshj\xe4lp","toggleButtonShow":"Visa fels\xf6kningshj\xe4lp","resendButton":"Skicka verifieringskod igen","resendCooldown":"Skicka kod igen om {{seconds}}s","title":"Fels\xf6kningstips:","tips":{"spam":"Kontrollera din skr\xe4ppost - automatiska e-postmeddelanden hamnar ibland d\xe4r","wait":"V\xe4nta n\xe5gra minuter - e-postleverans kan ta 2-5 minuter","checkEmail":"Kontrollera att {{email}} \xe4r korrekt","provider":"Vissa e-postleverant\xf6rer (s\xe4rskilt f\xf6retag) kan blockera automatiska e-postmeddelanden"},"enumeration":{"title":"Finns kontot redan?","description":"Om ett konto med din e-postadress redan finns f\xe5r du inget registreringsmail. Detta \xe4r avsiktligt s\xe4kerhetsbeteende.","whyTitle":"Varf\xf6r inte bara s\xe4ga att e-postadressen anv\xe4nds?","whyDescription":"Detta skyddar din integritet genom att f\xf6rhindra att d\xe5liga akt\xf6rer uppt\xe4cker vilka e-postadresser som \xe4r registrerade hos oss.","signInLink":"F\xf6rs\xf6k logga in ist\xe4llet \u2192"}},"footer":{"hasAccount":"Har du redan ett konto?","signInLink":"Logga in","closeButton":"St\xe4ng"},"errors":{"unexpected":"Ett ov\xe4ntat fel uppstod. F\xf6rs\xf6k igen.","resendFailed":"Kunde inte skicka kod igen. F\xf6rs\xf6k igen."}},"validation":{"email":{"required":"E-postadress kr\xe4vs","invalid":"Ange en giltig e-postadress"},"password":{"required":"L\xf6senord kr\xe4vs","tooShort":"L\xf6senordet m\xe5ste vara minst 8 tecken","missingNumber":"L\xf6senordet m\xe5ste inneh\xe5lla minst en siffra","missingSpecialChar":"L\xf6senordet m\xe5ste inneh\xe5lla minst ett specialtecken"},"confirmPassword":{"required":"Bekr\xe4fta ditt l\xf6senord","mismatch":"L\xf6senorden matchar inte"},"otp":{"required":"Verifieringskod kr\xe4vs","invalid":"Ange en giltig 6-siffrig kod","tooShort":"Verifieringskoden m\xe5ste vara 6 siffror","notNumeric":"Verifieringskoden f\xe5r bara inneh\xe5lla siffror"},"general":{"unexpected":"Ett ov\xe4ntat fel uppstod. F\xf6rs\xf6k igen."}},"signUp":{"checkEmailMessage":"Kontrollera din e-post f\xf6r bekr\xe4ftelsel\xe4nk","failedToSignUp":"Registreringen misslyckades"},"errors":{"invalidCredentials":"Felaktig e-postadress eller l\xf6senord. Kontrollera dina uppgifter och f\xf6rs\xf6k igen.","emailNotConfirmed":"Verifiera din e-postadress med den 6-siffriga koden vi skickade till dig.","userAlreadyRegistered":"Ett konto med denna e-postadress finns redan. Logga in ist\xe4llet.","passwordTooShort":"L\xf6senordet m\xe5ste vara minst 6 tecken l\xe5ngt.","invalidPassword":"Ange ett giltigt l\xf6senord.","invalidEmail":"Ange en giltig e-postadress.","emailNotFound":"Inget konto hittades med denna e-postadress.","tooManyRequests":"F\xf6r m\xe5nga f\xf6rs\xf6k. V\xe4nta en stund innan du f\xf6rs\xf6ker igen.","connectionError":"Anslutningsfel. Kontrollera din internetanslutning och f\xf6rs\xf6k igen.","networkError":"N\xe4tverksfel. F\xf6rs\xf6k igen.","unknownError":"Ok\xe4nt fel","operationTimedOut":"\xc5tg\xe4rden tog f\xf6r l\xe5ng tid"},"passwordRequirements":{"atLeastChars":"minst {{count}} tecken","uppercaseAndLowercase":"stora och sm\xe5 bokst\xe4ver","uppercase":"stora bokst\xe4ver","lowercase":"sm\xe5 bokst\xe4ver","letters":"bokst\xe4ver","atLeastOneNumber":"minst en siffra","atLeastOneSpecialChar":"minst ett specialtecken","mustBe":"M\xe5ste vara {{requirements}}"},"changePassword":{"modalTitle":"Byt L\xf6senord","closeModal":"St\xe4ng dialog","header":{"title":"Byt Ditt L\xf6senord","subtitle":"Ange ditt nuvarande l\xf6senord f\xf6r att verifiera din identitet, sedan st\xe4ll in ett nytt l\xf6senord"},"form":{"currentPasswordLabel":"Nuvarande L\xf6senord","currentPasswordPlaceholder":"Ange ditt nuvarande l\xf6senord","newPasswordLabel":"Nytt L\xf6senord","newPasswordPlaceholder":"Ange ditt nya l\xf6senord","confirmPasswordLabel":"Bekr\xe4fta Nytt L\xf6senord","confirmPasswordPlaceholder":"Bekr\xe4fta ditt nya l\xf6senord","submitButton":"Byt L\xf6senord","submittingButton":"Byter L\xf6senord..."},"requirements":{"title":"L\xf6senordskrav:","items":{"minLength":"Minst 8 tecken l\xe5ngt","different":"M\xe5ste vara annorlunda \xe4n ditt nuvarande l\xf6senord","mix":"Anv\xe4nd en blandning av bokst\xe4ver, siffror och symboler"}},"success":{"title":"L\xf6senord Bytt!","button":"Klar"},"errors":{"currentPasswordRequired":"Nuvarande l\xf6senord kr\xe4vs","newPasswordRequired":"Nytt l\xf6senord kr\xe4vs","newPasswordTooShort":"Nytt l\xf6senord m\xe5ste vara minst 8 tecken l\xe5ngt","newPasswordSame":"Nytt l\xf6senord m\xe5ste vara annorlunda \xe4n nuvarande l\xf6senord","confirmPasswordRequired":"Bekr\xe4fta ditt nya l\xf6senord","passwordsMismatch":"L\xf6senorden matchar inte","unexpected":"Ett ov\xe4ntat fel uppstod. F\xf6rs\xf6k igen."}}}'),Le=JSON.parse('{"header":{"title":"Profilinst\xe4llningar"},"form":{"nameLabel":"Visningsnamn","namePlaceholder":"Ange ditt namn","emailLabel":"E-postadress","languageLabel":"Spr\xe5k","languageEnglish":"English","languageSwedish":"Svenska","saveButton":"Spara \xc4ndringar","savingButton":"Sparar..."},"validation":{"nameRequired":"Namn kr\xe4vs","nameTooShort":"Namnet m\xe5ste vara minst 2 tecken","nameInvalidChars":"Namnet inneh\xe5ller ogiltiga tecken. Anv\xe4nd endast bokst\xe4ver, siffror, mellanslag, bindestreck, apostrofer och punkter."},"messages":{"updateSuccess":"Profil uppdaterad!","updateError":"Misslyckades med att uppdatera profil","unexpectedError":"Ett ov\xe4ntat fel intr\xe4ffade. F\xf6rs\xf6k igen."},"screen":{"title":"Profil","back":"Tillbaka"},"personalInfo":{"title":"Personlig Information","fullName":"Fullst\xe4ndigt Namn","emailAddress":"E-postadress","password":"L\xf6senord","namePlaceholder":"Ange ditt fullst\xe4ndiga namn","readOnly":"(Skrivskyddad)","changePassword":"Byt L\xf6senord","passwordHint":"Att regelbundet uppdatera ditt l\xf6senord hj\xe4lper till att h\xe5lla ditt konto s\xe4kert","emailVerified":"E-post verifierad"},"accountInfo":{"title":"Kontoinformation","created":"Konto Skapat","updated":"Senast Uppdaterad","userId":"Anv\xe4ndar-ID","emailStatus":"E-poststatus","verified":"Verifierad","pendingVerification":"V\xe4ntar p\xe5 verifiering"},"teamManagement":{"title":"Laghantering","loading":"Laddar dina klubbar och lag...","currentTeam":"Nuvarande Lag","yourClubs":"Dina Klubbar ({{count}})","yourTeams":"Dina Lag ({{count}})","member":"Medlem","inactive":"Inaktiv","switch":"Byt","leave":"L\xe4mna","leaving":"L\xe4mnar..."},"emptyStates":{"noClubs":{"title":"Inga klubbar \xe4n","description":"Du har inte g\xe5tt med i n\xe5gon klubb \xe4n. Skapa en klubb eller g\xe5 med i en befintlig klubb.","action":"Skapa eller g\xe5 med i klubb"},"noTeams":{"title":"Inga Lag \xc4n","description":"Du har inte g\xe5tt med i n\xe5got lag \xe4n. Skapa ditt f\xf6rsta lag eller be en tr\xe4nare att bjuda in dig.","action":"Skapa eller G\xe5 med i Lag"}},"modals":{"leaveClub":{"title":"L\xe4mna klubb","message":"\xc4r du s\xe4ker p\xe5 att du vill l\xe4mna {{clubName}}?","confirm":"L\xe4mna klubb"},"leaveTeam":{"title":"L\xe4mna lag","message":"\xc4r du s\xe4ker p\xe5 att du vill l\xe4mna {{teamName}}?","confirm":"L\xe4mna lag"},"cantLeaveClub":{"title":"Kan inte l\xe4mna klubb","lastMember":"Du \xe4r den sista medlemmen i {{teamName}}. Ta bort laget ist\xe4llet?","deleteButton":"Ta Bort Lag","deletingButton":"Tar Bort..."},"cantLeaveTeam":{"title":"Kan inte l\xe4mna lag","lastMember":"Du \xe4r den sista medlemmen i {{teamName}}. Ta bort laget ist\xe4llet?","lastAdmin":"Du \xe4r den sista administrat\xf6ren f\xf6r {{teamName}}. Ta bort laget ist\xe4llet?"}},"buttons":{"save":"Spara","saving":"Sparar...","cancel":"Avbryt","edit":"Redigera"},"formatting":{"notAvailable":"Ej tillg\xe4ngligt","invalidDate":"Ogiltigt datum","defaultUser":"Anv\xe4ndare","unknownClub":"Ok\xe4nd klubb","unknownTeam":"Ok\xe4nt lag","thisTeam":"detta lag"}}'),qe=JSON.parse('{"period":{"label":"Period {{number}}","ordinal":{"1st":"1:a","2nd":"2:a","3rd":"3:e","4th":"4:e","nth":"{{number}}:e"}},"startScreen":{"startMatch":"Starta Match","startPeriod":"Starta {{ordinal}} Perioden","instructions":"Tryck f\xf6r att b\xf6rja perioden och starta timers","backToSetup":"Tillbaka till Konfiguration"},"timers":{"matchClock":"Matchklocka","substitutionTimer":"Bytestimer","pauseTooltip":"Pausa bytestimer","resumeTooltip":"\xc5teruppta bytestimer"},"score":{"instructions":"Tryck p\xe5 lagnamn f\xf6r att l\xe4gga till m\xe5l \u2022 H\xe5ll inne st\xe4llning f\xf6r att redigera"},"substitution":{"button":"BYT NU","buttonSingle":"BYT 1 SPELARE","buttonMultiple":"BYT {{count}} SPELARE","makeSubstitution":"Genomf\xf6r byte","cannotSubstitute":"Alla avbytare \xe4r inaktiva - kan inte g\xf6ra byte","undoTooltip":"\xc5ngra senaste byte","undoDisabled":"Inget byte att \xe5ngra","decreaseCount":"Minska antal spelare att byta","increaseCount":"\xd6ka antal spelare att byta","undoModal":{"title":"\xc5ngra Byte","message":"\xc4r du s\xe4ker p\xe5 att du vill \xe5ngra det senaste bytet? Detta kommer att \xe5terst\xe4lla spelarpositioner och tidm\xe4tning.","confirm":"\xc5ngra","cancel":"Avbryt"}},"actions":{"endPeriod":"Avsluta Period"},"modals":{"fieldPlayer":{"setNext":"S\xe4tt som N\xe4sta","removeFromNext":"Ta Bort fr\xe5n N\xe4sta","subNow":"Byt Nu","changePosition":"Byt Position","cancel":"Avbryt"},"substitute":{"inactivate":"Inaktivera","activate":"Aktivera","cancel":"Avbryt"},"goalie":{"switchGoalie":"Byt M\xe5lvakt","cancel":"Avbryt"}},"formation":{"noConfig":"Ingen lagkonfiguration tillg\xe4nglig","invalidConfig":"Ogiltig lagkonfiguration","inactive":"(Inaktiv)","positions":{"goalie":"M\xe5lvakt","leftDefender":"V\xe4nster Back","rightDefender":"H\xf6ger Back","leftAttacker":"V\xe4nster Forward","rightAttacker":"H\xf6ger Forward","defender":"Back","left":"V\xe4nster Mittf\xe4lt","right":"H\xf6ger Mittf\xe4lt","attacker":"Forward","leftMidfielder":"V\xe4nster Mittf\xe4ltare","rightMidfielder":"H\xf6ger Mittf\xe4ltare","centerMidfielder":"Centralt Mittf\xe4lt","substitute":"Avbytare"},"inactiveStatus":"Inaktiv"},"finished":{"title":"Match Avslutad!","subtitle":"Bra match! H\xe4r \xe4r sammanfattningen:","finalScore":"Slutresultat","matchTime":"Matchtid","periods":"Perioder","fairPlay":"Fair Play-Utm\xe4rkelse","fairPlayDescription":"Mest balanserad speltid","topScorer":"Skyttekung","topScorerGoals":"{{count}} m\xe5l","topScorerGoals_other":"{{count}} m\xe5l","noGoals":"Inga m\xe5l gjorda","viewReport":"Visa Fullst\xe4ndig Rapport","newMatch":"Ny Match"},"validation":{"selectPlayersCount":"V\xe4lj mellan {{min}} och {{max}} spelare till truppen.","assignGoaliePerPeriod":"Tilldela en m\xe5lvakt f\xf6r varje period.","invalidFormation":"Ogiltig formation uppt\xe4ckt. Se till att alla positioner \xe4r korrekt tilldelade.","completeFormation":"Fyll i formationen med 1 m\xe5lvakt och {{count}} unika utespelare.","completeFormationAssignment":"Fyll i formationstilldelningen.","assignAllPositions":"Tilldela alla positioner inklusive m\xe5lvakt.","noActiveMatch":"Ingen aktiv match att spara.","teamContextRequired":"Lagkontext kr\xe4vs f\xf6r att spara konfiguration."},"helpMessages":{"fieldPlayerOptions":"H\xe5ll inne f\xf6r alternativ","substituteToggleActivate":"H\xe5ll inne f\xf6r att aktivera","substituteToggleInactivate":"H\xe5ll inne f\xf6r att inaktivera"},"persistence":{"retrying":"F\xf6rs\xf6ker spara igen (f\xf6rs\xf6k {{attempt}}/{{maxAttempts}})...","failedAfterRetries":"Misslyckades med att spara matchen efter {{maxAttempts}} f\xf6rs\xf6k","failedToSaveMatch":"Misslyckades med att spara matchen","cannotRetry":"Kan inte f\xf6rs\xf6ka igen: Ingen v\xe4ntande matchdata hittades.","cannotSaveNoMatchId":"Kan inte spara match: Inget match-ID.","cannotSaveNoPlayerData":"Kan inte spara match: Ingen spelardata tillg\xe4nglig.","cannotSaveMissingStartTime":"Kan inte spara match: Starttid saknas.","cannotSaveIncompleteData":"Kan inte spara match: Ofullst\xe4ndig matchdata ({{fields}})","cannotSaveNoParticipants":"Kan inte spara match: Inga deltagande spelare hittades.","playerStatsFailed":"Spelarstatistik misslyckades f\xf6r: {{names}}","playerStatsFailedCount":"Spelarstatistik misslyckades f\xf6r {{count}} spelare","configSaved":"Konfiguration sparad","configSavedWithWarnings":"Konfiguration sparad (med varningar)","failedToSaveConfig":"Misslyckades med att spara konfiguration","failedToSaveConfigError":"Misslyckades med att spara konfiguration: {{error}}"},"stats":{"title":"Match Avslutad - Statistik","opponent":"Motst\xe5ndare","fairPlayAward":"Fair Play-Utm\xe4rkelse","notAwarded":"Ej tilldelad","fairPlayWinner":"FAIR PLAY-VINNARE","savingSelection":"Sparar val...","selectionSavesAutomatically":"Val sparas automatiskt","matchSaved":"Match sparad i historik","viewMatchReport":"Visa Matchrapport","startNewGame":"Starta Ny Match","errors":{"noMatchId":"Inget match-ID hittat. Starta om matchen f\xf6r att aktivera sparande.","signInRequired":"Logga in f\xf6r att spara matchuppdateringar.","saveFailed":"Misslyckades med att spara matchuppdateringar"}}}'),Ue=JSON.parse('{"tabs":{"team":"Lag","player":"Spelare","attendance":"N\xe4rvaro","history":"Historik"},"teamStats":{"title":"\xd6versikt","totalMatches":"Totalt Antal Matcher","winRate":"Vinstprocent","avgGoalsScored":"Snitt Gjorda M\xe5l","avgGoalsConceded":"Snitt Insl\xe4ppta M\xe5l","activePlayers":"Aktiva spelare","perMatch":"Per match","wins":"Vinster","draws":"Oavgjorda","losses":"F\xf6rluster","loading":"Laddar \xf6versikt...","error":"Fel vid laddning av \xf6versikt","noStats":"Ingen \xf6versikt tillg\xe4nglig","failedToLoadMatchData":"Misslyckades med att ladda matchdata","noMatchesFiltered":"Inga matcher hittades med valda filter","adjustFilters":"Prova att justera dina filterkriterier","victories":"vinster","totalGoals":"totalt antal m\xe5l","sections":{"goals":"M\xe5l","matchOutcomes":"Matcher","recentMatches":"Senaste Matcher","homeRecord":"Hemmastatistik","awayRecord":"Bortastatistik","cleanSheets":"H\xe5llna Nollor"},"labels":{"matchesWon":"Vunna Matcher","matchesDrawn":"Oavgjorda Matcher","matchesLost":"F\xf6rlorade Matcher","goalsScored":"Gjorda M\xe5l","goalsConceded":"Insl\xe4ppta M\xe5l","goalDifference":"M\xe5lskillnad","matches":"matcher","total":"totalt","ofTotal":"av totalt"},"outcomes":{"win":"Vinst","draw":"Oavgjort","loss":"F\xf6rlust"},"record":{"wins":"vinster","draws":"oavgjorda","loss":"f\xf6rlust","losses":"f\xf6rluster"},"summaryRecord":"{{wins}}V {{draws}}O {{losses}}F"},"playerStats":{"title":"Spelarstatistik","totalPlayers":"Totalt Antal Spelare","avgPlayingTime":"Snitt Speltid","avgGoals":"Snitt m\xe5l","topScorer":"Skyttekung","noStats":"Ingen spelarstatistik tillg\xe4nglig","adjustTimeRange":"L\xe4gg till matcher eller justera valt tidsintervall","loading":"Laddar spelarstatistik...","error":"Fel vid laddning av spelarstatistik","errorDetails":"Misslyckades med att ladda spelarstatistik","failedToLoadMatches":"Misslyckades med att ladda matcher","failedToLoadLoanMatches":"Misslyckades med att ladda utl\xe5nade matcher","unnamedPlayer":"Namnl\xf6s Spelare","noMatchesAvailable":"Ingen spelarstatistik tillg\xe4nglig","addMatchesOrAdjust":"L\xe4gg till matcher eller justera valt tidsintervall.","noMatchesFiltered":"Inga matcher hittades med valda filter","adjustFilters":"Prova att justera filterkriterier.","noStatsRecorded":"Ingen spelarstatistik registrerad f\xf6r valda filter","activePlayers":"Aktiva spelare","perMatch":"Per match","totalGoalsLabel":"Totalt antal m\xe5l:","goals":"m\xe5l","noData":"Ingen data","tableSubtitle":"Klicka p\xe5 kolumnrubriker f\xf6r att sortera eller dra f\xf6r att \xe4ndra ordning. Utl\xe5nade matcher viktas med {{weight}}.","columns":{"player":"Spelare","matches":"Matcher","loanMatches":"Utl\xe5nade Matcher","goals":"M\xe5l","avgTime":"Snitt Tid","outfieldTime":"Utespelartid","startedAsSub":"Startade som Avbytare","defender":"Back","midfielder":"Mittf\xe4lt","attacker":"Forward","goalkeeper":"M\xe5lvakt","captain":"Kapten","fairPlay":"Fair Play"}},"attendanceStats":{"title":"N\xe4rvarostatistik","totalPlayers":"Totalt Antal Spelare","trackedPlayers":"Sp\xe5rade spelare","totalPractices":"Totalt Antal Tr\xe4ningar","inSelectedPeriod":"I vald period","avgAttendanceRate":"Snitt N\xe4rvaro","acrossAllPlayers":"Alla spelare","topAttendee":"B\xe4sta N\xe4rvaro","failedToLoadAttendance":"Misslyckades med att ladda n\xe4rvarostatistik","failedToLoadLoanMatches":"Misslyckades med att ladda utl\xe5nade matcher","noData":"Ingen n\xe4rvarodata tillg\xe4nglig","noDataTimeRange":"Ingen n\xe4rvarodata tillg\xe4nglig f\xf6r valt tidsintervall","adjustTimeFilter":"Prova att justera tidsfiltret eller v\xe4nta p\xe5 n\xe4sta synk.","loading":"Laddar n\xe4rvarostatistik...","error":"Fel vid laddning av n\xe4rvarostatistik","noConnector":{"title":"Ingen n\xe4rvarodata tillg\xe4nglig","description":"Konfigurera en Connector under Laghantering Connectors-fliken f\xf6r att samla n\xe4rvarodata fr\xe5n:","platforms":{"sportadmin":"SportAdmin","svenskalag":"Svenska Lag","myclub":"MyClub"},"connectButton":"Anslut Nu"},"table":{"player":"Spelare","practicesPerMatch":"Tr\xe4ningar/Match","practicesAttended":"Tr\xe4ningar n\xe4rvarande","attendanceRate":"N\xe4rvaroprocent","matchesPlayed":"Spelade matcher","matchesLoaned":"Utl\xe5nade matcher","sortInstruction":"Klicka p\xe5 kolumnrubriker f\xf6r att sortera eller dra f\xf6r att \xe4ndra ordning."}},"matchHistory":{"title":"Matchhistorik","noMatches":"Inga matcher \xe4n","addMatches":"Matcher du spelar kommer att visas h\xe4r","loading":"Laddar matchhistorik...","error":"Fel vid laddning av matchhistorik","errorDetails":"Misslyckades med att ladda matchhistorik","addMatch":"L\xe4gg till Match","matchesFound":"{{count}} matcher hittades. Klicka p\xe5 en match f\xf6r att se detaljerad statistik.","noMatchesFiltered":"Inga matcher hittades med valda filter.","adjustFilters":"Prova att justera dina filterkriterier.","venues":{"home":"Hemma","away":"Borta","neutral":"Neutral"},"outcomes":{"win":"Vinst","draw":"Oavgjort","loss":"F\xf6rlust"}},"matchDetails":{"title":"Matchdetaljer","newMatch":"Ny Match","opponent":"Motst\xe5ndare","opponentName":"Motst\xe5ndarlagets namn","venue":"Arena","matchType":"Matchtyp","type":"Typ","format":"Format","formation":"Formation","periods":"Perioder","periodDuration":"Periodl\xe4ngd","totalTime":"Total Tid","duration":"L\xe4ngd","finalScore":"Slutresultat","saving":"Sparar...","saveChanges":"Spara \xc4ndringar","cancel":"Avbryt","editMatch":"Redigera Match","deleting":"Tar bort...","delete":"Ta Bort Match","deleteTitle":"Ta Bort Match","deleteConfirm":"\xc4r du s\xe4ker p\xe5 att du vill ta bort denna match fr\xe5n historiken? Detta kan inte \xe5ngras.","deletingEllipsis":"Tar bort...","deleteSuccess":"Match borttagen","deleteError":"Misslyckades med att ta bort match","errorSaving":"Fel vid sparande:","errorDeleting":"Fel vid borttagning av match:","loading":"Laddar matchdetaljer...","notFound":"Match hittades inte","noMatchId":"Inget match-ID angivet","failedToLoadDetails":"Misslyckades med att ladda matchdetaljer","teamRequired":"Ett lag m\xe5ste v\xe4ljas innan en match kan l\xe4ggas till.","failedToCreate":"Misslyckades med att skapa match","failedToUpdateDetails":"Misslyckades med att uppdatera matchdetaljer","failedToUpdatePlayerStats":"Misslyckades med att uppdatera spelarstatistik","failedToDelete":"Misslyckades med att ta bort match","unknownType":"Ok\xe4nd","unnamedPlayer":"Namnl\xf6s Spelare","outcomes":{"win":"Vinst","draw":"Oavgjort","loss":"F\xf6rlust"},"venues":{"home":"Hemma","away":"Borta","neutral":"Neutral"},"playerStats":{"title":"Spelarstatistik","subtitle":"Individuell spelarprestanda f\xf6r denna match","player":"Spelare","goals":"M\xe5l","outfieldTime":"Utespelartid","defender":"Back","midfielder":"Mittf\xe4lt","attacker":"Forward","goalkeeper":"M\xe5lvakt","substitute":"Avbytare","startingRole":"Startroll","captain":"Kapten","fairPlay":"Fair Play","actions":"\xc5tg\xe4rder","addPlayer":"L\xe4gg Till Spelare","remove":"Ta Bort","selectPlayer":"V\xe4lj spelare","allPlayersIncluded":"Alla spelare inkluderade","exceedsMatchDuration":"\xd6verstiger matchl\xe4ngd","goalWarning":"Spelarnas m\xe5l ({{playerGoals}}) \xf6verstiger lagets totala ({{teamGoals}}).","roleWarning":"Inkonsistens i startroll: {{issues}}.","goalkeeperCountIssue":"{{count}} m\xe5lvakter (f\xf6rv\xe4ntat 1)","outfieldCountIssue":"{{count}} utespelare (f\xf6rv\xe4ntat {{expected}} f\xf6r {{format}})"}},"matchSummary":{"scheduled":"Schemalagd:","noStartTime":"Ingen starttid registrerad","durationUnknown":"L\xe4ngd ok\xe4nd","wins":"{{teamName}} vinner","tied":"Oavgjort","periodsFormat":"{{periods}} \xd7 {{duration}}min"},"filters":{"title":"Filter","clearAll":"Rensa Alla","all":"Alla","timeRange":"Tidsperiod","matchType":"Matchtyp","type":"Typ","outcome":"Utfall","venue":"Arena","opponent":"Motst\xe5ndare","withPlayer":"Med Spelare","format":"Format","outcomes":{"win":"Vinst","draw":"Oavgjort","loss":"F\xf6rlust"},"venues":{"home":"Hemma","away":"Borta","neutral":"Neutral"}},"timeFilter":{"allTime":"Alla tider","last30Days":"Senaste 30 Dagarna","last3Months":"Senaste 3 M\xe5naderna","last6Months":"Senaste 6 M\xe5naderna","lastYear":"Senaste \xc5ret","custom":"Anpassat","customRange":"Anpassat intervall...","selectTimeRange":"V\xe4lj Tidsperiod","startDate":"Startdatum","endDate":"Slutdatum","apply":"Till\xe4mpa","cancel":"Avbryt","from":"Fr\xe5n {{date}}","until":"Till {{date}}","dateRange":"{{start}} - {{end}}","invalidStartDate":"Ogiltigt startdatum","invalidEndDate":"Ogiltigt slutdatum","startBeforeEnd":"Startdatum m\xe5ste vara f\xf6re slutdatum","startDateTooFar":"Startdatum kan inte vara mer \xe4n ett \xe5r i framtiden","endDateTooFar":"Slutdatum kan inte vara mer \xe4n ett \xe5r i framtiden","presets":{"last-30-days":"Senaste 30 dagarna","last-3-months":"Senaste 3 m\xe5naderna","last-6-months":"Senaste 6 m\xe5naderna","last-12-months":"Senaste 12 m\xe5naderna","year-to-date":"Fr\xe5n \xe5rets b\xf6rjan","all-time":"Alla tider"}},"table":{"player":"Spelare","matches":"Matcher","playingTime":"Speltid","goals":"M\xe5l","assists":"Assist","attendance":"N\xe4rvaro","sortBy":"Sortera efter"},"loading":"Laddar statistik...","error":"Kan inte ladda statistik","empty":{"title":"Ingen Data Tillg\xe4nglig","description":"Statistik kommer att visas n\xe4r du har spelat matcher"},"screen":{"title":"Statistik","loadingSubtitle":"Laddar statistik...","fetchingData":"H\xe4mtar senaste data...","signInSubtitle":"H\xe5ll dig n\xe4ra matchen","signInBody":"Logga in med ditt f\xf6r\xe4ldrakonto f\xf6r att utforska matchhistorik, spelarstatistik och lagtrender.","signIn":"Logga In","createAccount":"Skapa Konto","selectTeamSubtitle":"V\xe4lj ett lag f\xf6r att forts\xe4tta","noTeamSubtitle":"Inget lagmedlemskap hittades","selectTeamBody":"V\xe4lj ett lag fr\xe5n huvudmenyn f\xf6r att se dess statistik.","noTeamBody":"Du beh\xf6ver ett lagmedlemskap innan du kan se statistik. Be en tr\xe4nare eller administrat\xf6r att l\xe4gga till dig i laget.","roleUpdateSubtitle":"Rolluppdatering kr\xe4vs","roleUpdateBody":"Statistik \xe4r tillg\xe4nglig f\xf6r f\xf6r\xe4ldrakonton. Be din lagadministrat\xf6r att uppgradera din \xe5tkomst.","tabs":{"teamStats":"\xd6versikt","teamStatsDescription":"Lagets prestanda\xf6versikt","playerMatchStats":"Spelarstatistik","playerMatchStatsDescription":"Individuell spelarstatistik per match","attendanceStats":"N\xe4rvarostatistik","attendanceStatsDescription":"N\xe4rvaro vid tr\xe4ningar","matchHistory":"Matchhistorik","matchHistoryDescription":"Komplett matchhistorik"}}}'),Be=JSON.parse('{"management":{"title":"Laghantering","tabs":{"overview":"\xd6versikt","roster":"Truppen","loans":"L\xe5n","access":"\xc5tkomsthantering","connectors":"Kopplingar","preferences":"Inst\xe4llningar"}},"roster":{"title":"Laglista","addPlayer":"L\xe4gg Till Spelare","editPlayer":"Redigera Spelare","deletePlayer":"Ta Bort Spelare","noPlayers":"Inga spelare i truppen","addPlayersToStart":"L\xe4gg till spelare f\xf6r att komma ig\xe5ng"},"player":{"name":"Namn","number":"Nummer","position":"F\xf6redragen Position","status":"Status","active":"Aktiv","inactive":"Inaktiv","temporary":"Tillf\xe4llig"},"addPlayer":{"title":"L\xe4gg Till Spelare","addToTeam":"L\xe4gg Till Spelare i Laget","addTemporary":"L\xe4gg Till Tillf\xe4llig Spelare","cancel":"Avbryt"},"editPlayer":{"title":"Redigera Spelare","save":"Spara \xc4ndringar","cancel":"Avbryt"},"deletePlayer":{"title":"Ta Bort Spelare","confirm":"\xc4r du s\xe4ker p\xe5 att du vill ta bort {{playerName}} fr\xe5n laget?","delete":"Ta Bort","cancel":"Avbryt"},"loans":{"title":"Spelarl\xe5n","loanDate":"L\xe5nedatum","receivingTeam":"Mottagande Lag","players":"Spelare","noLoans":"Inga aktiva l\xe5n","addLoan":"L\xe4gg Till L\xe5n"},"access":{"title":"Lag\xe5tkomst","role":"Roll","admin":"Administrat\xf6r","coach":"Tr\xe4nare","viewer":"\xc5sk\xe5dare","invite":"Bjud In Medlem","remove":"Ta Bort"},"invite":{"title":"Bjud In Lagmedlem","email":"E-postadress","role":"Roll","send":"Skicka Inbjudan","cancel":"Avbryt"},"creation":{"title":"Skapa Lag","teamName":"Lagnamn","clubName":"Klubbnamn","ageGroup":"\xc5ldersgrupp","create":"Skapa Lag","cancel":"Avbryt"},"selector":{"title":"V\xe4lj Lag","noTeams":"Inga lag tillg\xe4ngliga","createTeam":"Skapa Lag"},"addRosterPlayerModal":{"header":{"title":"L\xe4gg Till Spelare","subtitle":"L\xe4gg till ny spelare i {{teamName}}"},"form":{"labels":{"firstName":"F\xf6rnamn *","lastName":"Efternamn","displayName":"Visningsnamn *","jerseyNumber":"Tr\xf6jnummer"},"placeholders":{"firstName":"Ange f\xf6rnamn","lastName":"Ange efternamn (valfritt)","displayName":"Ange visningsnamn"},"helperText":{"displayName":"Detta \xe4r namnet som visas i appen (fylls i automatiskt fr\xe5n f\xf6rnamn)"}},"validation":{"firstNameRequired":"F\xf6rnamn kr\xe4vs","firstNameMinLength":"F\xf6rnamn m\xe5ste vara minst 2 tecken","firstNameMaxLength":"F\xf6rnamn f\xe5r vara h\xf6gst 50 tecken","lastNameMaxLength":"Efternamn f\xe5r vara h\xf6gst 50 tecken","displayNameRequired":"Visningsnamn kr\xe4vs","displayNameMinLength":"Visningsnamn m\xe5ste vara minst 2 tecken","displayNameMaxLength":"Visningsnamn f\xe5r vara h\xf6gst 50 tecken","jerseyNumberInvalid":"V\xe4lj ett giltigt tr\xf6jnummer","failedToAdd":"Misslyckades l\xe4gga till spelare"},"jerseyNumber":{"noNumber":"Inget tr\xf6jnummer","allTaken":"Alla tr\xf6jnummer (1-100) \xe4r upptagna"},"buttons":{"addPlayer":"L\xe4gg Till Spelare","adding":"L\xe4gger till...","cancel":"Avbryt"},"success":{"playerAdded":"{{playerName}} tillagd!"}},"editRosterPlayerModal":{"header":{"title":"Redigera Spelare","subtitle":"Uppdatera {{playerName}}s information"},"form":{"labels":{"firstName":"F\xf6rnamn *","lastName":"Efternamn","displayName":"Visningsnamn *","jerseyNumber":"Tr\xf6jnummer","onRoster":"Aktiv i truppen"},"placeholders":{"firstName":"Ange f\xf6rnamn","lastName":"Ange efternamn (valfritt)","displayName":"Ange visningsnamn"},"helperText":{"displayName":"Detta \xe4r namnet som visas i appen"}},"validation":{"firstNameRequired":"F\xf6rnamn kr\xe4vs","firstNameMinLength":"F\xf6rnamn m\xe5ste vara minst 2 tecken","firstNameMaxLength":"F\xf6rnamn f\xe5r vara h\xf6gst 50 tecken","lastNameMaxLength":"Efternamn f\xe5r vara h\xf6gst 50 tecken","displayNameRequired":"Visningsnamn kr\xe4vs","displayNameMinLength":"Visningsnamn m\xe5ste vara minst 2 tecken","displayNameMaxLength":"Visningsnamn f\xe5r vara h\xf6gst 50 tecken","jerseyNumberRange":"Tr\xf6jnummer m\xe5ste vara mellan 1 och 99","jerseyNumberTaken":"Detta tr\xf6jnummer \xe4r redan upptaget","failedToUpdate":"Misslyckades uppdatera spelare"},"jerseyNumber":{"noNumber":"Inget tr\xf6jnummer","currentLabel":"#{{number}} (nuvarande)","allTaken":"Alla tr\xf6jnummer (1-99) \xe4r upptagna"},"playerInfo":{"header":"Spelarinformation","created":"Skapad:","lastUpdated":"Senast Uppdaterad:","unknown":"Ok\xe4nd"},"buttons":{"updatePlayer":"Uppdatera Spelare","updating":"Uppdaterar...","cancel":"Avbryt"}},"wizard":{"clubSelection":{"title":"V\xe4lj Din Klubb","description":"S\xf6k efter din klubb eller skapa en ny","placeholder":"Skriv klubbnamn...","cancel":"Avbryt"},"clubCreation":{"title":"Skapa Ny Klubb","description":"Ange klubbinformation","fullNameLabel":"Fullst\xe4ndigt Klubbnamn *","fullNamePlaceholder":"t.ex., Djurg\xe5rdens IF Fotboll","displayNameLabel":"Visningsnamn *","displayNamePlaceholder":"Ange klubbnamn","shortNameLabel":"Kortnamn (valfritt)","shortNamePlaceholder":"t.ex., DIF","shortNameHelper":"Anv\xe4nds f\xf6r f\xf6rkortningar och snabb identifiering","creating":"Skapar...","createButton":"Skapa Klubb"},"teamSelection":{"title":"V\xe4lj Lag","description":"S\xf6k efter ditt lag eller skapa ett nytt i <strong>{{clubName}}</strong>","placeholder":"Skriv ditt lagnamn...","existingTeamsHeader":"Befintliga Lag","createButton":"Skapa Nytt Lag"},"teamCreation":{"title":"Skapa Nytt Lag","description":"St\xe4ll in ditt lag f\xf6r <strong>{{clubName}}</strong>","teamNameLabel":"Lagnamn *","teamNamePlaceholder":"Ange lagnamn","teamNameHelper":"t.ex., \\"F16-6\\", \\"P16\\", \\"Juniorlag\\"","creating":"Skapar...","createButton":"Skapa Lag"},"playerCreation":{"title":"L\xe4gg Till Spelare","description":"L\xe4gg till spelare i <strong>{{teamName}}</strong>","playerNamePlaceholder":"Spelarens visningsnamn","addButton":"L\xe4gg Till","addedPlayersHeader":"Tillagda Spelare ({{count}})","laterNote":"Du kan l\xe4gga till fler spelare senare fr\xe5n laghanteringen.","completeButton":"Slutf\xf6r Konfiguration"},"complete":{"title":"Lagkonfiguration Klar!","description":"Ditt lag <strong>{{teamName}}</strong> har skapats."},"validation":{"clubNameRequired":"Klubbnamn kr\xe4vs","teamNameRequired":"Lagnamn kr\xe4vs","playerNameRequired":"Spelarnamn kr\xe4vs"}},"inviteModal":{"header":{"title":"Bjud In Lagmedlem","closeLabel":"St\xe4ng","teamFallback":"Lag"},"form":{"labels":{"email":"E-postadress","role":"Lagroll","message":"Personligt Meddelande"},"placeholders":{"email":"Ange e-postadress","message":"L\xe4gg till ett personligt meddelande till inbjudan..."},"hints":{"role":"V\xe4lj l\xe4mplig roll f\xf6r denna lagmedlem","messageOptional":"(valfritt)","characterCount":"{{count}}/500 tecken"},"roles":{"coach":"Tr\xe4nare","parent":"F\xf6r\xe4lder","player":"Spelare","admin":"Administrat\xf6r"}},"buttons":{"send":"Skicka Inbjudan","sending":"Skickar Inbjudan...","refresh":"F\xf6rnya","delete":"Ta Bort"},"validation":{"emailRequired":"E-postadress kr\xe4vs","emailInvalid":"Ange en giltig e-postadress","roleRequired":"V\xe4lj en roll","messageTooLong":"Meddelandet f\xe5r vara h\xf6gst 500 tecken","sendFailed":"Misslyckades skicka inbjudan. F\xf6rs\xf6k igen."},"success":{"invitationSent":"Inbjudan skickad!","invitationRefreshed":"Inbjudan f\xf6rnyad!","invitationDeleted":"Inbjudan borttagen!"},"invitations":{"pendingHeader":"V\xe4ntande Inbjudningar","expiredHeader":"Utg\xe5ngna Inbjudningar","countLabel":"({{count}})","noPending":"Inga v\xe4ntande inbjudningar","loading":"Laddar inbjudningar...","status":{"pending":"V\xe4ntande","expired":"Utg\xe5ngen"},"details":{"sent":"Skickad: {{date}}","remaining":"{{time}} kvar","hoursMinutesRemaining":"{{hours}}t {{minutes}}m kvar","minutesRemaining":"{{minutes}}m kvar"}},"info":{"title":"Vad h\xe4nder nu?","steps":{"emailSent":"Den inbjudna f\xe5r ett e-postmeddelande med en s\xe4ker inbjudningsl\xe4nk","accountSetup":"De kan skapa ett konto eller logga in om de redan har ett","autoAdded":"N\xe4r inbjudan accepteras l\xe4ggs de automatiskt till i ditt lag","manageRoles":"Du kan hantera deras roll och beh\xf6righeter n\xe4r som helst"}}},"loanModal":{"header":{"titleNew":"Registrera L\xe5n","titleEdit":"Redigera L\xe5n","subtitleNew":"Sp\xe5ra en spelares upptr\xe4dande f\xf6r annat lag","subtitleEdit":"Uppdatera l\xe5nedetaljer","closeLabel":"St\xe4ng"},"form":{"labels":{"players":"Spelare","receivingTeam":"Mottagande Lag","loanDate":"L\xe5nedatum"},"placeholders":{"players":"V\xe4lj en eller flera spelare","receivingTeam":"Ange mottagande lag"}},"validation":{"playersRequired":"V\xe4lj minst en spelare","receivingTeamRequired":"Mottagande lag kr\xe4vs","receivingTeamMaxLength":"Mottagande lag f\xe5r vara h\xf6gst 200 tecken","loanDateRequired":"L\xe5nedatum kr\xe4vs","saveFailed":"Misslyckades spara l\xe5nepost"},"buttons":{"cancel":"Avbryt","saving":"Sparar...","recordLoan":"Registrera L\xe5n","saveChanges":"Spara \xc4ndringar"}},"loansView":{"header":{"title":"Spelarl\xe5n","newLoanButton":"Nytt L\xe5n"},"filters":{"title":"Filter","expandLabel":"Visa filter","collapseLabel":"D\xf6lj filter","clearButton":"Rensa filter","labels":{"players":"Spelare","teams":"Lag","status":"Status","timePeriod":"Tidsperiod"},"placeholders":{"allPlayers":"Alla spelare","allTeams":"Alla lag"},"statusOptions":{"all":"Alla","upcoming":"Kommande","past":"Tidigare"}},"match":{"upcomingBadge":"Kommande","playersLabel":"Spelare ({{count}}):","editLabel":"Redigera match","deleteLabel":"Ta bort match"},"emptyStates":{"noLoans":{"title":"Inga l\xe5nmatcher registrerade \xe4n","description":"Sp\xe5ra n\xe4r dina spelare spelar f\xf6r andra lag.","button":"Registrera F\xf6rsta Matchen"},"noResults":{"title":"Inga l\xe5n hittades","description":"F\xf6rs\xf6k justera dina filter.","button":"Rensa Filter"},"loading":"Laddar l\xe5nmatcher..."},"messages":{"retry":"F\xf6rs\xf6k Igen","loanRecordedSingle":"L\xe5nmatch registrerad f\xf6r 1 spelare.","loanRecordedMultiple":"L\xe5nmatch registrerad f\xf6r {{count}} spelare.","loanUpdatedSingle":"L\xe5nmatch uppdaterad f\xf6r 1 spelare.","loanUpdatedMultiple":"L\xe5nmatch uppdaterad f\xf6r {{count}} spelare.","loanDeleted":"Tog bort {{count}} spelare fr\xe5n l\xe5nmatch.","loadFailed":"Misslyckades ladda spelarl\xe5n","rosterLoadFailed":"Misslyckades ladda trupp f\xf6r l\xe5n","deleteFailed":"Misslyckades ta bort l\xe5nmatch"},"deleteConfirmation":{"title":"Ta bort l\xe5nmatch","message":"Ta bort {{count}} spelare fr\xe5n l\xe5nmatchen {{teamName}} den {{date}}?","confirmButton":"Ta Bort Match","cancelButton":"Avbryt"},"fallback":{"unknownTeam":"Ok\xe4nt Lag","unknownPlayerDeleted":"Ok\xe4nd Spelare (borttagen)"}},"teamManagement":{"header":{"title":"Laghantering","teamSetup":"Laginst\xe4llning","back":"Tillbaka"},"loading":{"teamInfo":"Laddar laginformation..."},"success":{"teamCreated":"Laget skapat!","accessProcessed":"\xc5tkomstbeg\xe4ran behandlad!"},"tabs":{"overview":{"label":"\xd6versikt","description":"Laginformation och medlemmar"},"roster":{"label":"Truppen","description":"Hantera lagspelare"},"loans":{"label":"L\xe5n","description":"Sp\xe5ra spelarl\xe5n"},"access":{"label":"\xc5tkomsthantering","description":"Godk\xe4nn f\xf6rfr\xe5gningar och bjud in anv\xe4ndare"},"connectors":{"label":"Kopplingar","description":"Hantera externa plattformar"},"preferences":{"label":"Inst\xe4llningar","description":"Lag inst\xe4llningar och preferenser"}},"teamHeader":{"noClub":"Ingen klubb","roleAdmin":"Administrat\xf6r","roleCoach":"Tr\xe4nare","roleUser":"Anv\xe4ndare","users":"anv\xe4ndare","usersPlural":"anv\xe4ndare"},"overview":{"title":"Laginformation","teamName":"Lagnamn","club":"Klubb","teamCreated":"Lag Skapat","unknown":"Ok\xe4nd","teamUsers":"Laganv\xe4ndare","unknownUser":"Ok\xe4nd Anv\xe4ndare","noUsers":"Inga laganv\xe4ndare funna"},"access":{"title":"\xc5tkomsthantering","manageAccess":"Hantera \xc5tkomst","pendingRequests":"{{count}} v\xe4ntande \xe5tkomstbeg\xe4ran","pendingRequestsPlural":"{{count}} v\xe4ntande \xe5tkomstbeg\xe4randen","reviewDescription":"Granska och godk\xe4nn nya lagmedlemsbeg\xe4randen","noPendingDescription":"Inga v\xe4ntande beg\xe4randen f\xf6r tillf\xe4llet","reviewRequests":"Granska Beg\xe4randen","inviteUsers":"Bjud In Anv\xe4ndare","inviteDescription":"Skicka inbjudningar till nya lagmedlemmar","invitations":"Inbjudningar","memberRoles":"Medlemsroller","rolesDescription":"Hantera lagmedlemmars beh\xf6righeter","manageRoles":"Hantera Roller"},"roster":{"title":"Spelarhantering","playersCount":"{{count}} spelare","addPlayer":"L\xe4gg Till Spelare","loadingRoster":"Laddar trupp...","showFormer":"Visa F\xf6re Detta Spelare","hideFormer":"D\xf6lj F\xf6re Detta Spelare","noPlayersYet":"Inga Spelare \xc4nnu","buildRoster":"B\xf6rja bygga din lagtrupp genom att l\xe4gga till spelare.","addFirstPlayer":"L\xe4gg Till F\xf6rsta Spelaren","noActivePlayers":"Inga aktiva spelare funna.","table":{"player":"Spelare","connectionStatus":"Anslutningsstatus","number":"#","actions":"\xc5tg\xe4rder"},"ghost":{"from":"Fr\xe5n {{provider}}","accept":"Acceptera","adding":"L\xe4gger till...","dismiss":"Avvisa","dismissing":"Avvisar..."},"player":{"former":"F\xf6re Detta","editTitle":"Redigera spelare","loanTitle":"Registrera L\xe5n","removeTitle":"Ta bort spelare"},"connection":{"connectedProviders":"Anslutna Plattformar:","matchedAs":"Matchad som:","needsMatching":"Beh\xf6ver Matchning","notMatched":"Denna spelare \xe4r inte matchad till n\xe5gon leverant\xf6rsdata \xe4n.","matchPlayer":"Matcha Spelare"},"success":{"playerMatched":"Spelare matchad till n\xe4rvarodata","ghostAdded":"{{playerName}} tillagd i truppen","ghostDismissed":"{{playerName}} avvisad","playerDeactivated":"{{playerName}} har inaktiverats men beh\xe5llits i register p\xe5 grund av matchhistorik.","playerRemoved":"{{playerName}} har tagits bort fr\xe5n truppen.","loanRecorded":"{{playerName}} l\xe5nmatch registrerad.","loanRecordedMultiple":"{{count}} spelares l\xe5nmatch registrerad."},"error":{"loadFailed":"Misslyckades ladda lagtrupp","addFailed":"Misslyckades l\xe4gga till spelare i truppen","dismissFailed":"Misslyckades avvisa spelare"}},"preferences":{"title":"Laginst\xe4llningar","loadingPreferences":"Laddar inst\xe4llningar...","matchSettings":"Matchinst\xe4llningar","matchFormat":"Matchformat","formation":"Formation","comingSoon":"Kommer Snart","timeSettings":"Tidsinst\xe4llningar","periodLength":"Periodl\xe4ngd (minuter)","numPeriods":"Antal Perioder","period":"Period","periods":"Perioder","substitutionSettings":"Bytesregler","alternateRoles":"Rotera roller r\xe4ttvist \xf6ver tid","alternateRolesTooltip":{"title":"R\xe4ttvis Rollrotation","description":"N\xe4r aktiverad kommer appen f\xf6resl\xe5 byten som s\xe4kerst\xe4ller att alla spelare f\xe5r liknande tid i varje roll (back, mittf\xe4lt, forward) under s\xe4songen."},"substitutionLogic":"Byteslogik","substitutionOptions":{"equalTime":"Lika Tid i Varje Roll","sameRole":"Beh\xe5ll Samma Roll"},"gameFeatures":"Matchfunktioner","trackGoalScorer":"Sp\xe5ra M\xe5lskyttar","fairPlayAward":"Fair Play-pris","fairPlayOptions":{"none":"Inga Priser","leagueOnly":"Endast Serie","competitive":"Serie, Cup och Turnering","allGames":"Alla Matcher"},"teamCaptain":"Lagkapten","teamCaptainOptions":{"none":"Ingen Lagkapten","permanent":"Permanent Lagkapten","assignEach":"Tilldela Varje Match"},"permanentCaptain":"Permanent Lagkapten","selectCaptain":"V\xe4lj Lagkapten","loadingPlayers":"Laddar spelare...","addPlayersForCaptain":"L\xe4gg till spelare i din trupp f\xf6r att v\xe4lja en lagkapten.","statistics":"Statistik","loanMatchWeight":"L\xe5nmatchvikt","loanWeightOptions":{"full":"Hel Match (1.0)","half":"Halv Match (0.5)","none":"Ingen Kredit (0.0)"},"loanWeightDescription":"Styr hur l\xe5nmatcher r\xe4knas mot s\xe4songsstatistik.","unnamedPlayer":"Namnl\xf6s Spelare","previousCaptain":"Tidigare vald lagkapten","errors":{"selectCaptain":"V\xe4lj en spelare som permanent lagkapten.","unsupportedFormat":"Endast 5v5 och 7v7 format st\xf6ds f\xf6r n\xe4rvarande. V\xe4lj ett format som st\xf6ds innan du sparar.","saveFailed":"Misslyckades spara inst\xe4llningar. F\xf6rs\xf6k igen.","loadFailed":"Misslyckades ladda inst\xe4llningar","loadRosterFailed":"Misslyckades ladda laguppst\xe4llningen"},"success":{"saved":"Inst\xe4llningar sparade"}}},"roleManagement":{"title":"Hantera Lagroller","managePermissions":"Hantera roller och beh\xf6righeter f\xf6r {{count}} lagmedlem","managePermissionsPlural":"Hantera roller och beh\xf6righeter f\xf6r {{count}} lagmedlemmar","security":{"title":"S\xe4kerhetsrestriktioner","cannotModifySelf":"Du kan inte \xe4ndra din egen roll eller ta bort dig sj\xe4lv","adminProtected":"Administrat\xf6rsroller \xe4r skyddade fr\xe5n \xe4ndring av andra administrat\xf6rer","lastAdmin":"Minst en administrat\xf6r m\xe5ste finnas kvar i laget"},"roles":{"admin":"Administrat\xf6r","adminDescription":"Fullst\xe4ndig laghanterings\xe5tkomst","coach":"Tr\xe4nare","coachDescription":"Hantera lag och spelare","player":"Spelare","playerDescription":"Grundl\xe4ggande lagmedlem","parent":"F\xf6r\xe4lder","parentDescription":"Visa laginformation"},"badges":{"you":"Du","lastAdmin":"Sista Admin"},"errors":{"coachCannotPromote":"Tr\xe4nare kan inte befordra medlemmar till administrat\xf6rsroll","cannotModifySelf":"Du kan inte \xe4ndra din egen roll","cannotModifyAdmin":"Administrat\xf6rer kan inte \xe4ndra andra administrat\xf6rers roller","lastAdminDemotion":"Kan inte degradera den sista administrat\xf6ren. Minst en administrat\xf6r m\xe5ste finnas kvar.","noChanges":"Inga \xe4ndringar att spara","updateFailed":"Misslyckades uppdatera medlemsroller","cannotRemoveSelf":"Du kan inte ta bort dig sj\xe4lv fr\xe5n laget","cannotRemoveAdmin":"Administrat\xf6rer kan inte tas bort. Degradera dem f\xf6rst, sedan ta bort.","removeFailed":"Misslyckades ta bort lagmedlem"},"success":{"rolesUpdated":"Uppdaterade {{count}} medlemsroll(er)","memberRemoved":"Tog bort {{name}} fr\xe5n laget"},"pendingChange":"Rollen \xe4ndras fr\xe5n {{from}} till {{to}}","unsavedChanges":"{{count}} osparad(e) \xe4ndring(ar)","confirmRemove":"\xc4r du s\xe4ker p\xe5 att du vill ta bort {{name}} fr\xe5n laget?","buttons":{"cancel":"Avbryt","close":"St\xe4ng","saving":"Sparar...","saveChanges":"Spara \xc4ndringar"},"tooltips":{"cannotRemoveSelf":"Kan inte ta bort dig sj\xe4lv","cannotRemoveAdmin":"Kan inte ta bort administrat\xf6rer","removeFromTeam":"Ta bort fr\xe5n laget"},"noMembers":"Inga lagmedlemmar hittades","unknownUser":"Ok\xe4nd Anv\xe4ndare"},"deletePlayerModal":{"title":"Ta Bort Spelare","subtitleDelete":"Denna spelare kommer att tas bort permanent","subtitleDeactivate":"Denna spelare kommer att inaktiveras","status":{"active":"Aktiv","inactive":"Inaktiv"},"warning":{"title":"\xc4r du s\xe4ker p\xe5 att du vill ta bort denna spelare?","permanentDelete":"tas bort permanent","permanentDeleteFull":"Spelaren har ingen matchhistorik och kommer att tas bort permanent","cannotUndo":"Denna \xe5tg\xe4rd kan inte \xe5ngras","deactivated":"inaktiveras","deactivatedFull":"Spelaren har matchhistorik och kommer att inaktiveras (s\xe4ttas som inaktiv)"},"whatHappensNext":"Vad h\xe4nder nu","deleteConsequences":{"jerseyAvailable":"Tr\xf6jnumret blir tillg\xe4ngligt f\xf6r andra spelare"},"deactivateConsequences":{"statsPreserved":"All matchstatistik och historik bevaras","jerseyAvailable":"Tr\xf6jnumret blir tillg\xe4ngligt f\xf6r andra spelare","canReactivate":"Spelaren kan \xe5teraktiveras senare vid behov"},"buttons":{"deletePlayer":"Ta Bort Spelare","deactivatePlayer":"Inaktivera Spelare","cancel":"Avbryt"},"unknownPlayer":"Ok\xe4nd Spelare"},"invitationNotification":{"title":"Laginbjudningar","closeLabel":"St\xe4ng","successJoined":"Gick med i {{teamName}}!","inviteDescription":"Du har blivit inbjuden att g\xe5 med i ett lag. V\xe4lj att acceptera eller avb\xf6ja varje inbjudan nedan.","inviteDescriptionPlural":"Du har blivit inbjuden att g\xe5 med i {{count}} lag. V\xe4lj att acceptera eller avb\xf6ja varje inbjudan nedan.","role":"Roll: {{role}}","expires":"Utg\xe5r: {{date}}","invitedBy":"Inbjuden av {{name}}","buttons":{"declining":"Avb\xf6jer...","decline":"Avb\xf6j","accepting":"Accepterar...","accept":"Acceptera","decideLater":"Jag best\xe4mmer mig senare"}},"clubAutocomplete":{"placeholder":"S\xf6k efter din klubb...","createNewClub":"Skapa ny klubb","noClubsFound":"Inga klubbar hittades f\xf6r \\"{{query}}\\""},"teamAutocomplete":{"placeholder":"S\xf6k efter ett lag...","createNewTeam":"Skapa nytt lag","noTeamsFound":"Inga lag hittades f\xf6r \\"{{query}}\\""},"playerMatching":{"title":"Matcha Spelare till Leverant\xf6r","subtitle":"L\xe4nka truppspelare till n\xe4rvarodata","rosterPlayer":"Truppspelare","selectProvider":"V\xe4lj en spelare fr\xe5n leverant\xf6r...","selectProviderLabel":"Matcha till Leverant\xf6rsspelare *","selectProviderHelp":"V\xe4lj vilken spelare fr\xe5n de anslutna plattformarna som matchar denna truppspelare.","errors":{"selectPlayer":"V\xe4lj en spelare fr\xe5n plattformen","matchFailed":"Misslyckades matcha spelare"},"buttons":{"cancel":"Avbryt","matching":"Matchar...","matchPlayer":"Matcha Spelare"}},"clubJoin":{"title":"G\xe5 Med i Klubb","successTitle":"Gick Med!","successMessage":"Du har g\xe5tt med i {{clubName}}. Du kan nu komma \xe5t lag inom denna klubb.","joinBenefitsTitle":"G\xe5 med i denna klubb f\xf6r att:","benefits":{"accessTeams":"Komma \xe5t lag inom klubben","requestJoin":"Beg\xe4ra att g\xe5 med i befintliga lag","createTeams":"Skapa nya lag f\xf6r klubben"},"buttons":{"cancel":"Avbryt","joining":"G\xe5r med...","joinClub":"G\xe5 Med i Klubb"}},"clubMembership":{"title":"Klubbhantering","subtitle":"Hantera dina klubbmedlemskap och uppt\xe4ck nya klubbar","tabs":{"myClubs":"Mina Klubbar","findClubs":"Hitta Klubbar","requests":"F\xf6rfr\xe5gningar"},"myClubs":{"title":"Mina Klubbar","empty":"Du \xe4r inte medlem i n\xe5gra klubbar \xe4nnu","emptyHint":"S\xf6k efter klubbar f\xf6r att beg\xe4ra medlemskap","joined":"Gick med {{date}}"},"search":{"title":"Hitta Klubbar","placeholder":"S\xf6k efter klubbar...","searching":"S\xf6ker...","searchButton":"S\xf6k","resultsTitle":"S\xf6kresultat","joined":"Medlem","joinClub":"G\xe5 Med i Klubb","noResults":"Inga klubbar hittades som matchar \\"{{query}}\\"","noResultsHint":"Prova ett annat s\xf6kord eller be en klubbadministrat\xf6r att bjuda in dig"},"requests":{"title":"V\xe4ntande F\xf6rfr\xe5gningar","empty":"Inga v\xe4ntande medlemsf\xf6rfr\xe5gningar","wantsToJoin":"vill g\xe5 med i {{clubName}}","requested":"Beg\xe4rd {{date}}","reject":"Avvisa","approve":"Godk\xe4nn"}},"teamSelector":{"title":"V\xe4lj Ditt Lag","newTeam":"Nytt Lag","current":"Nuvarande","availableTeams":"Tillg\xe4ngliga Lag ({{count}})","role":"Roll: {{role}}","loading":"Laddar lag...","noTeamsTitle":"Inga Lag Hittade","noTeamsMessage":"Du har inte tillg\xe5ng till n\xe5gra lag \xe4nnu. Skapa ditt f\xf6rsta lag f\xf6r att komma ig\xe5ng.","createOrJoin":"Skapa eller G\xe5 Med i ett Lag"},"teamMatches":{"title":"Lagmatcher","back":"Tillbaka","loading":"Laddar matcher...","error":{"loadFailed":"Misslyckades ladda matcher","loadUpcomingFailed":"Misslyckades ladda kommande matcher","tryAgain":"F\xf6rs\xf6k Igen","copyFailed":"Misslyckades kopiera l\xe4nk","deleteFailed":"Misslyckades ta bort v\xe4ntande match"},"empty":{"title":"Inga Aktiva Matcher","description":"Ditt lag har inga v\xe4ntande eller p\xe5g\xe5ende matcher just nu."},"states":{"running":"P\xe5g\xe5r","pending":"V\xe4ntande","upcoming":"Kommande"},"notifications":{"linkCopied":"L\xe4nk Kopierad","linkCopiedMessage":"Livematchl\xe4nk kopierad till urklipp!","liveMatchUrl":"Livematch-URL","couldNotCopy":"Kunde inte kopiera l\xe4nk","error":"Fel","matchDeleted":"Match Borttagen","matchDeletedMessage":"V\xe4ntande match borttagen."},"timestamps":{"noDate":"Inget datum","today":"Idag kl {{time}}","yesterday":"Ig\xe5r kl {{time}}","dateTbd":"Datum ej best\xe4mt"},"buttons":{"resumeSetup":"\xc5teruppta","openLive":"\xd6ppna Live","copying":"Kopierar...","copyLink":"Kopiera L\xe4nk","deleting":"Tar bort...","delete":"Ta Bort","plan":"Planera"},"upcoming":{"title":"Kommande Matcher","description":"Framtida matcher fr\xe5n anslutna scheman. Inte planerade \xe4nnu.","notPlanned":"Inte planerad \xe4nnu"},"planModal":{"title":"Planera Matcher","cancel":"Avbryt","planSelected":"Planera Valda"}},"planMatches":{"title":"Planera Matcher","back":"Tillbaka","teamRequired":"Lagkontext kr\xe4vs.","noMatches":"Inga matcher valda.","toolbar":{"sortByPractices":"Sortera efter tr\xe4ningar per match","sortByAttendance":"Sortera efter n\xe4rvaroprocent","statsLoading":"Statistik...","recommend":"Rekommendera"},"autoSelect":{"title":"Automatiskt Urval","squadSizeMulti":"Truppstorlek per match","squadSizeSingle":"Truppstorlek f\xf6r denna match","ensureCoverage":"Varje spelare spelar minst en match?","prioritizePractices":"Prioritera tr\xe4ningar/matchpo\xe4ng","prioritizeAttendance":"Prioritera n\xe4rvaroprocent","cancel":"Avbryt","apply":"Till\xe4mpa"},"matchCard":{"saving":"Sparar...","saved":"Sparad","save":"Spara","roster":"Truppen","selected":"Valda","empty":"Tom.","reset":"\xc5terst\xe4ll"},"playerSelector":{"noPlayers":"Inga truppspelare.","markAvailable":"Markera tillg\xe4nglig","markUnavailable":"Markera ej tillg\xe4nglig","providerUnavailable":"Ej tillg\xe4nglig (rapporterad)","practicesTooltip":"Tr\xe4ningar per match"},"notifications":{"noPlayersTitle":"Inga spelare valda","noPlayersMessage":"V\xe4lj spelare innan du planerar denna match.","matchPlanned":"Match planerad","pendingCreated":"V\xe4ntande match skapad.","planningFailed":"Planering misslyckades","planningFailedMessage":"Misslyckades planera match."},"unknownPlayer":"Ok\xe4nd Spelare"},"accessRequestModal":{"header":{"title":"Lag\xe5tkomst"},"tabs":{"request":"Beg\xe4r \xc5tkomst","manageRequests":"Hantera F\xf6rfr\xe5gningar","teamManagement":"Laghantering"},"request":{"header":{"title":"Beg\xe4r Lag\xe5tkomst","subtitle":"Beg\xe4r att g\xe5 med i"},"form":{"roleLabel":"\xd6nskad Roll *","roleHint":"Lagtr\xe4naren kommer att granska och tilldela din slutliga roll","messageLabel":"Meddelande till Lagtr\xe4naren","messagePlaceholder":"Presentera dig sj\xe4lv och f\xf6rklara varf\xf6r du vill g\xe5 med i detta lag...","characterCount":"{{count}}/500 tecken","roles":{"coach":"Tr\xe4nare","parent":"F\xf6r\xe4lder","admin":"Administrat\xf6r"}},"buttons":{"cancel":"Avbryt","sending":"Skickar...","sendRequest":"Skicka F\xf6rfr\xe5gan","close":"St\xe4ng"},"success":{"submitted":"F\xf6rfr\xe5gan skickad! Lagadministrat\xf6ren kommer att granska din f\xf6rfr\xe5gan."},"warnings":{"pendingTitle":"F\xf6rfr\xe5gan V\xe4ntande","pendingMessage":"Du har redan en v\xe4ntande f\xf6rfr\xe5gan f\xf6r detta lag"},"yourRequests":{"title":"Dina F\xf6rfr\xe5gningar","role":"Roll: {{role}}","messageLabel":"Meddelande:","reviewLabel":"Granskning:","cancel":"Avbryt"},"status":{"pending":"v\xe4ntande","approved":"godk\xe4nd","rejected":"avvisad"}},"manage":{"header":{"title":"Hantera Lagf\xf6rfr\xe5gningar","badgeAdmin":"Administrat\xf6r","badgeCoach":"Tr\xe4nare","subtitle":"Granska \xe5tkomstf\xf6rfr\xe5gningar f\xf6r","adminPrivileges":"Du har fullst\xe4ndiga administrat\xf6rsbeh\xf6righeter f\xf6r detta lag"},"empty":{"title":"Inga v\xe4ntande f\xf6rfr\xe5gningar","description":"Nya lag\xe5tkomstf\xf6rfr\xe5gningar kommer att visas h\xe4r"},"privacyNotice":"\ud83d\udce7 E-postadresser visas f\xf6r att hj\xe4lpa till att identifiera f\xf6rfr\xe5gande personer och \xe4r endast synliga f\xf6r lagadministrat\xf6rer.","request":{"unnamedUser":"Namnl\xf6s Anv\xe4ndare","requestedRole":"\xd6nskad roll:","messageLabel":"Meddelande:","statusPending":"V\xe4ntande","atTime":"kl"},"buttons":{"reject":"Avvisa","approve":"Godk\xe4nn som {{role}}","rejectReason":"F\xf6rfr\xe5gan nekad av lagtr\xe4naren"},"members":{"title":"Lagmedlemmar ({{count}})","empty":"Inga lagmedlemmar hittades","joined":"Gick med {{date}}","remove":"Ta Bort","cannotRemoveAdmin":"Kan inte ta bort administrat\xf6r","removeMember":"Ta bort medlem","confirmRemove":"\xc4r du s\xe4ker p\xe5 att du vill ta bort denna medlem fr\xe5n laget?","removed":"Medlem borttagen fr\xe5n laget"}},"success":{"requestApproved":"F\xf6rfr\xe5gan godk\xe4nd!"}},"errors":{"loadTeams":"Misslyckades ladda lag","loginRequired":"Du m\xe5ste vara inloggad f\xf6r att forts\xe4tta","createClub":"Misslyckades skapa klubb","createTeam":"Misslyckades skapa lag","teamNameExists":"Ett lag med detta namn finns redan i denna klubb. Beg\xe4r att g\xe5 med i det befintliga laget.","noTeamSelected":"Inget lag valt","createPlayer":"Misslyckades skapa spelare","teamNotFound":"Laget hittades inte","initUserData":"Misslyckades initiera anv\xe4ndardata","checkClubMembership":"Misslyckades kontrollera klubbmedlemskap","alreadyClubMember":"Du \xe4r redan medlem i denna klubb","joinClub":"Misslyckades g\xe5 med i klubb","clubMembershipNotFound":"Klubbmedlemskap hittades inte","loginRequiredLeaveClub":"Du m\xe5ste vara inloggad f\xf6r att l\xe4mna klubb","leaveClub":"Misslyckades l\xe4mna klubb","teamMembershipNotFound":"Lagmedlemskap hittades inte","loginRequiredLeaveTeam":"Du m\xe5ste vara inloggad f\xf6r att l\xe4mna lag","leaveTeam":"Misslyckades l\xe4mna lag","loginRequiredDeleteTeam":"Du m\xe5ste vara inloggad f\xf6r att ta bort lag","deleteTeam":"Misslyckades ta bort lag","approveClubMembership":"Misslyckades godk\xe4nna klubbmedlemskap","rejectClubMembership":"Misslyckades avvisa klubbmedlemskap","loginRequiredInvite":"Du m\xe5ste vara inloggad f\xf6r att skicka inbjudningar","noPermissionInvite":"Du har inte beh\xf6righet att bjuda in anv\xe4ndare till detta lag","coachCannotInviteAdmin":"Tr\xe4nare kan inte bjuda in anv\xe4ndare som administrat\xf6rer","sendInvitation":"Misslyckades skicka inbjudan","cancelInvitation":"Misslyckades avbryta inbjudan","loginRequiredAccept":"Du m\xe5ste vara inloggad f\xf6r att acceptera inbjudningar","acceptInvitation":"Misslyckades acceptera inbjudan","loadInvitations":"Misslyckades ladda v\xe4ntande inbjudningar","loginRequiredDecline":"Du m\xe5ste vara inloggad f\xf6r att avb\xf6ja inbjudningar","declineInvitation":"Misslyckades avb\xf6ja inbjudan","loginRequiredRefresh":"Du m\xe5ste vara inloggad f\xf6r att f\xf6rnya inbjudningar","refreshInvitation":"Misslyckades f\xf6rnya inbjudan","loginRequiredDelete":"Du m\xe5ste vara inloggad f\xf6r att ta bort inbjudningar","deleteInvitation":"Misslyckades ta bort inbjudan","pendingRequestExists":"Du har redan en v\xe4ntande f\xf6rfr\xe5gan f\xf6r detta lag. V\xe4nta tills den nuvarande f\xf6rfr\xe5gan har granskats, eller avbryt den f\xf6rst f\xf6r att skicka en ny.","requestTeamAccess":"Misslyckades beg\xe4ra lag\xe5tkomst","fetchRequestDetails":"Misslyckades h\xe4mta f\xf6rfr\xe5gandetaljer","addUserToTeam":"Misslyckades l\xe4gga till anv\xe4ndare i laget","updateRequestStatus":"Misslyckades uppdatera f\xf6rfr\xe5gans status","approveTeamAccess":"Misslyckades godk\xe4nna lag\xe5tkomst","rejectTeamAccess":"Misslyckades avvisa lag\xe5tkomst","cancelRequest":"Misslyckades avbryta f\xf6rfr\xe5gan","updateMemberRole":"Misslyckades uppdatera medlemsroll","removeTeamMember":"Misslyckades ta bort lagmedlem","genericError":"Ett ov\xe4ntat fel uppstod","loginRequiredCreateTeam":"Du m\xe5ste vara inloggad f\xf6r att skapa ett lag","loginRequiredCreateClub":"Du m\xe5ste vara inloggad f\xf6r att skapa klubb"},"context":{"invitationSentTo":"Inbjudan skickad till {{email}}","welcomeToTeam":"V\xe4lkommen till laget! Du har lagts till.","invitationDeclined":"Inbjudan avb\xf6jd","invitationDeleted":"Inbjudan borttagen","teamFallbackName":"Lag","teamAdminFallback":"Lagadministrat\xf6r"}}'),Ge=JSON.parse('{"multiSelect":{"allSelected":"Alla valda","selected":"valda","noOptions":"Inga alternativ tillg\xe4ngliga","clearSelection":"Rensa val","done":"Klar"},"badges":{"comingSoon":"Kommer Snart","new":"Nytt","beta":"Beta"},"loading":"Laddar...","error":"Ett fel uppstod","retry":"F\xf6rs\xf6k Igen","close":"St\xe4ng","ok":"OK","back":"Tillbaka","inactive":"Inaktiv","opponent":"Motst\xe5ndare","user":"Anv\xe4ndare"}'),ze=JSON.parse('{"abandonMatch":{"titleRunning":"Avbryt Aktiv Match?","titleNotRunning":"Starta Nytt Spel?","messageRunning":"Du har en aktiv match som p\xe5g\xe5r. All matchdata, spelarstatistik och spelhistorik kommer permanent att g\xe5 f\xf6rlorad om du startar en ny match.","messageNotRunning":"Detta kommer att \xe5terst\xe4lla din nuvarande session och ta dig tillbaka till konfigurationssk\xe4rmen.","subtitleRunning":"Data kommer permanent att g\xe5 f\xf6rlorad","subtitleNotRunning":"Nuvarande session kommer att \xe5terst\xe4llas","cancel":"\xc5ngra","abandonMatch":"Avbryt Match","startNewGame":"Starta Nytt Spel"},"matchRecovery":{"title":"Spara Match?","subtitle":"Hittade en avslutad match som inte sparades","matchDetails":"Matchdetaljer","unknownDate":"Ok\xe4nt datum","unknownDuration":"Ok\xe4nd l\xe4ngd","unknown":"Ok\xe4nd","wonScore":"Vinst {{score}}","lostScore":"F\xf6rlust {{score}}","drewScore":"Oavgjort {{score}}","vsOpponent":"mot {{opponent}}","formatInfo":"Format: {{format}} \u2022 Formation: {{formation}}","explanation":"Denna match avslutades men sparades inte i din matchhistorik. Du kan antingen spara den nu f\xf6r att bevara statistiken, eller radera den permanent.","savingMatch":"Sparar Match...","saveToHistory":"Spara till Matchhistorik","deletingMatch":"Raderar Match...","deleteMatchPermanently":"Radera Match Permanent","tip":"Att spara till historik bevarar spelarstatistik och prestandadata"},"pendingMatchResume":{"title":"\xc5teruppta Matchkonfiguration","noMatchesFound":"Inga sparade matcher hittades","matchesFound":"{{count}} sparad match hittad","matchesFound_other":"{{count}} sparade matcher hittade","noPendingMatches":"Inga V\xe4ntande Matcher","noPendingDescription":"Du har inga sparade matchkonfigurationer.","continueToConfigureNew":"Forts\xe4tt till Konfigurera Ny Match","vsOpponent":"mot {{opponent}}","unknownOpponent":"Ok\xe4nt Motst\xe5ndare","createdBy":"Skapad av {{name}}","typeLabel":"Typ:","formatLabel":"Format:","periodsFormat":"{{periods}} \xd7 {{duration}} min perioder","squadLabel":"Truppen:","squadInfo":"{{size}} spelare, {{formation}} formation","resuming":"\xc5terupptar...","resumeSetup":"\xc5teruppta Konfiguration","deleting":"Raderar...","delete":"Radera","configureNewMatch":"Konfigurera Ny Match","cancel":"Avbryt","tip":"\xc5teruppta Konfiguration tar dig till konfigurationssk\xe4rmen d\xe4r du kan granska och \xe4ndra inst\xe4llningar","processing":"Bearbetar...","dateAtTime":"{{date}} kl. {{time}}","unknownFormation":"Ok\xe4nd"},"addPlayer":{"title":"L\xe4gg Till Spelare","message":"V\xe4lj hur du vill l\xe4gga till en spelare.","addToTeam":"L\xe4gg Till Spelare i Laget","addTemporary":"L\xe4gg Till Tillf\xe4llig Spelare","cancel":"Avbryt"},"addTemporaryPlayer":{"title":"L\xe4gg Till Tillf\xe4llig Spelare","description":"Denna spelare kommer endast att synas i nuvarande match och l\xe4ggs inte till i lagupps\xe4ttningen.","playerNameLabel":"Spelarnamn","playerNamePlaceholder":"Ange spelarnamn","cancel":"Avbryt","addPlayer":"L\xe4gg Till Spelare"},"goalScorer":{"title":"Vem Gjorde M\xe5l?","selectPlayer":"V\xe4lj spelaren som gjorde m\xe5l","noPlayers":"Inga tillg\xe4ngliga spelare","cancel":"Avbryt","correctGoalScorer":"Korrigera M\xe5lskytt","goalInformation":"M\xe5linformation","goalAt":"M\xe5l vid {{time}}","scoredGoalAt":"Gjort m\xe5l vid {{time}}","concededGoalAt":"Insl\xe4ppt m\xe5l vid {{time}}","updateScorer":"Uppdatera M\xe5lskytt","confirmScorer":"Bekr\xe4fta M\xe5lskytt","currentScorer":"Nuvarande M\xe5lskytt","noScorerRecorded":"Ingen m\xe5lskytt registrerad","selectNewScorer":"V\xe4lj Ny M\xe5lskytt:","selectScorer":"V\xe4lj M\xe5lskytt:","noSpecificScorer":"Ingen specifik m\xe5lskytt","goalDetails":"M\xe5ldetaljer:","team":"Lag","scored":"Gjort","conceded":"Insl\xe4ppt","time":"Tid","period":"Period","scorer":"M\xe5lskytt","unknown":"Ok\xe4nd","readOnlyNotice":"Denna m\xe5linformation \xe4r skrivskyddad. Anv\xe4nd korrigeringsl\xe4ge f\xf6r att g\xf6ra \xe4ndringar."},"fieldPlayer":{"title":"Alternativ f\xf6r F\xe4ltspelare","changePositionTitle":"Byt Position","message":"Vad vill du g\xf6ra med {{playerName}}?","selectPositionSwitch":"V\xe4lj vilken spelare som ska byta position med {{playerName}}:","cancel":"Avbryt","back":"Tillbaka","removeFromNext":"Ta bort fr\xe5n n\xe4sta byte","setToGoOffNext":"St\xe4ll in f\xf6r att g\xe5 av n\xe4sta","substituteNow":"Byt ut nu","changePosition":"Byt position","tooltipCannotModify":"Alla avbytare \xe4r inaktiva - kan inte modifiera bytesordning","tooltipCannotSetNext":"Alla avbytare \xe4r inaktiva - kan inte s\xe4tta som n\xe4sta","tooltipCannotSubstitute":"Alla avbytare \xe4r inaktiva - kan inte byta ut"},"substitute":{"title":"Alternativ f\xf6r Avbytare","changeNextPositionTitle":"Byt N\xe4sta Position","message":"Vad vill du g\xf6ra med {{playerName}}?","selectNextPosition":"V\xe4lj vilken position {{playerName}} ska ta n\xe4r hen kommer in:","cancel":"Avbryt","back":"Tillbaka","changeNextPosition":"Byt n\xe4sta position","setToGoInNext":"St\xe4ll in f\xf6r att g\xe5 in n\xe4sta","putBackInRotation":"S\xe4tt tillbaka {{playerName}} i bytesordning","takeOutOfRotation":"Ta ut {{playerName}} ur bytesordning"},"goalie":{"title":"Byt M\xe5lvakt","message":"V\xe4lj en ny m\xe5lvakt som ers\xe4tter {{goalieName}}:","cancel":"Avbryt","inactive":"(Inaktiv)"},"scoreEdit":{"title":"Redigera Resultat","cancel":"Avbryt","saveScore":"Spara Resultat"},"scoreManager":{"title":"Hantera Resultat","goalsScored":"Gjorda M\xe5l","noGoalsRecorded":"Inga m\xe5l registrerade \xe4n","opponent":"Motst\xe5ndare","edit":"Redigera","delete":"Ta bort","addGoal":"L\xe4gg Till M\xe5l","close":"St\xe4ng","unknownScorer":"Ok\xe4nd m\xe5lskytt","scorerNotTracked":"M\xe5lskytt ej sp\xe5rad"},"substituteSelection":{"title":"V\xe4lj Avbytare","message":"V\xe4lj vilken avbytare som ska komma in f\xf6r {{fieldPlayerName}}:","cancel":"Avbryt"},"preferences":{"title":"Inst\xe4llningar","loadingPreferences":"Laddar inst\xe4llningar...","substitutionAlerts":"Byteslarm","enableAudioAlerts":"Aktivera Ljudlarm","enableAudioDescription":"Spela ljud n\xe4r bytestimern n\xe5r larmtiden","disableAudioLabel":"Inaktivera ljudlarm","enableAudioLabel":"Aktivera ljudlarm","alertSound":"Larmljud","loadingSound":"Laddar ljud...","previewSound":"F\xf6rhandsgranska valt ljud","unableToPreview":"Kan inte f\xf6rhandsgranska ljud: {{error}}","playingPreview":"Spelar f\xf6rhandsgranskning...","volume":"Volym","noteLabel":"Obs:","audioNote":"Ljudlarm fungerar tillsammans med vibrationslarm. Om din webbl\xe4sare blockerar ljuduppspelning anv\xe4nds bara vibration. Larmtiden konfigureras i spelinst\xe4llningssk\xe4rmen.","language":"Spr\xe5k","applicationLanguage":"Applikationsspr\xe5k","moreLanguages":"Fler spr\xe5k kommer snart!","uiTheme":"Gr\xe4nssnittstema","colorTheme":"F\xe4rgtema","moreThemes":"Fler teman kommer snart!","cancel":"Avbryt","saveChanges":"Spara \xc4ndringar"},"featureVote":{"voteRecorded":"R\xf6st Registrerad!","voteAlreadyRecorded":"R\xf6st Redan Registrerad","voteFailed":"R\xf6stning Misslyckades","featureComingSoon":"Funktion Kommer Snart!","featureDescription":"Formationen \\"{{featureName}}\\" \xe4r inte implementerad \xe4nnu. Du kan r\xf6sta f\xf6r att den ska prioriteras.","close":"St\xe4ng","cancel":"Avbryt","signInToVote":"Logga In f\xf6r att R\xf6sta","submitting":"Skickar...","voteFor":"R\xf6sta f\xf6r {{featureName}}"},"confirmations":{"areYouSure":"\xc4r du s\xe4ker?","cannotUndo":"Denna \xe5tg\xe4rd kan inte \xe5ngras.","confirm":"Bekr\xe4fta","cancel":"Avbryt"},"endPeriodEarly":{"title":"Avsluta Period i F\xf6rtid?","message":"Det \xe5terst\xe5r fortfarande {{timeString}} av denna period. \xc4r du s\xe4ker p\xe5 att du vill avsluta perioden i f\xf6rtid?"},"signOutDuringMatch":{"title":"Logga Ut Under Aktiv Match?","message":"Du har en match som p\xe5g\xe5r. Om du loggar ut nu kan sp\xe5rningen av denna match avbrytas. \xc4r du s\xe4ker p\xe5 att du vill logga ut?","confirmSignOut":"Logga Ut","cancelStayLoggedIn":"Forts\xe4tt Inloggad"},"unableToSaveMatch":{"title":"Kunde Inte Spara Match","retrying":"F\xf6rs\xf6ker igen...","retry":"F\xf6rs\xf6k Igen","continueWithoutSaving":"Forts\xe4tt utan att spara"},"newGame":{"title":"Starta ny match?","message":"\xc4r du s\xe4ker p\xe5 att du vill starta en ny match? Detta \xe5terst\xe4ller alla framsteg och tar dig tillbaka till konfigurationssk\xe4rmen.","stayOnPage":"Stanna kvar","yesStartNewGame":"Ja, starta ny match","leaveSportWizard":"L\xe4mna Sport Wizard"}}'),Ve=JSON.parse('{"header":{"title":"Matchrapport","noStartTime":"Ingen starttid registrerad","durationUnknown":"L\xe4ngd ok\xe4nd"},"navigation":{"summary":"Sammanfattning","timeline":"Tidslinje","playerStats":"Spelarstatistik"},"timeline":{"title":"Matchh\xe4ndelser","noEvents":"Inga h\xe4ndelser registrerade","toggleSubstitutions":"Byten","eventTypes":{"goal":"M\xe5l","substitution":"Byte","periodStart":"Period Start","periodEnd":"Period Slut"}},"playerStats":{"title":"Spelarstatistik","name":"Spelare","playingTime":"Speltid","goals":"M\xe5l","position":"Position","timeAsGoalie":"Tid som M\xe5lvakt","timeAsDefender":"Tid som Back","timeAsMidfielder":"Tid som Mittf\xe4lt","timeAsAttacker":"Tid som Forward","noStats":"Ingen spelarstatistik tillg\xe4nglig"},"table":{"columns":{"player":"Spelare","startingRole":"Startroll","outfield":"Utespelare","defender":"Back","midfielder":"Mittf\xe4lt","attacker":"Forward","goalie":"M\xe5lvakt","substitute":"Avbytare","goals":"M\xe5l"},"roles":{"goalie":"M\xe5lvakt","defender":"Back","midfielder":"Mittf\xe4lt","attacker":"Forward","substitute":"Avb","field":"Ute","none":"--"},"noStats":"Ingen spelarstatistik tillg\xe4nglig"},"summary":{"finalScore":"Slutresultat","duration":"L\xe4ngd","periods":"Perioder","totalGoals":"Totalt Antal M\xe5l","ourGoals":"V\xe5ra M\xe5l","opponentGoals":"Motst\xe5ndarens M\xe5l"},"events":{"matchStarted":"Match startad","matchEnded":"Match avslutad","periodStarted":"Period {{period}} startad","periodEnded":"Period {{period}} avslutad","goalScoredWithScore":"{{ownScore}}-{{opponentScore}} {{team}} M\xe5l","goalFor":"M\xe5l f\xf6r {{team}} - {{scorer}}","goalForTeam":"M\xe5l f\xf6r {{team}}","unknownScorer":"Ok\xe4nd m\xe5lskytt","substitution":"Byte","out":"Ut","in":"In","unknown":"Ok\xe4nd","unknownPlayer":"Ok\xe4nd spelare","unknownPosition":"Ok\xe4nd position","from":"fr\xe5n","newGoalie":"Ny m\xe5lvakt","oldGoalie":"Tidigare m\xe5lvakt","leavesGoal":"l\xe4mnar m\xe5let","otherSwitches":"\xd6vriga byten","playerIsGoalie":"{{name}} \xe4r m\xe5lvakt","goalieAssigned":"M\xe5lvakt tilldelad","positionSwitch":"Positionsbyte","positionChange":"Positions\xe4ndring","playerInactivated":"{{name}} inaktiverad","playerActivated":"{{name}} \xe5teraktiverad","fairPlayAward":"Fair Play-Utm\xe4rkelse","timerPaused":"Timer pausad","timerResumed":"Timer \xe5terupptagen","periodPaused":"Period pausad","periodResumed":"Period \xe5terupptagen","intermission":"Halvtidspaus","goalCorrected":"M\xe5l korrigerat","goalUndone":"M\xe5l \xe5ngrad","substitutionUndone":"Byte \xe5ngrad","technicalTimeout":"Teknisk timeout","undone":"\xc5NGRAD","clickToEditScorer":"Tryck f\xf6r att \xe4ndra m\xe5lskytt"},"details":{"period":"Period","score":"St\xe4llning","awardedTo":"Tilldelad","undone":"\xc5ngrad","userAction":"anv\xe4ndar\xe5tg\xe4rd","undoneAt":"\xc5ngrad vid","relatedTo":"Relaterad till","positionChanges":"Positions\xe4ndringar","startingPositions":"Startpositioner"},"controls":{"eventCount":"{{count}} h\xe4ndelser","player":"Spelare","allPlayers":"Alla Spelare","newestFirst":"Senaste f\xf6rst","oldestFirst":"\xc4ldsta f\xf6rst","periodLabel":"Period {{period}}"}}'),He=JSON.parse('{"section":{"title":"Externa Kopplingar","description":"Anslut till externa plattformar f\xf6r att synkronisera din trupp"},"card":{"connected":"Ansluten","disconnected":"Inte Ansluten","verifying":"Verifierar...","error":"Anslutningsfel","retrying":"F\xf6rs\xf6ker Igen...","connect":"Anslut","disconnect":"Koppla Bort","configure":"Konfigurera"},"sportAdmin":{"title":"SportAdmin","description":"Synkronisera din laglista fr\xe5n SportAdmin","modal":{"title":"Anslut till SportAdmin","email":"SportAdmin E-post","emailPlaceholder":"Ange din SportAdmin e-post","password":"SportAdmin L\xf6senord","passwordPlaceholder":"Ange ditt SportAdmin l\xf6senord","teamId":"Lag-ID","teamIdPlaceholder":"Ange ditt SportAdmin lag-ID","connect":"Anslut","cancel":"Avbryt","connecting":"Ansluter..."}},"disconnect":{"title":"Koppla Bort {{provider}}?","subtitle":"Detta stoppar automatisk synkronisering","confirmMessage":"\xc4r du s\xe4ker p\xe5 att du vill koppla bort {{provider}}?","warningAutoSync":"Automatisk datasynkronisering kommer att stoppas","warningCredentials":"Lagrade uppgifter kommer att tas bort","reassureData":"Befintlig n\xe4rvaro- och matchdata bevaras","reassureReconnect":"Du kan \xe5teransluta n\xe4r som helst","disconnecting":"Kopplar bort...","disconnect":"Koppla Bort","cancel":"Avbryt","errorFallback":"Misslyckades med att koppla bort leverant\xf6r"},"status":{"syncing":"Synkroniserar trupp...","lastSync":"Senast synkroniserad: {{time}}","neverSynced":"Aldrig synkroniserad","syncSuccess":"Trupp synkroniserad","syncError":"Misslyckades med att synkronisera trupp"},"sportAdminConnect":{"header":{"title":"Anslut SportAdmin","subtitle":"Synkronisera n\xe4rvaro och matchdata"},"info":{"description":"Ange dina SportAdmin-uppgifter f\xf6r att aktivera automatisk synkronisering.","security":"Dina uppgifter kommer att krypteras och lagras s\xe4kert."},"form":{"labels":{"username":"Anv\xe4ndarnamn","password":"L\xf6senord"},"placeholders":{"username":"Ditt SportAdmin anv\xe4ndarnamn","password":"Ditt SportAdmin l\xf6senord"}},"validation":{"usernameRequired":"Anv\xe4ndarnamn kr\xe4vs","usernameMaxLength":"Anv\xe4ndarnamn f\xe5r vara h\xf6gst 100 tecken","passwordRequired":"L\xf6senord kr\xe4vs","passwordMaxLength":"L\xf6senord f\xe5r vara h\xf6gst 200 tecken","connectionFailed":"Misslyckades ansluta SportAdmin. Kontrollera dina uppgifter och f\xf6rs\xf6k igen."},"buttons":{"connect":"Anslut","connecting":"Ansluter...","cancel":"Avbryt"}},"connectorsSection":{"title":"Kopplingar","infoBanner":"Anslut externa laghanteringsplattformar f\xf6r att automatiskt synkronisera tr\xe4ningsn\xe4rvaro och matchscheman.","loadingConnectors":"Laddar kopplingar...","connectedProviders":"Anslutna Plattformar","availableProviders":"Tillg\xe4ngliga Plattformar","connected":"Ansluten","connect":"Anslut","dismiss":"Avf\xe4rda","connectedSuccess":"SportAdmin ansluten! Verifiering p\xe5g\xe5r (tar upp till 5 minuter)...","syncStarted":"Synkronisering startad!","disconnectedSuccess":"Leverant\xf6r bortkopplad!","retryingConnection":"F\xf6rs\xf6ker ansluta igen...","immediateSyncFailed":"Omedelbar synkronisering misslyckades, k\xf6rs enligt schema."},"onboarding":{"syncTitle":"Synkronisera Spelare fr\xe5n Externa Plattformar","syncDescription":"Anslut till din laghanteringsplattform f\xf6r att automatiskt synkronisera trupp och tr\xe4ningsn\xe4rvaro."},"unmappedBanner":{"title":"Spelare Tillg\xe4ngliga att Matcha","description":"Du har omatchade spelare fr\xe5n {{providerName}} som v\xe4ntar p\xe5 att matchas till din trupp."},"providerLogo":{"fallbackLabel":"Koppling","logoAlt":"{{providerName}}-logotyp","logoPlaceholder":"{{label}} logotypplatsh\xe5llare"},"connectorCard":{"lastVerified":"Senast verifierad:","lastSync":"Senast synkroniserad:","never":"Aldrig","connectionCreated":"Anslutning Skapad","errorPrefix":"Fel:","connectionError":"Anslutningsfel","buttons":{"retryConnection":"F\xf6rs\xf6k Igen","manualSync":"Manuell Synkronisering","syncing":"Synkroniserar...","disconnect":"Koppla Bort"}},"providers":{"sportadmin":{"description":"Svensk laghanteringsplattform","features":{"practiceAttendance":"N\xe4rvarohantering","upcomingMatches":"Kommande matcher"}},"svenska_lag":{"description":"Svensk laghanteringsplattform","features":{"comingSoon":"Kommer snart"}},"myclub":{"description":"Laghanteringsplattform","features":{"comingSoon":"Kommer snart"}}},"statusLabels":{"connected":"Ansluten","verifying":"Verifierar","error":"Fel","disconnected":"Fr\xe5nkopplad","unknown":"Ok\xe4nd"},"syncStatusLabels":{"completed":"Klar","running":"K\xf6rs","waiting":"V\xe4ntar","retrying":"F\xf6rs\xf6ker igen","failed":"Misslyckades","cancelled":"Avbruten","unknown":"Ok\xe4nd"}}'),Ke=JSON.parse('{"screen":{"title":"Taktisk Tavla","instructions":"Dra och sl\xe4pp spelare och mark\xf6rer f\xf6r att planera din taktik"},"controls":{"back":"Tillbaka","undo":"\xc5ngra","clear":"Rensa","clearAll":"Rensa Allt","drag":"Dra","draw":"Rita","full":"Hel","half":"Halv"},"palette":{"title":"Mark\xf6rer","players":"Spelare","ball":"Boll","cones":"Koner","clear":"Rensa Tavla","dragInstruction":"Dra mark\xf6rer till planen \u2022 Dubbelklicka f\xf6r att ta bort","drawModeHint":"Byt tillbaka till Dra-l\xe4ge f\xf6r att l\xe4gga till eller flytta mark\xf6rer."},"chip":{"player":"Spelare","ball":"Boll","cone":"Kon"}}'),We=JSON.parse('{"screen":{"title":"Livematch","spectatorView":"\xc5sk\xe5darvy","loading":"Laddar match...","notFound":"Match hittades inte","ended":"Denna match har avslutats"},"status":{"waitingToStart":"V\xe4ntar p\xe5 att matchen ska starta","inProgress":"Match p\xe5g\xe5r","paused":"Pausad","ended":"Avslutad","matchNotStarted":"Matchen Har Inte Startat","liveMatch":"LIVE Match","matchFinished":"Match Avslutad"},"info":{"period":"Period {{number}}","periodWithMinute":"Period {{period}} - {{minute}}\'","score":"St\xe4llning","time":"Tid","lastUpdated":"Senast uppdaterad: {{time}}","loadingEvents":"Laddar matchh\xe4ndelser...","errorLoadingMatch":"Fel Vid Laddning Av Match","noEventsFound":"Inga matchh\xe4ndelser hittades","matchSummary":"Match\xf6versikt","gameEvents":"Matchh\xe4ndelser","substitutions":"Byten"}}'),Ye=JSON.parse('{"back":"Tillbaka","backTo":{"setup":"Tillbaka till Inst\xe4llningar","matchHistory":"Tillbaka till Matchhistorik","signIn":"Tillbaka till Inloggning"},"goTo":{"rosterManagement":"G\xe5 till Laglisthantering","connectors":"G\xe5 till Kopplingar"},"return":{"toApp":"Tillbaka till appen"},"menu":{"ariaLabel":"Meny","profile":"Profil","preferences":"Inst\xe4llningar","teamManagement":"Laghantering","createTeam":"Skapa Lag","teamMatches":"Lagmatcher","statistics":"Statistik","tacticalBoard":"Taktiktavla","addPlayer":"L\xe4gg till Spelare","getLiveMatchLink":"H\xe4mta Live Match-l\xe4nk","newGame":"Ny Match","signIn":"Logga in","signOut":"Logga ut","createAccount":"Skapa Konto","signInToUnlock":"Logga in f\xf6r att l\xe5sa upp:","cloudSync":"Molnsynk"},"liveMatchLink":{"linkCopied":"L\xe4nk Kopierad","linkCopiedMessage":"Live match-l\xe4nk kopierad till urklipp!","liveMatchUrl":"Live Match-URL","error":"Fel","errorMessage":"Misslyckades med att skapa live match-l\xe4nk"}}');W.use(oe).init({resources:{en:{common:we,configuration:Se,auth:ke,profile:Ne,game:je,statistics:Te,team:Ae,shared:_e,modals:Ce,reports:Me,connectors:Pe,tactical:Ee,live:Ie,navigation:Re},sv:{common:Oe,configuration:De,auth:Fe,profile:Le,game:qe,statistics:Ue,team:Be,shared:Ge,modals:ze,reports:Ve,connectors:He,tactical:Ke,live:We,navigation:Ye}},lng:"en",fallbackLng:"en",defaultNS:"common",debug:!1,interpolation:{escapeValue:!1},react:{useSuspense:!1}});var Je=a(816);function Qe(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(a[n[r]]=e[n[r]])}return a}function $e(e,t,a,n){return new(a||(a=Promise))(function(r,s){function i(e){try{l(n.next(e))}catch(t){s(t)}}function o(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof a?t:new a(function(e){e(t)})).then(i,o)}l((n=n.apply(e,t||[])).next())})}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;class Xe extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",a=arguments.length>2?arguments[2]:void 0;super(e),this.name=t,this.context=a}}class Ze extends Xe{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class et extends Xe{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class tt extends Xe{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var at;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(at||(at={}));class nt{constructor(e){let{headers:t={},customFetch:a,region:n=at.Any}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=t,this.region=n,this.fetch=(e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)})(a)}setAuth(e){this.headers.Authorization="Bearer ".concat(e)}invoke(e){return $e(this,arguments,void 0,function(e){var t=this;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){var n;let r,s;try{const{headers:i,method:o,body:l,signal:c,timeout:d}=a;let u={},{region:m}=a;m||(m=t.region);const h=new URL("".concat(t.url,"/").concat(e));let p;m&&"any"!==m&&(u["x-region"]=m,h.searchParams.set("forceFunctionRegion",m)),l&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)?"undefined"!==typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",p=l):"string"===typeof l?(u["Content-Type"]="text/plain",p=l):"undefined"!==typeof FormData&&l instanceof FormData?p=l:(u["Content-Type"]="application/json",p=JSON.stringify(l)):p=!l||"string"===typeof l||"undefined"!==typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer||"undefined"!==typeof FormData&&l instanceof FormData?l:JSON.stringify(l);let f=c;d&&(s=new AbortController,r=setTimeout(()=>s.abort(),d),c?(f=s.signal,c.addEventListener("abort",()=>s.abort())):f=s.signal);const g=yield t.fetch(h.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},u),t.headers),i),body:p,signal:f}).catch(e=>{throw new Ze(e)}),v=g.headers.get("x-relay-error");if(v&&"true"===v)throw new et(g);if(!g.ok)throw new tt(g);let y,b=(null!==(n=g.headers.get("Content-Type"))&&void 0!==n?n:"text/plain").split(";")[0].trim();return y="application/json"===b?yield g.json():"application/octet-stream"===b||"application/pdf"===b?yield g.blob():"text/event-stream"===b?g:"multipart/form-data"===b?yield g.formData():yield g.text(),{data:y,error:null,response:g}}catch(i){return{data:null,error:i,response:i instanceof tt||i instanceof et?i.context:void 0}}finally{r&&clearTimeout(r)}}()})}}var rt=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},st=class{constructor(e){var t,a,n;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(a=e.isMaybeSingle)&&void 0!==a&&a,this.urlLengthLimit=null!==(n=e.urlLengthLimit)&&void 0!==n?n:8e3,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var a=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let n=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{let t=null,n=null,r=null,s=e.status,i=e.statusText;if(e.ok){var o,l;if("HEAD"!==a.method){var c;const t=await e.text();""===t||(n="text/csv"===a.headers.get("Accept")||a.headers.get("Accept")&&(null===(c=a.headers.get("Accept"))||void 0===c?void 0:c.includes("application/vnd.pgrst.plan+text"))?t:JSON.parse(t))}const d=null===(o=a.headers.get("Prefer"))||void 0===o?void 0:o.match(/count=(exact|planned|estimated)/),u=null===(l=e.headers.get("content-range"))||void 0===l?void 0:l.split("/");d&&u&&u.length>1&&(r=parseInt(u[1])),a.isMaybeSingle&&"GET"===a.method&&Array.isArray(n)&&(n.length>1?(t={code:"PGRST116",details:"Results contain ".concat(n.length," rows, application/vnd.pgrst.object+json requires 1 row"),hint:null,message:"JSON object requested, multiple (or no) rows returned"},n=null,r=null,s=406,i="Not Acceptable"):n=1===n.length?n[0]:null)}else{var d;const r=await e.text();try{t=JSON.parse(r),Array.isArray(t)&&404===e.status&&(n=[],t=null,s=200,i="OK")}catch(u){404===e.status&&""===r?(s=204,i="No Content"):t={message:r}}if(t&&a.isMaybeSingle&&(null===t||void 0===t||null===(d=t.details)||void 0===d?void 0:d.includes("0 rows"))&&(t=null,s=200,i="OK"),t&&a.shouldThrowOnError)throw new rt(t)}return{error:t,data:n,count:r,status:s,statusText:i}});return this.shouldThrowOnError||(n=n.catch(e=>{var t;let a="",n="",r="";const s=null===e||void 0===e?void 0:e.cause;if(s){var i,o,l,c;const t=null!==(i=null===s||void 0===s?void 0:s.message)&&void 0!==i?i:"",n=null!==(o=null===s||void 0===s?void 0:s.code)&&void 0!==o?o:"";a="".concat(null!==(l=null===e||void 0===e?void 0:e.name)&&void 0!==l?l:"FetchError",": ").concat(null===e||void 0===e?void 0:e.message),a+="\n\nCaused by: ".concat(null!==(c=null===s||void 0===s?void 0:s.name)&&void 0!==c?c:"Error",": ").concat(t),n&&(a+=" (".concat(n,")")),(null===s||void 0===s?void 0:s.stack)&&(a+="\n".concat(s.stack))}else{var d;a=null!==(d=null===e||void 0===e?void 0:e.stack)&&void 0!==d?d:""}const u=this.url.toString().length;return"AbortError"===(null===e||void 0===e?void 0:e.name)||"ABORT_ERR"===(null===e||void 0===e?void 0:e.code)?(r="",n="Request was aborted (timeout or manual cancellation)",u>this.urlLengthLimit&&(n+=". Note: Your request URL is ".concat(u," characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side."))):"HeadersOverflowError"!==(null===s||void 0===s?void 0:s.name)&&"UND_ERR_HEADERS_OVERFLOW"!==(null===s||void 0===s?void 0:s.code)||(r="",n="HTTP headers exceeded server limits (typically 16KB)",u>this.urlLengthLimit&&(n+=". Your request URL is ".concat(u," characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead."))),{error:{message:"".concat(null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"FetchError",": ").concat(null===e||void 0===e?void 0:e.message),details:a,hint:n,code:r},data:null,count:null,status:0,statusText:""}})),n.then(e,t)}returns(){return this}overrideTypes(){return this}},it=class extends st{select(e){let t=!1;const a=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",a),this.headers.append("Prefer","return=representation"),this}order(e){let{ascending:t=!0,nullsFirst:a,foreignTable:n,referencedTable:r=n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=r?"".concat(r,".order"):"order",i=this.url.searchParams.get(s);return this.url.searchParams.set(s,"".concat(i?"".concat(i,","):"").concat(e,".").concat(t?"asc":"desc").concat(void 0===a?"":a?".nullsfirst":".nullslast")),this}limit(e){let{foreignTable:t,referencedTable:a=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n="undefined"===typeof a?"limit":"".concat(a,".limit");return this.url.searchParams.set(n,"".concat(e)),this}range(e,t){let{foreignTable:a,referencedTable:n=a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r="undefined"===typeof n?"offset":"".concat(n,".offset"),s="undefined"===typeof n?"limit":"".concat(n,".limit");return this.url.searchParams.set(r,"".concat(e)),this.url.searchParams.set(s,"".concat(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain(){let{analyze:e=!1,verbose:t=!1,settings:a=!1,buffers:n=!1,wal:r=!1,format:s="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var i;const o=[e?"analyze":null,t?"verbose":null,a?"settings":null,n?"buffers":null,r?"wal":null].filter(Boolean).join("|"),l=null!==(i=this.headers.get("Accept"))&&void 0!==i?i:"application/json";return this.headers.set("Accept","application/vnd.pgrst.plan+".concat(s,'; for="').concat(l,'"; options=').concat(o,";")),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer","max-affected=".concat(e)),this}};const ot=new RegExp("[,()]");var lt=class extends it{eq(e,t){return this.url.searchParams.append(e,"eq.".concat(t)),this}neq(e,t){return this.url.searchParams.append(e,"neq.".concat(t)),this}gt(e,t){return this.url.searchParams.append(e,"gt.".concat(t)),this}gte(e,t){return this.url.searchParams.append(e,"gte.".concat(t)),this}lt(e,t){return this.url.searchParams.append(e,"lt.".concat(t)),this}lte(e,t){return this.url.searchParams.append(e,"lte.".concat(t)),this}like(e,t){return this.url.searchParams.append(e,"like.".concat(t)),this}likeAllOf(e,t){return this.url.searchParams.append(e,"like(all).{".concat(t.join(","),"}")),this}likeAnyOf(e,t){return this.url.searchParams.append(e,"like(any).{".concat(t.join(","),"}")),this}ilike(e,t){return this.url.searchParams.append(e,"ilike.".concat(t)),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,"ilike(all).{".concat(t.join(","),"}")),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,"ilike(any).{".concat(t.join(","),"}")),this}regexMatch(e,t){return this.url.searchParams.append(e,"match.".concat(t)),this}regexIMatch(e,t){return this.url.searchParams.append(e,"imatch.".concat(t)),this}is(e,t){return this.url.searchParams.append(e,"is.".concat(t)),this}isDistinct(e,t){return this.url.searchParams.append(e,"isdistinct.".concat(t)),this}in(e,t){const a=Array.from(new Set(t)).map(e=>"string"===typeof e&&ot.test(e)?'"'.concat(e,'"'):"".concat(e)).join(",");return this.url.searchParams.append(e,"in.(".concat(a,")")),this}notIn(e,t){const a=Array.from(new Set(t)).map(e=>"string"===typeof e&&ot.test(e)?'"'.concat(e,'"'):"".concat(e)).join(",");return this.url.searchParams.append(e,"not.in.(".concat(a,")")),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cs.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cs.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cs.".concat(JSON.stringify(t))),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cd.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cd.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cd.".concat(JSON.stringify(t))),this}rangeGt(e,t){return this.url.searchParams.append(e,"sr.".concat(t)),this}rangeGte(e,t){return this.url.searchParams.append(e,"nxl.".concat(t)),this}rangeLt(e,t){return this.url.searchParams.append(e,"sl.".concat(t)),this}rangeLte(e,t){return this.url.searchParams.append(e,"nxr.".concat(t)),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,"adj.".concat(t)),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(e,"ov.".concat(t)):this.url.searchParams.append(e,"ov.{".concat(t.join(","),"}")),this}textSearch(e,t){let{config:a,type:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r="";"plain"===n?r="pl":"phrase"===n?r="ph":"websearch"===n&&(r="w");const s=void 0===a?"":"(".concat(a,")");return this.url.searchParams.append(e,"".concat(r,"fts").concat(s,".").concat(t)),this}match(e){return Object.entries(e).forEach(e=>{let[t,a]=e;this.url.searchParams.append(t,"eq.".concat(a))}),this}not(e,t,a){return this.url.searchParams.append(e,"not.".concat(t,".").concat(a)),this}or(e){let{foreignTable:t,referencedTable:a=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=a?"".concat(a,".or"):"or";return this.url.searchParams.append(n,"(".concat(e,")")),this}filter(e,t,a){return this.url.searchParams.append(e,"".concat(t,".").concat(a)),this}},ct=class{constructor(e,t){let{headers:a={},schema:n,fetch:r,urlLengthLimit:s=8e3}=t;this.url=e,this.headers=new Headers(a),this.schema=n,this.fetch=r,this.urlLengthLimit=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:a=!1,count:n}=null!==t&&void 0!==t?t:{},r=a?"HEAD":"GET";let s=!1;const i=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!s?"":('"'===e&&(s=!s),e)).join(""),{url:o,headers:l}=this.cloneRequestState();return o.searchParams.set("select",i),n&&l.append("Prefer","count=".concat(n)),new lt({method:r,url:o,headers:l,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(e){let{count:t,defaultToNull:a=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;const{url:r,headers:s}=this.cloneRequestState();if(t&&s.append("Prefer","count=".concat(t)),a||s.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));r.searchParams.set("columns",e.join(","))}}return new lt({method:"POST",url:r,headers:s,schema:this.schema,body:e,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(e){let{onConflict:t,ignoreDuplicates:a=!1,count:n,defaultToNull:r=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s;const{url:i,headers:o}=this.cloneRequestState();if(o.append("Prefer","resolution=".concat(a?"ignore":"merge","-duplicates")),void 0!==t&&i.searchParams.set("on_conflict",t),n&&o.append("Prefer","count=".concat(n)),r||o.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));i.searchParams.set("columns",e.join(","))}}return new lt({method:"POST",url:i,headers:o,schema:this.schema,body:e,fetch:null!==(s=this.fetch)&&void 0!==s?s:fetch,urlLengthLimit:this.urlLengthLimit})}update(e){let{count:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var a;const{url:n,headers:r}=this.cloneRequestState();return t&&r.append("Prefer","count=".concat(t)),new lt({method:"PATCH",url:n,headers:r,schema:this.schema,body:e,fetch:null!==(a=this.fetch)&&void 0!==a?a:fetch,urlLengthLimit:this.urlLengthLimit})}delete(){let{count:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;const{url:a,headers:n}=this.cloneRequestState();return e&&n.append("Prefer","count=".concat(e)),new lt({method:"DELETE",url:a,headers:n,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch,urlLengthLimit:this.urlLengthLimit})}};function dt(e){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ut(e){var t=function(e,t){if("object"!=dt(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=dt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==dt(t)?t:t+""}function mt(e,t,a){return(t=ut(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ht(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function pt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(a),!0).forEach(function(t){mt(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ht(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var ft=class e{constructor(e){let{headers:t={},schema:a,fetch:n,timeout:r,urlLengthLimit:s=8e3}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=new Headers(t),this.schemaName=a,this.urlLengthLimit=s;const i=null!==n&&void 0!==n?n:globalThis.fetch;this.fetch=void 0!==r&&r>0?(e,t)=>{const a=new AbortController,n=setTimeout(()=>a.abort(),r),s=null===t||void 0===t?void 0:t.signal;if(s){if(s.aborted)return clearTimeout(n),i(e,t);const r=()=>{clearTimeout(n),a.abort()};return s.addEventListener("abort",r,{once:!0}),i(e,pt(pt({},t),{},{signal:a.signal})).finally(()=>{clearTimeout(n),s.removeEventListener("abort",r)})}return i(e,pt(pt({},t),{},{signal:a.signal})).finally(()=>clearTimeout(n))}:i}from(e){if(!e||"string"!==typeof e||""===e.trim())throw new Error("Invalid relation name: relation must be a non-empty string.");return new ct(new URL("".concat(this.url,"/").concat(e)),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:a=!1,get:n=!1,count:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var s;let i;const o=new URL("".concat(this.url,"/rpc/").concat(e));let l;const c=e=>null!==e&&"object"===typeof e&&(!Array.isArray(e)||e.some(c)),d=a&&Object.values(t).some(c);d?(i="POST",l=t):a||n?(i=a?"HEAD":"GET",Object.entries(t).filter(e=>{let[t,a]=e;return void 0!==a}).map(e=>{let[t,a]=e;return[t,Array.isArray(a)?"{".concat(a.join(","),"}"):"".concat(a)]}).forEach(e=>{let[t,a]=e;o.searchParams.append(t,a)})):(i="POST",l=t);const u=new Headers(this.headers);return d?u.set("Prefer",r?"count=".concat(r,",return=minimal"):"return=minimal"):r&&u.set("Prefer","count=".concat(r)),new lt({method:i,url:o,headers:u,schema:this.schemaName,body:l,fetch:null!==(s=this.fetch)&&void 0!==s?s:fetch,urlLengthLimit:this.urlLengthLimit})}};const gt=class{constructor(){}static detectEnvironment(){var e;if("undefined"!==typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!==typeof globalThis&&"undefined"!==typeof globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!==typeof a.g&&"undefined"!==typeof a.g.WebSocket)return{type:"native",constructor:a.g.WebSocket};if("undefined"!==typeof globalThis&&"undefined"!==typeof globalThis.WebSocketPair&&"undefined"===typeof globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!==typeof globalThis&&globalThis.EdgeRuntime||"undefined"!==typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const t=globalThis.process;if(t){const e=t.versions;if(e&&e.node){const t=e.node,a=parseInt(t.replace(/^v/,"").split(".")[0]);return a>=22?"undefined"!==typeof globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:"Node.js ".concat(a," detected but native WebSocket not found."),workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:"Node.js ".concat(a," detected without native WebSocket support."),workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+="\n\nSuggested solution: ".concat(e.workaround)),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}};const vt="realtime-js/".concat("2.95.2"),yt="2.0.0",bt=yt,xt=1e4;var wt,St,kt,Nt,jt,Tt;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(wt||(wt={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(St||(St={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(kt||(kt={})),function(e){e.websocket="websocket"}(Nt||(Nt={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(jt||(jt={}));class At{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=null!==e&&void 0!==e?e:[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&"string"===typeof e.payload.event)return t(this._binaryEncodeUserBroadcastPush(e));let a=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer(null===(t=e.payload)||void 0===t?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,a;const n=null!==(a=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==a?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(e){var t,a;const n=null!==(a=null===(t=e.payload)||void 0===t?void 0:t.payload)&&void 0!==a?a:{},r=(new TextEncoder).encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,r)}_encodeUserBroadcastPush(e,t,a){var n,r;const s=e.topic,i=null!==(n=e.ref)&&void 0!==n?n:"",o=null!==(r=e.join_ref)&&void 0!==r?r:"",l=e.payload.event,c=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},d=0===Object.keys(c).length?"":JSON.stringify(c);if(o.length>255)throw new Error("joinRef length ".concat(o.length," exceeds maximum of 255"));if(i.length>255)throw new Error("ref length ".concat(i.length," exceeds maximum of 255"));if(s.length>255)throw new Error("topic length ".concat(s.length," exceeds maximum of 255"));if(l.length>255)throw new Error("userEvent length ".concat(l.length," exceeds maximum of 255"));if(d.length>255)throw new Error("metadata length ".concat(d.length," exceeds maximum of 255"));const u=this.USER_BROADCAST_PUSH_META_LENGTH+o.length+i.length+s.length+l.length+d.length,m=new ArrayBuffer(this.HEADER_LENGTH+u);let h=new DataView(m),p=0;h.setUint8(p++,this.KINDS.userBroadcastPush),h.setUint8(p++,o.length),h.setUint8(p++,i.length),h.setUint8(p++,s.length),h.setUint8(p++,l.length),h.setUint8(p++,d.length),h.setUint8(p++,t),Array.from(o,e=>h.setUint8(p++,e.charCodeAt(0))),Array.from(i,e=>h.setUint8(p++,e.charCodeAt(0))),Array.from(s,e=>h.setUint8(p++,e.charCodeAt(0))),Array.from(l,e=>h.setUint8(p++,e.charCodeAt(0))),Array.from(d,e=>h.setUint8(p++,e.charCodeAt(0)));var f=new Uint8Array(m.byteLength+a.byteLength);return f.set(new Uint8Array(m),0),f.set(new Uint8Array(a),m.byteLength),f.buffer}decode(e,t){if(this._isArrayBuffer(e)){return t(this._binaryDecode(e))}if("string"===typeof e){const a=JSON.parse(e),[n,r,s,i,o]=a;return t({join_ref:n,ref:r,topic:s,event:i,payload:o})}return t({})}_binaryDecode(e){const t=new DataView(e),a=t.getUint8(0),n=new TextDecoder;if(a===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,t,n)}_decodeUserBroadcast(e,t,a){const n=t.getUint8(1),r=t.getUint8(2),s=t.getUint8(3),i=t.getUint8(4);let o=this.HEADER_LENGTH+4;const l=a.decode(e.slice(o,o+n));o+=n;const c=a.decode(e.slice(o,o+r));o+=r;const d=a.decode(e.slice(o,o+s));o+=s;const u=e.slice(o,e.byteLength),m=i===this.JSON_ENCODING?JSON.parse(a.decode(u)):u,h={type:this.BROADCAST_EVENT,event:c,payload:m};return s>0&&(h.meta=JSON.parse(d)),{join_ref:null,ref:null,topic:l,event:this.BROADCAST_EVENT,payload:h}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||"ArrayBuffer"===(null===(t=null===e||void 0===e?void 0:e.constructor)||void 0===t?void 0:t.name)}_pick(e,t){return e&&"object"===typeof e?Object.fromEntries(Object.entries(e).filter(e=>{let[a]=e;return t.includes(a)})):{}}}class _t{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(Tt||(Tt={}));const Ct=function(e,t){var a;const n=null!==(a=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==a?a:[];return t?Object.keys(t).reduce((a,r)=>(a[r]=Mt(r,e,t,n),a),{}):{}},Mt=(e,t,a,n)=>{const r=t.find(t=>t.name===e),s=null===r||void 0===r?void 0:r.type,i=a[e];return s&&!n.includes(s)?Pt(s,i):Et(i)},Pt=(e,t)=>{if("_"===e.charAt(0)){const a=e.slice(1,e.length);return Dt(t,a)}switch(e){case Tt.bool:return It(t);case Tt.float4:case Tt.float8:case Tt.int2:case Tt.int4:case Tt.int8:case Tt.numeric:case Tt.oid:return Rt(t);case Tt.json:case Tt.jsonb:return Ot(t);case Tt.timestamp:return Ft(t);case Tt.abstime:case Tt.date:case Tt.daterange:case Tt.int4range:case Tt.int8range:case Tt.money:case Tt.reltime:case Tt.text:case Tt.time:case Tt.timestamptz:case Tt.timetz:case Tt.tsrange:case Tt.tstzrange:default:return Et(t)}},Et=e=>e,It=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Rt=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Ot=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(t){return e}return e},Dt=(e,t)=>{if("string"!==typeof e)return e;const a=e.length-1,n=e[a];if("{"===e[0]&&"}"===n){let n;const s=e.slice(1,a);try{n=JSON.parse("["+s+"]")}catch(r){n=s?s.split(","):[]}return n.map(e=>Pt(t,e))}return e},Ft=e=>"string"===typeof e?e.replace(" ","T"):e,Lt=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),""===t.pathname||"/"===t.pathname?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class qt{constructor(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:xt;this.channel=e,this.event=t,this.payload=a,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var a;return this._hasReceived(e)&&t(null===(a=this.receivedResp)||void 0===a?void 0:a.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:a}=e;this.recHooks.filter(e=>e.status===t).forEach(e=>e.callback(a))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ut,Bt,Gt,zt;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(Ut||(Ut={}));class Vt{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},e=>{const{onJoin:t,onLeave:a,onSync:n}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Vt.syncState(this.state,e,t,a),this.pendingDiffs.forEach(e=>{this.state=Vt.syncDiff(this.state,e,t,a)}),this.pendingDiffs=[],n()}),this.channel._on(a.diff,{},e=>{const{onJoin:t,onLeave:a,onSync:n}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=Vt.syncDiff(this.state,e,t,a),n())}),this.onJoin((e,t,a)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:a})}),this.onLeave((e,t,a)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,a,n){const r=this.cloneDeep(e),s=this.transformState(t),i={},o={};return this.map(r,(e,t)=>{s[e]||(o[e]=t)}),this.map(s,(e,t)=>{const a=r[e];if(a){const n=t.map(e=>e.presence_ref),r=a.map(e=>e.presence_ref),s=t.filter(e=>r.indexOf(e.presence_ref)<0),l=a.filter(e=>n.indexOf(e.presence_ref)<0);s.length>0&&(i[e]=s),l.length>0&&(o[e]=l)}else i[e]=t}),this.syncDiff(r,{joins:i,leaves:o},a,n)}static syncDiff(e,t,a,n){const{joins:r,leaves:s}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return a||(a=()=>{}),n||(n=()=>{}),this.map(r,(t,n)=>{var r;const s=null!==(r=e[t])&&void 0!==r?r:[];if(e[t]=this.cloneDeep(n),s.length>0){const a=e[t].map(e=>e.presence_ref),n=s.filter(e=>a.indexOf(e.presence_ref)<0);e[t].unshift(...n)}a(t,s,n)}),this.map(s,(t,a)=>{let r=e[t];if(!r)return;const s=a.map(e=>e.presence_ref);r=r.filter(e=>s.indexOf(e.presence_ref)<0),e[t]=r,n(t,r,a),0===r.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(a=>t(a,e[a]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,a)=>{const n=e[a];return t[a]="metas"in n?n.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(Bt||(Bt={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(Gt||(Gt={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(zt||(zt={}));class Ht{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},a=arguments.length>2?arguments[2]:void 0;var n,r;if(this.topic=e,this.params=t,this.socket=a,this.bindings={},this.state=St.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new qt(this,kt.join,this.params,this.timeout),this.rejoinTimer=new _t(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=St.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel","close ".concat(this.topic," ").concat(this._joinRef())),this.state=St.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=St.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel","timeout ".concat(this.topic),this.joinPush.timeout),this.state=St.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=St.errored,this.rejoinTimer.scheduleTimeout())}),this._on(kt.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new Vt(this),this.broadcastEndpointURL=Lt(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null===(r=null===(n=this.params.config)||void 0===n?void 0:n.broadcast)||void 0===r?void 0:r.replay))throw"tried to use replay on public channel '".concat(this.topic,"'. It must be a private channel.")}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;var a,n,r;if(this.socket.isConnected()||this.socket.connect(),this.state==St.closed){const{config:{broadcast:s,presence:i,private:o}}=this.params,l=null!==(n=null===(a=this.bindings.postgres_changes)||void 0===a?void 0:a.map(e=>e.filter))&&void 0!==n?n:[],c=!!this.bindings[Gt.PRESENCE]&&this.bindings[Gt.PRESENCE].length>0||!0===(null===(r=this.params.config.presence)||void 0===r?void 0:r.enabled),d={},u={broadcast:s,presence:Object.assign(Object.assign({},i),{enabled:c}),postgres_changes:l,private:o};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(t=>null===e||void 0===e?void 0:e(zt.CHANNEL_ERROR,t)),this._onClose(()=>null===e||void 0===e?void 0:e(zt.CLOSED)),this.updateJoinPayload(Object.assign({config:u},d)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async t=>{let{postgres_changes:a}=t;var n;if(this.socket._isManualToken()||this.socket.setAuth(),void 0!==a){const t=this.bindings.postgres_changes,r=null!==(n=null===t||void 0===t?void 0:t.length)&&void 0!==n?n:0,s=[];for(let n=0;n<r;n++){const r=t[n],{filter:{event:i,schema:o,table:l,filter:c}}=r,d=a&&a[n];if(!(d&&d.event===i&&Ht.isFilterValueEqual(d.schema,o)&&Ht.isFilterValueEqual(d.table,l)&&Ht.isFilterValueEqual(d.filter,c)))return this.unsubscribe(),this.state=St.errored,void(null===e||void 0===e||e(zt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));s.push(Object.assign(Object.assign({},r),{id:d.id}))}return this.bindings.postgres_changes=s,void(e&&e(zt.SUBSCRIBED))}null===e||void 0===e||e(zt.SUBSCRIBED)}).receive("error",t=>{this.state=St.errored,null===e||void 0===e||e(zt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null===e||void 0===e||e(zt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,a){return this.state===St.joined&&e===Gt.PRESENCE&&(this.socket.log("channel","resubscribe to ".concat(this.topic," due to change in presence callbacks on joined channel")),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,a)}async httpSend(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var n;if(void 0===t||null===t)return Promise.reject("Payload is required for httpSend()");const r={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(r.Authorization="Bearer ".concat(this.socket.accessTokenValue));const s={method:"POST",headers:r,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},i=await this._fetchWithTimeout(this.broadcastEndpointURL,s,null!==(n=a.timeout)&&void 0!==n?n:this.timeout);if(202===i.status)return{success:!0};let o=i.statusText;try{const e=await i.json();o=e.error||e.message||o}catch(l){}return Promise.reject(new Error(o))}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var a,n;if(this._canPush()||"broadcast"!==e.type)return new Promise(a=>{var n,r,s;const i=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(s=null===(r=null===(n=this.params)||void 0===n?void 0:n.config)||void 0===r?void 0:r.broadcast)||void 0===s?void 0:s.ack)||a("ok"),i.receive("ok",()=>a("ok")),i.receive("error",()=>a("error")),i.receive("timeout",()=>a("timed out"))});{console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:i}=e,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization="Bearer ".concat(this.socket.accessTokenValue));const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,l,null!==(a=t.timeout)&&void 0!==a?a:this.timeout);return await(null===(n=e.body)||void 0===n?void 0:n.cancel()),e.ok?"ok":"error"}catch(r){return"AbortError"===r.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=St.leaving;const t=()=>{this.socket.log("channel","leave ".concat(this.topic)),this._trigger(kt.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(n=>{a=new qt(this,kt.leave,{},e),a.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{null===a||void 0===a||a.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=St.closed,this.bindings={}}async _fetchWithTimeout(e,t,a){const n=new AbortController,r=setTimeout(()=>n.abort(),a),s=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(r),s}_push(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw"tried to push '".concat(e,"' to '").concat(this.topic,"' before joining. Use channel.subscribe() before pushing events");let n=new qt(this,e,t,a);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel","discarded push due to buffer overflow: ".concat(e.event),e.payload))}}_onMessage(e,t,a){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,a){var n,r;const s=e.toLocaleLowerCase(),{close:i,error:o,leave:l,join:c}=kt;if(a&&[i,o,l,c].indexOf(s)>=0&&a!==this._joinRef())return;let d=this._onMessage(s,t,a);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?null===(n=this.bindings.postgres_changes)||void 0===n||n.filter(e=>{var t,a,n;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(n=null===(a=e.filter)||void 0===a?void 0:a.event)||void 0===n?void 0:n.toLocaleLowerCase())===s}).map(e=>e.callback(d,a)):null===(r=this.bindings[s])||void 0===r||r.filter(e=>{var a,n,r,i,o,l;if(["broadcast","presence","postgres_changes"].includes(s)){if("id"in e){const s=e.id,i=null===(a=e.filter)||void 0===a?void 0:a.event;return s&&(null===(n=t.ids)||void 0===n?void 0:n.includes(s))&&("*"===i||(null===i||void 0===i?void 0:i.toLocaleLowerCase())===(null===(r=t.data)||void 0===r?void 0:r.type.toLocaleLowerCase()))}{const a=null===(o=null===(i=null===e||void 0===e?void 0:e.filter)||void 0===i?void 0:i.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===a||a===(null===(l=null===t||void 0===t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===s}).map(e=>{if("object"===typeof d&&"ids"in d){const e=d.data,{schema:t,table:a,commit_timestamp:n,type:r,errors:s}=e,i={schema:t,table:a,commit_timestamp:n,eventType:r,new:{},old:{},errors:s};d=Object.assign(Object.assign({},i),this._getPayloadRecords(e))}e.callback(d,a)})}_isClosed(){return this.state===St.closed}_isJoined(){return this.state===St.joined}_isJoining(){return this.state===St.joining}_isLeaving(){return this.state===St.leaving}_replyEventName(e){return"chan_reply_".concat(e)}_on(e,t,a){const n=e.toLocaleLowerCase(),r={type:n,filter:t,callback:a};return this.bindings[n]?this.bindings[n].push(r):this.bindings[n]=[r],this}_off(e,t){const a=e.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(e=>{var n;return!((null===(n=e.type)||void 0===n?void 0:n.toLocaleLowerCase())===a&&Ht.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const a in e)if(e[a]!==t[a])return!1;return!0}static isFilterValueEqual(e,t){return(null!==e&&void 0!==e?e:void 0)===(null!==t&&void 0!==t?t:void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(kt.close,{},e)}_onError(e){this._on(kt.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=St.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=Ct(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=Ct(e.columns,e.old_record)),t}}const Kt=()=>{},Wt=25e3,Yt=10,Jt=100,Qt=[1e3,2e3,5e3,1e4];class $t{constructor(e,t){var a;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=xt,this.transport=null,this.heartbeatIntervalMs=Wt,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Kt,this.ref=0,this.reconnectTimer=null,this.vsn=bt,this.logger=Kt,this.conn=null,this.sendBuffer=[],this.serializer=new At,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)},!(null===(a=null===t||void 0===t?void 0:t.params)||void 0===a?void 0:a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint="".concat(e,"/").concat(Nt.websocket),this.httpEndpoint=Lt(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null===t||void 0===t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=gt.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;if(t.includes("Node.js"))throw new Error("".concat(t,"\n\n")+'To use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })');throw new Error("WebSocket not available: ".concat(t))}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},"function"===typeof this.conn.close&&(e?this.conn.close(e,null!==t&&void 0!==t?t:""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,a){this.logger(e,t,a)}connectionState(){switch(this.conn&&this.conn.readyState){case wt.connecting:return jt.Connecting;case wt.open:return jt.Open;case wt.closing:return jt.Closing;default:return jt.Closed}}isConnected(){return this.connectionState()===jt.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};const a="realtime:".concat(e),n=this.getChannels().find(e=>e.topic===a);if(n)return n;{const a=new Ht("realtime:".concat(e),t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:a,payload:n,ref:r}=e,s=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push","".concat(t," ").concat(a," (").concat(r,")"),n),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}return this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},Jt)}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}else try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",'leaving duplicate topic "'.concat(e,'"')),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event&&e.ref&&e.ref===this.pendingHeartbeatRef){const t=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error",t)}catch(o){this.log("error","error in heartbeat callback",o)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:t,event:a,payload:n,ref:r}=e,s=r?"(".concat(r,")"):"",i=n.status||"";this.log("receive","".concat(i," ").concat(t," ").concat(a," ").concat(s).trim(),n),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(a,n,r)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===wt.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===wt.open||this.conn.readyState===wt.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport","connected to ".concat(this.endpointURL()));(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(e=>{this.log("error","error waiting for auth on connect",e),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker","starting worker for from ".concat(this.workerUrl)):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this._terminateWorker()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport","".concat(e)),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(t){this.log("error","error in heartbeat callback",t)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(kt.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const a=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return"".concat(e).concat(a).concat(n)}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=!1;if(t)e=t,a=!0;else if(this.accessToken)try{e=await this.accessToken()}catch(n){this.log("error","Error fetching access token from callback",n),e=this.accessTokenValue}else e=this.accessTokenValue;a?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(t=>{const a={access_token:e,version:vt};e&&t.updateJoinPayload(a),t.joinedOnce&&t._isJoined()&&t._push(kt.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"general";this._isManualToken()||this.setAuth().catch(t=>{this.log("error","Error setting auth in ".concat(e),t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(a=>{try{a(t)}catch(n){this.log("error","error in ".concat(e," callback"),n)}})}catch(a){this.log("error","error triggering ".concat(e," callbacks"),a)}}_setupReconnectionTimer(){this.reconnectTimer=new _t(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Yt)},this.reconnectAfterMs)}_initializeOptions(e){var t,a,n,r,s,i,o,l,c,d,u,m;switch(this.transport=null!==(t=null===e||void 0===e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(a=null===e||void 0===e?void 0:e.timeout)&&void 0!==a?a:xt,this.heartbeatIntervalMs=null!==(n=null===e||void 0===e?void 0:e.heartbeatIntervalMs)&&void 0!==n?n:Wt,this.worker=null!==(r=null===e||void 0===e?void 0:e.worker)&&void 0!==r&&r,this.accessToken=null!==(s=null===e||void 0===e?void 0:e.accessToken)&&void 0!==s?s:null,this.heartbeatCallback=null!==(i=null===e||void 0===e?void 0:e.heartbeatCallback)&&void 0!==i?i:Kt,this.vsn=null!==(o=null===e||void 0===e?void 0:e.vsn)&&void 0!==o?o:bt,(null===e||void 0===e?void 0:e.params)&&(this.params=e.params),(null===e||void 0===e?void 0:e.logger)&&(this.logger=e.logger),((null===e||void 0===e?void 0:e.logLevel)||(null===e||void 0===e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(l=null===e||void 0===e?void 0:e.reconnectAfterMs)&&void 0!==l?l:e=>Qt[e-1]||1e4,this.vsn){case"1.0.0":this.encode=null!==(c=null===e||void 0===e?void 0:e.encode)&&void 0!==c?c:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(d=null===e||void 0===e?void 0:e.decode)&&void 0!==d?d:(e,t)=>t(JSON.parse(e));break;case yt:this.encode=null!==(u=null===e||void 0===e?void 0:e.encode)&&void 0!==u?u:this.serializer.encode.bind(this.serializer),this.decode=null!==(m=null===e||void 0===e?void 0:e.decode)&&void 0!==m?m:this.serializer.decode.bind(this.serializer);break;default:throw new Error("Unsupported serializer version: ".concat(this.vsn))}if(this.worker){if("undefined"!==typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null===e||void 0===e?void 0:e.workerUrl}}}var Xt=class extends Error{constructor(e,t){var a;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown="CommitStateUnknownException"===t.icebergType||[500,502,504].includes(t.status)&&!0===(null===(a=t.icebergType)||void 0===a?void 0:a.includes("CommitState"))}isNotFound(){return 404===this.status}isConflict(){return 409===this.status}isAuthenticationTimeout(){return 419===this.status}};function Zt(e){var t;const a=null!==(t=e.fetchImpl)&&void 0!==t?t:globalThis.fetch;return{async request(t){let{method:r,path:s,query:i,body:o,headers:l}=t;const c=function(e,t,a){const n=new URL(t,e);if(a)for(const[r,s]of Object.entries(a))void 0!==s&&n.searchParams.set(r,s);return n.toString()}(e.baseUrl,s,i),d=await async function(e){return e&&"none"!==e.type?"bearer"===e.type?{Authorization:"Bearer ".concat(e.token)}:"header"===e.type?{[e.name]:e.value}:"custom"===e.type?await e.getHeaders():{}:{}}(e.auth),u=await a(c,{method:r,headers:(0,n.A)((0,n.A)((0,n.A)({},o?{"Content-Type":"application/json"}:{}),d),l),body:o?JSON.stringify(o):void 0}),m=await u.text(),h=(u.headers.get("content-type")||"").includes("application/json"),p=h&&m?JSON.parse(m):m;if(!u.ok){var f;const e=h?p:void 0,t=null===e||void 0===e?void 0:e.error;throw new Xt(null!==(f=null===t||void 0===t?void 0:t.message)&&void 0!==f?f:"Request failed with status ".concat(u.status),{status:u.status,icebergType:null===t||void 0===t?void 0:t.type,icebergCode:null===t||void 0===t?void 0:t.code,details:e})}return{status:u.status,headers:u.headers,data:p}}}}function ea(e){return e.join("\x1f")}var ta=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:ea(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:"".concat(this.prefix,"/namespaces"),query:t})).data.namespaces.map(e=>({namespace:e}))}async createNamespace(e,t){const a={namespace:e.namespace,properties:null===t||void 0===t?void 0:t.properties};return(await this.client.request({method:"POST",path:"".concat(this.prefix,"/namespaces"),body:a})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:"".concat(this.prefix,"/namespaces/").concat(ea(e.namespace))})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:"".concat(this.prefix,"/namespaces/").concat(ea(e.namespace))})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:"".concat(this.prefix,"/namespaces/").concat(ea(e.namespace))}),!0}catch(t){if(t instanceof Xt&&404===t.status)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(a){if(a instanceof Xt&&409===a.status)return;throw a}}};function aa(e){return e.join("\x1f")}var na=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2?arguments[2]:void 0;this.client=e,this.prefix=t,this.accessDelegation=a}async listTables(e){return(await this.client.request({method:"GET",path:"".concat(this.prefix,"/namespaces/").concat(aa(e.namespace),"/tables")})).data.identifiers}async createTable(e,t){const a={};this.accessDelegation&&(a["X-Iceberg-Access-Delegation"]=this.accessDelegation);return(await this.client.request({method:"POST",path:"".concat(this.prefix,"/namespaces/").concat(aa(e.namespace),"/tables"),body:t,headers:a})).data.metadata}async updateTable(e,t){const a=await this.client.request({method:"POST",path:"".concat(this.prefix,"/namespaces/").concat(aa(e.namespace),"/tables/").concat(e.name),body:t});return{"metadata-location":a.data["metadata-location"],metadata:a.data.metadata}}async dropTable(e,t){var a;await this.client.request({method:"DELETE",path:"".concat(this.prefix,"/namespaces/").concat(aa(e.namespace),"/tables/").concat(e.name),query:{purgeRequested:String(null!==(a=null===t||void 0===t?void 0:t.purge)&&void 0!==a&&a)}})}async loadTable(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);return(await this.client.request({method:"GET",path:"".concat(this.prefix,"/namespaces/").concat(aa(e.namespace),"/tables/").concat(e.name),headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:"".concat(this.prefix,"/namespaces/").concat(aa(e.namespace),"/tables/").concat(e.name),headers:t}),!0}catch(a){if(a instanceof Xt&&404===a.status)return!1;throw a}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(a){if(a instanceof Xt&&409===a.status)return await this.loadTable({namespace:e.namespace,name:t.name});throw a}}},ra=class{constructor(e){var t;let a="v1";e.catalogName&&(a+="/".concat(e.catalogName));const n=e.baseUrl.endsWith("/")?e.baseUrl:"".concat(e.baseUrl,"/");this.client=Zt({baseUrl:n,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=null===(t=e.accessDelegation)||void 0===t?void 0:t.join(","),this.namespaceOps=new ta(this.client,a),this.tableOps=new na(this.client,a,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}};var sa=class extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"storage",a=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;super(e),this.__isStorageError=!0,this.namespace=t,this.name="vectors"===t?"StorageVectorsError":"StorageError",this.status=a,this.statusCode=n}};function ia(e){return"object"===typeof e&&null!==e&&"__isStorageError"in e}var oa=class extends sa{constructor(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"storage";super(e,n,t,a),this.name="vectors"===n?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},la=class extends sa{constructor(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"storage";super(e,a),this.name="vectors"===a?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const ca=e=>{if(Array.isArray(e))return e.map(e=>ca(e));if("function"===typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(e=>{let[a,n]=e;const r=a.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[r]=ca(n)}),t};function da(e){return(da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ua(e){var t=function(e,t){if("object"!=da(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=da(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==da(t)?t:t+""}function ma(e,t,a){return(t=ua(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ha(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function pa(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ha(Object(a),!0).forEach(function(t){ma(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ha(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}const fa=e=>{var t;return e.msg||e.message||e.error_description||("string"===typeof e.error?e.error:null===(t=e.error)||void 0===t?void 0:t.message)||JSON.stringify(e)},ga=(e,t,a,n)=>{const r={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"!==e&&"HEAD"!==e&&n?((e=>{if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)})(n)?(r.headers=pa({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),r.body=JSON.stringify(n)):r.body=n,(null===t||void 0===t?void 0:t.duplex)&&(r.duplex=t.duplex),pa(pa({},r),a)):pa(pa({},r),a)};async function va(e,t,a,n,r,s,i){return new Promise((o,l)=>{e(a,ga(t,n,r,s)).then(e=>{if(!e.ok)throw e;if(null===n||void 0===n?void 0:n.noResolveJson)return e;if("vectors"===i){const t=e.headers.get("content-type");if("0"===e.headers.get("content-length")||204===e.status)return{};if(!t||!t.includes("application/json"))return{}}return e.json()}).then(e=>o(e)).catch(e=>(async(e,t,a,n)=>{if(e&&"object"===typeof e&&"status"in e&&"ok"in e&&"number"===typeof e.status&&!(null===a||void 0===a?void 0:a.noResolveJson)){const a=e,r=a.status||500;if("function"===typeof a.json)a.json().then(e=>{const a=(null===e||void 0===e?void 0:e.statusCode)||(null===e||void 0===e?void 0:e.code)||r+"";t(new oa(fa(e),r,a,n))}).catch(()=>{if("vectors"===n){const e=r+"";t(new oa(a.statusText||"HTTP ".concat(r," error"),r,e,n))}else{const e=r+"";t(new oa(a.statusText||"HTTP ".concat(r," error"),r,e,n))}});else{const e=r+"";t(new oa(a.statusText||"HTTP ".concat(r," error"),r,e,n))}}else t(new la(fa(e),e,n))})(e,l,n,i))})}function ya(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"storage";return{get:async(t,a,n,r)=>va(t,"GET",a,n,r,void 0,e),post:async(t,a,n,r,s)=>va(t,"POST",a,r,s,n,e),put:async(t,a,n,r,s)=>va(t,"PUT",a,r,s,n,e),head:async(t,a,n,r)=>va(t,"HEAD",a,pa(pa({},n),{},{noResolveJson:!0}),r,void 0,e),remove:async(t,a,n,r,s)=>va(t,"DELETE",a,r,s,n,e)}}const ba=ya("storage"),{get:xa,post:wa,put:Sa,head:ka,remove:Na}=ba,ja=ya("vectors");var Ta=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"storage";var r;this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=(r=a)?function(){return r(...arguments)}:function(){return fetch(...arguments)},this.namespace=n}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(e){try{return{data:await e(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ia(t))return{data:null,error:t};throw t}}},Aa=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){try{return{data:(await this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ia(e))return{data:null,error:e};throw e}}};let _a;_a=Symbol.toStringTag;var Ca=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[_a]="BlobDownloadBuilder",this.promise=null}asStream(){return new Aa(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){try{return{data:await(await this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ia(e))return{data:null,error:e};throw e}}};const Ma={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Pa={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Ea=class extends Ta{constructor(e){let t=arguments.length>2?arguments[2]:void 0;super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>3?arguments[3]:void 0,"storage"),this.bucketId=t}async uploadOrUpdate(e,t,a,n){var r=this;return r.handleOperation(async()=>{let s;const i=pa(pa({},Pa),n);let o=pa(pa({},r.headers),"POST"===e&&{"x-upsert":String(i.upsert)});const l=i.metadata;"undefined"!==typeof Blob&&a instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",r.encodeMetadata(l)),s.append("",a)):"undefined"!==typeof FormData&&a instanceof FormData?(s=a,s.has("cacheControl")||s.append("cacheControl",i.cacheControl),l&&!s.has("metadata")&&s.append("metadata",r.encodeMetadata(l))):(s=a,o["cache-control"]="max-age=".concat(i.cacheControl),o["content-type"]=i.contentType,l&&(o["x-metadata"]=r.toBase64(r.encodeMetadata(l))),("undefined"!==typeof ReadableStream&&s instanceof ReadableStream||s&&"object"===typeof s&&"pipe"in s&&"function"===typeof s.pipe)&&!i.duplex&&(i.duplex="half")),(null===n||void 0===n?void 0:n.headers)&&(o=pa(pa({},o),n.headers));const c=r._removeEmptyFolders(t),d=r._getFinalPath(c),u=await("PUT"==e?Sa:wa)(r.fetch,"".concat(r.url,"/object/").concat(d),s,pa({headers:o},(null===i||void 0===i?void 0:i.duplex)?{duplex:i.duplex}:{}));return{path:c,id:u.Id,fullPath:u.Key}})}async upload(e,t,a){return this.uploadOrUpdate("POST",e,t,a)}async uploadToSignedUrl(e,t,a,n){var r=this;const s=r._removeEmptyFolders(e),i=r._getFinalPath(s),o=new URL(r.url+"/object/upload/sign/".concat(i));return o.searchParams.set("token",t),r.handleOperation(async()=>{let e;const t=pa({upsert:Pa.upsert},n),i=pa(pa({},r.headers),{"x-upsert":String(t.upsert)});return"undefined"!==typeof Blob&&a instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",a)):"undefined"!==typeof FormData&&a instanceof FormData?(e=a,e.append("cacheControl",t.cacheControl)):(e=a,i["cache-control"]="max-age=".concat(t.cacheControl),i["content-type"]=t.contentType),{path:s,fullPath:(await Sa(r.fetch,o.toString(),e,{headers:i})).Key}})}async createSignedUploadUrl(e,t){var a=this;return a.handleOperation(async()=>{let n=a._getFinalPath(e);const r=pa({},a.headers);(null===t||void 0===t?void 0:t.upsert)&&(r["x-upsert"]="true");const s=await wa(a.fetch,"".concat(a.url,"/object/upload/sign/").concat(n),{},{headers:r}),i=new URL(a.url+s.url),o=i.searchParams.get("token");if(!o)throw new sa("No token returned by API");return{signedUrl:i.toString(),path:e,token:o}})}async update(e,t,a){return this.uploadOrUpdate("PUT",e,t,a)}async move(e,t,a){var n=this;return n.handleOperation(async()=>await wa(n.fetch,"".concat(n.url,"/object/move"),{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===a||void 0===a?void 0:a.destinationBucket},{headers:n.headers}))}async copy(e,t,a){var n=this;return n.handleOperation(async()=>({path:(await wa(n.fetch,"".concat(n.url,"/object/copy"),{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===a||void 0===a?void 0:a.destinationBucket},{headers:n.headers})).Key}))}async createSignedUrl(e,t,a){var n=this;return n.handleOperation(async()=>{let r=n._getFinalPath(e),s=await wa(n.fetch,"".concat(n.url,"/object/sign/").concat(r),pa({expiresIn:t},(null===a||void 0===a?void 0:a.transform)?{transform:a.transform}:{}),{headers:n.headers});const i=(null===a||void 0===a?void 0:a.download)?"&download=".concat(!0===a.download?"":a.download):"";return{signedUrl:encodeURI("".concat(n.url).concat(s.signedURL).concat(i))}})}async createSignedUrls(e,t,a){var n=this;return n.handleOperation(async()=>{const r=await wa(n.fetch,"".concat(n.url,"/object/sign/").concat(n.bucketId),{expiresIn:t,paths:e},{headers:n.headers}),s=(null===a||void 0===a?void 0:a.download)?"&download=".concat(!0===a.download?"":a.download):"";return r.map(e=>pa(pa({},e),{},{signedUrl:e.signedURL?encodeURI("".concat(n.url).concat(e.signedURL).concat(s)):null}))})}download(e,t){const a="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image/authenticated":"object",n=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{}),r=n?"?".concat(n):"",s=this._getFinalPath(e);return new Ca(()=>xa(this.fetch,"".concat(this.url,"/").concat(a,"/").concat(s).concat(r),{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}async info(e){var t=this;const a=t._getFinalPath(e);return t.handleOperation(async()=>ca(await xa(t.fetch,"".concat(t.url,"/object/info/").concat(a),{headers:t.headers})))}async exists(e){var t=this;const a=t._getFinalPath(e);try{return await ka(t.fetch,"".concat(t.url,"/object/").concat(a),{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(ia(n)&&n instanceof la){const e=n.originalError;if([400,404].includes(null===e||void 0===e?void 0:e.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const a=this._getFinalPath(e),n=[],r=(null===t||void 0===t?void 0:t.download)?"download=".concat(!0===t.download?"":t.download):"";""!==r&&n.push(r);const s="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image":"object",i=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{});""!==i&&n.push(i);let o=n.join("&");return""!==o&&(o="?".concat(o)),{data:{publicUrl:encodeURI("".concat(this.url,"/").concat(s,"/public/").concat(a).concat(o))}}}async remove(e){var t=this;return t.handleOperation(async()=>await Na(t.fetch,"".concat(t.url,"/object/").concat(t.bucketId),{prefixes:e},{headers:t.headers}))}async list(e,t,a){var n=this;return n.handleOperation(async()=>{const r=pa(pa(pa({},Ma),t),{},{prefix:e||""});return await wa(n.fetch,"".concat(n.url,"/object/list/").concat(n.bucketId),r,{headers:n.headers},a)})}async listV2(e,t){var a=this;return a.handleOperation(async()=>{const n=pa({},e);return await wa(a.fetch,"".concat(a.url,"/object/list-v2/").concat(a.bucketId),n,{headers:a.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!==typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return"".concat(this.bucketId,"/").concat(e.replace(/^\/+/,""))}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push("width=".concat(e.width)),e.height&&t.push("height=".concat(e.height)),e.resize&&t.push("resize=".concat(e.resize)),e.format&&t.push("format=".concat(e.format)),e.quality&&t.push("quality=".concat(e.quality)),t.join("&")}};const Ia={"X-Client-Info":"storage-js/".concat("2.95.2")};var Ra=class extends Ta{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;const r=new URL(e);(null===n||void 0===n?void 0:n.useNewHostname)&&/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase."));super(r.href.replace(/\/$/,""),pa(pa({},Ia),t),a,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const a=t.listBucketOptionsToQueryString(e);return await xa(t.fetch,"".concat(t.url,"/bucket").concat(a),{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await xa(t.fetch,"".concat(t.url,"/bucket/").concat(e),{headers:t.headers}))}async createBucket(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};var a=this;return a.handleOperation(async()=>await wa(a.fetch,"".concat(a.url,"/bucket"),{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:a.headers}))}async updateBucket(e,t){var a=this;return a.handleOperation(async()=>await Sa(a.fetch,"".concat(a.url,"/bucket/").concat(e),{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:a.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await wa(t.fetch,"".concat(t.url,"/bucket/").concat(e,"/empty"),{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await Na(t.fetch,"".concat(t.url,"/bucket/").concat(e),{},{headers:t.headers}))}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},Oa=class extends Ta{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;super(e.replace(/\/$/,""),pa(pa({},Ia),t),a,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await wa(t.fetch,"".concat(t.url,"/bucket"),{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const a=new URLSearchParams;void 0!==(null===e||void 0===e?void 0:e.limit)&&a.set("limit",e.limit.toString()),void 0!==(null===e||void 0===e?void 0:e.offset)&&a.set("offset",e.offset.toString()),(null===e||void 0===e?void 0:e.sortColumn)&&a.set("sortColumn",e.sortColumn),(null===e||void 0===e?void 0:e.sortOrder)&&a.set("sortOrder",e.sortOrder),(null===e||void 0===e?void 0:e.search)&&a.set("search",e.search);const n=a.toString(),r=n?"".concat(t.url,"/bucket?").concat(n):"".concat(t.url,"/bucket");return await xa(t.fetch,r,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await Na(t.fetch,"".concat(t.url,"/bucket/").concat(e),{},{headers:t.headers}))}from(e){var t=this;if(!(e=>!(!e||"string"!==typeof e)&&!(0===e.length||e.length>100)&&e.trim()===e&&!e.includes("/")&&!e.includes("\\")&&/^[\w!.\*'() &$@=;:+,?-]+$/.test(e))(e))throw new sa("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const a=new ra({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(a,{get(e,t){const a=e[t];return"function"!==typeof a?a:async function(){try{for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return{data:await a.apply(e,r),error:null}}catch(i){if(n)throw i;return{data:null,error:i}}}}})}},Da=class extends Ta{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;super(e.replace(/\/$/,""),pa(pa({},Ia),{},{"Content-Type":"application/json"},t),a,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await ja.post(t.fetch,"".concat(t.url,"/CreateIndex"),e,{headers:t.headers})||{})}async getIndex(e,t){var a=this;return a.handleOperation(async()=>await ja.post(a.fetch,"".concat(a.url,"/GetIndex"),{vectorBucketName:e,indexName:t},{headers:a.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await ja.post(t.fetch,"".concat(t.url,"/ListIndexes"),e,{headers:t.headers}))}async deleteIndex(e,t){var a=this;return a.handleOperation(async()=>await ja.post(a.fetch,"".concat(a.url,"/DeleteIndex"),{vectorBucketName:e,indexName:t},{headers:a.headers})||{})}},Fa=class extends Ta{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;super(e.replace(/\/$/,""),pa(pa({},Ia),{},{"Content-Type":"application/json"},t),a,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await ja.post(t.fetch,"".concat(t.url,"/PutVectors"),e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await ja.post(t.fetch,"".concat(t.url,"/GetVectors"),e,{headers:t.headers}))}async listVectors(e){var t=this;if(void 0!==e.segmentCount){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(void 0!==e.segmentIndex&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error("segmentIndex must be between 0 and ".concat(e.segmentCount-1))}return t.handleOperation(async()=>await ja.post(t.fetch,"".concat(t.url,"/ListVectors"),e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await ja.post(t.fetch,"".concat(t.url,"/QueryVectors"),e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await ja.post(t.fetch,"".concat(t.url,"/DeleteVectors"),e,{headers:t.headers})||{})}},La=class extends Ta{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;super(e.replace(/\/$/,""),pa(pa({},Ia),{},{"Content-Type":"application/json"},t),a,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await ja.post(t.fetch,"".concat(t.url,"/CreateVectorBucket"),{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await ja.post(t.fetch,"".concat(t.url,"/GetVectorBucket"),{vectorBucketName:e},{headers:t.headers}))}async listBuckets(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t=this;return t.handleOperation(async()=>await ja.post(t.fetch,"".concat(t.url,"/ListVectorBuckets"),e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await ja.post(t.fetch,"".concat(t.url,"/DeleteVectorBucket"),{vectorBucketName:e},{headers:t.headers})||{})}},qa=class extends La{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t.headers||{},t.fetch)}from(e){return new Ua(this.url,this.headers,e,this.fetch)}async createBucket(e){return(()=>super.createBucket)().call(this,e)}async getBucket(e){return(()=>super.getBucket)().call(this,e)}async listBuckets(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(()=>super.listBuckets)().call(this,e)}async deleteBucket(e){return(()=>super.deleteBucket)().call(this,e)}},Ua=class extends Da{constructor(e,t,a,n){super(e,t,n),this.vectorBucketName=a}async createIndex(e){return(()=>super.createIndex)().call(this,pa(pa({},e),{},{vectorBucketName:this.vectorBucketName}))}async listIndexes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(()=>super.listIndexes)().call(this,pa(pa({},e),{},{vectorBucketName:this.vectorBucketName}))}async getIndex(e){return(()=>super.getIndex)().call(this,this.vectorBucketName,e)}async deleteIndex(e){return(()=>super.deleteIndex)().call(this,this.vectorBucketName,e)}index(e){return new Ba(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},Ba=class extends Fa{constructor(e,t,a,n,r){super(e,t,r),this.vectorBucketName=a,this.indexName=n}async putVectors(e){var t=this;return(()=>super.putVectors)().call(t,pa(pa({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async getVectors(e){var t=this;return(()=>super.getVectors)().call(t,pa(pa({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async listVectors(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t=this;return(()=>super.listVectors)().call(t,pa(pa({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async queryVectors(e){var t=this;return(()=>super.queryVectors)().call(t,pa(pa({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}async deleteVectors(e){var t=this;return(()=>super.deleteVectors)().call(t,pa(pa({},e),{},{vectorBucketName:t.vectorBucketName,indexName:t.indexName}))}},Ga=class extends Ra{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0)}from(e){return new Ea(this.url,this.headers,e,this.fetch)}get vectors(){return new qa(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Oa(this.url+"/iceberg",this.headers,this.fetch)}};const za="2.95.2",Va=3e4,Ha=9e4,Ka={"X-Client-Info":"gotrue-js/".concat(za)},Wa="X-Supabase-Api-Version",Ya={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},Ja=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class Qa extends Error{constructor(e,t,a){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=a}}function $a(e){return"object"===typeof e&&null!==e&&"__isAuthError"in e}class Xa extends Qa{constructor(e,t,a){super(e,t,a),this.name="AuthApiError",this.status=t,this.code=a}}class Za extends Qa{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class en extends Qa{constructor(e,t,a,n){super(e,a,n),this.name=t,this.status=a}}class tn extends en{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function an(e){return $a(e)&&"AuthSessionMissingError"===e.name}class nn extends en{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class rn extends en{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class sn extends en{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class on extends en{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ln extends en{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class cn extends en{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function dn(e){return $a(e)&&"AuthRetryableFetchError"===e.name}class un extends en{constructor(e,t,a){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=a}}class mn extends en{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const hn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),pn=" \t\n\r=".split(""),fn=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<pn.length;t+=1)e[pn[t].charCodeAt(0)]=-2;for(let t=0;t<hn.length;t+=1)e[hn[t].charCodeAt(0)]=t;return e})();function gn(e,t,a){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;a(hn[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;a(hn[e]),t.queuedBits-=6}}function vn(e,t,a){const n=fn[e];if(!(n>-1)){if(-2===n)return;throw new Error('Invalid Base64-URL character "'.concat(String.fromCharCode(e),'"'))}for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)a(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function yn(e){const t=[],a=e=>{t.push(String.fromCodePoint(e))},n={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},s=e=>{!function(e,t,a){if(0===t.utf8seq){if(e<=127)return void a(e);for(let a=1;a<6;a+=1)if(0===(e>>7-a&1)){t.utf8seq=a;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&a(t.codepoint)}}(e,n,a)};for(let i=0;i<e.length;i+=1)vn(e.charCodeAt(i),r,s);return t.join("")}function bn(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error("Unrecognized Unicode codepoint: ".concat(e.toString(16)))}t(e)}function xn(e,t){for(let a=0;a<e.length;a+=1){let n=e.charCodeAt(a);if(n>55295&&n<=56319){const t=1024*(n-55296)&65535;n=65536+(e.charCodeAt(a+1)-56320&65535|t),a+=1}bn(n,t)}}function wn(e){const t=[],a={queue:0,queuedBits:0},n=e=>{t.push(e)};for(let r=0;r<e.length;r+=1)vn(e.charCodeAt(r),a,n);return new Uint8Array(t)}function Sn(e){const t=[],a={queue:0,queuedBits:0},n=e=>{t.push(e)};return e.forEach(e=>gn(e,a,n)),gn(null,a,n),t.join("")}const kn=()=>"undefined"!==typeof window&&"undefined"!==typeof document,Nn={tested:!1,writable:!1},jn=()=>{if(!kn())return!1;try{if("object"!==typeof globalThis.localStorage)return!1}catch(t){return!1}if(Nn.tested)return Nn.writable;const e="lswt-".concat(Math.random()).concat(Math.random());try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Nn.tested=!0,Nn.writable=!0}catch(t){Nn.tested=!0,Nn.writable=!1}return Nn.writable};const Tn=e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)},An=async(e,t,a)=>{await e.setItem(t,JSON.stringify(a))},_n=async(e,t)=>{const a=await e.getItem(t);if(!a)return null;try{return JSON.parse(a)}catch(n){return a}},Cn=async(e,t)=>{await e.removeItem(t)};class Mn{constructor(){this.promise=new Mn.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function Pn(e){const t=e.split(".");if(3!==t.length)throw new mn("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!Ja.test(t[a]))throw new mn("JWT not in base64url format");return{header:JSON.parse(yn(t[0])),payload:JSON.parse(yn(t[1])),signature:wn(t[2]),raw:{header:t[0],payload:t[1]}}}function En(e){return("0"+e.toString(16)).substr(-2)}async function In(e){if(!("undefined"!==typeof crypto&&"undefined"!==typeof crypto.subtle&&"undefined"!==typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),a=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(a);return Array.from(n).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Rn(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=function(){const e=new Uint32Array(56);if("undefined"===typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let a="";for(let n=0;n<56;n++)a+=e.charAt(Math.floor(Math.random()*t));return a}return crypto.getRandomValues(e),Array.from(e,En).join("")}();let r=n;a&&(r+="/PASSWORD_RECOVERY"),await An(e,"".concat(t,"-code-verifier"),r);const s=await In(n);return[s,n===s?"plain":"s256"]}Mn.promiseConstructor=Promise;const On=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const Dn=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Fn(e){if(!Dn.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ln(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"===typeof t){const e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "'.concat(t,'" property of the session object is not supported. Please use getUser() instead.'))},set:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))},deleteProperty:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))}})}function qn(e){return JSON.parse(JSON.stringify(e))}const Un=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Bn=[502,503,504];async function Gn(e){var t,a;if(!("object"===typeof(a=e)&&null!==a&&"status"in a&&"ok"in a&&"json"in a&&"function"===typeof a.json))throw new cn(Un(e),0);if(Bn.includes(e.status))throw new cn(Un(e),e.status);let n,r;try{n=await e.json()}catch(i){throw new Za(Un(i),i)}const s=function(e){const t=e.headers.get(Wa);if(!t)return null;if(!t.match(On))return null;try{return new Date("".concat(t,"T00:00:00.0Z"))}catch(i){return null}}(e);if(s&&s.getTime()>=Ya.timestamp&&"object"===typeof n&&n&&"string"===typeof n.code?r=n.code:"object"===typeof n&&n&&"string"===typeof n.error_code&&(r=n.error_code),r){if("weak_password"===r)throw new un(Un(n),e.status,(null===(t=n.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===r)throw new tn}else if("object"===typeof n&&n&&"object"===typeof n.weak_password&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0))throw new un(Un(n),e.status,n.weak_password.reasons);throw new Xa(Un(n),e.status||500,r)}async function zn(e,t,a,n){var r;const s=Object.assign({},null===n||void 0===n?void 0:n.headers);s[Wa]||(s[Wa]=Ya.name),(null===n||void 0===n?void 0:n.jwt)&&(s.Authorization="Bearer ".concat(n.jwt));const i=null!==(r=null===n||void 0===n?void 0:n.query)&&void 0!==r?r:{};(null===n||void 0===n?void 0:n.redirectTo)&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await async function(e,t,a,n,r,s){const i=((e,t,a,n)=>{const r={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),r.body=JSON.stringify(n),Object.assign(Object.assign({},r),a))})(t,n,r,s);let o;try{o=await e(a,Object.assign({},i))}catch(l){throw console.error(l),new cn(Un(l),0)}o.ok||await Gn(o);if(null===n||void 0===n?void 0:n.noResolveJson)return o;try{return await o.json()}catch(l){await Gn(l)}}(e,t,a+o,{headers:s,noResolveJson:null===n||void 0===n?void 0:n.noResolveJson},{},null===n||void 0===n?void 0:n.body);return(null===n||void 0===n?void 0:n.xform)?null===n||void 0===n?void 0:n.xform(l):{data:Object.assign({},l),error:null}}function Vn(e){var t;let a=null;var n;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(a=Object.assign({},e),e.expires_at||(a.expires_at=(n=e.expires_in,Math.round(Date.now()/1e3)+n)));return{data:{session:a,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function Hn(e){const t=Vn(e);return!t.error&&e.weak_password&&"object"===typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"===typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function Kn(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function Wn(e){return{data:e,error:null}}function Yn(e){const{action_link:t,email_otp:a,hashed_token:n,redirect_to:r,verification_type:s}=e,i=Qe(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:a,hashed_token:n,redirect_to:r,verification_type:s},user:Object.assign({},i)},error:null}}function Jn(e){return e}const Qn=["global","local","others"];class $n{constructor(e){let{url:t="",headers:a={},fetch:n}=e;this.url=t,this.headers=a,this.fetch=Tn(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn[0];if(Qn.indexOf(t)<0)throw new Error("@supabase/auth-js: Parameter scope must be one of ".concat(Qn.join(", ")));try{return await zn(this.fetch,"POST","".concat(this.url,"/logout?scope=").concat(t),{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(a){if($a(a))return{data:null,error:a};throw a}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await zn(this.fetch,"POST","".concat(this.url,"/invite"),{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Kn})}catch(a){if($a(a))return{data:{user:null},error:a};throw a}}async generateLink(e){try{const{options:t}=e,a=Qe(e,["options"]),n=Object.assign(Object.assign({},a),t);return"newEmail"in a&&(n.new_email=null===a||void 0===a?void 0:a.newEmail,delete n.newEmail),await zn(this.fetch,"POST","".concat(this.url,"/admin/generate_link"),{body:n,headers:this.headers,xform:Yn,redirectTo:null===t||void 0===t?void 0:t.redirectTo})}catch(t){if($a(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await zn(this.fetch,"POST","".concat(this.url,"/admin/users"),{body:e,headers:this.headers,xform:Kn})}catch(t){if($a(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,a,n,r,s,i,o;try{const l={nextPage:null,lastPage:0,total:0},c=await zn(this.fetch,"GET","".concat(this.url,"/admin/users"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(a=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==a?a:"",per_page:null!==(r=null===(n=null===e||void 0===e?void 0:e.perPage)||void 0===n?void 0:n.toString())&&void 0!==r?r:""},xform:Jn});if(c.error)throw c.error;const d=await c.json(),u=null!==(s=c.headers.get("x-total-count"))&&void 0!==s?s:0,m=null!==(o=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==o?o:[];return m.length>0&&(m.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),a=JSON.parse(e.split(";")[1].split("=")[1]);l["".concat(a,"Page")]=t}),l.total=parseInt(u)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if($a(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){Fn(e);try{return await zn(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,xform:Kn})}catch(t){if($a(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Fn(e);try{return await zn(this.fetch,"PUT","".concat(this.url,"/admin/users/").concat(e),{body:t,headers:this.headers,xform:Kn})}catch(a){if($a(a))return{data:{user:null},error:a};throw a}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Fn(e);try{return await zn(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,body:{should_soft_delete:t},xform:Kn})}catch(a){if($a(a))return{data:{user:null},error:a};throw a}}async _listFactors(e){Fn(e.userId);try{const{data:t,error:a}=await zn(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e.userId,"/factors"),{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:a}}catch(t){if($a(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Fn(e.userId),Fn(e.id);try{return{data:await zn(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e.userId,"/factors/").concat(e.id),{headers:this.headers}),error:null}}catch(t){if($a(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,a,n,r,s,i,o;try{const l={nextPage:null,lastPage:0,total:0},c=await zn(this.fetch,"GET","".concat(this.url,"/admin/oauth/clients"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(a=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==a?a:"",per_page:null!==(r=null===(n=null===e||void 0===e?void 0:e.perPage)||void 0===n?void 0:n.toString())&&void 0!==r?r:""},xform:Jn});if(c.error)throw c.error;const d=await c.json(),u=null!==(s=c.headers.get("x-total-count"))&&void 0!==s?s:0,m=null!==(o=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==o?o:[];return m.length>0&&(m.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),a=JSON.parse(e.split(";")[1].split("=")[1]);l["".concat(a,"Page")]=t}),l.total=parseInt(u)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if($a(l))return{data:{clients:[]},error:l};throw l}}async _createOAuthClient(e){try{return await zn(this.fetch,"POST","".concat(this.url,"/admin/oauth/clients"),{body:e,headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if($a(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await zn(this.fetch,"GET","".concat(this.url,"/admin/oauth/clients/").concat(e),{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if($a(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await zn(this.fetch,"PUT","".concat(this.url,"/admin/oauth/clients/").concat(e),{body:t,headers:this.headers,xform:e=>({data:e,error:null})})}catch(a){if($a(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(e){try{return await zn(this.fetch,"DELETE","".concat(this.url,"/admin/oauth/clients/").concat(e),{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if($a(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await zn(this.fetch,"POST","".concat(this.url,"/admin/oauth/clients/").concat(e,"/regenerate_secret"),{headers:this.headers,xform:e=>({data:e,error:null})})}catch(t){if($a(t))return{data:null,error:t};throw t}}}function Xn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,a)=>{e[t]=a},removeItem:t=>{delete e[t]}}}const Zn=!!(globalThis&&jn()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class er extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class tr extends er{}async function ar(e,t,a){Zn&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Zn&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async n=>{if(!n){if(0===t)throw Zn&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new tr('Acquiring an exclusive Navigator LockManager lock "'.concat(e,'" immediately failed'));if(Zn)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(r){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",r)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await a()}Zn&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await a()}finally{Zn&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}))}function nr(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error('@supabase/auth-js: Address "'.concat(e,'" is invalid.'));return e.toLowerCase()}function rr(e){const t=(new TextEncoder).encode(e);return"0x"+Array.from(t,e=>e.toString(16).padStart(2,"0")).join("")}class sr extends Error{constructor(e){let{message:t,code:a,cause:n,name:r}=e;var s;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=null!==(s=null!==r&&void 0!==r?r:n instanceof Error?n.name:void 0)&&void 0!==s?s:"Unknown Error",this.code=a}}class ir extends sr{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function or(e){let{error:t,options:a}=e;var n,r,s;const{publicKey:i}=a;if(!i)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(a.signal instanceof AbortSignal)return new sr({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if("ConstraintError"===t.name){if(!0===(null===(n=i.authenticatorSelection)||void 0===n?void 0:n.requireResidentKey))return new sr({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if("conditional"===a.mediation&&"required"===(null===(r=i.authenticatorSelection)||void 0===r?void 0:r.userVerification))return new sr({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if("required"===(null===(s=i.authenticatorSelection)||void 0===s?void 0:s.userVerification))return new sr({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if("InvalidStateError"===t.name)return new sr({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if("NotAllowedError"===t.name)return new sr({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if("NotSupportedError"===t.name){return 0===i.pubKeyCredParams.filter(e=>"public-key"===e.type).length?new sr({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new sr({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t})}if("SecurityError"===t.name){const e=window.location.hostname;if(!pr(e))return new sr({message:"".concat(window.location.hostname," is an invalid domain"),code:"ERROR_INVALID_DOMAIN",cause:t});if(i.rp.id!==e)return new sr({message:'The RP ID "'.concat(i.rp.id,'" is invalid for this domain'),code:"ERROR_INVALID_RP_ID",cause:t})}else if("TypeError"===t.name){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new sr({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if("UnknownError"===t.name)return new sr({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new sr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function lr(e){let{error:t,options:a}=e;const{publicKey:n}=a;if(!n)throw Error("options was missing required publicKey property");if("AbortError"===t.name){if(a.signal instanceof AbortSignal)return new sr({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if("NotAllowedError"===t.name)return new sr({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if("SecurityError"===t.name){const e=window.location.hostname;if(!pr(e))return new sr({message:"".concat(window.location.hostname," is an invalid domain"),code:"ERROR_INVALID_DOMAIN",cause:t});if(n.rpId!==e)return new sr({message:'The RP ID "'.concat(n.rpId,'" is invalid for this domain'),code:"ERROR_INVALID_RP_ID",cause:t})}else if("UnknownError"===t.name)return new sr({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new sr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}const cr=new class{createNewAbortSignal(){if(this.controller){const e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}};function dr(e){if(!e)throw new Error("Credential creation options are required");if("undefined"!==typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"===typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:a,excludeCredentials:n}=e,r=Qe(e,["challenge","user","excludeCredentials"]),s=wn(t).buffer,i=Object.assign(Object.assign({},a),{id:wn(a.id).buffer}),o=Object.assign(Object.assign({},r),{challenge:s,user:i});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let e=0;e<n.length;e++){const t=n[e];o.excludeCredentials[e]=Object.assign(Object.assign({},t),{id:wn(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return o}function ur(e){if(!e)throw new Error("Credential request options are required");if("undefined"!==typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"===typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:a}=e,n=Qe(e,["challenge","allowCredentials"]),r=wn(t).buffer,s=Object.assign(Object.assign({},n),{challenge:r});if(a&&a.length>0){s.allowCredentials=new Array(a.length);for(let e=0;e<a.length;e++){const t=a[e];s.allowCredentials[e]=Object.assign(Object.assign({},t),{id:wn(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return s}function mr(e){var t;if("toJSON"in e&&"function"===typeof e.toJSON)return e.toJSON();const a=e;return{id:e.id,rawId:e.id,response:{attestationObject:Sn(new Uint8Array(e.response.attestationObject)),clientDataJSON:Sn(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:null!==(t=a.authenticatorAttachment)&&void 0!==t?t:void 0}}function hr(e){var t;if("toJSON"in e&&"function"===typeof e.toJSON)return e.toJSON();const a=e,n=e.getClientExtensionResults(),r=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Sn(new Uint8Array(r.authenticatorData)),clientDataJSON:Sn(new Uint8Array(r.clientDataJSON)),signature:Sn(new Uint8Array(r.signature)),userHandle:r.userHandle?Sn(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:null!==(t=a.authenticatorAttachment)&&void 0!==t?t:void 0}}function pr(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function fr(){var e,t;return!!(kn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&"function"===typeof(null===(e=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===e?void 0:e.create)&&"function"===typeof(null===(t=null===navigator||void 0===navigator?void 0:navigator.credentials)||void 0===t?void 0:t.get))}const gr={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},vr={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function yr(){const e=e=>null!==e&&"object"===typeof e&&!Array.isArray(e),t=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),a={};for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];for(const i of r)if(i)for(const n in i){const r=i[n];if(void 0!==r)if(Array.isArray(r))a[n]=r;else if(t(r))a[n]=r;else if(e(r)){const t=a[n];e(t)?a[n]=yr(t,r):a[n]=yr(r)}else a[n]=r}return a}class br{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge(e,t){let{factorId:a,webauthn:n,friendlyName:r,signal:s}=e;var i;try{const{data:e,error:o}=await this.client.mfa.challenge({factorId:a,webauthn:n});if(!e)return{data:null,error:o};const l=null!==s&&void 0!==s?s:cr.createNewAbortSignal();if("create"===e.webauthn.type){const{user:t}=e.webauthn.credential_options.publicKey;if(!t.name){const e=r;if(e)t.name="".concat(t.id,":").concat(e);else{const e=(await this.client.getUser()).data.user,a=(null===(i=null===e||void 0===e?void 0:e.user_metadata)||void 0===i?void 0:i.name)||(null===e||void 0===e?void 0:e.email)||(null===e||void 0===e?void 0:e.id)||"User";t.name="".concat(t.id,":").concat(a)}}t.displayName||(t.displayName=t.name)}switch(e.webauthn.type){case"create":{const n=function(e,t){return yr(gr,e,t||{})}(e.webauthn.credential_options.publicKey,null===t||void 0===t?void 0:t.create),{data:r,error:s}=await async function(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new ir("Browser returned unexpected credential type",t)}:{data:null,error:new ir("Empty credential response",t)}}catch(t){return{data:null,error:or({error:t,options:e})}}}({publicKey:n,signal:l});return r?{data:{factorId:a,challengeId:e.id,webauthn:{type:e.webauthn.type,credential_response:r}},error:null}:{data:null,error:s}}case"request":{const n=function(e,t){return yr(vr,e,t||{})}(e.webauthn.credential_options.publicKey,null===t||void 0===t?void 0:t.request),{data:r,error:s}=await async function(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new ir("Browser returned unexpected credential type",t)}:{data:null,error:new ir("Empty credential response",t)}}catch(t){return{data:null,error:lr({error:t,options:e})}}}(Object.assign(Object.assign({},e.webauthn.credential_options),{publicKey:n,signal:l}));return r?{data:{factorId:a,challengeId:e.id,webauthn:{type:e.webauthn.type,credential_response:r}},error:null}:{data:null,error:s}}}}catch(o){return $a(o)?{data:null,error:o}:{data:null,error:new Za("Unexpected error in challenge",o)}}}async _verify(e){let{challengeId:t,factorId:a,webauthn:n}=e;return this.client.mfa.verify({factorId:a,challengeId:t,webauthn:n})}async _authenticate(e,t){let{factorId:a,webauthn:{rpId:n=("undefined"!==typeof window?window.location.hostname:void 0),rpOrigins:r=("undefined"!==typeof window?[window.location.origin]:void 0),signal:s}={}}=e;if(!n)return{data:null,error:new Qa("rpId is required for WebAuthn authentication")};try{if(!fr())return{data:null,error:new Za("Browser does not support WebAuthn",null)};const{data:e,error:i}=await this.challenge({factorId:a,webauthn:{rpId:n,rpOrigins:r},signal:s},{request:t});if(!e)return{data:null,error:i};const{webauthn:o}=e;return this._verify({factorId:a,challengeId:e.challengeId,webauthn:{type:o.type,rpId:n,rpOrigins:r,credential_response:o.credential_response}})}catch(i){return $a(i)?{data:null,error:i}:{data:null,error:new Za("Unexpected error in authenticate",i)}}}async _register(e,t){let{friendlyName:a,webauthn:{rpId:n=("undefined"!==typeof window?window.location.hostname:void 0),rpOrigins:r=("undefined"!==typeof window?[window.location.origin]:void 0),signal:s}={}}=e;if(!n)return{data:null,error:new Qa("rpId is required for WebAuthn registration")};try{if(!fr())return{data:null,error:new Za("Browser does not support WebAuthn",null)};const{data:e,error:i}=await this._enroll({friendlyName:a});if(!e)return await this.client.mfa.listFactors().then(e=>{var t;return null===(t=e.data)||void 0===t?void 0:t.all.find(e=>"webauthn"===e.factor_type&&e.friendly_name===a&&"unverified"!==e.status)}).then(e=>e?this.client.mfa.unenroll({factorId:null===e||void 0===e?void 0:e.id}):void 0),{data:null,error:i};const{data:o,error:l}=await this._challenge({factorId:e.id,friendlyName:e.friendly_name,webauthn:{rpId:n,rpOrigins:r},signal:s},{create:t});return o?this._verify({factorId:e.id,challengeId:o.challengeId,webauthn:{rpId:n,rpOrigins:r,type:o.webauthn.type,credential_response:o.webauthn.credential_response}}):{data:null,error:l}}catch(i){return $a(i)?{data:null,error:i}:{data:null,error:new Za("Unexpected error in register",i)}}}}!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!==typeof self&&(self.globalThis=self)}}();const xr={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ka,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function wr(e,t,a){return await a()}const Sr={};class kr{get jwks(){var e,t;return null!==(t=null===(e=Sr[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){Sr[this.storageKey]=Object.assign(Object.assign({},Sr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=Sr[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Sr[this.storageKey]=Object.assign(Object.assign({},Sr[this.storageKey]),{cachedAt:e})}constructor(e){var t,a,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const r=Object.assign(Object.assign({},xr),e);if(this.storageKey=r.storageKey,this.instanceID=null!==(t=kr.nextInstanceID[this.storageKey])&&void 0!==t?t:0,kr.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!r.debug,"function"===typeof r.debug&&(this.logger=r.debug),this.instanceID>0&&kn()){const e="".concat(this._logPrefix()," Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");console.warn(e),this.logDebugMessages&&console.trace(e)}if(this.persistSession=r.persistSession,this.autoRefreshToken=r.autoRefreshToken,this.admin=new $n({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Tn(r.fetch),this.lock=r.lock||wr,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,this.throwOnError=r.throwOnError,this.lockAcquireTimeout=r.lockAcquireTimeout,r.lock?this.lock=r.lock:this.persistSession&&kn()&&(null===(a=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===a?void 0:a.locks)?this.lock=ar:this.lock=wr,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new br(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(r.storage?this.storage=r.storage:jn()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Xn(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=Xn(this.memoryStorage)),kn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}null===(n=this.broadcastChannel)||void 0===n||n.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e);try{await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}catch(t){this._debug("#broadcastChannel","error",t)}})}this.initialize().catch(e=>{this._debug("#initialize()","error",e)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return"GoTrueClient@"+"".concat(this.storageKey,":").concat(this.instanceID," (").concat(za,") ").concat((new Date).toISOString())}_debug(){if(this.logDebugMessages){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];this.logger(this._logPrefix(),...t)}return this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t={},a="none";if(kn()&&(t=function(e){const t={},a=new URL(e);if(a.hash&&"#"===a.hash[0])try{new URLSearchParams(a.hash.substring(1)).forEach((e,a)=>{t[a]=e})}catch(n){}return a.searchParams.forEach((e,a)=>{t[a]=e}),t}(window.location.href),this._isImplicitGrantCallback(t)?a="implicit":await this._isPKCECallback(t)&&(a="pkce")),kn()&&this.detectSessionInUrl&&"none"!==a){const{data:n,error:r}=await this._getSessionFromURL(t,a);if(r){if(this._debug("#_initialize()","error detecting session from URL",r),function(e){return $a(e)&&"AuthImplicitGrantRedirectError"===e.name}(r)){const t=null===(e=r.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:r}}return{error:r}}const{session:s,redirectType:i}=n;return this._debug("#_initialize()","detected session in URL",s,"redirect type",i),await this._saveSession(s),setTimeout(async()=>{"recovery"===i?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return $a(t)?this._returnResult({error:t}):this._returnResult({error:new Za("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,a,n;try{const r=await zn(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{data:null!==(a=null===(t=null===e||void 0===e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==a?a:{},gotrue_meta_security:{captcha_token:null===(n=null===e||void 0===e?void 0:e.options)||void 0===n?void 0:n.captchaToken}},xform:Vn}),{data:s,error:i}=r;if(i||!s)return this._returnResult({data:{user:null,session:null},error:i});const o=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(r){if($a(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signUp(e){var t,a,n;try{let r;if("email"in e){const{email:a,password:n,options:s}=e;let i=null,o=null;"pkce"===this.flowType&&([i,o]=await Rn(this.storage,this.storageKey)),r=await zn(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,redirectTo:null===s||void 0===s?void 0:s.emailRedirectTo,body:{email:a,password:n,data:null!==(t=null===s||void 0===s?void 0:s.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken},code_challenge:i,code_challenge_method:o},xform:Vn})}else{if(!("phone"in e))throw new rn("You must provide either an email or phone number and a password");{const{phone:t,password:s,options:i}=e;r=await zn(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{phone:t,password:s,data:null!==(a=null===i||void 0===i?void 0:i.data)&&void 0!==a?a:{},channel:null!==(n=null===i||void 0===i?void 0:i.channel)&&void 0!==n?n:"sms",gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}},xform:Vn})}}const{data:s,error:i}=r;if(i||!s)return await Cn(this.storage,"".concat(this.storageKey,"-code-verifier")),this._returnResult({data:{user:null,session:null},error:i});const o=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(r){if(await Cn(this.storage,"".concat(this.storageKey,"-code-verifier")),$a(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:n,options:r}=e;t=await zn(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{email:a,password:n,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},xform:Hn})}else{if(!("phone"in e))throw new rn("You must provide either an email or phone number and a password");{const{phone:a,password:n,options:r}=e;t=await zn(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{phone:a,password:n,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},xform:Hn})}}const{data:a,error:n}=t;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!a||!a.session||!a.user){const e=new nn;return this._returnResult({data:{user:null,session:null},error:e})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:n})}catch(t){if($a(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,a,n,r;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(a=e.options)||void 0===a?void 0:a.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:null===(r=e.options)||void 0===r?void 0:r.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error('@supabase/auth-js: Unsupported chain "'.concat(t,'"'))}}async signInWithEthereum(e){var t,a,n,r,s,i,o,l,c,d,u;let m,h;if("message"in e)m=e.message,h=e.signature;else{const{chain:d,wallet:u,statement:p,options:f}=e;let g;if(kn())if("object"===typeof u)g=u;else{const e=window;if(!("ethereum"in e)||"object"!==typeof e.ethereum||!("request"in e.ethereum)||"function"!==typeof e.ethereum.request)throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.");g=e.ethereum}else{if("object"!==typeof u||!(null===f||void 0===f?void 0:f.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");g=u}const v=new URL(null!==(t=null===f||void 0===f?void 0:f.url)&&void 0!==t?t:window.location.href),y=await g.request({method:"eth_requestAccounts"}).then(e=>e).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!y||0===y.length)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const b=nr(y[0]);let x=null===(a=null===f||void 0===f?void 0:f.signInWithEthereum)||void 0===a?void 0:a.chainId;if(!x){const e=await g.request({method:"eth_chainId"});x=parseInt(e,16)}m=function(e){var t;const{chainId:a,domain:n,expirationTime:r,issuedAt:s=new Date,nonce:i,notBefore:o,requestId:l,resources:c,scheme:d,uri:u,version:m}=e;if(!Number.isInteger(a))throw new Error('@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: '.concat(a));if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error('@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: '.concat(i));if(!u)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==m)throw new Error("@supabase/auth-js: Invalid SIWE message field \"version\". Version must be '1'. Provided value: ".concat(m));if(null===(t=e.statement)||void 0===t?void 0:t.includes("\n"))throw new Error("@supabase/auth-js: Invalid SIWE message field \"statement\". Statement must not include '\\n'. Provided value: ".concat(e.statement));const h=nr(e.address),p=d?"".concat(d,"://").concat(n):n,f=e.statement?"".concat(e.statement,"\n"):"",g="".concat(p," wants you to sign in with your Ethereum account:\n").concat(h,"\n\n").concat(f);let v="URI: ".concat(u,"\nVersion: ").concat(m,"\nChain ID: ").concat(a).concat(i?"\nNonce: ".concat(i):"","\nIssued At: ").concat(s.toISOString());if(r&&(v+="\nExpiration Time: ".concat(r.toISOString())),o&&(v+="\nNot Before: ".concat(o.toISOString())),l&&(v+="\nRequest ID: ".concat(l)),c){let e="\nResources:";for(const t of c){if(!t||"string"!==typeof t)throw new Error('@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: '.concat(t));e+="\n- ".concat(t)}v+=e}return"".concat(g,"\n").concat(v)}({domain:v.host,address:b,statement:p,uri:v.href,version:"1",chainId:x,nonce:null===(n=null===f||void 0===f?void 0:f.signInWithEthereum)||void 0===n?void 0:n.nonce,issuedAt:null!==(s=null===(r=null===f||void 0===f?void 0:f.signInWithEthereum)||void 0===r?void 0:r.issuedAt)&&void 0!==s?s:new Date,expirationTime:null===(i=null===f||void 0===f?void 0:f.signInWithEthereum)||void 0===i?void 0:i.expirationTime,notBefore:null===(o=null===f||void 0===f?void 0:f.signInWithEthereum)||void 0===o?void 0:o.notBefore,requestId:null===(l=null===f||void 0===f?void 0:f.signInWithEthereum)||void 0===l?void 0:l.requestId,resources:null===(c=null===f||void 0===f?void 0:f.signInWithEthereum)||void 0===c?void 0:c.resources}),h=await g.request({method:"personal_sign",params:[rr(m),b]})}try{const{data:t,error:a}=await zn(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"ethereum",message:m,signature:h},(null===(d=e.options)||void 0===d?void 0:d.captchaToken)?{gotrue_meta_security:{captcha_token:null===(u=e.options)||void 0===u?void 0:u.captchaToken}}:null),xform:Vn});if(a)throw a;if(!t||!t.session||!t.user){const e=new nn;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:a})}catch(p){if($a(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async signInWithSolana(e){var t,a,n,r,s,i,o,l,c,d,u,m;let h,p;if("message"in e)h=e.message,p=e.signature;else{const{chain:u,wallet:m,statement:f,options:g}=e;let v;if(kn())if("object"===typeof m)v=m;else{const e=window;if(!("solana"in e)||"object"!==typeof e.solana||!("signIn"in e.solana&&"function"===typeof e.solana.signIn||"signMessage"in e.solana&&"function"===typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");v=e.solana}else{if("object"!==typeof m||!(null===g||void 0===g?void 0:g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=m}const y=new URL(null!==(t=null===g||void 0===g?void 0:g.url)&&void 0!==t?t:window.location.href);if("signIn"in v&&v.signIn){const e=await v.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null===g||void 0===g?void 0:g.signInWithSolana),{version:"1",domain:y.host,uri:y.href}),f?{statement:f}:null));let t;if(Array.isArray(e)&&e[0]&&"object"===typeof e[0])t=e[0];else{if(!(e&&"object"===typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"===typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");h="string"===typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),p=t.signature}else{if(!("signMessage"in v)||"function"!==typeof v.signMessage||!("publicKey"in v)||"object"!==typeof v||!v.publicKey||!("toBase58"in v.publicKey)||"function"!==typeof v.publicKey.toBase58)throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");h=["".concat(y.host," wants you to sign in with your Solana account:"),v.publicKey.toBase58(),...f?["",f,""]:[""],"Version: 1","URI: ".concat(y.href),"Issued At: ".concat(null!==(n=null===(a=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===a?void 0:a.issuedAt)&&void 0!==n?n:(new Date).toISOString()),...(null===(r=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===r?void 0:r.notBefore)?["Not Before: ".concat(g.signInWithSolana.notBefore)]:[],...(null===(s=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===s?void 0:s.expirationTime)?["Expiration Time: ".concat(g.signInWithSolana.expirationTime)]:[],...(null===(i=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===i?void 0:i.chainId)?["Chain ID: ".concat(g.signInWithSolana.chainId)]:[],...(null===(o=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===o?void 0:o.nonce)?["Nonce: ".concat(g.signInWithSolana.nonce)]:[],...(null===(l=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===l?void 0:l.requestId)?["Request ID: ".concat(g.signInWithSolana.requestId)]:[],...(null===(d=null===(c=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===d?void 0:d.length)?["Resources",...g.signInWithSolana.resources.map(e=>"- ".concat(e))]:[]].join("\n");const e=await v.signMessage((new TextEncoder).encode(h),"utf8");if(!e||!(e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=e}}try{const{data:t,error:a}=await zn(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"solana",message:h,signature:Sn(p)},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(m=e.options)||void 0===m?void 0:m.captchaToken}}:null),xform:Vn});if(a)throw a;if(!t||!t.session||!t.user){const e=new nn;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:a})}catch(f){if($a(f))return this._returnResult({data:{user:null,session:null},error:f});throw f}}async _exchangeCodeForSession(e){const t=await _n(this.storage,"".concat(this.storageKey,"-code-verifier")),[a,n]=(null!==t&&void 0!==t?t:"").split("/");try{if(!a&&"pkce"===this.flowType)throw new ln;const{data:t,error:r}=await zn(this.fetch,"POST","".concat(this.url,"/token?grant_type=pkce"),{headers:this.headers,body:{auth_code:e,code_verifier:a},xform:Vn});if(await Cn(this.storage,"".concat(this.storageKey,"-code-verifier")),r)throw r;if(!t||!t.session||!t.user){const e=new nn;return this._returnResult({data:{user:null,session:null,redirectType:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign(Object.assign({},t),{redirectType:null!==n&&void 0!==n?n:null}),error:r})}catch(r){if(await Cn(this.storage,"".concat(this.storageKey,"-code-verifier")),$a(r))return this._returnResult({data:{user:null,session:null,redirectType:null},error:r});throw r}}async signInWithIdToken(e){try{const{options:t,provider:a,token:n,access_token:r,nonce:s}=e,i=await zn(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,body:{provider:a,id_token:n,access_token:r,nonce:s,gotrue_meta_security:{captcha_token:null===t||void 0===t?void 0:t.captchaToken}},xform:Vn}),{data:o,error:l}=i;if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o||!o.session||!o.user){const e=new nn;return this._returnResult({data:{user:null,session:null},error:e})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:o,error:l})}catch(t){if($a(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,a,n,r,s;try{if("email"in e){const{email:n,options:r}=e;let s=null,i=null;"pkce"===this.flowType&&([s,i]=await Rn(this.storage,this.storageKey));const{error:o}=await zn(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{email:n,data:null!==(t=null===r||void 0===r?void 0:r.data)&&void 0!==t?t:{},create_user:null===(a=null===r||void 0===r?void 0:r.shouldCreateUser)||void 0===a||a,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken},code_challenge:s,code_challenge_method:i},redirectTo:null===r||void 0===r?void 0:r.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}if("phone"in e){const{phone:t,options:a}=e,{data:i,error:o}=await zn(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{phone:t,data:null!==(n=null===a||void 0===a?void 0:a.data)&&void 0!==n?n:{},create_user:null===(r=null===a||void 0===a?void 0:a.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken},channel:null!==(s=null===a||void 0===a?void 0:a.channel)&&void 0!==s?s:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:null===i||void 0===i?void 0:i.message_id},error:o})}throw new rn("You must provide either an email or phone number.")}catch(i){if(await Cn(this.storage,"".concat(this.storageKey,"-code-verifier")),$a(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async verifyOtp(e){var t,a;try{let n,r;"options"in e&&(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo,r=null===(a=e.options)||void 0===a?void 0:a.captchaToken);const{data:s,error:i}=await zn(this.fetch,"POST","".concat(this.url,"/verify"),{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:r}}),redirectTo:n,xform:Vn});if(i)throw i;if(!s){throw new Error("An error occurred on token verification.")}const o=s.session,l=s.user;return(null===o||void 0===o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(n){if($a(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(e){var t,a,n,r,s;try{let i=null,o=null;"pkce"===this.flowType&&([i,o]=await Rn(this.storage,this.storageKey));const l=await zn(this.fetch,"POST","".concat(this.url,"/sso"),{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(a=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==a?a:void 0}),(null===(n=null===e||void 0===e?void 0:e.options)||void 0===n?void 0:n.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Wn});return(null===(r=l.data)||void 0===r?void 0:r.url)&&kn()&&!(null===(s=e.options)||void 0===s?void 0:s.skipBrowserRedirect)&&window.location.assign(l.data.url),this._returnResult(l)}catch(i){if(await Cn(this.storage,"".concat(this.storageKey,"-code-verifier")),$a(i))return this._returnResult({data:null,error:i});throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:a}=e;if(a)throw a;if(!t)throw new tn;const{error:n}=await zn(this.fetch,"GET","".concat(this.url,"/reauthenticate"),{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if($a(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t="".concat(this.url,"/resend");if("email"in e){const{email:a,type:n,options:r}=e,{error:s}=await zn(this.fetch,"POST",t,{headers:this.headers,body:{email:a,type:n,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}},redirectTo:null===r||void 0===r?void 0:r.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:s})}if("phone"in e){const{phone:a,type:n,options:r}=e,{data:s,error:i}=await zn(this.fetch,"POST",t,{headers:this.headers,body:{phone:a,type:n,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:null===s||void 0===s?void 0:s.message_id},error:i})}throw new rn("You must provide either an email or phone number and a type")}catch(t){if($a(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await a}catch(e){}})()),a}return await this.lock("lock:".concat(this.storageKey),e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await _n(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const a=!!e.expires_at&&1e3*e.expires_at-Date.now()<Ha;if(this._debug("#__loadSession()","session has".concat(a?"":" not"," expired"),"expires_at",e.expires_at),!a){if(this.userStorage){const t=await _n(this.userStorage,this.storageKey+"-user");(null===t||void 0===t?void 0:t.user)?e.user=t.user:e.user=Ln()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const t={value:this.suppressGetSessionWarning};e.user=function(e,t){return new Proxy(e,{get:(e,a,n)=>{if("__isInsecureUserWarningProxy"===a)return!0;if("symbol"===typeof a){const t=a.toString();if("Symbol(Symbol.toPrimitive)"===t||"Symbol(Symbol.toStringTag)"===t||"Symbol(util.inspect.custom)"===t||"Symbol(nodejs.util.inspect.custom)"===t)return Reflect.get(e,a,n)}return t.value||"string"!==typeof a||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(e,a,n)}})}(e.user,t),t.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:n,error:r}=await this._callRefreshToken(e.refresh_token);return r?this._returnResult({data:{session:null},error:r}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{return e?await zn(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:e,xform:Kn}):await this._useSession(async e=>{var t,a,n;const{data:r,error:s}=e;if(s)throw s;return(null===(t=r.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await zn(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:null!==(n=null===(a=r.session)||void 0===a?void 0:a.access_token)&&void 0!==n?n:void 0,xform:Kn}):{data:{user:null},error:new tn}})}catch(t){if($a(t))return an(t)&&(await this._removeSession(),await Cn(this.storage,"".concat(this.storageKey,"-code-verifier"))),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession(async a=>{const{data:n,error:r}=a;if(r)throw r;if(!n.session)throw new tn;const s=n.session;let i=null,o=null;"pkce"===this.flowType&&null!=e.email&&([i,o]=await Rn(this.storage,this.storageKey));const{data:l,error:c}=await zn(this.fetch,"PUT","".concat(this.url,"/user"),{headers:this.headers,redirectTo:null===t||void 0===t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:i,code_challenge_method:o}),jwt:s.access_token,xform:Kn});if(c)throw c;return s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),this._returnResult({data:{user:s.user},error:null})})}catch(a){if(await Cn(this.storage,"".concat(this.storageKey,"-code-verifier")),$a(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new tn;const t=Date.now()/1e3;let a=t,n=!0,r=null;const{payload:s}=Pn(e.access_token);if(s.exp&&(a=s.exp,n=a<=t),n){const{data:t,error:a}=await this._callRefreshToken(e.refresh_token);if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!t)return{data:{user:null,session:null},error:null};r=t}else{const{data:n,error:s}=await this._getUser(e.access_token);if(s)return this._returnResult({data:{user:null,session:null},error:s});r={access_token:e.access_token,refresh_token:e.refresh_token,user:n.user,token_type:"bearer",expires_in:a-t,expires_at:a},await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)}return this._returnResult({data:{user:r.user,session:r},error:null})}catch(t){if($a(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var a;if(!e){const{data:n,error:r}=t;if(r)throw r;e=null!==(a=n.session)&&void 0!==a?a:void 0}if(!(null===e||void 0===e?void 0:e.refresh_token))throw new tn;const{data:n,error:r}=await this._callRefreshToken(e.refresh_token);return r?this._returnResult({data:{user:null,session:null},error:r}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if($a(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!kn())throw new sn("No browser detected.");if(e.error||e.error_description||e.error_code)throw new sn(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new on("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new sn("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new on("No code detected.");const{data:t,error:a}=await this._exchangeCodeForSession(e.code);if(a)throw a;const n=new URL(window.location.href);return n.searchParams.delete("code"),window.history.replaceState(window.history.state,"",n.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:n,access_token:r,refresh_token:s,expires_in:i,expires_at:o,token_type:l}=e;if(!r||!i||!s||!l)throw new sn("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(i);let u=c+d;o&&(u=parseInt(o));const m=u-c;1e3*m<=Va&&console.warn("@supabase/gotrue-js: Session as retrieved from URL expires in ".concat(m,"s, should have been closer to ").concat(d,"s"));const h=u-d;c-h>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",h,u,c):c-h<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",h,u,c);const{data:p,error:f}=await this._getUser(r);if(f)throw f;const g={provider_token:a,provider_refresh_token:n,access_token:r,expires_in:d,expires_at:u,refresh_token:s,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:g,redirectType:e.type},error:null})}catch(a){if($a(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(e){return"function"===typeof this.detectSessionInUrl?this.detectSessionInUrl(new URL(window.location.href),e):Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await _n(this.storage,"".concat(this.storageKey,"-code-verifier"));return!(!e.code||!t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession(async t=>{var a;const{data:n,error:r}=t;if(r&&!an(r))return this._returnResult({error:r});const s=null===(a=n.session)||void 0===a?void 0:a.access_token;if(s){const{error:t}=await this.admin.signOut(s,e);if(t&&(!function(e){return $a(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status)&&!an(t))return this._returnResult({error:t})}return"others"!==e&&(await this._removeSession(),await Cn(this.storage,"".concat(this.storageKey,"-code-verifier"))),this._returnResult({error:null})})}onAuthStateChange(e){const t=Symbol("auth-callback"),a={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,a),(async()=>{await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:a}}}async _emitInitialSession(e){return await this._useSession(async t=>{var a,n;try{const{data:{session:n},error:r}=t;if(r)throw r;await(null===(a=this.stateChangeEmitters.get(e))||void 0===a?void 0:a.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(r){await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",r),console.error(r)}})}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=null,n=null;"pkce"===this.flowType&&([a,n]=await Rn(this.storage,this.storageKey,!0));try{return await zn(this.fetch,"POST","".concat(this.url,"/recover"),{body:{email:e,code_challenge:a,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(r){if(await Cn(this.storage,"".concat(this.storageKey,"-code-verifier")),$a(r))return this._returnResult({data:null,error:r});throw r}}async getUserIdentities(){var e;try{const{data:t,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null})}catch(t){if($a(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:a,error:n}=await this._useSession(async t=>{var a,n,r,s,i;const{data:o,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider("".concat(this.url,"/user/identities/authorize"),e.provider,{redirectTo:null===(a=e.options)||void 0===a?void 0:a.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:!0});return await zn(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(i=null===(s=o.session)||void 0===s?void 0:s.access_token)&&void 0!==i?i:void 0})});if(n)throw n;return kn()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null===a||void 0===a?void 0:a.url),this._returnResult({data:{provider:e.provider,url:null===a||void 0===a?void 0:a.url},error:null})}catch(a){if($a(a))return this._returnResult({data:{provider:e.provider,url:null},error:a});throw a}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var a;try{const{error:n,data:{session:r}}=t;if(n)throw n;const{options:s,provider:i,token:o,access_token:l,nonce:c}=e,d=await zn(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,jwt:null!==(a=null===r||void 0===r?void 0:r.access_token)&&void 0!==a?a:void 0,body:{provider:i,id_token:o,access_token:l,nonce:c,link_identity:!0,gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken}},xform:Vn}),{data:u,error:m}=d;return m?this._returnResult({data:{user:null,session:null},error:m}):u&&u.session&&u.user?(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("USER_UPDATED",u.session)),this._returnResult({data:u,error:m})):this._returnResult({data:{user:null,session:null},error:new nn})}catch(n){if(await Cn(this.storage,"".concat(this.storageKey,"-code-verifier")),$a(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var a,n;const{data:r,error:s}=t;if(s)throw s;return await zn(this.fetch,"DELETE","".concat(this.url,"/user/identities/").concat(e.identity_id),{headers:this.headers,jwt:null!==(n=null===(a=r.session)||void 0===a?void 0:a.access_token)&&void 0!==n?n:void 0})})}catch(t){if($a(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t="#_refreshAccessToken(".concat(e.substring(0,5),"...)");this._debug(t,"begin");try{const r=Date.now();return await(a=async a=>(a>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,a-1)),this._debug(t,"refreshing attempt",a),await zn(this.fetch,"POST","".concat(this.url,"/token?grant_type=refresh_token"),{body:{refresh_token:e},headers:this.headers,xform:Vn})),n=(e,t)=>{const a=200*Math.pow(2,e);return t&&dn(t)&&Date.now()+a-r<Va},new Promise((e,t)=>{(async()=>{for(let s=0;s<1/0;s++)try{const t=await a(s);if(!n(s,null,t))return void e(t)}catch(r){if(!n(s,r))return void t(r)}})()}))}catch(r){if(this._debug(t,"error",r),$a(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(t,"end")}var a,n}_isValidSession(e){return"object"===typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const a=await this._getUrlForProvider("".concat(this.url,"/authorize"),e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",a),kn()&&!t.skipBrowserRedirect&&window.location.assign(a),{data:{provider:e,url:a},error:null}}async _recoverAndRefresh(){var e,t;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const r=await _n(this.storage,this.storageKey);if(r&&this.userStorage){let t=await _n(this.userStorage,this.storageKey+"-user");this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:r.user},await An(this.userStorage,this.storageKey+"-user",t)),r.user=null!==(e=null===t||void 0===t?void 0:t.user)&&void 0!==e?e:Ln()}else if(r&&!r.user&&!r.user){const e=await _n(this.storage,this.storageKey+"-user");e&&(null===e||void 0===e?void 0:e.user)?(r.user=e.user,await Cn(this.storage,this.storageKey+"-user"),await An(this.storage,this.storageKey,r)):r.user=Ln()}if(this._debug(a,"session from storage",r),!this._isValidSession(r))return this._debug(a,"session is not valid"),void(null!==r&&await this._removeSession());const s=1e3*(null!==(t=r.expires_at)&&void 0!==t?t:1/0)-Date.now()<Ha;if(this._debug(a,"session has".concat(s?"":" not"," expired with margin of ").concat(Ha,"s")),s){if(this.autoRefreshToken&&r.refresh_token){const{error:e}=await this._callRefreshToken(r.refresh_token);e&&(console.error(e),dn(e)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(r.user&&!0===r.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(r.access_token);!t&&(null===e||void 0===e?void 0:e.user)?(r.user=e.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(n){console.error("Error getting user data:",n),this._debug(a,"error getting user data, skipping SIGNED_IN notification",n)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){return this._debug(a,"error",r),void console.error(r)}finally{this._debug(a,"end")}}async _callRefreshToken(e){var t,a;if(!e)throw new tn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n="#_callRefreshToken(".concat(e.substring(0,5),"...)");this._debug(n,"begin");try{this.refreshingDeferred=new Mn;const{data:t,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!t.session)throw new tn;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const n={data:t.session,error:null};return this.refreshingDeferred.resolve(n),n}catch(r){if(this._debug(n,"error",r),$a(r)){const e={data:null,error:r};return dn(r)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(a=this.refreshingDeferred)||void 0===a||a.reject(r),r}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t){let a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n="#_notifyAllSubscribers(".concat(e,")");this._debug(n,"begin",t,"broadcast = ".concat(a));try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:e,session:t});const n=[],r=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,t)}catch(r){n.push(r)}});if(await Promise.all(r),n.length>0){for(let e=0;e<n.length;e+=1)console.error(n[e]);throw n[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Cn(this.storage,"".concat(this.storageKey,"-code-verifier"));const t=Object.assign({},e),a=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!a&&t.user&&await An(this.userStorage,this.storageKey+"-user",{user:t.user});const e=Object.assign({},t);delete e.user;const n=qn(e);await An(this.storage,this.storageKey,n)}else{const e=qn(t);await An(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Cn(this.storage,this.storageKey),await Cn(this.storage,this.storageKey+"-code-verifier"),await Cn(this.storage,this.storageKey+"-user"),this.userStorage&&await Cn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&kn()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Va);this.autoRefreshTicker=e,e&&"object"===typeof e&&"function"===typeof e.unref?e.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(e);const t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&"object"===typeof t&&"function"===typeof t.unref?t.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:a}}=e;if(!a||!a.refresh_token||!a.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const n=Math.floor((1e3*a.expires_at-t)/Va);this._debug("#_autoRefreshTokenTick()","access token expires in ".concat(n," ticks, a tick lasts ").concat(Va,"ms, refresh threshold is ").concat(3," ticks")),n<=3&&await this._callRefreshToken(a.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(!(e.isAcquireTimeout||e instanceof er))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!kn()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t="#_onVisibilityChanged(".concat(e,")");this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,a){const n=["provider=".concat(encodeURIComponent(t))];if((null===a||void 0===a?void 0:a.redirectTo)&&n.push("redirect_to=".concat(encodeURIComponent(a.redirectTo))),(null===a||void 0===a?void 0:a.scopes)&&n.push("scopes=".concat(encodeURIComponent(a.scopes))),"pkce"===this.flowType){const[e,t]=await Rn(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:"".concat(encodeURIComponent(e)),code_challenge_method:"".concat(encodeURIComponent(t))});n.push(a.toString())}if(null===a||void 0===a?void 0:a.queryParams){const e=new URLSearchParams(a.queryParams);n.push(e.toString())}return(null===a||void 0===a?void 0:a.skipBrowserRedirect)&&n.push("skip_http_redirect=".concat(a.skipBrowserRedirect)),"".concat(e,"?").concat(n.join("&"))}async _unenroll(e){try{return await this._useSession(async t=>{var a;const{data:n,error:r}=t;return r?this._returnResult({data:null,error:r}):await zn(this.fetch,"DELETE","".concat(this.url,"/factors/").concat(e.factorId),{headers:this.headers,jwt:null===(a=null===n||void 0===n?void 0:n.session)||void 0===a?void 0:a.access_token})})}catch(t){if($a(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var a,n;const{data:r,error:s}=t;if(s)return this._returnResult({data:null,error:s});const i=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:"totp"===e.factorType?{issuer:e.issuer}:{}),{data:o,error:l}=await zn(this.fetch,"POST","".concat(this.url,"/factors"),{body:i,headers:this.headers,jwt:null===(a=null===r||void 0===r?void 0:r.session)||void 0===a?void 0:a.access_token});return l?this._returnResult({data:null,error:l}):("totp"===e.factorType&&"totp"===o.type&&(null===(n=null===o||void 0===o?void 0:o.totp)||void 0===n?void 0:n.qr_code)&&(o.totp.qr_code="data:image/svg+xml;utf-8,".concat(o.totp.qr_code)),this._returnResult({data:o,error:null}))})}catch(t){if($a(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var a;const{data:n,error:r}=t;if(r)return this._returnResult({data:null,error:r});const s=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:"create"===e.webauthn.type?mr(e.webauthn.credential_response):hr(e.webauthn.credential_response)})}:{code:e.code}),{data:i,error:o}=await zn(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/verify"),{body:s,headers:this.headers,jwt:null===(a=null===n||void 0===n?void 0:n.session)||void 0===a?void 0:a.access_token});return o?this._returnResult({data:null,error:o}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),this._returnResult({data:i,error:o}))})}catch(t){if($a(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var a;const{data:n,error:r}=t;if(r)return this._returnResult({data:null,error:r});const s=await zn(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/challenge"),{body:e,headers:this.headers,jwt:null===(a=null===n||void 0===n?void 0:n.session)||void 0===a?void 0:a.access_token});if(s.error)return s;const{data:i}=s;if("webauthn"!==i.type)return{data:i,error:null};switch(i.webauthn.type){case"create":return{data:Object.assign(Object.assign({},i),{webauthn:Object.assign(Object.assign({},i.webauthn),{credential_options:Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:dr(i.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},i),{webauthn:Object.assign(Object.assign({},i.webauthn),{credential_options:Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:ur(i.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if($a(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:a}=await this._challenge({factorId:e.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:a}=await this.getUser();if(a)return{data:null,error:a};const n={all:[],phone:[],totp:[],webauthn:[]};for(const r of null!==(e=null===t||void 0===t?void 0:t.factors)&&void 0!==e?e:[])n.all.push(r),"verified"===r.status&&n[r.factor_type].push(r);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(e){var t,a,n,r;if(e)try{const{payload:n}=Pn(e);let r=null;n.aal&&(r=n.aal);let s=r;const{data:{user:i},error:o}=await this.getUser(e);if(o)return this._returnResult({data:null,error:o});(null!==(a=null===(t=null===i||void 0===i?void 0:i.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==a?a:[]).length>0&&(s="aal2");return{data:{currentLevel:r,nextLevel:s,currentAuthenticationMethods:n.amr||[]},error:null}}catch(d){if($a(d))return this._returnResult({data:null,error:d});throw d}const{data:{session:s},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Pn(s.access_token);let l=null;o.aal&&(l=o.aal);let c=l;(null!==(r=null===(n=s.user.factors)||void 0===n?void 0:n.filter(e=>"verified"===e.status))&&void 0!==r?r:[]).length>0&&(c="aal2");return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:o.amr||[]},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:a},error:n}=t;return n?this._returnResult({data:null,error:n}):a?await zn(this.fetch,"GET","".concat(this.url,"/oauth/authorizations/").concat(e),{headers:this.headers,jwt:a.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new tn})})}catch(t){if($a(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async a=>{const{data:{session:n},error:r}=a;if(r)return this._returnResult({data:null,error:r});if(!n)return this._returnResult({data:null,error:new tn});const s=await zn(this.fetch,"POST","".concat(this.url,"/oauth/authorizations/").concat(e,"/consent"),{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:e=>({data:e,error:null})});return s.data&&s.data.redirect_url&&kn()&&!(null===t||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(s.data.redirect_url),s})}catch(a){if($a(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(e,t){try{return await this._useSession(async a=>{const{data:{session:n},error:r}=a;if(r)return this._returnResult({data:null,error:r});if(!n)return this._returnResult({data:null,error:new tn});const s=await zn(this.fetch,"POST","".concat(this.url,"/oauth/authorizations/").concat(e,"/consent"),{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:e=>({data:e,error:null})});return s.data&&s.data.redirect_url&&kn()&&!(null===t||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(s.data.redirect_url),s})}catch(a){if($a(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:a}=e;return a?this._returnResult({data:null,error:a}):t?await zn(this.fetch,"GET","".concat(this.url,"/user/oauth/grants"),{headers:this.headers,jwt:t.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new tn})})}catch(e){if($a(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:a},error:n}=t;return n?this._returnResult({data:null,error:n}):a?(await zn(this.fetch,"DELETE","".concat(this.url,"/user/oauth/grants"),{headers:this.headers,jwt:a.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new tn})})}catch(t){if($a(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e){let t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[]}).keys.find(t=>t.kid===e);if(t)return t;const a=Date.now();if(t=this.jwks.keys.find(t=>t.kid===e),t&&this.jwks_cached_at+6e5>a)return t;const{data:n,error:r}=await zn(this.fetch,"GET","".concat(this.url,"/.well-known/jwks.json"),{headers:this.headers});if(r)throw r;return n.keys&&0!==n.keys.length?(this.jwks=n,this.jwks_cached_at=a,t=n.keys.find(t=>t.kid===e),t||null):null}async getClaims(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let a=e;if(!a){const{data:e,error:t}=await this.getSession();if(t||!e.session)return this._returnResult({data:null,error:t});a=e.session.access_token}const{header:n,payload:r,signature:s,raw:{header:i,payload:o}}=Pn(a);(null===t||void 0===t?void 0:t.allowExpired)||function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(r.exp);const l=n.alg&&!n.alg.startsWith("HS")&&n.kid&&"crypto"in globalThis&&"subtle"in globalThis.crypto?await this.fetchJwk(n.kid,(null===t||void 0===t?void 0:t.keys)?{keys:t.keys}:null===t||void 0===t?void 0:t.jwks):null;if(!l){const{error:e}=await this.getUser(a);if(e)throw e;return{data:{claims:r,header:n,signature:s},error:null}}const c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(n.alg),d=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!await crypto.subtle.verify(c,d,s,function(e){const t=[];return xn(e,e=>t.push(e)),new Uint8Array(t)}("".concat(i,".").concat(o))))throw new mn("Invalid JWT signature");return{data:{claims:r,header:n,signature:s},error:null}}catch(a){if($a(a))return this._returnResult({data:null,error:a});throw a}}}kr.nextInstanceID={};const Nr=kr;let jr="";jr="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const Tr={headers:{"X-Client-Info":"supabase-js-".concat(jr,"/").concat("2.95.2")}},Ar={schema:"public"},_r={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Cr={};function Mr(e){return(Mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pr(e){var t=function(e,t){if("object"!=Mr(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=Mr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Mr(t)?t:t+""}function Er(e,t,a){return(t=Pr(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Ir(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function Rr(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ir(Object(a),!0).forEach(function(t){Er(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ir(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}const Or=(e,t,a)=>{const n=(e=>e?function(){return e(...arguments)}:function(){return fetch(...arguments)})(a),r=Headers;return async(a,s)=>{var i;const o=null!==(i=await t())&&void 0!==i?i:e;let l=new r(null===s||void 0===s?void 0:s.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization","Bearer ".concat(o)),n(a,Rr(Rr({},s),{},{headers:l}))}};var Dr=class extends Nr{constructor(e){super(e)}},Fr=class{constructor(e,t,a){var n,r;this.supabaseUrl=e,this.supabaseKey=t;const s=function(e){const t=null===e||void 0===e?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL((a=t).endsWith("/")?a:a+"/")}catch(n){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}var a}(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",s),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",s),this.storageUrl=new URL("storage/v1",s),this.functionsUrl=new URL("functions/v1",s);const i="sb-".concat(s.hostname.split(".")[0],"-auth-token"),o=function(e,t){var a,n;const{db:r,auth:s,realtime:i,global:o}=e,{db:l,auth:c,realtime:d,global:u}=t,m={db:Rr(Rr({},l),r),auth:Rr(Rr({},c),s),realtime:Rr(Rr({},d),i),storage:{},global:Rr(Rr(Rr({},u),o),{},{headers:Rr(Rr({},null!==(a=null===u||void 0===u?void 0:u.headers)&&void 0!==a?a:{}),null!==(n=null===o||void 0===o?void 0:o.headers)&&void 0!==n?n:{})}),accessToken:async()=>""};return e.accessToken?m.accessToken=e.accessToken:delete m.accessToken,m}(null!==a&&void 0!==a?a:{},{db:Ar,realtime:Cr,auth:Rr(Rr({},_r),{},{storageKey:i}),global:Tr});var l;(this.storageKey=null!==(n=o.auth.storageKey)&&void 0!==n?n:"",this.headers=null!==(r=o.global.headers)&&void 0!==r?r:{},o.accessToken)?(this.accessToken=o.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error("@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.".concat(String(t)," is not possible"))}})):this.auth=this._initSupabaseAuthClient(null!==(l=o.auth)&&void 0!==l?l:{},this.headers,o.global.fetch);this.fetch=Or(t,this._getAccessToken.bind(this),o.global.fetch),this.realtime=this._initRealtimeClient(Rr({headers:this.headers,accessToken:this._getAccessToken.bind(this)},o.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(e=>this.realtime.setAuth(e)).catch(e=>console.warn("Failed to set initial Realtime auth token:",e)),this.rest=new ft(new URL("rest/v1",s).href,{headers:this.headers,schema:o.db.schema,fetch:this.fetch,timeout:o.db.timeout,urlLengthLimit:o.db.urlLengthLimit}),this.storage=new Ga(this.storageUrl.href,this.headers,this.fetch,null===a||void 0===a?void 0:a.storage),o.accessToken||this._listenForAuthEvents()}get functions(){return new nt(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{head:!1,get:!1,count:void 0};return this.rest.rpc(e,t,a)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t,a=this;if(a.accessToken)return await a.accessToken();const{data:n}=await a.auth.getSession();return null!==(e=null===(t=n.session)||void 0===t?void 0:t.access_token)&&void 0!==e?e:a.supabaseKey}_initSupabaseAuthClient(e,t,a){let{autoRefreshToken:n,persistSession:r,detectSessionInUrl:s,storage:i,userStorage:o,storageKey:l,flowType:c,lock:d,debug:u,throwOnError:m}=e;const h={Authorization:"Bearer ".concat(this.supabaseKey),apikey:"".concat(this.supabaseKey)};return new Dr({url:this.authUrl.href,headers:Rr(Rr({},h),t),storageKey:l,autoRefreshToken:n,persistSession:r,detectSessionInUrl:s,storage:i,userStorage:o,flowType:c,lock:d,debug:u,throwOnError:m,fetch:a,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new $t(this.realtimeUrl.href,Rr(Rr({},e),{},{params:Rr(Rr({},{apikey:this.supabaseKey}),null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)})}_handleTokenChanged(e,t,a){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===a?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):(this.changedAccessToken=a,this.realtime.setAuth(a))}};(function(){if("undefined"!==typeof window)return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(void 0===t||null===t)return!1;const a=t.match(/^v(\d+)\./);return!!a&&parseInt(a[1],10)<=18})()&&console.warn("\u26a0\ufe0f  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Lr="https://cyjdmcdmdercyxoojkvl.supabase.co",qr="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN5amRtY2RtZGVyY3l4b29qa3ZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUzNTI1MTksImV4cCI6MjA3MDkyODUxOX0.MkjyGrTOud4xSr-PrATGkOFTLKjZzx6eoAsDaVsEVzk";const Ur=((e,t,a)=>new Fr(e,t,a))(Lr||"https://test.supabase.co",qr||"test-anon-key",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce",debug:!1},db:{schema:"public"},global:{headers:{"X-Client-Info":"dif-f16-6-coach-app"}}}),Br={GAME_STATE:"sport-wizard-game-state",TIMER_STATE:"sport-wizard-timer-state",SUBSTITUTION_COUNT:"sport-wizard-substitution-count",TEAM_PREFERENCES_CACHE:"sport-wizard-team-preferences-cache",MATCH_EVENTS:"sport-wizard-match-events",MATCH_HISTORY:"sport-wizard-match-history",PREFERENCES:"sport-wizard-preferences",TACTICAL_PREFERENCES:"sport-wizard-tactical-preferences",TIMELINE_PREFERENCES:"sport-wizard-timeline-preferences",TIMELINE_PREFERENCES_LIVE:"sport-wizard-timeline-preferences-live",NAVIGATION_HISTORY:"sport-wizard-navigation-history",STATS_FILTERS:"sport-wizard-stats-filter",STATISTICS_ACTIVE_TAB:"sport-wizard-stats-active-tab",STATISTICS_TIME_RANGE:"sport-wizard-stats-time-range",STATISTICS_PLAYER_COLUMN_ORDER:"sport-wizard-stats-player-column-order",STATISTICS_ATTENDANCE_COLUMN_ORDER:"sport-wizard-stats-attendance-column-order",TEAM_MANAGEMENT_ACTIVE_TAB:"sport-wizard-team-management-active-tab",PLAYER_LOANS_TIME_RANGE:"sport-wizard-player-loans-time-range",DISMISSED_MODALS:"sport-wizard-dismissed-modals",PLAN_MATCH_UNAVAILABLE_PLAYERS:"sport-wizard-plan-match-unavailable-players",PLAN_MATCH_AUTO_SELECT_SETTINGS:"sport-wizard-plan-match-auto-select-settings",PLAN_MATCH_PROGRESS:"sport-wizard-plan-match-progress",AUTH_SESSION:"sport-wizard-session",AUTH_USER_PREFERENCES:"sport-wizard-user-prefs",AUTH_REMEMBER_EMAIL:"sport-wizard-remember-email",AUTH_LAST_LOGIN:"sport-wizard-last-login",CURRENT_TEAM_ID:"sport-wizard-current-team-id",PENDING_INVITATION:"sport-wizard-pending-invitation",CACHE_PREFIX:"supabase_app_",SESSION_LAST_SIGN_OUT:"sport-wizard-last-sign-out",DEBUG_MODE:"sport-wizard-debug-mode",STORAGE_TEST:"__storage_test__",SIZE_TEST:"__size_test__"},Gr={MATCH_EVENTS_BACKUP:"sport-wizard-match-events-backup",MATCH_EVENTS_EMERGENCY:"sport-wizard-match-events-emergency",AUDIO_PREFERENCES_LEGACY:"sport-wizard-audio-preferences",CURRENT_TEAM_ID_OLD:"currentTeamId",PENDING_INVITATION_OLD:"pendingInvitation",STATISTICS_ACTIVE_TAB_OLD:"statistics-active-tab",DISMISSED_MODALS_PREFIX:"sport-wizard-dismissedModals-",TIMER_PREFIX:"sport-wizard-timer-"},zr=[Br.TIMELINE_PREFERENCES,Br.TIMELINE_PREFERENCES_LIVE,Br.PREFERENCES,Br.TACTICAL_PREFERENCES,Br.AUTH_USER_PREFERENCES,Br.AUTH_REMEMBER_EMAIL,Br.AUTH_LAST_LOGIN],Vr=[Br.GAME_STATE,Br.TIMER_STATE,Br.SUBSTITUTION_COUNT,Br.MATCH_EVENTS,Br.MATCH_HISTORY,Br.NAVIGATION_HISTORY,Br.CURRENT_TEAM_ID,Br.PENDING_INVITATION,Br.AUTH_SESSION,Br.TEAM_PREFERENCES_CACHE],Hr=[Gr.TIMER_PREFIX,Gr.DISMISSED_MODALS_PREFIX],Kr={[Gr.CURRENT_TEAM_ID_OLD]:Br.CURRENT_TEAM_ID,[Gr.PENDING_INVITATION_OLD]:Br.PENDING_INVITATION,[Gr.STATISTICS_ACTIVE_TAB_OLD]:Br.STATISTICS_ACTIVE_TAB},Wr={PREFIX:Br.CACHE_PREFIX,DEFAULT_TTL:864e5,MAX_STORAGE_SIZE:4194304},Yr={AUTH_USER:"authUser",USER_PROFILE:"userProfile",CURRENT_TEAM:"currentTeam",USER_TEAMS:"userTeams",TEAM_PLAYERS:"teamPlayers",USER_CLUBS:"userClubs",PENDING_REQUESTS:"pendingRequests",CACHE_META:"cacheMeta"},Jr=e=>"".concat(Wr.PREFIX).concat(e),Qr=()=>{try{const e="__cache_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return console.warn("Cache not available:",e),!1}},$r=()=>{if(!Qr())return null;try{const e=localStorage.getItem(Jr(Yr.CACHE_META));return e?JSON.parse(e):{}}catch(e){return console.warn("Error reading cache metadata:",e),{}}},Xr=e=>{if(Qr())try{const t=$r()||{},a=(0,n.A)((0,n.A)((0,n.A)({},t),e),{},{lastUpdated:Date.now()});localStorage.setItem(Jr(Yr.CACHE_META),JSON.stringify(a))}catch(t){console.warn("Error updating cache metadata:",t)}},Zr=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const a=$r();if(!a||!a[e])return!1;const n=t||Wr.DEFAULT_TTL;return Date.now()-a[e].timestamp<n},es=e=>{if(!Qr())return null;try{if(!Zr(e))return as(e),null;const t=localStorage.getItem(Jr(e));if(!t)return null;return JSON.parse(t)}catch(t){return console.warn("Error reading from cache for key ".concat(e,":"),t),as(e),null}},ts=(e,t)=>{if(!Qr())return!1;try{const a=JSON.stringify(t),n=new Blob([a]).size;return n>Wr.MAX_STORAGE_SIZE/10?(console.warn("Data too large for cache key ".concat(e,":"),{size:n,maxAllowed:Wr.MAX_STORAGE_SIZE/10}),!1):(localStorage.setItem(Jr(e),a),Xr({[e]:{timestamp:Date.now(),size:n}}),!0)}catch(a){if("QuotaExceededError"!==a.name)return console.warn("Error saving to cache for key ".concat(e,":"),a),!1;console.warn("Cache storage quota exceeded, clearing old cache"),ns();try{return localStorage.setItem(Jr(e),JSON.stringify(t)),Xr({[e]:{timestamp:Date.now(),size:new Blob([JSON.stringify(t)]).size}}),!0}catch(n){return console.error("Cache save failed even after cleanup:",n),!1}}},as=e=>{if(Qr())try{localStorage.removeItem(Jr(e));const t=$r();t&&t[e]&&(delete t[e],localStorage.setItem(Jr(Yr.CACHE_META),JSON.stringify(t)))}catch(t){console.warn("Error removing cache for key ".concat(e,":"),t)}},ns=()=>{if(!Qr())return;const e=$r();e&&Object.keys(e).forEach(e=>{"lastUpdated"!==e&&(Zr(e)||as(e))})},rs=e=>ts(Yr.USER_PROFILE,e),ss=e=>e?ts(Yr.AUTH_USER,e):(as(Yr.AUTH_USER),!1),is=()=>es(Yr.USER_PROFILE),os=e=>{const{currentTeam:t,userTeams:a,userClubs:n,teamPlayers:r,pendingRequests:s}=e,i={};return void 0!==t&&(i.currentTeam=ts(Yr.CURRENT_TEAM,t)),void 0!==a&&(i.userTeams=ts(Yr.USER_TEAMS,a)),void 0!==n&&(i.userClubs=ts(Yr.USER_CLUBS,n)),void 0!==r&&(i.teamPlayers=ts(Yr.TEAM_PLAYERS,r)),void 0!==s&&(i.pendingRequests=ts(Yr.PENDING_REQUESTS,s)),i};const ls=zr,cs=[...Vr,...Hr,...Object.values(Gr)];function ds(e){return ls.includes(e)}function us(e){return cs.some(t=>t.endsWith("-")?e.startsWith(t):e===t)}const ms="NEW_SIGN_IN",hs="PAGE_REFRESH",ps=1e4,fs={AUTH_TIMESTAMP:"sport-wizard-auth-timestamp",LAST_ACTIVITY:"sport-wizard-last-activity",PAGE_LOAD_COUNT:"sport-wizard-page-load-count",DETECTION_CACHE:"sport-wizard-detection-cache",DETECTION_SESSION_ID:"sport-wizard-detection-session-id"},gs=/^sb-.*-auth-token$/,vs={LAST_SIGN_OUT:Br.SESSION_LAST_SIGN_OUT},ys="sport-wizard-pending-sign-in";function bs(){let e=sessionStorage.getItem(fs.DETECTION_SESSION_ID);if(!e){e="det_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9));try{sessionStorage.setItem(fs.DETECTION_SESSION_ID,e)}catch(t){console.warn("Failed to store session ID (storage quota exceeded?):",t)}}return e}function xs(){const e=[];"undefined"!==typeof sessionStorage&&e.push(sessionStorage),"undefined"!==typeof localStorage&&e.push(localStorage);const t=t=>{t&&!e.includes(t)&&e.push(t)};"undefined"!==typeof a.g&&(t(a.g.sessionStorage),t(a.g.localStorage)),"undefined"!==typeof window&&(t(window.sessionStorage),t(window.localStorage));const n=new Set;return e.some(e=>{if(!e||"function"!==typeof e.getItem)return!1;if(n.has(e))return!1;n.add(e);try{const t="number"===typeof e.length?e.length:"function"===typeof e.key?Number.MAX_SAFE_INTEGER:0;if("function"!==typeof e.key)return Object.keys(e).some(t=>"string"===typeof t&&(!!gs.test(t)&&!!e.getItem(t)));for(let a=0;a<t;a+=1){const t=e.key(a);if(t&&"string"===typeof t&&(gs.test(t)&&e.getItem(t)))return!0}}catch(t){return!1}return!1})}function ws(e,t){var a;let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{hasRecentSignOut:r=!1,hasPendingSignIn:s=!1}=n,i=e.pageLoadCount,o=t.pageLoadCount,l=!!t.lastActivity;(null===(a=e.navigationTiming)||void 0===a?void 0:a.type)||e.navigationType;return function(e,t,a,n,r,s,i,o){const l=Math.max(e,t);if(o)return!0;if(i)return!1;if(!s)return!1;const c=!a;if("true"===sessionStorage.getItem("auth_session_initialized")&&s&&!(l<=1||sessionStorage.getItem(ys)))return!1;if(c&&l<=2)return!0;if(c&&r){const e=parseInt(r,10);if(!Number.isNaN(e)&&Date.now()-e<ps)return!0}return!!(c&&l<=3)}(i,o,l,0,t.authTimestamp,t.hasSupabaseSession,r,s)?ms:(void Math.max(i,o),hs)}function Ss(){try{const e=function(){const e=[];"undefined"!==typeof localStorage&&e.push(localStorage),"undefined"!==typeof a.g&&a.g.localStorage&&e.push(a.g.localStorage),"undefined"!==typeof window&&window.localStorage&&e.push(window.localStorage);let t=null;return e.forEach(e=>{if(e&&"function"===typeof e.getItem)try{const n=e.getItem(vs.LAST_SIGN_OUT);if(n){const e=parseInt(n,10);var a;Number.isNaN(e)||(t=Math.max(null!==(a=t)&&void 0!==a?a:e,e))}e.removeItem(vs.LAST_SIGN_OUT)}catch(n){}}),t}(),t=!!(e&&Date.now()-e<1e4),n=function(){try{return"undefined"!==typeof sessionStorage&&(!!sessionStorage.getItem(ys)&&(sessionStorage.removeItem(ys),!0))}catch(e){return!1}}(),r=t||n;if(r)sessionStorage.removeItem(fs.DETECTION_CACHE);else{const e=function(){try{const e=sessionStorage.getItem(fs.DETECTION_CACHE);if(!e)return null;const t=JSON.parse(e),a=bs(),n=Date.now()-t.timestamp;if(t.sessionId===a&&n<3e4)return t.result.type,t.result}catch(e){}return null}();if(e)return e}const s=bs(),i=function(){const e=parseInt(sessionStorage.getItem(fs.PAGE_LOAD_COUNT)||"0")+1;try{sessionStorage.setItem(fs.PAGE_LOAD_COUNT,e.toString())}catch(n){console.warn("Failed to update page load count (storage quota exceeded?):",n)}let t=0,a=null;try{const e=performance.getEntriesByType("navigation");e&&e.length>0&&(a={type:e[0].type})}catch(n){performance.navigation&&(t=performance.navigation.type)}return{pageLoadCount:e,navigationType:t,navigationTiming:a,timestamp:Date.now()}}(),o={authTimestamp:sessionStorage.getItem(fs.AUTH_TIMESTAMP),lastActivity:sessionStorage.getItem(fs.LAST_ACTIVITY),hasSupabaseSession:xs(),pageLoadCount:parseInt(sessionStorage.getItem(fs.PAGE_LOAD_COUNT)||"0")},l=ws(i,o,{hasRecentSignOut:t,hasPendingSignIn:n});let c=75;l===ms?o.hasSupabaseSession&&!o.lastActivity?c=90:o.authTimestamp&&(c=85):l===hs&&o.lastActivity&&o.pageLoadCount>=2&&(c=85);const d={type:l,confidence:c,scores:{pageLoadCount:Math.max(i.pageLoadCount,o.pageLoadCount),hasActivity:!!o.lastActivity,hasSupabaseSession:o.hasSupabaseSession,authAge:o.authTimestamp?Date.now()-parseInt(o.authTimestamp):null},signals:{navigation:i,session:o},sessionId:s,timestamp:Date.now()};return r||function(e,t){try{const a={result:e,sessionId:t,timestamp:Date.now()};sessionStorage.setItem(fs.DETECTION_CACHE,JSON.stringify(a))}catch(a){console.warn("Failed to cache detection result (storage quota exceeded?):",a)}}(d,s),function(e){const t=Date.now().toString();try{sessionStorage.setItem(fs.LAST_ACTIVITY,t),e===ms&&sessionStorage.setItem(fs.AUTH_TIMESTAMP,t)}catch(a){console.warn("Failed to update session tracking (storage quota exceeded?):",a)}}(l),"(confidence: ".concat(c,"%, session: ").concat(s.substr(-4),")"),d}catch(e){console.error("Session detection failed:",e);return{type:hs,confidence:0,scores:{},signals:{},error:e.message,sessionId:null,timestamp:Date.now()}}}function ks(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?e.type===ms:Ss().type===ms}const Ns=()=>Date.now(),js=e=>{if(!e)return!1;try{const t=Ns(),a="sport-wizard-otp-sent-".concat(e.toLowerCase().trim());return localStorage.setItem(a,t.toString()),!0}catch(t){return console.warn("Failed to store OTP sent time:",t),!1}};var Ts=a(579);const As=(0,e.createContext)({user:null,userProfile:null,loading:!0,authError:null,sessionExpiry:null,sessionDetectionResult:null,isAuthenticated:!1,isEmailConfirmed:!1,hasValidProfile:!1,profileName:"Not set",needsProfileCompletion:!1,showSessionWarning:!1,extendSession:async()=>{},dismissSessionWarning:()=>{},clearAuthError:()=>{},markProfileCompleted:()=>{},signUp:async()=>{},signIn:async()=>{},signOut:async()=>{},verifyOtp:async()=>{},resendOtp:async()=>{},resetPassword:async()=>{},updatePassword:async()=>{},changePassword:async()=>{},updateProfile:async()=>{}});function _s(t){let{children:r}=t;const{t:s}=xe("auth"),[i,o]=(0,e.useState)(null),[l,c]=(0,e.useState)(null),[d,u]=(0,e.useState)(!0),[m,h]=(0,e.useState)(null),[p,f]=(0,e.useState)(null),[g,v]=(0,e.useState)(!1),[y,b]=(0,e.useState)(!1),[x,w]=(0,e.useState)(!1),[S,k]=(0,e.useState)(null);(0,e.useEffect)(()=>{m&&h(null)},[i,m]);const N=(0,e.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{if((null===a||void 0===a?void 0:a.type)===hs){const t=is();if(t&&t.id===e){c(t);const e=!t.name||0===t.name.trim().length;return b(e),t}}if(!t){var n;t=null===(n=(await Ur.auth.getSession()).data)||void 0===n?void 0:n.session}const r=Ur.from("user_profile").select("*").eq("id",e).single(),s=new Promise((e,t)=>setTimeout(()=>t(new Error("Profile fetch timeout")),12e3)),{data:i,error:o}=await Promise.race([r,s]);if(o){if("PGRST116"===o.code)return c(null),b(!0),null;throw o}c(i),rs(i);const l=!i||!i.name||0===i.name.trim().length;return b(l),i}catch(r){return console.error("Error fetching profile:",r.message),c(null),null}},[]),j=(0,e.useCallback)(async()=>{try{const{data:{session:e},error:t}=await Ur.auth.refreshSession();if(t)throw t;if(e){const t=new Date(1e3*e.expires_at);f(t),v(!1)}return{success:!0}}catch(e){return{success:!1,error:e.message}}},[]),T=(0,e.useCallback)(()=>{v(!1)},[]),A=(0,e.useCallback)(()=>{h(null)},[]),_=(0,e.useCallback)(()=>{b(!1)},[]),C=(0,e.useCallback)(e=>{if(!e)return f(null),void v(!1);const t=new Date(1e3*e.expires_at);f(t)},[]),M=(0,e.useRef)(null),P=(0,e.useRef)(!1),E=(0,e.useRef)(!1),I=(0,e.useRef)(null),R=(0,e.useRef)(null);(0,e.useEffect)(()=>{const e=Ss();if(M.current=e,k(e),e.type===hs){const e=es(Yr.AUTH_USER),t=is();if(e&&o(e),t&&(!e||t.id===e.id)){c(t);const e=!(null!==t&&void 0!==t&&t.name)||0===t.name.trim().length;b(e),P.current=!0}(e||t)&&u(!1)}},[]),(0,e.useEffect)(()=>{const{data:{subscription:e}}=Ur.auth.onAuthStateChange(async(e,t)=>{if("SIGNED_OUT"===e||null===t||void 0===t||!t.user)return o(null),c(null),f(null),b(!1),u(!1),E.current=!1,void(R.current=null);if(("SIGNED_IN"!==e&&"INITIAL_SESSION"!==e||!E.current||null===t||void 0===t||!t.user||R.current!==t.user.id)&&null!==t&&void 0!==t&&t.user){const e=t.user.id;if(R.current===e&&I.current)return;o(t.user),ss(t.user),C(t),R.current=e;const a=M.current||Ss();if(M.current=a,k(a),sessionStorage.setItem("auth_session_initialized","true"),ks(a)&&function(){try{const e=[],t=[],a=[],n=[];for(let r=0;r<localStorage.length;r++){const s=localStorage.key(r);s&&(t.push(s),ds(s)?a.push(s):us(s)?e.push(s):n.push(s))}return e.forEach(e=>{try{localStorage.removeItem(e)}catch(t){console.warn("Failed to remove localStorage key ".concat(e,":"),t)}}),{success:!0,removedKeys:e,preservedKeys:ls.filter(e=>null!==localStorage.getItem(e))}}catch(e){return console.warn("Failed to clean up localStorage:",e),{success:!1,error:e.message}}}(),a.type===ms&&async function(){try{const e=new Date,t=new Date(e.getTime()-18e6),a={deleted_at:e.toISOString()},{data:n,error:r}=await Ur.from("match").select("id").eq("state","running").is("deleted_at",null).not("started_at","is",null).lt("started_at",t.toISOString());if(r)return console.error("\u274c Failed to fetch running matches for cleanup:",r),{success:!1,cleanedRunning:0,error:"Failed to fetch running matches: ".concat(r.message)};const s=(null===n||void 0===n?void 0:n.map(e=>e.id))||[];if(s.length>0){const{error:e}=await Ur.from("match").update(a,{returning:"minimal"}).in("id",s);if(e)return console.error("\u274c Failed to cleanup running matches:",e),{success:!1,cleanedRunning:0,error:"Failed to cleanup running matches: ".concat(e.message)}}const i=s.length;return i>0&&console.log("\ud83e\uddf9 Cleaned up ".concat(i," orphaned running matches")),{success:!0,cleanedRunning:i}}catch(e){return console.error("\u274c Exception during match cleanup:",e),{success:!1,cleanedRunning:0,error:"Unexpected error: ".concat(e.message)}}}().catch(e=>{0}),I.current,x)E.current=!0,u(!1);else{const n=a.type===hs;if(n&&P.current)E.current=!0,u(!1);else{const r=N(e,t,a);if(I.current=r,n)r.finally(()=>{I.current===r&&(I.current=null)}),E.current=!0,u(!1);else try{await r}finally{I.current=null,E.current=!0,u(!1)}}}}});return()=>{e.unsubscribe()}},[N,C,x]);const O=!!i,D=null!=(null===i||void 0===i?void 0:i.email_confirmed_at),F=!!l&&!!l.id&&l.id===(null===i||void 0===i?void 0:i.id),L=(null===l||void 0===l?void 0:l.name)||"Not set",q=(0,e.useCallback)(()=>{w(!0)},[]),U=(0,e.useCallback)(()=>{w(!1)},[]),B={user:i,userProfile:l,loading:d,authError:m,sessionExpiry:p,sessionDetectionResult:S,isAuthenticated:O,isEmailConfirmed:D,hasValidProfile:F,profileName:L,needsProfileCompletion:y,showSessionWarning:g,extendSession:j,dismissSessionWarning:T,clearAuthError:A,markProfileCompleted:_,enableProfileFetchSkip:q,disableProfileFetchSkip:U,signUp:async(e,t,a)=>{try{u(!0),h(null);const n={email:e,password:t,options:{data:{name:a}}},{data:r,error:i}=await Ur.auth.signUp(n);if(i)throw i;return r.user&&!r.session?(js(e),{user:null,error:null,message:s("signUp.checkEmailMessage")}):{user:r.user,error:null}}catch(n){const e=n.message||s("signUp.failedToSignUp");return h(e),console.error("Sign up error:",n.message),{user:null,error:{message:e}}}finally{u(!1)}},signIn:async(e,t)=>{try{u(!0),h(null);const{data:a,error:n}=await Ur.auth.signInWithPassword({email:e,password:t});if(n)throw n;!function(){try{"undefined"!==typeof sessionStorage&&sessionStorage.setItem(ys,Date.now().toString())}catch(n){}}();const r=Ss();return k(r),{user:a.user,error:null}}catch(a){const e=a.message||"Failed to sign in";return h(e),{user:null,error:{message:e}}}finally{u(!1)}},signOut:async()=>{try{u(!0),h(null);const{error:e}=await Ur.auth.signOut();if(e)throw e;return o(null),c(null),f(null),(()=>{if(Qr())try{Object.values(Yr).forEach(e=>{localStorage.removeItem(Jr(e))})}catch(e){console.warn("Error clearing all cache:",e)}})(),ss(null),function(){try{"undefined"!==typeof localStorage&&localStorage.setItem(vs.LAST_SIGN_OUT,Date.now().toString())}catch(e){}try{"undefined"!==typeof a.g&&a.g.localStorage&&a.g.localStorage.setItem(vs.LAST_SIGN_OUT,Date.now().toString())}catch(e){}try{"undefined"!==typeof window&&window.localStorage&&window.localStorage.setItem(vs.LAST_SIGN_OUT,Date.now().toString())}catch(e){}}(),function(){try{Object.values(fs).forEach(e=>{sessionStorage.removeItem(e)}),sessionStorage.removeItem(ys),sessionStorage.removeItem("auth_session_initialized");const e=Object.keys(sessionStorage).filter(e=>e.includes("auth")||e.includes("sport-wizard")||e.includes("dif-coach"));e.forEach(e=>{sessionStorage.removeItem(e)});const t=e=>{if(e&&"function"===typeof e.removeItem)try{if("function"===typeof e.key){const t=[];for(let a=0;a<(e.length||0);a+=1){const n=e.key(a);n&&gs.test(n)&&t.push(n)}t.forEach(t=>e.removeItem(t))}else Object.keys(e).forEach(t=>{gs.test(t)&&e.removeItem(t)})}catch(t){}};return t("undefined"!==typeof sessionStorage?sessionStorage:null),t("undefined"!==typeof localStorage?localStorage:null),t("undefined"!==typeof a.g?a.g.localStorage:null),t("undefined"!==typeof window?window.localStorage:null),{success:!0,clearedKeys:[...Object.values(fs),"auth_session_initialized",...e]}}catch(e){return console.error("Failed to clear session data:",e),{success:!1,error:e.message}}}(),E.current=!1,R.current=null,{error:null}}catch(e){const t=e.message||"Failed to sign out";return h(t),{error:{message:t}}}finally{u(!1)}},verifyOtp:async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"signup";try{u(!0),h(null);const{data:n,error:r}=await Ur.auth.verifyOtp({email:e,token:t,type:a});if(r)throw r;return(e=>{if(!e)return!1;try{const t="sport-wizard-otp-sent-".concat(e.toLowerCase().trim());return localStorage.removeItem(t),!0}catch(r){return console.warn("Failed to clear OTP sent time:",r),!1}})(e),{user:n.user,error:null}}catch(n){const e=n.message||"Verification failed";return h(e),{user:null,error:{message:e}}}finally{u(!1)}},resendOtp:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"signup";try{u(!0),h(null);const{data:a,error:n}=await Ur.auth.resend({type:t,email:e});if(n)throw n;return js(e),{data:a,error:null,message:"Verification code sent! Please check your email."}}catch(a){const e=a.message||"Failed to resend verification code";return h(e),{data:null,error:{message:e}}}finally{u(!1)}},resetPassword:async e=>{try{u(!0),h(null);const{error:t}=await Ur.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/")});if(t)throw t;return{error:null,message:"Password reset link sent to your email. Please check your inbox and follow the instructions."}}catch(t){const e=t.message||"Failed to send password reset email";return h(e),{error:{message:e},message:null}}finally{u(!1)}},updatePassword:async e=>{try{u(!0),h(null);const{error:t}=await Ur.auth.updateUser({password:e});if(t)throw t;return{error:null,message:"Password updated successfully. You can now sign in with your new password."}}catch(t){const e=t.message||"Failed to update password";return h(e),{error:{message:e},message:null}}finally{u(!1)}},changePassword:async(e,t)=>{try{if(!i)throw new Error("No authenticated user");u(!0),h(null);const{error:a}=await Ur.auth.signInWithPassword({email:i.email,password:e});if(a){const e="Invalid login credentials"===a.message?"Current password is incorrect":"Failed to verify current password";return h(e),{error:{message:e},message:null}}const{error:n}=await Ur.auth.updateUser({password:t});if(n)throw n;return{error:null,message:"Password updated successfully. Your account security has been improved."}}catch(a){const e=a.message||"Failed to change password";return h(e),{error:{message:e},message:null}}finally{u(!1)}},updateProfile:async e=>{try{if(!i)throw new Error("No authenticated user");u(!0),h(null);const{data:t,error:a}=await Ur.from("user_profile").upsert((0,n.A)({id:i.id},e)).select().single();if(a)throw a;return c(t),rs(t),{profile:t,error:null}}catch(t){const e=t.message||"Failed to update profile";return h(e),{profile:null,error:{message:e}}}finally{u(!1)}}};return(0,Ts.jsx)(As.Provider,{value:B,children:r})}const Cs=()=>{const t=(0,e.useContext)(As);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},Ms=/^[a-zA-Z\xc0-\xff0-9\s\-'&.]*$/,Ps=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,Es=/(--|\/\*|\*\/|xp_|sp_|0x|\bunion\b|\bselect\b|\binsert\b|\bupdate\b|\bdelete\b|\bdrop\b|\bcreate\b|\btable\b|\balter\b|\bexec\b|\bexecute\b)/gi,Is=e=>"string"!==typeof e?"":(e.length>50&&(e=e.substring(0,50)),Ms.test(e)||(e=e.replace(/[^a-zA-Z\xc0-\xff0-9\s\-'&.]/g,"")),e=(e=(e=(e=(e=e.replace(/<script[^>]*>.*?<\/script>/gi,"")).replace(/<[^>]*>/g,"")).replace(/javascript:/gi,"")).replace(/on\w+\s*=/gi,"")).replace(Es,"")),Rs=e=>"string"!==typeof e?"":(e.length>320&&(e=e.substring(0,320)),(e=(e=(e=(e=(e=e.replace(/<script[^>]*>.*?<\/script>/gi,"")).replace(/<[^>]*>/g,"")).replace(/javascript:/gi,"")).replace(/on\w+\s*=/gi,"")).replace(Es,"")).toLowerCase().trim()),Os=e=>{if("string"!==typeof e)return!1;const t=e.trim().toLowerCase();return!(0===t.length||t.length>320)&&(!!Ps.test(t)&&(!(/<script/gi.test(t)||/javascript:/gi.test(t)||/on\w+\s*=/gi.test(t))&&!Es.test(t)))},Ds=e=>{if("string"!==typeof e)return"";let t=e.replace(/<script[^>]*>.*?<\/script>/gi,"");return t=t.replace(/<[^>]*>/g,""),t=t.replace(/javascript:/gi,""),t=t.replace(/on\w+\s*=/gi,""),t.length>500&&(t=t.substring(0,500)),t=t.replace(Es,""),t};var Fs=a(211);const Ls=["id","displayName","firstName","lastName","jerseyNumber","stats"];class qs{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.storageKey=e,this.defaultState=t,this.isSupported=this._checkStorageSupport()}_checkStorageSupport(){try{const e="__storage_test__";return localStorage.setItem(e,"test"),localStorage.removeItem(e),!0}catch(e){return console.warn("localStorage is not supported or available:",e),!1}}loadState(){if(!this.isSupported)return this.defaultState;try{const e=localStorage.getItem(this.storageKey);if(!e)return this.defaultState;const t=JSON.parse(e);return"object"!==typeof t||null===t?(console.warn("Invalid state format in localStorage, using default state"),this.defaultState):this._mergeWithDefaults(t)}catch(e){return console.warn("Failed to load state from localStorage:",e),this.defaultState}}saveState(e){if(!this.isSupported)return!1;try{if("object"!==typeof e||null===e)return console.warn("Invalid state provided for saving"),!1;const t=this._sanitizeState(e);return localStorage.setItem(this.storageKey,JSON.stringify(t)),!0}catch(t){if(console.warn("Failed to save state to localStorage:",t),"QuotaExceededError"===t.name){console.warn("Storage quota exceeded, attempting to clear and retry"),this.clearState();try{return localStorage.setItem(this.storageKey,JSON.stringify(e)),!0}catch(a){console.error("Failed to save even after clearing storage:",a)}}return!1}}clearState(){if(!this.isSupported)return!1;try{return localStorage.removeItem(this.storageKey),!0}catch(e){return console.warn("Failed to clear state from localStorage:",e),!1}}hasStoredState(){if(!this.isSupported)return!1;try{return null!==localStorage.getItem(this.storageKey)}catch(e){return console.warn("Failed to check for stored state:",e),!1}}getStorageInfo(){if(!this.isSupported)return{supported:!1,size:0,available:0};try{const t=localStorage.getItem(this.storageKey),a=t?new Blob([t]).size:0;let n=0;try{const e="x".repeat(1048576);localStorage.setItem("__size_test__",e),localStorage.removeItem("__size_test__"),n=5242880}catch(e){n=0}return{supported:!0,size:a,available:n,key:this.storageKey}}catch(t){return{supported:!1,size:0,available:0,error:t.message}}}_mergeWithDefaults(e){if(!this.defaultState||"object"!==typeof this.defaultState||Array.isArray(this.defaultState))return Array.isArray(e)?[...e]:(0,n.A)({},e);const t=(0,n.A)({},this.defaultState);return Object.keys(e).forEach(a=>{a in this.defaultState?"object"!==typeof this.defaultState[a]||null===this.defaultState[a]||Array.isArray(this.defaultState[a])?t[a]=e[a]:t[a]=(0,n.A)((0,n.A)({},this.defaultState[a]),e[a]):t[a]=e[a]}),t}_sanitizeState(e){return JSON.parse(JSON.stringify(e))}}class Us extends qs{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Br.GAME_STATE;const{getInitialFormationTemplate:t}=a(180),{createDefaultTeamConfig:n,FORMATS:r}=a(935),{DEFAULT_MATCH_TYPE:s}=a(150),{DEFAULT_VENUE_TYPE:i}=a(211),o=n(7,r.FORMAT_5V5);super(e,{allPlayers:[],view:"config",selectedSquadIds:[],numPeriods:3,periodDurationMinutes:15,periodGoalieIds:{},teamConfig:o,selectedFormation:o.formation,alertMinutes:2,captainId:null,currentPeriodNumber:1,formation:t(o),nextPlayerToSubOut:"leftDefender",nextPlayerIdToSubOut:null,rotationQueue:[],gameLog:[],opponentTeam:"",matchType:s,venueType:i,ownScore:0,opponentScore:0,trackGoalScorer:!0,matchEvents:[],matchStartTime:null,goalScorers:{},eventSequenceNumber:0,lastEventBackup:null,timerPauseStartTime:null,totalMatchPausedDuration:0,currentMatchId:null,matchCreated:!1})}saveGameState(e){var t,a,r,s,i,o,l,c,d,u,m,h,p,f,g,v,y,b,x,w,S,k,N,j,T,A,_,C,M,P,E,I,R,O,D,F,L,q,U,B,G,z,V,H,K,W,Y,J,Q,$,X,Z,ee,te,ae,ne,re,se,ie,oe,le,ce;if(!e||"object"!==typeof e)return console.warn("GamePersistenceManager.saveGameState called with invalid gameState. Aborting save."),!1;const de=this.defaultState||{},ue={allPlayers:(me=null!==(t=null!==(a=e.allPlayers)&&void 0!==a?a:de.allPlayers)&&void 0!==t?t:[],Array.isArray(me)?me.map(e=>{if(!e||"object"!==typeof e)return e;const t=(0,n.A)({},e);"name"in t&&delete t.name;const{id:a=null,displayName:r=null,firstName:s=null,lastName:i=null,jerseyNumber:o=null,stats:l={}}=t,c=he(t,Ls);return(0,n.A)((0,n.A)({},c),{},{id:a,displayName:r,firstName:s,lastName:i,jerseyNumber:o,stats:l})}):[]),view:null!==(r=null!==(s=e.view)&&void 0!==s?s:de.view)&&void 0!==r?r:"config",selectedSquadIds:null!==(i=null!==(o=e.selectedSquadIds)&&void 0!==o?o:de.selectedSquadIds)&&void 0!==i?i:[],numPeriods:null!==(l=null!==(c=e.numPeriods)&&void 0!==c?c:de.numPeriods)&&void 0!==l?l:3,periodDurationMinutes:null!==(d=null!==(u=e.periodDurationMinutes)&&void 0!==u?u:de.periodDurationMinutes)&&void 0!==d?d:15,periodGoalieIds:null!==(m=null!==(h=e.periodGoalieIds)&&void 0!==h?h:de.periodGoalieIds)&&void 0!==m?m:{},teamConfig:null!==(p=null!==(f=e.teamConfig)&&void 0!==f?f:de.teamConfig)&&void 0!==p?p:null,selectedFormation:null!==(g=null!==(v=e.selectedFormation)&&void 0!==v?v:de.selectedFormation)&&void 0!==g?g:null,alertMinutes:null!==(y=null!==(b=e.alertMinutes)&&void 0!==b?b:de.alertMinutes)&&void 0!==y?y:0,captainId:null!==(x=null!==(w=e.captainId)&&void 0!==w?w:de.captainId)&&void 0!==x?x:null,currentPeriodNumber:null!==(S=null!==(k=e.currentPeriodNumber)&&void 0!==k?k:de.currentPeriodNumber)&&void 0!==S?S:1,formation:null!==(N=null!==(j=e.formation)&&void 0!==j?j:de.formation)&&void 0!==N?N:null,nextPlayerToSubOut:null!==(T=null!==(A=e.nextPlayerToSubOut)&&void 0!==A?A:de.nextPlayerToSubOut)&&void 0!==T?T:null,nextPlayerIdToSubOut:null!==(_=null!==(C=e.nextPlayerIdToSubOut)&&void 0!==C?C:de.nextPlayerIdToSubOut)&&void 0!==_?_:null,rotationQueue:null!==(M=null!==(P=e.rotationQueue)&&void 0!==P?P:de.rotationQueue)&&void 0!==M?M:[],gameLog:null!==(E=null!==(I=e.gameLog)&&void 0!==I?I:de.gameLog)&&void 0!==E?E:[],opponentTeam:null!==(R=null!==(O=e.opponentTeam)&&void 0!==O?O:de.opponentTeam)&&void 0!==R?R:"",matchType:null!==(D=null!==(F=e.matchType)&&void 0!==F?F:de.matchType)&&void 0!==D?D:"league",venueType:null!==(L=null!==(q=e.venueType)&&void 0!==q?q:de.venueType)&&void 0!==L?L:Fs.DEFAULT_VENUE_TYPE,ownScore:null!==(U=null!==(B=e.ownScore)&&void 0!==B?B:de.ownScore)&&void 0!==U?U:0,opponentScore:null!==(G=null!==(z=e.opponentScore)&&void 0!==z?z:de.opponentScore)&&void 0!==G?G:0,trackGoalScorer:null===(V=null!==(H=e.trackGoalScorer)&&void 0!==H?H:de.trackGoalScorer)||void 0===V||V,matchEvents:null!==(K=null!==(W=e.matchEvents)&&void 0!==W?W:de.matchEvents)&&void 0!==K?K:[],matchStartTime:null!==(Y=null!==(J=e.matchStartTime)&&void 0!==J?J:de.matchStartTime)&&void 0!==Y?Y:null,goalScorers:null!==(Q=null!==($=e.goalScorers)&&void 0!==$?$:de.goalScorers)&&void 0!==Q?Q:{},eventSequenceNumber:null!==(X=null!==(Z=e.eventSequenceNumber)&&void 0!==Z?Z:de.eventSequenceNumber)&&void 0!==X?X:0,lastEventBackup:null!==(ee=null!==(te=e.lastEventBackup)&&void 0!==te?te:de.lastEventBackup)&&void 0!==ee?ee:null,timerPauseStartTime:null!==(ae=null!==(ne=e.timerPauseStartTime)&&void 0!==ne?ne:de.timerPauseStartTime)&&void 0!==ae?ae:null,totalMatchPausedDuration:null!==(re=null!==(se=e.totalMatchPausedDuration)&&void 0!==se?se:de.totalMatchPausedDuration)&&void 0!==re?re:0,currentMatchId:null!==(ie=null!==(oe=e.currentMatchId)&&void 0!==oe?oe:de.currentMatchId)&&void 0!==ie?ie:null,matchCreated:null!==(le=null!==(ce=e.matchCreated)&&void 0!==ce?ce:de.matchCreated)&&void 0!==le&&le};var me;return this.saveState(ue)}}function Bs(e){return new qs(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}function Gs(){return new Us(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Br.GAME_STATE)}const zs=["hasFairPlayAward"],Vs=Gs(Br.GAME_STATE),Hs=e=>({id:e.id,displayName:e.display_name,firstName:e.first_name,lastName:e.last_name,jerseyNumber:e.jersey_number||null,stats:{currentPosition:null,currentRole:null,currentStatus:"substitute",isCaptain:!1,isInactive:!1,hasFairPlayAward:!1,lastStintStartTimeEpoch:null,startedMatchAs:null,timeAsAttackerSeconds:0,timeAsDefenderSeconds:0,timeAsGoalieSeconds:0,timeAsMidfielderSeconds:0,timeOnFieldSeconds:0}}),Ks=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(e=e||[],t=t||[],!Array.isArray(e)||0===e.length)return t;const a={};t.forEach(e=>{e&&e.id&&(a[e.id]=e)});const r={};e.forEach(e=>{e&&e.id&&(r[e.id]=e)});const s=[];return e.forEach(e=>{if(!e||!e.id)return;const t=a[e.id];t?s.push(((e,t)=>{const a=t?(0,n.A)({},t):{},{hasFairPlayAward:r}=a,s=he(a,zs);return(0,n.A)((0,n.A)({},s),{},{displayName:e.display_name,firstName:e.first_name,lastName:e.last_name,jerseyNumber:e.jersey_number||s.jerseyNumber,hasFairPlayAward:!1})})(e,t)):s.push(Hs(e))}),t.forEach(e=>{r[e.id]||s.push(e)}),s},Ws=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Vs;try{const r=Ks(e,t),s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vs;try{const a=t.loadState(),r=(0,n.A)((0,n.A)({},a),{},{allPlayers:e});return t.saveState(r),!0}catch(a){return console.error("Failed to sync players to localStorage:",a),!1}}(r,a);return s?{success:!0,players:r,message:"Synced ".concat(e.length," roster players to game state")}:{success:!1,players:t,error:"Failed to save to localStorage"}}catch(r){return console.error("Team roster sync failed:",r),{success:!1,players:t,error:r.message}}},Ys="matchFormat",Js="formation",Qs="periodLength",$s="numPeriods",Xs="substitutionLogic",Zs="alternateRoles",ei="trackGoalScorer",ti="fairPlayAward",ai="teamCaptain",ni="loanMatchWeight",ri="match",si="time",ii="substitution",oi="features",li="statistics",ci={NONE:"none",LEAGUE_ONLY:"league_only",COMPETITIVE:"competitive",ALL_GAMES:"all_games"},di={[Ys]:"5v5",[Js]:"2-2",[Qs]:20,[$s]:2,[Xs]:"equal_time",[Zs]:!0,[ei]:!0,[ti]:"none",[ai]:"none",[ni]:.5},ui=e=>"boolean"===typeof e?e?"true":"false":"number"===typeof e?e.toString():e,mi=(0,e.createContext)({}),hi={AUTH_REQUIRED:"auth_required",CLUB_MEMBERSHIP_NOT_FOUND:"club_membership_not_found",DUPLICATE_CLUB_MEMBERSHIP:"duplicate_club_membership",DUPLICATE_TEAM_NAME:"duplicate_team_name",GENERIC:"generic_error",TEAM_MEMBERSHIP_NOT_FOUND:"team_membership_not_found",TEAM_NOT_FOUND:"team_not_found"},pi={[hi.AUTH_REQUIRED]:"team:errors.loginRequired",[hi.CLUB_MEMBERSHIP_NOT_FOUND]:"team:errors.clubMembershipNotFound",[hi.DUPLICATE_CLUB_MEMBERSHIP]:"team:errors.alreadyClubMember",[hi.DUPLICATE_TEAM_NAME]:"team:errors.teamNameExists",[hi.GENERIC]:"team:errors.genericError",[hi.TEAM_MEMBERSHIP_NOT_FOUND]:"team:errors.teamMembershipNotFound",[hi.TEAM_NOT_FOUND]:"team:errors.teamNotFound"},fi={"A team with this name already exists in this club. Please request to join the existing team.":hi.DUPLICATE_TEAM_NAME,"Club membership not found":hi.CLUB_MEMBERSHIP_NOT_FOUND,"Must be logged in to create club":hi.AUTH_REQUIRED,"Must be logged in to delete team":hi.AUTH_REQUIRED,"Must be logged in to leave club":hi.AUTH_REQUIRED,"Must be logged in to leave team":hi.AUTH_REQUIRED,"Team membership not found":hi.TEAM_MEMBERSHIP_NOT_FOUND,"Team not found":hi.TEAM_NOT_FOUND,"User must be authenticated to create a team":hi.AUTH_REQUIRED,"You are already a member of this club":hi.DUPLICATE_CLUB_MEMBERSHIP},gi=e=>Object.values(hi).includes(e),vi=()=>{const t=(0,e.useContext)(mi);if(!t)throw new Error("useTeam must be used within a TeamProvider");return t},yi=t=>{let{children:a}=t;const{t:r}=xe("team"),{user:s,userProfile:i,sessionDetectionResult:o}=Cs(),l=(0,e.useMemo)(()=>Bs(Br.CURRENT_TEAM_ID,{teamId:null}),[]),c=(0,e.useMemo)(()=>Bs(Br.TEAM_PREFERENCES_CACHE,{teamId:null,fetchedAt:0,preferences:{}}),[]),[d,u]=(0,e.useState)(null),[m,h]=(0,e.useState)([]),[p,f]=(0,e.useState)([]),[g,v]=(0,e.useState)([]),[y,b]=(0,e.useState)([]),[x,w]=(0,e.useState)(()=>({matchState:"not_started",isRunning:!1,isActive:!1})),S=x.isRunning,[k,N]=(0,e.useState)(!1),[j,T]=(0,e.useState)(null),A=(0,e.useMemo)(()=>((e,t)=>{if(!e)return null;const a=e=>t?t(e):e;if("string"===typeof e){if(gi(e))return{code:e,message:a(pi[e]||pi[hi.GENERIC]),isTransient:e===hi.TEAM_NOT_FOUND};const t=fi[e]||hi.GENERIC;return{code:t,message:e,isTransient:t===hi.TEAM_NOT_FOUND}}const r=gi(e.code)?e.code:hi.GENERIC,s=pi[r]||pi[hi.GENERIC],i=e.message||a(s);return(0,n.A)((0,n.A)({},e),{},{code:r,message:i,isTransient:Boolean(e.isTransient||r===hi.TEAM_NOT_FOUND)})})(j,r),[j,r]),_=(0,e.useMemo)(()=>!A||A.isTransient?null:A.message,[A]),C=(0,e.useRef)(null),M=(0,e.useRef)(!1),P=(0,e.useCallback)(()=>{T(null)},[]);(0,e.useEffect)(()=>{if(null===A||void 0===A||!A.isTransient)return;const e=setTimeout(()=>{T(null)},0);return()=>clearTimeout(e)},[null===A||void 0===A?void 0:A.code,null===A||void 0===A?void 0:A.isTransient]);const E=(0,e.useCallback)(e=>{if(!e)return null;const t=c.loadState();if(null===t||void 0===t||!t.teamId||t.teamId!==e)return null;if(!t.fetchedAt)return null;return Date.now()-t.fetchedAt>864e5?null:t.preferences||{}},[c]),I=(0,e.useCallback)((e,t)=>{if(!e)return{};const a=t&&"object"===typeof t?t:{};return c.saveState({teamId:e,fetchedAt:Date.now(),preferences:a}),a},[c]),R=(0,e.useCallback)(()=>{c.clearState()},[c]),O=(0,e.useCallback)(async()=>{if(!s)return[];try{N(!0),P();const{data:e,error:t}=await Ur.from("team_user").select("\n          id,\n          role,\n          team:team_id (\n            id,\n            name,\n            active,\n            created_at,\n            club:club_id (\n              id,\n              name,\n              short_name,\n              long_name\n            )\n          )\n        ").eq("user_id",s.id).eq("team.active",!0);if(t)return console.error("Error fetching user teams:",t),T(r("errors.loadTeams")),[];const a=(e||[]).filter(e=>null===e||void 0===e?void 0:e.team).map(e=>{var t;return(0,n.A)((0,n.A)({},e.team),{},{userRole:e.role,club:(null===(t=e.team)||void 0===t?void 0:t.club)||null})});return h(a),os({userTeams:a}),d&&!a.some(e=>e.id===d.id)&&(u(null),v([]),l.clearState(),os({currentTeam:null,teamPlayers:[]})),a}catch(e){return console.error("Exception in getUserTeams:",e),T(r("errors.loadTeams")),[]}finally{N(!1)}},[s,P,d,l,r]),D=(0,e.useCallback)(async e=>{if(null===e||void 0===e||!e.trim())return[];try{const t=(e=>{if("string"!==typeof e)return"";let t=e.replace(/[%_\\'"`;]/g,"");return t=t.replace(/<script[^>]*>.*?<\/script>/gi,""),t=t.replace(/<[^>]*>/g,""),t=t.replace(/javascript:/gi,""),t=t.replace(/on\w+\s*=/gi,""),t=t.replace(Es,""),t=t.substring(0,100),t.trim().toLowerCase()})(e);if(t.length<2)return[];const a="%".concat(t,"%"),{data:n,error:r}=await Ur.from("club").select("id, name, short_name, long_name").or("name.ilike.".concat(a,",short_name.ilike.").concat(a,",long_name.ilike.").concat(a)).order("name").limit(10);return r?(console.error("Error searching clubs:",r),[]):n||[]}catch(t){return console.error("Exception in searchClubs:",t),[]}},[]),F=(0,e.useCallback)(async()=>{try{const{data:e,error:t}=await Ur.from("club_user").select("\n          id, role, status, joined_at,\n          club:club_id (id, name, short_name, long_name)\n        ").eq("user_id",s.id).eq("status","active").order("joined_at",{ascending:!1});if(t)return console.error("Error fetching club memberships:",t),[];const a=e||[];return f(a),os({userClubs:a}),a}catch(e){return console.error("Exception in getClubMemberships:",e),[]}},[s]),L=(0,e.useCallback)(async e=>{if(!s)return T(r("errors.loginRequiredCreateClub")),null;try{N(!0),P();const{data:t,error:a}=await Ur.rpc("create_club_with_admin",{club_name:e.name,club_short_name:e.shortName||null,club_long_name:e.longName||null});if(a)return console.error("Error calling create_club_with_admin:",a),T(r("errors.createClub")),null;if(!t.success)return console.error("Create club function failed:",t.error),T(t.message||r("errors.createClub")),null;const n=await F();return f(n),t.club}catch(t){return console.error("Exception in createClub:",t),T(r("errors.createClub")),null}finally{N(!1)}},[s,P,F,r]),q=(0,e.useCallback)(async e=>{try{const{data:t,error:a}=await Ur.from("team").select("id, name, active").eq("club_id",e).eq("active",!0).order("name");return a?(console.error("Error fetching teams by club:",a),[]):t||[]}catch(t){return console.error("Exception in getTeamsByClub:",t),[]}},[]),U=(0,e.useCallback)(async e=>{if(!s)return T(r("errors.loginRequiredCreateTeam")),null;try{N(!0),P();const{data:t,error:a}=await Ur.rpc("create_team_with_admin",{p_club_id:e.clubId,team_name:e.name,team_config:e.configuration||{}});return a?(console.error("Error calling create_team_with_admin:",a),T(r("errors.createTeam")),null):t.success?(await O(),t.team):(console.error("Create team function failed:",t.error),"duplicate_team_name"===t.error?T(r("errors.teamNameExists")):T(t.message||r("errors.createTeam")),null)}catch(t){return console.error("Exception in createTeam:",t),T(r("errors.createTeam")),null}finally{N(!1)}},[s,P,O,r]),B=(0,e.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return[];try{let a=Ur.from("player").select("id, first_name, last_name, display_name, jersey_number, on_roster").eq("team_id",e).order("display_name");t||(a=a.eq("on_roster",!0));const{data:n,error:r}=await a;return r?(console.error("Error fetching team players:",r),[]):n||[]}catch(a){return console.error("Exception in getTeamPlayers:",a),[]}},[]),G=(0,e.useCallback)(async e=>{const t=e||(null===d||void 0===d?void 0:d.id);if(!t)return[];const a=await B(t);return v(a),a},[null===d||void 0===d?void 0:d.id,B]),z=(0,e.useCallback)(async e=>{if(!d)return T(r("errors.noTeamSelected")),null;try{N(!0),P();const{data:a,error:n}=await Ur.from("player").insert([{team_id:d.id,first_name:e.firstName,last_name:e.lastName||null,display_name:e.displayName,jersey_number:e.jerseyNumber||null}]).select().single();if(n)return console.error("Error creating player:",n),T(r("errors.createPlayer")),null;const s=await B(d.id);v(s);try{const e=Ws(s,[]);e.success||console.warn("\u26a0\ufe0f Failed to sync new player to game state:",e.error)}catch(t){console.warn("\u26a0\ufe0f Player sync error (non-blocking):",t)}return a}catch(a){return console.error("Exception in createPlayer:",a),T(r("errors.createPlayer")),null}finally{N(!1)}},[d,P,B,r]),V=(0,e.useCallback)(async e=>{const t=m.find(t=>t.id===e);if(!t)return void T(r("errors.teamNotFound"));u(t);const a=await B(e);v(a);try{const e=Ws(a,[]);e.success||console.warn("\u26a0\ufe0f Failed to sync team roster to game state:",e.error)}catch(n){console.warn("\u26a0\ufe0f Team roster sync error (non-blocking):",n)}os({currentTeam:t,teamPlayers:a}),l.saveState({teamId:e})},[m,B,l,r]);(0,e.useEffect)(()=>{if(s&&!M.current){var e;M.current=!0;const t={currentTeam:es(Yr.CURRENT_TEAM),userTeams:es(Yr.USER_TEAMS),userClubs:es(Yr.USER_CLUBS),teamPlayers:es(Yr.TEAM_PLAYERS),pendingRequests:es(Yr.PENDING_REQUESTS)},a=t.userTeams||t.userClubs||t.currentTeam,n=(null===o||void 0===o?void 0:o.type)===hs,s="undefined"!==typeof performance&&1===(null===(e=performance.navigation)||void 0===e?void 0:e.type);(n||s)&&a?(console.log("\ud83d\udd04 Page refresh detected with valid cache, loading team data from cache..."),t.userTeams&&h(t.userTeams),t.userClubs&&f(t.userClubs),t.currentTeam&&u(t.currentTeam),t.teamPlayers&&v(t.teamPlayers),t.pendingRequests&&b(t.pendingRequests),C.current&&clearTimeout(C.current),C.current=setTimeout(()=>{Promise.all([O(),F()]).then(e=>{let[t,a]=e;console.log("\ud83d\udd04 Deferred refresh completed - Teams:",t.length,"Clubs:",a.length),f(a)}).catch(e=>{console.error("Deferred background refresh failed:",e)}).finally(()=>{C.current=null})},0)):Promise.all([O(),F()]).then(e=>{let[t,a]=e;f(a)}).catch(e=>{console.error("Error initializing user data:",e),T(r("errors.initUserData"))})}else s||(M.current=!1,u(null),h([]),f([]),v([]),b([]),l.clearState(),R())},[s,O,F,o,l,R,r]),(0,e.useEffect)(()=>()=>{C.current&&(clearTimeout(C.current),C.current=null)},[]),(0,e.useEffect)(()=>{if(m.length>0&&!d){const e=l.loadState().teamId,t=e?m.find(t=>t.id===e):null;if(t)u(t),B(t.id).then(e=>{v(e)}),l.saveState({teamId:t.id});else if(1===m.length){const e=m[0];u(e),B(e.id).then(e=>{v(e)}),l.saveState({teamId:e.id})}}else 0===m.length&&M.current&&(u(null),v([]))},[m,d,B,l]);const H=(0,e.useCallback)(async e=>{try{const{data:t,error:a}=await Ur.from("team_access_request").select("\n          id, created_at, requested_role, message, status, user_id,\n          user:user_id (id, name)\n        ").eq("team_id",e).eq("status","pending").order("created_at",{ascending:!0});if(a)return console.error("Error fetching team access requests:",a),[];const r=t||[],s=await Promise.all(r.map(async t=>{try{const{data:a,error:r}=await Ur.rpc("get_user_email_for_team_request",{request_user_id:t.user_id,team_id:e});return r&&console.error("Error fetching user email:",r),(0,n.A)((0,n.A)({},t),{},{user_email:a||null})}catch(a){return console.error("Exception fetching user email:",a),t}}));return d&&d.id===e&&b(s),s}catch(t){return console.error("Exception in getTeamAccessRequests:",t),[]}},[d]),K=(0,e.useCallback)(async()=>{if(S)return;if(!d||!s||!i)return void b([]);const e=d.userRole;if("admin"===e||"coach"===e)try{return await H(d.id)}catch(t){return console.error("Exception in checkPendingRequests:",t),b([]),[]}else b([])},[d,s,i,H,S]),W=(0,e.useCallback)(e=>{e&&w(t=>{if(t.matchState===e)return t;const a="running"===e;return{matchState:e,isRunning:a,isActive:a||"pending"===e}})},[]);(0,e.useEffect)(()=>{if(!S)if(s&&i&&d){const e=d.userRole;"admin"===e||"coach"===e?(console.log("Checking for pending requests for team admin/coach:",d.name),K()):b([])}else b([])},[s,i,d,K,S]);const Y=(0,e.useCallback)(async e=>{try{N(!0),P();const{data:t,error:a}=await Ur.from("club_user").select("id, role, status").eq("club_id",e).eq("user_id",s.id).single();if(a&&"PGRST116"!==a.code)return console.error("Error checking existing club membership:",a),T(r("errors.checkClubMembership")),null;if(t)return T(r("errors.alreadyClubMember")),null;const{data:n,error:i}=await Ur.from("club_user").insert([{club_id:e,user_id:s.id,role:"member",status:"active"}]).select("\n          id, role, status, created_at,\n          club:club_id (id, name, short_name, long_name)\n        ").single();if(i)return console.error("Error joining club:",i),"23505"===i.code?T(r("errors.alreadyClubMember")):T(r("errors.joinClub")),null;const o=await F();return f(o),n}catch(t){return console.error("Exception in joinClub:",t),T(r("errors.joinClub")),null}finally{N(!1)}},[s,P,F,r]),J=(0,e.useCallback)(async e=>{var t;const a="string"===typeof e?e:(null===e||void 0===e||null===(t=e.club)||void 0===t?void 0:t.id)||(null===e||void 0===e?void 0:e.club_id)||null;if(!a)return T(r("errors.clubMembershipNotFound")),null;if(!s)return T(r("errors.loginRequiredLeaveClub")),null;try{N(!0),P();const{data:e,error:t}=await Ur.rpc("leave_club",{p_club_id:a});if(t)return console.error("Error leaving club:",t),T(r("errors.leaveClub")),null;if(null===e||void 0===e||!e.success){if("last_team_member"===(null===e||void 0===e?void 0:e.error))return e;const t=(null===e||void 0===e?void 0:e.message)||(null===e||void 0===e?void 0:e.error)||r("errors.leaveClub");return T(t),e}await O();const n=await F();return f(n),e}catch(n){return console.error("Exception in leaveClub:",n),T(r("errors.leaveClub")),null}finally{N(!1)}},[s,P,F,O,r]),Q=(0,e.useCallback)(async e=>{const t="string"===typeof e?e:(null===e||void 0===e?void 0:e.id)||(null===e||void 0===e?void 0:e.team_id)||null;if(!t)return T(r("errors.teamMembershipNotFound")),null;if(!s)return T(r("errors.loginRequiredLeaveTeam")),null;try{N(!0),P();const{data:e,error:a}=await Ur.rpc("leave_team",{p_team_id:t});return a?(console.error("Error leaving team:",a),T(r("errors.leaveTeam")),null):null!==e&&void 0!==e&&e.success?(await O(),(null===d||void 0===d?void 0:d.id)===t&&(u(null),v([]),l.clearState(),os({currentTeam:null,teamPlayers:[]})),e):(T((null===e||void 0===e?void 0:e.message)||(null===e||void 0===e?void 0:e.error)||r("errors.leaveTeam")),e)}catch(a){return console.error("Exception in leaveTeam:",a),T(r("errors.leaveTeam")),null}finally{N(!1)}},[s,P,O,d,l,r]),$=(0,e.useCallback)(async e=>{const t="string"===typeof e?e:(null===e||void 0===e?void 0:e.id)||(null===e||void 0===e?void 0:e.team_id)||null;if(!t)return T(r("errors.teamNotFound")),null;if(!s)return T(r("errors.loginRequiredDeleteTeam")),null;try{N(!0),P();const{data:e,error:a}=await Ur.rpc("delete_team",{p_team_id:t});return a?(console.error("Error deleting team:",a),T(r("errors.deleteTeam")),null):null!==e&&void 0!==e&&e.success?(await O(),(null===d||void 0===d?void 0:d.id)===t&&(u(null),v([]),l.clearState(),os({currentTeam:null,teamPlayers:[]})),e):(T((null===e||void 0===e?void 0:e.message)||(null===e||void 0===e?void 0:e.error)||r("errors.deleteTeam")),null)}catch(a){return console.error("Exception in deleteTeam:",a),T(r("errors.deleteTeam")),null}finally{N(!1)}},[s,P,O,d,l,r]),X=(0,e.useCallback)(async()=>{try{const{data:e,error:t}=await Ur.from("club_user").select("\n          id, created_at, role,\n          user:user_id (id, name),\n          club:club_id (id, name, short_name, long_name)\n        ").eq("status","pending").order("created_at",{ascending:!0});return t?(console.error("Error fetching pending club requests:",t),[]):e||[]}catch(e){return console.error("Exception in getPendingClubRequests:",e),[]}},[]),Z=(0,e.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"member";try{N(!0),P();const{data:a,error:n}=await Ur.from("club_user").update({status:"active",role:t,joined_at:(new Date).toISOString()}).eq("id",e).select("\n          id, role, status, joined_at,\n          user:user_id (id, name),\n          club:club_id (id, name, short_name, long_name)\n        ").single();return n?(console.error("Error approving club membership:",n),T(r("errors.approveClubMembership")),null):a}catch(a){return console.error("Exception in approveClubMembership:",a),T(r("errors.approveClubMembership")),null}finally{N(!1)}},[P,r]),ee=(0,e.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";try{N(!0),P();const{data:a,error:n}=await Ur.from("club_user").update({status:"inactive",review_notes:t}).eq("id",e).select().single();return n?(console.error("Error rejecting club membership:",n),T(r("errors.rejectClubMembership")),null):a}catch(a){return console.error("Exception in rejectClubMembership:",a),T(r("errors.rejectClubMembership")),null}finally{N(!1)}},[P,r]),te=(0,e.useCallback)(async e=>{let{teamId:t,email:a,role:n,message:i=""}=e;try{if(!s)return T(r("errors.loginRequiredInvite")),{success:!1,error:"Authentication required"};N(!0),P();const e=m.find(e=>e.id===t);if(!e||"admin"!==e.userRole&&"coach"!==e.userRole)return T(r("errors.noPermissionInvite")),{success:!1,error:"Insufficient permissions"};if("coach"===e.userRole&&"admin"===n)return T(r("errors.coachCannotInviteAdmin")),{success:!1,error:"Role restriction"};const{data:o,error:l}=await Ur.functions.invoke("invite-user-to-team",{body:{p_team_id:t,p_email:a.toLowerCase(),p_role:n,p_message:i,p_redirect_url:"".concat(window.location.origin,"/?invitation=true&team=").concat(encodeURIComponent(t),"&role=").concat(encodeURIComponent(n))}});return l?(console.error("Error calling Edge Function:",l),T(l.message||r("errors.sendInvitation")),{success:!1,error:l.message}):null!==o&&void 0!==o&&o.success?(o.warning&&console.warn("Invitation created with warning:",o.warning),{success:!0,data:o.data||o,message:o.message||r("context.invitationSentTo",{email:a}),warning:o.warning}):(console.error("Edge Function returned error:",null===o||void 0===o?void 0:o.error),T((null===o||void 0===o?void 0:o.error)||r("errors.sendInvitation")),{success:!1,error:null===o||void 0===o?void 0:o.error})}catch(o){console.error("Exception in inviteUserToTeam:",o);const e=o.message||r("errors.sendInvitation");return T(e),{success:!1,error:e}}finally{N(!1)}},[s,m,P,r]),ae=(0,e.useCallback)(async e=>{try{const{data:t,error:a}=await Ur.from("team_invitation").select("id, email, role, message, status, created_at, invited_by_user_id, expires_at").eq("team_id",e).order("created_at",{ascending:!1});return a?(console.error("Error fetching team invitations:",a),[]):t||[]}catch(t){return console.error("Exception in getTeamInvitations:",t),[]}},[]),ne=(0,e.useCallback)(async e=>{try{N(!0),P();const{data:t,error:a}=await Ur.from("team_invitation").update({status:"cancelled",updated_at:(new Date).toISOString()}).eq("id",e).eq("invited_by_user_id",s.id).select().single();return a?(console.error("Error cancelling invitation:",a),T(r("errors.cancelInvitation")),null):t}catch(t){return console.error("Exception in cancelTeamInvitation:",t),T(r("errors.cancelInvitation")),null}finally{N(!1)}},[s,P,r]),re=(0,e.useCallback)(async e=>{try{if(!s)return T(r("errors.loginRequiredAccept")),{success:!1,error:"Authentication required"};N(!0),P();const{data:t,error:a}=await Ur.rpc("accept_team_invitation",{p_invitation_id:e,p_user_email:s.email});if(a){console.error("Error accepting invitation:",a);const e=a.message||r("errors.acceptInvitation");return T(e),{success:!1,error:e}}return await O(),{success:!0,data:t,message:r("context.welcomeToTeam")}}catch(t){console.error("Exception in acceptTeamInvitation:",t);const e=t.message||r("errors.acceptInvitation");return T(e),{success:!1,error:e}}finally{N(!1)}},[s,P,O,r]),se=(0,e.useCallback)(async()=>{try{if(!s)return[];N(!0),P();const{data:e,error:t}=await Ur.from("team_invitation").select("\n          id,\n          team_id,\n          email,\n          role,\n          message,\n          created_at,\n          expires_at,\n          team:team_id (\n            id,\n            name,\n            club:club_id (\n              id,\n              name,\n              short_name,\n              long_name\n            )\n          )\n        ").eq("status","pending").eq("email",s.email).gt("expires_at","now()").order("created_at",{ascending:!1});if(t)return console.error("Error fetching user pending invitations:",t),T(r("errors.loadInvitations")),[];return(null===e||void 0===e?void 0:e.map(e=>({id:e.id,teamId:e.team_id,email:e.email,role:e.role,message:e.message,createdAt:e.created_at,expiresAt:e.expires_at,team:e.team?{id:e.team.id,name:e.team.name,club:e.team.club}:{id:e.team_id,name:r("context.teamFallbackName"),club:null},invitedBy:{id:null,name:r("context.teamAdminFallback")}})))||[]}catch(e){return console.error("Exception in getUserPendingInvitations:",e),T(r("errors.loadInvitations")),[]}finally{N(!1)}},[s,P,r]),ie=(0,e.useCallback)(async e=>{try{if(!s)return T(r("errors.loginRequiredDecline")),{success:!1,error:"Authentication required"};N(!0),P();const{data:t,error:a}=await Ur.rpc("decline_team_invitation",{p_invitation_id:e,p_user_email:s.email});if(a){console.error("Error declining invitation:",a);const e=a.message||r("errors.declineInvitation");return T(e),{success:!1,error:e}}return{success:!0,data:t,message:(null===t||void 0===t?void 0:t.message)||r("context.invitationDeclined")}}catch(t){console.error("Exception in declineTeamInvitation:",t);const e=r("errors.declineInvitation");return T(e),{success:!1,error:e}}finally{N(!1)}},[s,P,r]),oe=(0,e.useCallback)(async e=>{let{invitationId:t,teamId:a,email:n,role:i,message:o=""}=e;try{if(!s)return T(r("errors.loginRequiredRefresh")),{success:!1,error:"Authentication required"};N(!0),P();const e=await te({teamId:a,email:n,role:i,message:o});return e.success?{success:!0,message:e.message,was_expired:e.was_expired}:(T(e.error||r("errors.refreshInvitation")),{success:!1,error:e.error})}catch(l){console.error("Exception in refreshInvitation:",l);const e=l.message||r("errors.refreshInvitation");return T(e),{success:!1,error:e}}finally{N(!1)}},[s,te,P,r]),le=(0,e.useCallback)(async e=>{try{if(!s)return T(r("errors.loginRequiredDelete")),{success:!1,error:"Authentication required"};N(!0),P();const{data:t,error:a}=await Ur.rpc("delete_team_invitation",{p_invitation_id:e});if(a){console.error("Error deleting invitation:",a);const e=a.message||r("errors.deleteInvitation");return T(e),{success:!1,error:e}}return{success:t.success||!0,message:t.message||r("context.invitationDeleted")}}catch(t){console.error("Exception in deleteInvitation:",t);const e=t.message||r("errors.deleteInvitation");return T(e),{success:!1,error:e}}finally{N(!1)}},[s,P,r]),ce=(0,e.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"coach",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{n||(N(!0),P());const{data:o,error:l}=await Ur.from("team_access_request").insert([{team_id:e,user_id:s.id,requested_role:t,message:a,status:"pending"}]).select("\n          id, created_at, requested_role, message, status,\n          team:team_id (\n            id,\n            name,\n            club:club_id (id, name, short_name, long_name)\n          ),\n          user:user_id (id, name)\n        ").single();if(l){var i;if(console.error("Error requesting team access:",l),!n)"23505"===l.code&&null!==(i=l.message)&&void 0!==i&&i.includes("unique_pending_request_idx")?T(r("errors.pendingRequestExists")):T(r("errors.requestTeamAccess"));return null}return o}catch(o){return console.error("Exception in requestTeamAccess:",o),n||T(r("errors.requestTeamAccess")),null}finally{n||N(!1)}},[s,P,r]),de=(0,e.useCallback)(async()=>{try{const{data:e,error:t}=await Ur.from("team_access_request").select("\n          id, created_at, requested_role, message, status, reviewed_at, review_notes,\n          team:team_id (\n            id,\n            name,\n            club:club_id (id, name, short_name, long_name)\n          )\n        ").eq("user_id",s.id).order("created_at",{ascending:!1});return t?(console.error("Error fetching user team requests:",t),[]):e||[]}catch(e){return console.error("Exception in getUserTeamRequests:",e),[]}},[s]),ue=(0,e.useCallback)(async(e,t)=>{try{N(!0),P();const{data:a,error:n}=await Ur.from("team_access_request").select("team_id, user_id").eq("id",e).single();if(n)return console.error("Error fetching request:",n),T(r("errors.fetchRequestDetails")),null;const{error:i}=await Ur.from("team_user").insert([{team_id:a.team_id,user_id:a.user_id,role:t}]);if(i)return console.error("Error adding user to team:",i),T(r("errors.addUserToTeam")),null;const{data:o,error:l}=await Ur.from("team_access_request").update({status:"approved",reviewed_by:s.id,reviewed_at:(new Date).toISOString()}).eq("id",e).select("\n          id, status, reviewed_at,\n          user:user_id (id, name),\n          team:team_id (\n            id,\n            name,\n            club:club_id (id, name, short_name, long_name)\n          )\n        ").single();return l?(console.error("Error updating request status:",l),T(r("errors.updateRequestStatus")),null):(d&&K(),o)}catch(a){return console.error("Exception in approveTeamAccess:",a),T(r("errors.approveTeamAccess")),null}finally{N(!1)}},[s,P,d,K,r]),me=(0,e.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";try{N(!0),P();const{data:a,error:n}=await Ur.from("team_access_request").update({status:"rejected",reviewed_by:s.id,reviewed_at:(new Date).toISOString(),review_notes:t}).eq("id",e).select("\n          id, status, reviewed_at, review_notes,\n          user:user_id (id, name),\n          team:team_id (\n            id,\n            name,\n            club:club_id (id, name, short_name, long_name)\n          )\n        ").single();return n?(console.error("Error rejecting team access:",n),T(r("errors.rejectTeamAccess")),null):(d&&K(),a)}catch(a){return console.error("Exception in rejectTeamAccess:",a),T(r("errors.rejectTeamAccess")),null}finally{N(!1)}},[s,P,d,K,r]),he=(0,e.useCallback)(async e=>{try{N(!0),P();const{data:t,error:a}=await Ur.from("team_access_request").update({status:"cancelled"}).eq("id",e).eq("user_id",s.id).select().single();return a?(console.error("Error cancelling team access request:",a),T(r("errors.cancelRequest")),null):t}catch(t){return console.error("Exception in cancelTeamAccess:",t),T(r("errors.cancelRequest")),null}finally{N(!1)}},[s,P,r]),pe=(0,e.useCallback)(async e=>{try{const{data:t,error:a}=await Ur.from("team_user").select("\n          id, role, created_at,\n          user:user_id (id, name)\n        ").eq("team_id",e).order("created_at",{ascending:!0});return a?(console.error("Error fetching team members:",a),[]):t||[]}catch(t){return console.error("Exception in getTeamMembers:",t),[]}},[]),fe=(0,e.useCallback)(async(e,t)=>{try{N(!0),P();const{data:a,error:n}=await Ur.from("team_user").update({role:t}).eq("id",e).select("\n          id, role, created_at,\n          user:user_id (id, name)\n        ").single();return n?(console.error("Error updating team member role:",n),T(r("errors.updateMemberRole")),null):a}catch(a){return console.error("Exception in updateTeamMemberRole:",a),T(r("errors.updateMemberRole")),null}finally{N(!1)}},[P,r]),ge=(0,e.useCallback)(async e=>{try{N(!0),P();const{data:t,error:a}=await Ur.from("team_user").delete().eq("id",e).select().single();return a?(console.error("Error removing team member:",a),T(r("errors.removeTeamMember")),null):t}catch(t){return console.error("Exception in removeTeamMember:",t),T(r("errors.removeTeamMember")),null}finally{N(!1)}},[P,r]),ve=(0,e.useCallback)(async e=>{if(!e)return[];try{const{data:t,error:a}=await Ur.from("player").select("\n          id,\n          first_name,\n          last_name,\n          display_name,\n          jersey_number,\n          on_roster,\n          match_id,\n          created_at,\n          updated_at\n        ").eq("team_id",e).is("match_id",null).order("jersey_number",{ascending:!0});if(a)throw console.error("Error fetching team roster:",a),new Error("Failed to load team roster");return t||[]}catch(t){throw console.error("Exception in getTeamRoster:",t),t}},[]),ye=(0,e.useCallback)(async(e,t)=>{if(!e||null===t||void 0===t||!t.first_name)return null;try{var a;if(t.jersey_number){const{data:a}=await Ur.from("player").select("id").eq("team_id",e).eq("jersey_number",t.jersey_number).single();if(a)throw new Error("Jersey number ".concat(t.jersey_number," is already taken"))}const{data:r,error:i}=await Ur.from("player").insert({team_id:e,first_name:t.first_name.trim(),last_name:t.last_name?t.last_name.trim():null,display_name:t.display_name.trim(),jersey_number:t.jersey_number||null,on_roster:null===(a=t.on_roster)||void 0===a||a,created_by:s.id,last_updated_by:s.id}).select().single();if(i)throw console.error("Error adding roster player:",i),new Error("Failed to add player to roster");if((null===d||void 0===d?void 0:d.id)===e){const t=await B(e);v(t);try{const e=Ws(t,[]);e.success||console.warn("\u26a0\ufe0f Failed to sync new roster player to game state:",e.error)}catch(n){console.warn("\u26a0\ufe0f Roster player sync error (non-blocking):",n)}}return r}catch(r){throw console.error("Exception in addRosterPlayer:",r),r}},[s,d,B]),be=(0,e.useCallback)(async(e,t)=>{if(!e)return null;try{if(void 0!==t.jersey_number){const{data:a}=await Ur.from("player").select("team_id").eq("id",e).single();if(a&&t.jersey_number){const{data:n}=await Ur.from("player").select("id").eq("team_id",a.team_id).eq("jersey_number",t.jersey_number).neq("id",e).single();if(n)throw new Error("Jersey number ".concat(t.jersey_number," is already taken"))}}const r=(0,n.A)((0,n.A)({},t),{},{last_updated_by:s.id,updated_at:(new Date).toISOString()});r.first_name&&(r.first_name=r.first_name.trim()),r.last_name&&(r.last_name=r.last_name.trim()),r.display_name&&(r.display_name=r.display_name.trim());const{data:i,error:o}=await Ur.from("player").update(r).eq("id",e).select().single();if(o)throw console.error("Error updating roster player:",o),new Error("Failed to update player");const l=null===i||void 0===i?void 0:i.team_id;if(l&&(null===d||void 0===d?void 0:d.id)===l){const e=await B(l);v(e);try{const t=Ws(e,[]);t.success||console.warn("\u26a0\ufe0f Failed to sync updated roster player to game state:",t.error)}catch(a){console.warn("\u26a0\ufe0f Roster player sync error (non-blocking):",a)}}return i}catch(r){throw console.error("Exception in updateRosterPlayer:",r),r}},[s,d,B]),we=(0,e.useCallback)(async e=>{if(!e)return null;try{const{data:t,error:a}=await Ur.from("player_match_stats").select("id").eq("player_id",e).limit(1);if(a)throw console.error("Error checking player game history:",a),new Error("Failed to check player game history");if(t&&t.length>0){const{data:t,error:a}=await Ur.from("player").update({on_roster:!1,last_updated_by:s.id,updated_at:(new Date).toISOString()}).eq("id",e).select().single();if(a)throw console.error("Error deactivating player:",a),new Error("Failed to deactivate player");return(0,n.A)((0,n.A)({},t),{},{operation:"deactivated"})}{const{data:t,error:a}=await Ur.from("player").delete().eq("id",e).select().single();if(a)throw console.error("Error removing player:",a),new Error("Failed to remove player from roster");return(0,n.A)((0,n.A)({},t),{},{operation:"deleted"})}}catch(t){throw console.error("Exception in removeRosterPlayer:",t),t}},[s]),Se=(0,e.useCallback)(async e=>{if(!e)return!1;try{const{data:t,error:a}=await Ur.from("player_match_stats").select("id").eq("player_id",e).limit(1);return a?(console.error("Error checking player game history:",a),!1):t&&t.length>0}catch(t){return console.error("Exception in checkPlayerGameHistory:",t),!1}},[]),ke=(0,e.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return[];try{const{data:a,error:n}=await Ur.from("player").select("jersey_number").eq("team_id",e).not("jersey_number","is",null);if(n)return console.error("Error fetching jersey numbers:",n),[];const r=new Set(a.filter(e=>null!==e.jersey_number&&(!t||e.id!==t)).map(e=>e.jersey_number)),s=[];for(let e=1;e<=100;e++)r.has(e)||s.push(e);return s}catch(a){return console.error("Exception in getAvailableJerseyNumbers:",a),[]}},[]),Ne=(0,e.useCallback)(e=>!(!s||!e)&&e.created_by===s.id,[s]),je=(0,e.useCallback)(e=>["matchFormat","formation"].includes(e)?ri:["periodLength","numPeriods"].includes(e)?si:["substitutionLogic","alternateRoles"].includes(e)?ii:["trackGoalScorer","fairPlayAward","teamCaptain"].includes(e)?oi:["loanMatchWeight"].includes(e)?li:null,[]),Te=(0,e.useCallback)(async function(e){let{forceRefresh:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return{};const a=t?null:E(e);if(a)return a;try{const{data:t,error:a}=await Ur.from("team_preference").select("key, value").eq("team_id",e);if(a){console.error("Error loading team preferences:",a);return E(e)||{}}const n={};return null===t||void 0===t||t.forEach(e=>{n[e.key]=((e,t)=>{switch(e){case Qs:case $s:return parseInt(t,10);case ei:case Zs:return"true"===t;case ni:return Number.isNaN(parseFloat(t))?.5:parseFloat(t);default:return t}})(e.key,e.value)}),I(e,n)}catch(n){console.error("Unexpected error loading preferences:",n);return E(e)||{}}},[E,I]),Ae=(0,e.useCallback)(async(e,t)=>{if(!e||!t)throw new Error("Team ID and preferences are required");try{const a=Object.entries(t).map(t=>{let[a,n]=t;return{team_id:e,key:a,value:ui(n),category:je(a)}}),{error:n}=await Ur.from("team_preference").upsert(a,{onConflict:"team_id,key",ignoreDuplicates:!1});if(n)throw console.error("Error saving team preferences:",n),new Error("Failed to save preferences");return I(e,t),!0}catch(a){throw console.error("Unexpected error saving preferences:",a),a}},[je,I]),_e=(0,e.useCallback)(async(e,t)=>{if(!e||!t)throw new Error("Team ID and preference key are required");try{const{error:a}=await Ur.from("team_preference").delete().eq("team_id",e).eq("key",t);if(a)throw console.error("Error deleting preference:",a),new Error("Failed to delete preference");const r=E(e);if(r&&Object.prototype.hasOwnProperty.call(r,t)){const a=(0,n.A)({},r);delete a[t],I(e,a)}return!0}catch(a){throw console.error("Unexpected error deleting preference:",a),a}},[E,I]);(0,e.useEffect)(()=>{null!==d&&void 0!==d&&d.id?Te(d.id,{forceRefresh:!0}).catch(e=>{console.error("Failed to prefetch team preferences:",e)}):R()},[null===d||void 0===d?void 0:d.id,Te,R]);const Ce={currentTeam:d,userTeams:m,userClubs:p,teamPlayers:g,pendingRequests:y,loading:k,error:_,getUserTeams:O,searchClubs:D,createClub:L,getTeamsByClub:q,createTeam:U,createPlayer:z,switchCurrentTeam:V,clearError:P,isClubCreator:Ne,joinClub:Y,leaveClub:J,leaveTeam:Q,deleteTeam:$,getClubMemberships:F,getPendingClubRequests:X,approveClubMembership:Z,rejectClubMembership:ee,inviteUserToTeam:te,getTeamInvitations:ae,cancelTeamInvitation:ne,acceptTeamInvitation:re,getUserPendingInvitations:se,declineTeamInvitation:ie,refreshInvitation:oe,deleteInvitation:le,requestTeamAccess:ce,getTeamAccessRequests:H,getUserTeamRequests:de,approveTeamAccess:ue,rejectTeamAccess:me,cancelTeamAccess:he,getTeamMembers:pe,updateTeamMemberRole:fe,removeTeamMember:ge,getTeamRoster:ve,addRosterPlayer:ye,updateRosterPlayer:be,removeRosterPlayer:we,refreshTeamPlayers:G,checkPlayerGameHistory:Se,getAvailableJerseyNumbers:ke,loadTeamPreferences:Te,saveTeamPreferences:Ae,deleteTeamPreference:_e,checkPendingRequests:K,matchActivityStatus:x,isMatchRunning:S,updateMatchActivityStatus:W,hasTeams:m.length>0,hasClubs:p.length>0,isCoach:"coach"===(null===d||void 0===d?void 0:d.userRole),isTeamAdmin:"admin"===(null===d||void 0===d?void 0:d.userRole),isParent:"parent"===(null===d||void 0===d?void 0:d.userRole),canManageTeam:"admin"===(null===d||void 0===d?void 0:d.userRole)||"coach"===(null===d||void 0===d?void 0:d.userRole),canViewStatistics:["parent","coach","admin"].includes(null===d||void 0===d?void 0:d.userRole),hasPendingRequests:y.length>0,pendingRequestsCount:y.length};return(0,Ts.jsx)(mi.Provider,{value:Ce,children:a})},bi={CONFIG:"config",PERIOD_SETUP:"periodSetup",GAME:"game",STATS:"stats",STATISTICS:"statistics",PROFILE:"profile",TACTICAL_BOARD:"tacticalBoard",TEAM_MANAGEMENT:"teamManagement",TEAM_MATCHES:"teamMatches",PLAN_MATCHES:"planMatches",LIVE_MATCH:"liveMatch"};var xi=a(935),wi=a(180);const Si=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e||"object"!==typeof e)return null;try{const a=t&&t!==e.formation?(0,n.A)((0,n.A)({},e),{},{formation:t}):e;return(0,wi.getModeDefinition)(a)}catch(a){return console.warn("Failed to get formation definition:",a),null}};var ki=a(239);const Ni=(0,ki.x8)(Je.q.DEFENDER),ji=(0,ki.x8)(Je.q.ATTACKER),Ti=(0,ki.x8)(Je.q.MIDFIELDER),Ai=function(e){return Si(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)},_i=(e,t,a,r,s)=>{var i,o;const l=a.filter(t=>t.id!==e).map(e=>{const a=t.find(t=>t.id===e.id),r=(null===a||void 0===a?void 0:a.stats.timeAsDefenderSeconds)||0,i=(null===a||void 0===a?void 0:a.stats.timeAsMidfielderSeconds)||0,o=(null===a||void 0===a?void 0:a.stats.timeAsAttackerSeconds)||0,l=(null===a||void 0===a?void 0:a.stats.timeOnFieldSeconds)||0,c=(0,n.A)((0,n.A)({},e),{},{totalOutfieldTime:l,defenderTime:r,midfielderTime:i,attackerTime:o,isInactive:(null===a||void 0===a?void 0:a.stats.isInactive)||!1});return s===xi.FORMATIONS.FORMATION_1_2_1?(0,n.A)((0,n.A)({},c),{},{defenderDeficit:Oi(r,i,o,Ni),midfielderDeficit:Oi(r,i,o,Ti),attackerDeficit:Oi(r,i,o,ji)}):(0,n.A)((0,n.A)({},c),{},{surplusAttackerTime:o-r})}),c=l.filter(e=>!e.isInactive),d=l.filter(e=>e.isInactive);if(c.length<=4)return Pi(e,c,d,r,s);const u=Ai(r,s),m=c.sort((e,t)=>e.totalOutfieldTime-t.totalOutfieldTime),h=(null===u||void 0===u||null===(i=u.fieldPositions)||void 0===i?void 0:i.length)||4,p=m.slice(0,h),f=m.slice(h),g=p.sort((e,t)=>t.totalOutfieldTime-e.totalOutfieldTime),v=f.sort((e,t)=>e.totalOutfieldTime-t.totalOutfieldTime),y=[...g,...v],b=c.sort((e,t)=>e.totalOutfieldTime-t.totalOutfieldTime).slice(0,h);let x;if(s===xi.FORMATIONS.FORMATION_1_2_1){var w,S,k,N;const t=Di(b);x={goalie:e,defender:(null===(w=t.defender)||void 0===w?void 0:w.id)||null,left:(null===(S=t.left)||void 0===S?void 0:S.id)||null,right:(null===(k=t.right)||void 0===k?void 0:k.id)||null,attacker:(null===(N=t.attacker)||void 0===N?void 0:N.id)||null}}else if(s===xi.FORMATIONS.FORMATION_2_2){var j,T,A,_;const t=[...b].sort((e,t)=>t.surplusAttackerTime-e.surplusAttackerTime),a=t.slice(0,2),n=t.slice(2,4);x={goalie:e,leftDefender:(null===(j=a[0])||void 0===j?void 0:j.id)||null,rightDefender:(null===(T=a[1])||void 0===T?void 0:T.id)||null,leftAttacker:(null===(A=n[0])||void 0===A?void 0:A.id)||null,rightAttacker:(null===(_=n[1])||void 0===_?void 0:_.id)||null}}else x=Ci(e,u,b,v,d);const C=(null===u||void 0===u?void 0:u.substitutePositions)||[];Ei(x,C,v,d);return{formation:x,rotationQueue:y.map(e=>e.id),nextToRotateOff:(null===(o=g[0])||void 0===o?void 0:o.id)||null}},Ci=(e,t,a,n,r)=>{const s={goalie:e},i=[...a],o=(t.fieldPositions||[]).filter(e=>e.toLowerCase().includes("defender")),l=(t.fieldPositions||[]).filter(e=>e.toLowerCase().includes("mid")),c=(t.fieldPositions||[]).filter(e=>e.toLowerCase().includes("attack")||"attacker"===e),d=(e,t)=>{e.forEach(e=>{i.sort((e,a)=>Mi(e,t)-Mi(a,t));const a=i.shift();s[e]=(null===a||void 0===a?void 0:a.id)||null})};d(o,"defender"),d(l,"midfielder"),d(c,"attacker");const u=(t.fieldPositions||[]).filter(e=>void 0===s[e]);u.length>0&&i.length>0&&(i.sort((e,t)=>e.totalOutfieldTime-t.totalOutfieldTime),u.forEach((e,t)=>{var a;s[e]=(null===(a=i[t])||void 0===a?void 0:a.id)||null}));const m=t.substitutePositions||[];return Ei(s,m,n,r),s},Mi=(e,t)=>{var a,n,r,s;switch(t){case"defender":return null!==(a=e.defenderTime)&&void 0!==a?a:0;case"midfielder":return null!==(n=e.midfielderTime)&&void 0!==n?n:0;case"attacker":return null!==(r=e.attackerTime)&&void 0!==r?r:0;default:return null!==(s=e.totalOutfieldTime)&&void 0!==s?s:0}},Pi=(e,t,a,n,r)=>{const s=t.sort((e,t)=>e.totalOutfieldTime-t.totalOutfieldTime),i=Ai(n,r),o=(null===i||void 0===i?void 0:i.fieldPositions)||[],l=(null===i||void 0===i?void 0:i.substitutePositions)||[],c={goalie:e};o.forEach((e,t)=>{var a;c[e]=(null===(a=s[t])||void 0===a?void 0:a.id)||null});const d=s.slice(o.length);return Ei(c,l,d,a),{formation:c,rotationQueue:[],nextToRotateOff:null}},Ei=(e,t,a,n)=>{const r=a.map(e=>e.id),s=n.map(e=>e.id);t.forEach((t,a)=>{if(a<r.length)e[t]=r[a]||null;else{const n=a-r.length;e[t]=s[n]||null}})},Ii=(e,t,a,n)=>_i(e,t,a,n,xi.FORMATIONS.FORMATION_2_2),Ri=(e,t,a,n)=>_i(e,t,a,n,xi.FORMATIONS.FORMATION_1_2_1),Oi=(e,t,a,n)=>{const r=e+t+a;if(0===r)return 0;const s=r/3;let i;switch(n){case Ni:i=e;break;case Ti:i=t;break;case ji:i=a;break;default:return 0}return Math.max(0,s-i)},Di=e=>{const t=[...e].sort((e,t)=>t.defenderDeficit-e.defenderDeficit),a=[...e].sort((e,t)=>t.midfielderDeficit-e.midfielderDeficit),n=[...e].sort((e,t)=>t.attackerDeficit-e.attackerDeficit),r={},s=new Set,i=t.find(e=>!s.has(e.id));i&&(r.defender=i,s.add(i.id));const o=n.find(e=>!s.has(e.id));o&&(r.attacker=o,s.add(o.id));const l=a.filter(e=>!s.has(e.id)).slice(0,2);r.left=l[0]||null,r.right=l[1]||null;const c=e.filter(e=>!s.has(e.id));return!r.left&&c.length>0&&(r.left=c.shift()),!r.right&&c.length>0&&(r.right=c.shift()),r};class Fi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.queue=[...e],this.inactivePlayers=[],this.getPlayerById=t||(()=>null)}toArray(){return[...this.queue]}getActiveQueue(){return[...this.queue]}getNextActivePlayer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return 1===e?this.queue[0]||null:this.queue.slice(0,e)}getInactivePlayers(){return[...this.inactivePlayers]}rotatePlayer(e){const t=this.queue.indexOf(e);-1!==t&&(this.queue.splice(t,1),this.queue.push(e))}addPlayer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"end";this.removePlayer(e),"start"===t?this.queue.unshift(e):"end"===t?this.queue.push(e):"number"===typeof t&&this.queue.splice(t,0,e)}removePlayer(e){const t=this.queue.indexOf(e);-1!==t&&this.queue.splice(t,1)}moveToFront(e){this.addPlayer(e,"start")}insertBefore(e,t){const a=this.queue.indexOf(t);-1!==a&&(this.removePlayer(e),this.queue.splice(a,0,e))}deactivatePlayer(e){this.removePlayer(e),this.inactivePlayers.includes(e)||this.inactivePlayers.push(e)}reactivatePlayer(e){const t=this.inactivePlayers.indexOf(e);-1!==t&&this.inactivePlayers.splice(t,1);const a=Math.min(4,this.queue.length);this.addPlayer(e,a)}reorderByPositions(e){const t=[];e.forEach(e=>{e&&this.queue.includes(e)&&t.push(e)}),this.queue.forEach(e=>{t.includes(e)||t.push(e)}),this.queue=t}size(){return this.queue.length}activeSize(){return this.queue.length}inactiveSize(){return this.inactivePlayers.length}contains(e){return this.queue.includes(e)}getPosition(e){return this.queue.indexOf(e)}getActivePosition(e){return this.queue.indexOf(e)}isPlayerInactive(e){return this.inactivePlayers.includes(e)}initialize(){const e=[],t=[];this.queue.forEach(a=>{var n;const r=this.getPlayerById(a);null!==r&&void 0!==r&&null!==(n=r.stats)&&void 0!==n&&n.isInactive?e.push(a):t.push(a)}),this.queue=t,this.inactivePlayers=e}reset(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.queue=[...e],this.inactivePlayers=[]}clone(){const e=new Fi(this.queue,this.getPlayerById);return e.inactivePlayers=[...this.inactivePlayers],e}}function Li(){return new Fi(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)}const qi=e=>e.map((e,t)=>{const a="Player ".concat(t+1),n="string"===typeof e?e.trim():"",[r,...s]=n.split(/\s+/).filter(Boolean),i=n||a,o=r||i,l=s.length>0?s.join(" "):null;return{id:"p".concat(t+1),displayName:i,firstName:o,lastName:l,stats:{startedMatchAs:null,startedAtRole:null,startedAtPosition:null,startLocked:!1,periodsAsGoalie:0,periodsAsDefender:0,periodsAsAttacker:0,periodsAsMidfielder:0,timeOnFieldSeconds:0,timeAsSubSeconds:0,timeAsGoalieSeconds:0,timeAsDefenderSeconds:0,timeAsAttackerSeconds:0,timeAsMidfielderSeconds:0,currentRole:null,currentStatus:null,lastStintStartTimeEpoch:0,currentPositionKey:null,isInactive:!1,isCaptain:!1,goals:0,saves:0,blocks:0,cards:[],hasFairPlayAward:!1}}}),Ui=(e,t)=>{if(e&&Array.isArray(e))return e.find(e=>e.id===t)},Bi=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unknown Player";return(null===e||void 0===e?void 0:e.displayName)||t},Gi=e=>e?e.display_name?e.display_name:e.first_name||e.last_name?"".concat(e.first_name||"").concat(e.last_name?" ".concat(e.last_name):"").trim():"Unknown Player":"Unknown Player",zi=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Unknown Player";const n=Ui(e,t);return Bi(n,a)},Vi=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{validateStats:a=!1}=t;return t=>{const n=Ui(e,t);return a&&n&&!n.stats?(console.warn("Player ".concat(t," found but missing stats object")),null):n}},Hi=function(e,t){var a;let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"N/A";const r=Ui(e,t);if(!r)return n;const s=r.displayName||r.firstName;if(!s)return n;return(null===(a=r.stats)||void 0===a?void 0:a.isCaptain)?"".concat(s," (C)"):s},Ki=(e,t)=>e.filter(e=>t.includes(e.id)),Wi=(e,t,a)=>e.filter(e=>t.includes(e.id)&&e.id!==a),Yi=e=>t=>Ui(e,t),Ji=(e,t)=>{if(!e||!Array.isArray(e))return!1;const n=a(180),r=n.getModeDefinition?n.getModeDefinition(t):null;if(!r)return!1;const s=r.substitutePositions||[];if(!s.length)return!1;return e.filter(e=>{var t;return s.includes(null===(t=e.stats)||void 0===t?void 0:t.currentPositionKey)}).some(e=>{var t;return!(null!==(t=e.stats)&&void 0!==t&&t.isInactive)})},Qi=(e,t)=>{if(t)return!1;if(!Array.isArray(e))return!1;return e.filter(e=>!0===e.on_roster).length<=3};var $i=a(338);const Xi=(e,t)=>!e||e<=0||!t||t<e?0:Math.round((t-e)/1e3),Zi=(e,t)=>e||!t||t<=0,eo=(e,t)=>{return n=t,(a=e)>0&&n>=a?Xi(e,t):0;var a,n};const to=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=(0,n.A)({},e.stats);if(Zi(a,r.lastStintStartTimeEpoch))return(0,n.A)({},r);const s=eo(r.lastStintStartTimeEpoch,t),i=ao(r,s);return(0,n.A)((0,n.A)({},i),{},{lastStintStartTimeEpoch:t})},ao=(e,t)=>{const a=(0,n.A)((0,n.A)({},e),{},{timeOnFieldSeconds:e.timeOnFieldSeconds||0,timeAsAttackerSeconds:e.timeAsAttackerSeconds||0,timeAsDefenderSeconds:e.timeAsDefenderSeconds||0,timeAsMidfielderSeconds:e.timeAsMidfielderSeconds||0,timeAsSubSeconds:e.timeAsSubSeconds||0,timeAsGoalieSeconds:e.timeAsGoalieSeconds||0});if(isNaN(t)||t<0)return a;switch(e.currentStatus){case Je.P.ON_FIELD:a.timeOnFieldSeconds+=t,e.currentRole===Je.q.DEFENDER?a.timeAsDefenderSeconds+=t:e.currentRole===Je.q.ATTACKER?a.timeAsAttackerSeconds+=t:e.currentRole===Je.q.MIDFIELDER&&(a.timeAsMidfielderSeconds+=t);break;case Je.P.SUBSTITUTE:a.timeAsSubSeconds+=t;break;case Je.P.GOALIE:a.timeAsGoalieSeconds+=t}return a},no=(e,t)=>{(!t||t<=0)&&(t=Ns());return(0,n.A)((0,n.A)({},e),{},{stats:(0,n.A)((0,n.A)({},e.stats),{},{timeOnFieldSeconds:e.stats.timeOnFieldSeconds||0,timeAsAttackerSeconds:e.stats.timeAsAttackerSeconds||0,timeAsDefenderSeconds:e.stats.timeAsDefenderSeconds||0,timeAsMidfielderSeconds:e.stats.timeAsMidfielderSeconds||0,timeAsSubSeconds:e.stats.timeAsSubSeconds||0,timeAsGoalieSeconds:e.stats.timeAsGoalieSeconds||0,lastStintStartTimeEpoch:t})})},ro=(e,t)=>((!t||t<=0)&&(t=Ns()),(0,n.A)((0,n.A)({},e),{},{stats:(0,n.A)((0,n.A)({},e.stats),{},{lastStintStartTimeEpoch:t})})),so={GAME_LOGIC:"game_logic",TIMER:"timer",STORAGE:"storage",FORMATION:"formation",PLAYER:"player",VALIDATION:"validation",NETWORK:"network",UI:"ui"},io={LOW:"low",MEDIUM:"medium",HIGH:"high",CRITICAL:"critical"};class oo extends Error{constructor(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:io.MEDIUM,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(e),this.name="GameError",this.category=t,this.severity=a,this.context=n,this.timestamp=Date.now(),this.stack=Error.captureStackTrace?Error.captureStackTrace(this,oo):(new Error).stack}}const lo=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=e instanceof oo?e:new oo(e.message||"Unknown error",t.category||so.UI,t.severity||io.MEDIUM,t),r={message:a.message,category:a.category,severity:a.severity,timestamp:a.timestamp,context:(0,n.A)((0,n.A)((0,n.A)({},a.context),t),{},{url:window.location.href,userAgent:navigator.userAgent,stack:a.stack})};switch(a.severity){case io.CRITICAL:console.error("\ud83d\udea8 [CRITICAL ERROR]",r);break;case io.HIGH:console.error("\u274c [HIGH ERROR]",r);break;case io.MEDIUM:console.warn("\u26a0\ufe0f [MEDIUM ERROR]",r);break;case io.LOW:console.info("\u2139\ufe0f [LOW ERROR]",r);break;default:console.warn("\u26a0\ufe0f [ERROR]",r)}return r},co={gameLogic:function(e){return new oo(e,so.GAME_LOGIC,io.HIGH,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})},timer:function(e){return new oo(e,so.TIMER,io.MEDIUM,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})},storage:function(e){return new oo(e,so.STORAGE,io.MEDIUM,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})},formation:function(e){return new oo(e,so.FORMATION,io.HIGH,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})},validation:function(e){return new oo(e,so.VALIDATION,io.LOW,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}},uo="left",mo="right";const ho=e=>{if(!e||"string"!==typeof e)return null;const t=e.toLowerCase();return t.includes(uo)?uo:t.includes(mo)?mo:null};class po{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.teamConfig=e,this.selectedFormation=t}getModeConfig(){return(0,wi.getModeDefinition)(this.teamConfig)}getPositionRole(e){return(0,$i.Mf)(e)}handleIndividualModeSubstitution(e){const{formation:t,nextPlayerIdToSubOut:a,allPlayers:r,rotationQueue:s,currentTimeEpoch:i,isSubTimerPaused:o,substitutionCount:l=1}=e;if(!s||0===s.length){const e=co.gameLogic("Rotation queue cannot be empty during substitution",{operation:"handleIndividualModeSubstitution",rotationQueue:s,nextPlayerIdToSubOut:a,teamConfig:this.teamConfig,selectedFormation:this.selectedFormation,severity:io.CRITICAL});throw lo(e),e}if(!a){const e=co.gameLogic("nextPlayerIdToSubOut cannot be null during substitution",{operation:"handleIndividualModeSubstitution",nextPlayerIdToSubOut:a,rotationQueue:null===s||void 0===s?void 0:s.slice(),severity:io.CRITICAL});throw lo(e),e}const c=this.getModeConfig(),{substitutePositions:d,supportsInactiveUsers:u,substituteRotationPattern:m}=c,h=s.slice(0,l),p=d.slice(0,l),f=c.fieldPositions,g=[];for(let n=0;n<h.length;n++){const e=h[n],a=p[n],s=f.find(a=>t[a]===e);if(!s){const a=co.gameLogic("Player to substitute out must be in a field position, not a substitute position",{operation:"handleIndividualModeSubstitution",playerGoingOffId:e,fieldPositions:f,currentFormation:Object.keys(t).reduce((e,a)=>(f.includes(a)&&(e[a]=t[a]),e),{}),severity:io.CRITICAL});throw lo(a),a}const i=t[a];if(u){const e=Ui(r,i);if(null!==e&&void 0!==e&&e.stats.isInactive)throw new Error("Substitute at ".concat(a," is inactive but was selected for substitution"))}const o=ho(s),l=this.getPositionRole(s);g.push({playerGoingOffId:e,playerComingOnId:i,fieldPosition:s,substitutePosition:a,newRole:l,side:o})}Li(s,Vi(r)).initialize();const v=function(e){return(0,n.A)({},e)}(t);if(g.forEach(e=>{v[e.fieldPosition]=e.playerComingOnId}),"simple"===m)g.forEach((e,t)=>{v[e.substitutePosition]=e.playerGoingOffId});else{if(d.some(e=>{const a=Ui(r,t[e]);return!0===(null===a||void 0===a?void 0:a.stats.isInactive)})){const e=d.filter(e=>{const a=Ui(r,t[e]);return a&&!a.stats.isInactive}),a=g.map(e=>e.playerComingOnId),n=g.map(e=>e.playerGoingOffId),s=[...e.map(e=>t[e]).filter(e=>e&&!a.includes(e)),...n];e.forEach((e,t)=>{const a=s[t];void 0!==a&&(v[e]=a)})}else{const e=g.map(e=>e.playerComingOnId),a=d.map(e=>({pos:e,id:t[e]})).filter(t=>!e.includes(t.id)).map(e=>e.id);g.map(e=>e.playerGoingOffId).forEach((e,t)=>{t<d.length&&(v[d[d.length-l+t]]=e)}),a.forEach((e,t)=>{t<d.length-l&&(v[d[t]]=e)})}}const y=g.map(e=>e.playerGoingOffId),b=g.map(e=>e.playerComingOnId),x=new Map,w=new Map;g.forEach(e=>{x.set(e.playerGoingOffId,e),w.set(e.playerComingOnId,e)});const S=r.map(e=>{if(x.has(e.id)){const t=x.get(e.id),a=o?ro(e,i):(0,n.A)((0,n.A)({},e),{},{stats:to(e,i,!1)}),r=Object.keys(v).find(t=>v[t]===e.id&&d.includes(t));return(0,n.A)((0,n.A)({},e),{},{stats:(0,n.A)((0,n.A)({},a.stats),{},{currentStatus:"substitute",currentPositionKey:r||t.substitutePosition,currentRole:Je.q.SUBSTITUTE},t.side?{preferredSide:t.side}:{})})}if(w.has(e.id)){const t=w.get(e.id),a=o?ro(e,i):(0,n.A)((0,n.A)({},e),{},{stats:to(e,i,!1)});return(0,n.A)((0,n.A)({},e),{},{stats:(0,n.A)((0,n.A)({},a.stats),{},{currentStatus:"on_field",currentPositionKey:t.fieldPosition,currentRole:t.newRole},t.side?{preferredSide:t.side}:{})})}if("simple"!==m){const a=Object.keys(t).find(a=>t[a]===e.id),r=Object.keys(v).find(t=>v[t]===e.id);if(a!==r&&d.includes(r))return(0,n.A)((0,n.A)({},e),{},{stats:(0,n.A)((0,n.A)({},e.stats),{},{currentPositionKey:r,currentRole:Je.q.SUBSTITUTE})})}return e}),k=Li(s,Vi(r));k.initialize(),y.forEach(e=>{k.rotatePlayer(e)});const N=k.toArray(),j=N[0],T=f.find(e=>v[e]===j);return{newFormation:v,updatedPlayers:S,newRotationQueue:N,newNextPlayerIdToSubOut:j,newNextPlayerToSubOut:T||"leftDefender",playersComingOnIds:b,playersGoingOffIds:y}}executeSubstitution(e){return this.handleIndividualModeSubstitution(e)}}function fo(e,t,a){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=to(e,a,r),i=(0,n.A)((0,n.A)({},e),{},{stats:(0,n.A)((0,n.A)({},s),{},{currentRole:t})});if(!r){return no(i,a)}return i}function go(e){return new po(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)}function vo(e){return e&&"object"===typeof e?e.format&&e.squadSize&&e.formation?(0,wi.getModeDefinition)(e):(e.mode,null):null}function yo(e){if(!e)return{};const t=vo(e);if(!t)return{};const a={goalie:null};(t.fieldPositions||[]).forEach(e=>{a[e]=null});return(t.substitutePositions||[]).forEach(e=>{a[e]=null}),a}function bo(e){let{typeFilter:t=[],outcomeFilter:a=[],venueFilter:n=[],opponentFilter:r=[],playerFilter:s=[],formatFilter:i=[],startDate:o,endDate:l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return!1;const c=t.map(e=>"string"===typeof e?e.toLowerCase():e),d="string"===typeof e.type?e.type.toLowerCase():e.type;if(o||l){const t=e.date?new Date(e.date):null;if(o&&t&&t<o)return!1;if(l&&t&&t>l)return!1}if(c.length>0&&(!d||!c.includes(d)))return!1;if(a.length>0&&(!e.outcome||!a.includes(e.outcome)))return!1;if(n.length>0&&(!e.venueType||!n.includes(e.venueType)))return!1;if(r.length>0&&(!e.opponent||!r.includes(e.opponent)))return!1;if(s.length>0){const t=Array.isArray(e.players)?e.players:[];if(!s.some(e=>t.includes(e)))return!1}return!(i.length>0&&(!e.format||!i.includes(e.format)))}function xo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Array.isArray(e)?e.filter(e=>bo(e,t)):[]}const wo={MATCH_START:"match_start",MATCH_END:"match_end",MATCH_ABANDONED:"match_abandoned",MATCH_SUSPENDED:"match_suspended",PERIOD_START:"period_start",PERIOD_END:"period_end",PERIOD_PAUSED:"period_paused",PERIOD_RESUMED:"period_resumed",INTERMISSION:"intermission",SUBSTITUTION:"substitution",SUBSTITUTION_UNDONE:"substitution_undone",GOALIE_SWITCH:"goalie_switch",GOALIE_ASSIGNMENT:"goalie_assignment",POSITION_CHANGE:"position_change",FAIR_PLAY_AWARD:"fair_play_award",PLAYER_INACTIVATED:"player_inactivated",PLAYER_ACTIVATED:"player_activated",GOAL_SCORED:"goal_scored",GOAL_CONCEDED:"goal_conceded",GOAL_CORRECTED:"goal_corrected",GOAL_UNDONE:"goal_undone",TIMER_PAUSED:"timer_paused",TIMER_RESUMED:"timer_resumed",TECHNICAL_TIMEOUT:"technical_timeout"},So=Bs(Br.MATCH_EVENTS,{matchId:null,version:"1.0.0",created:null,lastUpdated:null,checksum:"",events:[],goalScorers:{},corrections:{},metadata:{eventCount:0,lastSequence:0}});let ko=0,No=null,jo=[],To=[];const Ao=()=>{const e=Date.now(),t=Math.random().toString(36).substr(2,9);return"evt_".concat(e,"_").concat(t)},_o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t||(t=No),!t||!e)return"00:00";const a=Math.max(0,e-t),n=Math.floor(a/6e4),r=Math.floor(a%6e4/1e3);return"".concat(n.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0"))},Co=e=>{const t=JSON.stringify(e);let a=0;for(let n=0;n<t.length;n++){a=(a<<5)-a+t.charCodeAt(n),a&=a}return Math.abs(a).toString(36)},Mo=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{matchId:t.matchId||Ao(),version:"1.0.0",created:t.created||Date.now(),lastUpdated:Date.now(),checksum:"",events:e,goalScorers:t.goalScorers||{},corrections:t.corrections||{},metadata:(0,n.A)((0,n.A)({},t),{},{eventCount:e.length,lastSequence:ko})}},Po=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const a=Mo(e,t);a.checksum=Co(a);if(!So.saveState(a))throw new Error("PersistenceManager failed to save events");return jo=[...e],Oo("events_saved",{events:e,metadata:t}),!0}catch(a){return console.error("Failed to save events:",a),!1}},Eo=()=>{try{const t=So.loadState();if(t&&t.events&&t.events.length>0){var e;const a=t.checksum;if(a!==Co((0,n.A)((0,n.A)({},t),{},{checksum:""})))return console.warn("Primary storage checksum mismatch, starting with empty events"),Mo();if(!(e=>{if(!Array.isArray(e)||0===e.length)return!0;for(let t=1;t<e.length;t++){const a=e[t-1],n=e[t];if(n.timestamp<a.timestamp)return console.warn("Events not in chronological order:",a.id,n.id),!1;if(n.sequence<=a.sequence)return console.warn("Event sequence numbers not increasing:",a.sequence,n.sequence),!1}return!0})(t.events))return console.warn("Event sequence validation failed, starting with empty events"),Mo();jo=t.events||[],ko=(null===(e=t.metadata)||void 0===e?void 0:e.lastSequence)||0;const r=jo.find(e=>e.type===wo.MATCH_START);return r&&(No=r.timestamp),t}return null}catch(t){return console.error("Failed to load events:",t),Mo()}},Io=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{if(!Object.values(wo).includes(e))throw new Error("Invalid event type: ".concat(e));const r=a||Date.now();ko++;const s={id:t.eventId||Ao(),type:e,timestamp:r,matchTime:_o(r),periodNumber:t.periodNumber||null,sequence:ko,data:(0,n.A)({},t),undone:!1,relatedEventId:t.relatedEventId||null},i=(e=>{const t=[];return e.id||t.push("Event missing id"),e.type&&Object.values(wo).includes(e.type)||t.push("Invalid event type"),e.timestamp&&"number"===typeof e.timestamp||t.push("Invalid timestamp"),"number"!==typeof e.sequence&&t.push("Invalid sequence number"),t})(s);if(i.length>0)throw new Error("Event validation failed: ".concat(i.join(", ")));e===wo.MATCH_START&&(No=r,s.matchTime="00:00");const o=[...jo,s];if(!Po(o,{goalScorers:t.goalScorers,corrections:t.corrections}))throw new Error("Failed to save event to storage");return s}catch(r){throw console.error("Failed to log event:",r),r}},Ro=e=>(To.push(e),()=>{const t=To.indexOf(e);t>-1&&To.splice(t,1)}),Oo=(e,t)=>{To.forEach(a=>{try{a(e,t)}catch(n){console.error("Event listener error:",n)}})},Do=()=>{try{jo=[],ko=0,No=null,So.clearState();try{localStorage.removeItem(Br.MATCH_EVENTS_BACKUP),localStorage.removeItem(Br.MATCH_EVENTS_EMERGENCY)}catch(e){}return Oo("events_cleared",{}),!0}catch(t){return console.error("Failed to clear events:",t),!1}},Fo=()=>No,Lo=()=>[...jo],qo=(e,t)=>{try{const a=jo.findIndex(t=>t.id===e);if(-1===a)return console.warn("Event not found for data update: ".concat(e)),!1;const r=[...jo];r[a]=(0,n.A)((0,n.A)({},r[a]),{},{data:(0,n.A)((0,n.A)({},r[a].data),t)});return!!Po(r)}catch(a){return console.error("Failed to update event data:",a),!1}},Uo=()=>{const e=Eo();return e};Uo();const Bo=new class{constructor(){this.retryQueue=[],this.maxRetries=5,this.baseRetryDelay=1e3,this.retryTimers=new Map}async persistEvent(e,t){try{var a;const r=t||(null===e||void 0===e?void 0:e.matchId)||(null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.matchId);if(!r)return{success:!0,skipped:!0,reason:"Missing matchId"};if(!await(async()=>{const{data:{user:e},error:t}=await Ur.auth.getUser();return t?(console.error("Error getting user:",t.message),null):e})())return{success:!0,skipped:!0,reason:"Not authenticated"};const s=this.transformEventForDatabase(e,r);if(!s)return{success:!0,skipped:!0,reason:"No database mapping"};const i=Array.isArray(s)?s:[s],o=[];for(const e of i)try{const t=await this.writeEventToDatabase(e);o.push({status:"fulfilled",value:t})}catch(n){o.push({status:"rejected",reason:n}),console.warn("Event write failed (continuing sequence):",n)}return{success:!0,results:o}}catch(n){return console.warn("Event persistence error:",n),{success:!1,error:n.message}}}mapEventTypeToDatabase(e){const t={match_start:"match_started",match_end:"match_ended",match_created:"match_created",period_start:"period_started",period_end:"period_ended",goal_scored:"goal_scored",goal_conceded:"goal_conceded",substitution:"substitution_in",goalie_assignment:"goalie_enters",position_change:"position_switch",player_inactivated:"player_inactivated",player_activated:"player_reactivated",player_reactivated:"player_reactivated",fair_play_award:"fair_play_award",goalie_switch:"goalie_exits",match_abandoned:"match_ended",match_suspended:"match_ended",period_paused:null,period_resumed:null,intermission:null,substitution_undone:null,goal_corrected:null,goal_undone:null,timer_paused:null,timer_resumed:null,technical_timeout:null};return void 0!==t[e]?t[e]:null}transformEventForDatabase(e,t){var a,r,s;const i=this.mapEventTypeToDatabase(e.type);if(!i)return null;const o=this.parseMatchTimeToSeconds(e.matchTime),l=this.normalizeCorrelationId((null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.correlationId)||(null===e||void 0===e?void 0:e.relatedEventId)||(null===e||void 0===e?void 0:e.id)),c=function(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.A)({match_id:t,event_type:i,occurred_at_seconds:o,period:e.periodNumber||1,data:null,correlation_id:l||null},a)},d=()=>l||this.generateCorrelationId();if("goalie_switch"===e.type){const t=this.generateCorrelationId(),a=[];if(e.data.previousGoalieId||e.data.oldGoalieId){const r=this.getDisplayNameForPlayer(e,e.data.previousGoalieId||e.data.oldGoalieId);a.push((0,n.A)((0,n.A)({},c({occurred_at_seconds:o,period:e.periodNumber||1})),{},{event_type:"goalie_exits",player_id:e.data.previousGoalieId||e.data.oldGoalieId,correlation_id:t,data:r?{display_name:r}:null}))}if(e.data.goalieId||e.data.newGoalieId){const r=this.getDisplayNameForPlayer(e,e.data.goalieId||e.data.newGoalieId);a.push((0,n.A)((0,n.A)({},c({occurred_at_seconds:o,period:e.periodNumber||1})),{},{event_type:"goalie_enters",player_id:e.data.goalieId||e.data.newGoalieId,correlation_id:t,data:r?{display_name:r}:null}))}return a.length>0?a:null}if("match_abandoned"===e.type||"match_suspended"===e.type)return c({data:{matchEndReason:e.type}});if("match_ended"===i&&"match_end"===e.type)return c({data:null});if("match_created"===i){var u,m,h,p;const t=(null===(u=e.data)||void 0===u?void 0:u.ownTeamName)||null,a=(null===(m=e.data)||void 0===m?void 0:m.opponentTeamName)||null,r=(null===(h=e.data)||void 0===h?void 0:h.periodDurationMinutes)||null,s=(null===(p=e.data)||void 0===p?void 0:p.totalPeriods)||null,i=(0,n.A)((0,n.A)((0,n.A)((0,n.A)({},t?{ownTeamName:t}:{}),a?{opponentTeamName:a}:{}),"number"===typeof r?{periodDurationMinutes:r}:{}),"number"===typeof s?{totalPeriods:s}:{}),o=Object.keys(i).length>0;return c({data:o?i:null})}if("match_started"===i){var f,g,v,y,b,x,w,S,k,N,j,T,A;const t=Array.isArray(null===(f=e.data)||void 0===f?void 0:f.startingLineup)?e.data.startingLineup:null,a=(null===(g=e.data)||void 0===g?void 0:g.ownTeamName)||(null===(v=e.data)||void 0===v?void 0:v.teamName)||null,r=(null===(y=e.data)||void 0===y?void 0:y.opponentTeamName)||(null===(b=e.data)||void 0===b?void 0:b.opponentTeam)||(null===(x=e.data)||void 0===x?void 0:x.opponentName)||null,s=(null===(w=e.data)||void 0===w?void 0:w.periodDurationMinutes)||(null===(S=e.data)||void 0===S||null===(k=S.matchMetadata)||void 0===k?void 0:k.periodDurationMinutes)||null,i=(null===(N=e.data)||void 0===N?void 0:N.numPeriods)||(null===(j=e.data)||void 0===j?void 0:j.totalPeriods)||(null===(T=e.data)||void 0===T||null===(A=T.matchMetadata)||void 0===A?void 0:A.plannedPeriods)||null,o=(0,n.A)((0,n.A)((0,n.A)((0,n.A)((0,n.A)({},t?{startingLineup:t}:{}),a?{ownTeamName:a}:{}),r?{opponentTeamName:r,opponentName:r}:{}),"number"===typeof s?{periodDurationMinutes:s}:{}),"number"===typeof i?{totalPeriods:i}:{}),l=Object.keys(o).length>0;return c({data:l?o:null})}if("match_ended"===i&&"match_end"===e.type){var _,C,M,P,E;let t="number"===typeof(null===(_=e.data)||void 0===_?void 0:_.matchDurationMs)?Math.round(e.data.matchDurationMs/1e3):null;null===t&&e.matchTime&&(t=this.parseMatchTimeToSeconds(e.matchTime));const a=(null===(C=e.data)||void 0===C?void 0:C.finalPeriodNumber)||(null===(M=e.data)||void 0===M||null===(P=M.matchMetadata)||void 0===P?void 0:P.totalPeriods)||null;return c({data:(0,n.A)((0,n.A)((0,n.A)({},null!==t?{matchDurationSeconds:t}:{}),"number"===typeof a?{totalPeriods:a}:{}),null!==(E=e.data)&&void 0!==E&&E.matchMetadata?{matchMetadata:e.data.matchMetadata}:null)})}if("goalie_enters"===i){var I,R,O,D,F,L,q,U;const t=(null===(I=e.data)||void 0===I?void 0:I.goalieId)||(null===(R=e.data)||void 0===R?void 0:R.newGoalieId)||(null===(O=e.data)||void 0===O?void 0:O.playerId)||(null===(D=e.data)||void 0===D?void 0:D.scorerId),a=d(),r=c({player_id:t||void 0,data:t?this.buildDisplayNameData(e,t):null,correlation_id:a}),s="replacement"===(null===(F=e.data)||void 0===F?void 0:F.eventType),i=(null===(L=e.data)||void 0===L?void 0:L.previousGoalieId)||(null===(q=e.data)||void 0===q?void 0:q.oldGoalieId),o=(null===(U=e.data)||void 0===U?void 0:U.newGoaliePosition)||null;if(s&&i){return[r,(0,n.A)({},c({event_type:"position_switch",player_id:i,correlation_id:a,data:(0,n.A)({old_position:"goalie",new_position:o},this.buildDisplayNameData(e,i)||{})}))]}return r}if("substitution"===e.type){var B,G;const t=d(),a=Array.isArray(null===(B=e.data)||void 0===B?void 0:B.playersOff)?e.data.playersOff:[],r=Array.isArray(null===(G=e.data)||void 0===G?void 0:G.playersOn)?e.data.playersOn:[],s=[];return a.forEach(a=>{const r=this.buildDisplayNameData(e,a);s.push((0,n.A)({},c({event_type:"substitution_out",player_id:a,correlation_id:t,data:r})))}),r.forEach(a=>{const r=this.buildDisplayNameData(e,a);s.push((0,n.A)({},c({event_type:"substitution_in",player_id:a,correlation_id:t,data:r})))}),s.length>0?s:null}if("position_switch"===i){var z,V,H,K;const t=null===(z=e.data)||void 0===z?void 0:z.sourcePlayerId,a=null===(V=e.data)||void 0===V?void 0:V.targetPlayerId,r=(null===(H=e.data)||void 0===H?void 0:H.sourcePosition)||null,s=(null===(K=e.data)||void 0===K?void 0:K.targetPosition)||null;if(t&&a){const i=d();return[(0,n.A)({},c({player_id:t,correlation_id:i,data:(0,n.A)({old_position:r,new_position:s},this.buildDisplayNameData(e,t)||{})})),(0,n.A)({},c({player_id:a,correlation_id:i,data:(0,n.A)({old_position:s,new_position:r},this.buildDisplayNameData(e,a)||{})}))]}}if("goal_scored"===i||"goal_conceded"===i){var W,Y,J,Q,$,X;const t={ownScore:null===(W=e.data)||void 0===W?void 0:W.ownScore,opponentScore:null===(Y=e.data)||void 0===Y?void 0:Y.opponentScore},a=this.getDisplayNameForPlayer(e,(null===(J=e.data)||void 0===J?void 0:J.playerId)||(null===(Q=e.data)||void 0===Q?void 0:Q.scorerId)||e.player_id);a&&(t.display_name=a);return c({data:t,player_id:(null===($=e.data)||void 0===$?void 0:$.playerId)||(null===(X=e.data)||void 0===X?void 0:X.scorerId)||void 0})}if("period_started"===i||"period_ended"===i){if("period_started"===i){var Z;const t=Array.isArray(null===(Z=e.data)||void 0===Z?void 0:Z.startingLineup)?e.data.startingLineup:null;return c({data:t?{startingLineup:t}:null})}return c({data:null})}if("player_inactivated"===i||"player_reactivated"===i){var ee;const t=(null===(ee=e.data)||void 0===ee?void 0:ee.playerId)||e.player_id,a=this.buildDisplayNameData(e,t);return c({event_type:i,player_id:t||void 0,data:a})}if("fair_play_award"===i){var te,ae;const t=this.buildDisplayNameData(e,null===(te=e.data)||void 0===te?void 0:te.playerId);return c({event_type:i,player_id:(null===(ae=e.data)||void 0===ae?void 0:ae.playerId)||void 0,data:t})}return c({data:e.data?(0,n.A)({},e.data):null,player_id:(null===(r=e.data)||void 0===r?void 0:r.playerId)||(null===(s=e.data)||void 0===s?void 0:s.scorerId)||void 0})}buildDisplayNameData(e,t){const a=this.getDisplayNameForPlayer(e,t);return a?{display_name:a}:null}getDisplayNameForPlayer(e,t){if(!e||!t)return null;const a=e.data||{},n=e=>{if(!e||"string"!==typeof e)return null;const t=e.trim();return t&&"unknown"!==t.toLowerCase()?t:null},r=n(a.display_name);if(r)return r;const s=n(a.playerDisplayName);if(s)return s;if("string"===typeof a.playerName&&(!a.playerId||a.playerId===t)){const e=n(a.playerName);if(e)return e}if("string"===typeof a.scorerName&&(!a.scorerId||a.scorerId===t)){const e=n(a.scorerName);if(e)return e}if("string"===typeof a.goalieName&&(a.goalieId&&a.goalieId===t||a.newGoalieId&&a.newGoalieId===t)){const e=n(a.goalieName);if(e)return e}if("string"===typeof a.previousGoalieName&&(a.previousGoalieId&&a.previousGoalieId===t||a.oldGoalieId&&a.oldGoalieId===t)){const e=n(a.previousGoalieName);if(e)return e}if(a.playerNameMap&&"object"===typeof a.playerNameMap&&a.playerNameMap[t]){const e=n(a.playerNameMap[t]);if(e)return e}if(Array.isArray(a.playersOff)&&Array.isArray(a.playersOffNames)){const e=a.playersOff.findIndex(e=>e===t);if(-1!==e&&a.playersOffNames[e]){const t=n(a.playersOffNames[e]);if(t)return t}}if(Array.isArray(a.playersOn)&&Array.isArray(a.playersOnNames)){const e=a.playersOn.findIndex(e=>e===t);if(-1!==e&&a.playersOnNames[e]){const t=n(a.playersOnNames[e]);if(t)return t}}if("string"===typeof a.sourcePlayerName&&a.sourcePlayerId===t){const e=n(a.sourcePlayerName);if(e)return e}if("string"===typeof a.targetPlayerName&&a.targetPlayerId===t){const e=n(a.targetPlayerName);if(e)return e}if("string"===typeof a.swapPlayerName&&a.swapPlayerId===t){const e=n(a.swapPlayerName);if(e)return e}return null}async writeEventToDatabase(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;try{"fair_play_award"===e.event_type&&await Ur.from("match_log_event").delete().eq("match_id",e.match_id).eq("event_type","fair_play_award");const{data:t,error:a}=await Ur.from("match_log_event").insert(e);if(a)throw a;return this.removeFromRetryQueue(e),{success:!0,data:t}}catch(a){return console.warn("Failed to write event (attempt ".concat(t+1,"):"),a.message),t<this.maxRetries?(this.scheduleRetry(e,t),{success:!1,retrying:!0}):(console.error("Max retries reached for event:",e,a),this.logPersistentFailure(e,a),{success:!1,retrying:!1,error:a})}}scheduleRetry(e,t){const a=this.calculateBackoffDelay(t),n=this.getEventKey(e);this.retryTimers.has(n)&&clearTimeout(this.retryTimers.get(n));const r=setTimeout(async()=>{await this.writeEventToDatabase(e,t+1),this.retryTimers.delete(n)},a);this.retryTimers.set(n,r)}calculateBackoffDelay(e){return this.baseRetryDelay*Math.pow(2,e)}parseMatchTimeToSeconds(e){if(!e||"string"!==typeof e)return 0;const t=e.split(":");if(2!==t.length)return 0;return 60*(parseInt(t[0],10)||0)+(parseInt(t[1],10)||0)}isValidUuid(e){if(!e||"string"!==typeof e)return!1;return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e.trim())}normalizeCorrelationId(e){return this.isValidUuid(e)?e:null}generateCorrelationId(){return"undefined"!==typeof crypto&&"function"===typeof crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}getEventKey(e){return"".concat(e.match_id,"_").concat(e.event_type,"_").concat(e.occurred_at_seconds,"_").concat(e.period)}removeFromRetryQueue(e){const t=this.getEventKey(e);this.retryQueue=this.retryQueue.filter(e=>this.getEventKey(e.event)!==t)}logPersistentFailure(e,t){try{const a=this.getFailedEventsFromStorage();a.push({event:e,error:t.message,timestamp:Date.now(),attemptedRetries:this.maxRetries}),localStorage.setItem("failed_event_writes",JSON.stringify(a)),console.error("Event persistence failed permanently:",{event:e,error:t.message,retries:this.maxRetries})}catch(a){console.error("Failed to store failed event:",a)}}getFailedEventsFromStorage(){try{const e=localStorage.getItem("failed_event_writes");return e?JSON.parse(e):[]}catch(e){return console.error("Failed to parse failed events:",e),[]}}clearAllRetryTimers(){this.retryTimers.forEach(e=>clearTimeout(e)),this.retryTimers.clear()}};const Go={Goalkeeper:(0,ki.x8)(Je.q.GOALIE),Goalie:(0,ki.x8)(Je.q.GOALIE),Defender:(0,ki.x8)(Je.q.DEFENDER),Midfielder:(0,ki.x8)(Je.q.MIDFIELDER),Attacker:(0,ki.x8)(Je.q.ATTACKER),Substitute:(0,ki.x8)(Je.q.SUBSTITUTE)},zo={goalie:"Goalkeeper",defender:"Defender",midfielder:"Midfielder",attacker:"Attacker",substitute:"Substitute"};function Vo(e){return e?Go[e]?Go[e]:function(e){if(!e)return console.warn("\u26a0\ufe0f  No starting role provided, defaulting to unknown"),(0,ki.x8)(Je.q.UNKNOWN);const t=(0,ki.GY)(e);if(t===Je.q.FIELD_PLAYER)return(0,ki.x8)(Je.q.DEFENDER);return(0,ki.x8)(t)}(e):null}function Ho(e){const t=["matchDurationSeconds","goalsScored","goalsConceded","outcome"].filter(t=>void 0===e[t]||null===e[t]);return{valid:0===t.length,missingFields:t.length>0?t:void 0}}async function Ko(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];try{const n=["teamId","format","formation","periods","periodDurationMinutes","type","venueType"].filter(t=>!e[t]);if(n.length>0)return{success:!1,error:"Missing required fields: ".concat(n.join(", "))};const r={team_id:e.teamId,format:e.format,formation:e.formation,periods:e.periods,period_duration_minutes:e.periodDurationMinutes,type:e.type,opponent:e.opponent||null,captain:e.captainId||null,venue_type:e.venueType,state:"pending"},{data:s,error:i}=await Ur.from("match").insert(r).select("id").single();if(i)return console.error("\u274c Failed to create match:",i),{success:!1,error:"Database error: ".concat(i.message)};let o=0;if(t&&t.length>0){const n=Array.isArray(a)&&a.length>0?t.filter(e=>a.includes(e.id)):t,r=await async function(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];try{const r=(Array.isArray(n)&&n.length>0?t.filter(e=>n.includes(e.id)):t).map(t=>rl(t,e,a)).filter(e=>null!==e);if(0===r.length)return console.warn("\u26a0\ufe0f  No initial player stats to insert - no players participating?"),{success:!0,inserted:0};const{data:s,error:i}=await Ur.from("player_match_stats").insert(r).select("id");return i?(console.error("\u274c Failed to insert initial player match stats:",i),{success:!1,error:"Database error: ".concat(i.message)}):{success:!0,inserted:(null===s||void 0===s?void 0:s.length)||0}}catch(i){return console.error("\u274c Exception while inserting initial player match stats:",i),{success:!1,error:"Unexpected error: ".concat(i.message)}}}(s.id,n,e.captainId,a);r.success?o=r.inserted:console.warn("\u26a0\ufe0f  Match created but failed to insert initial player stats:",r.error)}return{success:!0,matchId:s.id,playerStatsInserted:o}}catch(n){return console.error("\u274c Exception while creating match:",n),{success:!1,error:"Unexpected error: ".concat(n.message)}}}async function Wo(e,t){if(e)try{const a={type:"match_created",matchTime:"00:00",periodNumber:0,data:{ownTeamName:t.ownTeamName||null,opponentTeamName:t.opponentTeamName||null,totalPeriods:t.totalPeriods||null,periodDurationMinutes:t.periodDurationMinutes||null}};await Bo.persistEvent(a,e)}catch(a){console.warn("Failed to log match_created event:",a)}else console.warn("Cannot log match_created event: missing matchId")}async function Yo(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];try{const s=Ho(t);if(!s.valid)return{success:!1,error:"Missing required final stats: ".concat(s.missingFields.join(", "))};const i={state:"finished",finished_at:(new Date).toISOString(),match_duration_seconds:t.matchDurationSeconds,goals_scored:t.goalsScored,goals_conceded:t.goalsConceded,outcome:t.outcome,fair_play_award:t.fairPlayAwardId||null};let o={success:!0,updated:0,total:0,failures:[]};if(a&&a.length>0&&(o=await async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];try{const r=t.filter(e=>{var t,a;return(null===(t=e.stats)||void 0===t?void 0:t.startedMatchAs)||(null===(a=e.stats)||void 0===a?void 0:a.startedAtPosition)});if(0===r.length)return console.warn("\u26a0\ufe0f  No player stats to update - no players participated?"),{success:!0,updated:0,total:0,failures:[]};let s=0;const i=[];for(const t of r){const r=sl(t,e,a,n);if(!r)continue;const o={goals_scored:r.goals_scored,goalie_time_seconds:r.goalie_time_seconds,defender_time_seconds:r.defender_time_seconds,midfielder_time_seconds:r.midfielder_time_seconds,attacker_time_seconds:r.attacker_time_seconds,substitute_time_seconds:r.substitute_time_seconds,total_field_time_seconds:r.total_field_time_seconds,got_fair_play_award:r.got_fair_play_award,updated_at:(new Date).toISOString()},{error:l}=await Ur.from("player_match_stats").update(o).eq("match_id",e).eq("player_id",t.id);l?i.push({playerId:t.id,error:l.message}):s++}return i.length>0&&console.warn("\u26a0\ufe0f  Failed to update ".concat(i.length," of ").concat(r.length," player stats."),{failures:i}),{success:0===i.length,updated:s,total:r.length,failures:i}}catch(c){return console.error("\u274c Exception while updating player match stats:",c),{success:!1,error:"Unexpected error: ".concat(c.message)}}}(e,a,n,r),!o.success))return console.warn("\u26a0\ufe0f  Failed to update player stats before finishing match:",o.error),{success:!1,matchUpdated:!1,playerStats:o,error:o.error||"errors.playerStatsUpdateFailed"};const{data:l,error:c}=await Ur.from("match").update(i).eq("id",e).is("deleted_at",null).eq("state","running").select("id");return c?(console.error("\u274c Failed to update match to finished:",c),{success:!1,matchUpdated:!1,playerStats:o,error:"Database error: ".concat(c.message)}):l&&0!==l.length?{success:!0,matchUpdated:!0,playerStatsUpdated:o.updated,playerStats:o}:{success:!1,matchUpdated:!1,playerStats:o,error:"errors.matchUpdateFailed"}}catch(s){return console.error("\u274c Exception while updating match to finished:",s),{success:!1,error:"Unexpected error: ".concat(s.message)}}}async function Jo(e){let{fairPlayAwardId:t,fairPlayAwardName:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{if(!e)return{success:!1,error:"Match ID is required"};const n={};if(void 0!==t&&(n.fair_play_award=t),0===Object.keys(n).length)return{success:!0};const{data:r,error:s}=await Ur.from("match").update(n).eq("id",e).is("deleted_at",null).eq("state","finished").select("id");if(s)return console.error("\u274c Failed to update finished match metadata:",s),{success:!1,error:"Database error: ".concat(s.message)};if(!r||0===r.length)return console.warn("\u26a0\ufe0f  No finished match found to update for matchId=".concat(e)),{success:!1,error:"errors.matchNotFinished"};if(void 0!==t){const n=await async function(e,t){try{const{error:a}=await Ur.from("player_match_stats").update({got_fair_play_award:!1}).eq("match_id",e);if(a)return console.error("\u274c Failed to clear existing fair play awards:",a),{success:!1,error:"Database error: ".concat(a.message)};if(!t)return{success:!0,updated:0};const{data:n,error:r}=await Ur.from("player_match_stats").update({got_fair_play_award:!0}).eq("match_id",e).eq("player_id",t).select("id");return r?(console.error("\u274c Failed to update fair play award in player stats:",r),{success:!1,error:"Database error: ".concat(r.message)}):n&&0!==n.length?{success:!0,updated:(null===n||void 0===n?void 0:n.length)||0}:(console.error("\u274c No player match stats rows updated with fair play award for match:",e),{success:!1,error:"errors.fairPlayNoStats"})}catch(s){return console.error("\u274c Exception while updating fair play award in player stats:",s),{success:!1,error:"Unexpected error: ".concat(s.message)}}}(e,t);if(!n.success)return console.error("\u274c Failed to persist fair play award update for finished match:",n.error),{success:!1,error:n.error||"errors.fairPlayAwardFailed"};t?await Bo.persistEvent({type:wo.FAIR_PLAY_AWARD,timestamp:Date.now(),matchTime:"00:00",periodNumber:1,data:{playerId:t,display_name:a||null,playerName:a||null},player_id:t},e):await Ur.from("match_log_event").delete().eq("match_id",e).eq("event_type","fair_play_award")}return{success:!0}}catch(n){return console.error("\u274c Exception while updating finished match metadata:",n),{success:!1,error:"Unexpected error: ".concat(n.message)}}}async function Qo(e){try{if(!e)return{success:!1,error:"Team ID is required"};const{data:t,error:a}=await Ur.from("match").select("id, opponent, state, created_at, started_at, type, venue_type, upcoming_match(match_date, match_time)").eq("team_id",e).in("state",["pending","running"]).is("deleted_at",null).order("created_at",{ascending:!1});if(a)return console.error("Failed to get active matches:",a),{success:!1,error:"Database error: ".concat(a.message)};return{success:!0,matches:(t||[]).map(e=>{const t=Array.isArray(e.upcoming_match)?e.upcoming_match[0]||null:e.upcoming_match||null,a={id:e.id,opponent:e.opponent||"Internal Match",state:e.state,createdAt:e.created_at,startedAt:e.started_at,type:e.type,venueType:e.venue_type};return null!==t&&void 0!==t&&t.match_date&&(a.matchDate=t.match_date),null!==t&&void 0!==t&&t.match_time&&(a.matchTime=t.match_time),a})}}catch(t){return console.error("Exception while getting active matches:",t),{success:!1,error:"Unexpected error: ".concat(t.message)}}}async function $o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{if(!e)return{success:!1,error:"Team ID is required"};let n=Ur.from("match").select("\n        id,\n        started_at,\n        opponent,\n        goals_scored,\n        goals_conceded,\n        venue_type,\n        type,\n        outcome,\n        format,\n        formation,\n        periods,\n        period_duration_minutes,\n        captain,\n        player_match_stats (\n        player:player_id (\n          id,\n          display_name,\n          first_name\n        )\n      )\n      ").eq("team_id",e).eq("state","finished").is("deleted_at",null).order("started_at",{ascending:!1});if(t&&(n=n.gte("started_at",t.toISOString())),a){const e=new Date(a);e.setDate(e.getDate()+1),n=n.lt("started_at",e.toISOString())}const{data:r,error:s}=await n;if(s)return console.error("\u274c Failed to get finished matches:",s),{success:!1,error:"Database error: ".concat(s.message)};return{success:!0,matches:(r||[]).map(e=>{const t=e.player_match_stats.filter(e=>e.player).map(e=>e.player.display_name||e.player.first_name||"Unknown Player");return{id:e.id,date:e.started_at,opponent:e.opponent||"Unknown",goalsScored:e.goals_scored,goalsConceded:e.goals_conceded,venueType:e.venue_type,type:e.type.charAt(0).toUpperCase()+e.type.slice(1),outcome:"win"===e.outcome?"W":"draw"===e.outcome?"D":"L",format:e.format,players:t}})}}catch(n){return console.error("\u274c Exception while getting finished matches:",n),{success:!1,error:"Unexpected error: ".concat(n.message)}}}async function Xo(e){try{if(!e)return{success:!1,error:"Match ID is required"};const{data:t,error:a}=await Ur.from("match").select("\n        id,\n        started_at,\n        opponent,\n        goals_scored,\n        goals_conceded,\n        venue_type,\n        type,\n        outcome,\n        format,\n        formation,\n        periods,\n        period_duration_minutes,\n        match_duration_seconds,\n        captain\n      ").eq("id",e).is("deleted_at",null).single();if(a)return console.error("\u274c Failed to get match details:",a),{success:!1,error:"Database error: ".concat(a.message)};const{data:n,error:r}=await Ur.from("player_match_stats").select("\n        player:player_id (\n          id,\n          display_name,\n          first_name\n        ),\n        goals_scored,\n        goalie_time_seconds,\n        defender_time_seconds,\n        midfielder_time_seconds,\n        attacker_time_seconds,\n        substitute_time_seconds,\n        total_field_time_seconds,\n        started_as,\n        was_captain,\n        got_fair_play_award\n      ").eq("match_id",e);if(r)return console.error("\u274c Failed to get player stats:",r),{success:!1,error:"Database error: ".concat(r.message)};const s=new Date(t.started_at),i="string"===typeof t.type?t.type.toLowerCase():"league",o={id:t.id,date:s.toISOString().split("T")[0],time:s.toTimeString().slice(0,5),type:i,opponent:t.opponent||"Unknown",goalsScored:t.goals_scored,goalsConceded:t.goals_conceded,venueType:t.venue_type,outcome:"win"===t.outcome?"W":"draw"===t.outcome?"D":"L",format:t.format,periods:t.periods,periodDuration:t.period_duration_minutes,matchDurationSeconds:t.match_duration_seconds,formation:t.formation};return{success:!0,match:o,playerStats:n.filter(e=>e.player).map((e,t)=>{const a=e.player.display_name||e.player.first_name||"Unnamed Player";return{id:t+1,playerId:e.player.id,displayName:a,goalsScored:e.goals_scored||0,totalTimePlayed:(e.total_field_time_seconds||0)/60,timeAsDefender:(e.defender_time_seconds||0)/60,timeAsMidfielder:(e.midfielder_time_seconds||0)/60,timeAsAttacker:(e.attacker_time_seconds||0)/60,timeAsGoalkeeper:(e.goalie_time_seconds||0)/60,startingRole:(n=e.started_as,n?zo[n]?zo[n]:n.charAt(0).toUpperCase()+n.slice(1):"Unknown"),wasCaptain:e.was_captain||!1,receivedFairPlayAward:e.got_fair_play_award||!1};var n})}}catch(t){return console.error("\u274c Exception while getting match details:",t),{success:!1,error:"Unexpected error: ".concat(t.message)}}}async function Zo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};try{if(!e)return{success:!1,error:"Team ID is required"};const s=e=>e instanceof Date&&!Number.isNaN(e.getTime())?new Date(e.getFullYear(),e.getMonth(),e.getDate()):null,i=e=>e instanceof Date&&!Number.isNaN(e.getTime())?new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999):null,o=e=>Array.isArray(e)?e:[],l={typeFilter:o(r.typeFilter),outcomeFilter:o(r.outcomeFilter),venueFilter:o(r.venueFilter),opponentFilter:o(r.opponentFilter),playerFilter:o(r.playerFilter),formatFilter:o(r.formatFilter)},c=s(t),d=i(a),u=e=>e&&"string"===typeof e?e.charAt(0).toUpperCase()+e.slice(1):null,m=e=>e?"win"===e?"W":"draw"===e?"D":"loss"===e?"L":e:null;let h=Ur.from("player_match_stats").select("\n        player_id,\n        goals_scored,\n        goalie_time_seconds,\n        defender_time_seconds,\n        midfielder_time_seconds,\n        attacker_time_seconds,\n        total_field_time_seconds,\n        started_as,\n        was_captain,\n        got_fair_play_award,\n        match:match_id (\n          id,\n          team_id,\n          state,\n          deleted_at,\n          started_at,\n          type,\n          outcome,\n          venue_type,\n          opponent,\n          format\n        ),\n        player:player_id (\n          id,\n          display_name,\n          first_name,\n          team_id,\n          match_id\n        )\n      ");const{data:p,error:f}=await h;if(f)return console.error("\u274c Failed to get player stats:",f),{success:!1,error:"Database error: ".concat(f.message)};const g=new Map;(p||[]).forEach(t=>{var a,n;if(!t.match||t.match.team_id!==e||"finished"!==t.match.state||null!==t.match.deleted_at)return;const r=t.match.id;if(!r)return;const s=g.get(r)||{id:r,date:t.match.started_at,type:u(t.match.type),outcome:m(t.match.outcome),venueType:t.match.venue_type,opponent:t.match.opponent||"Unknown",format:t.match.format,players:new Set},i=(null===(a=t.player)||void 0===a?void 0:a.display_name)||(null===(n=t.player)||void 0===n?void 0:n.first_name);i&&s.players.add(i),g.set(r,s)});const v=(p||[]).filter(t=>{if(!t.match||!t.player)return!1;if(t.match.team_id!==e)return!1;if("finished"!==t.match.state)return!1;if(null!==t.match.deleted_at)return!1;if(null!==t.player.match_id&&void 0!==t.player.match_id)return!1;if(c||d){const e=new Date(t.match.started_at);if(c&&e<c)return!1;if(d&&e>d)return!1}const a=g.get(t.match.id);if(!a)return!1;return!!bo((0,n.A)((0,n.A)({},a),{},{players:Array.from(a.players)}),(0,n.A)((0,n.A)({},l),{},{startDate:c,endDate:d}))}),y=new Map;v.forEach(e=>{const t=e.player_id;if(!y.has(t)){const a=e.player.display_name||e.player.first_name||"Unnamed Player";y.set(t,{playerId:t,displayName:a,matchesPlayed:0,goalsScored:0,totalDefenderSeconds:0,totalMidfielderSeconds:0,totalAttackerSeconds:0,totalGoalieSeconds:0,totalFieldTimeSeconds:0,substituteStarts:0,matchesAsCaptain:0,fairPlayAwards:0})}const a=y.get(t);a.matchesPlayed+=1,a.goalsScored+=e.goals_scored||0,a.totalDefenderSeconds+=e.defender_time_seconds||0,a.totalMidfielderSeconds+=e.midfielder_time_seconds||0,a.totalAttackerSeconds+=e.attacker_time_seconds||0,a.totalGoalieSeconds+=e.goalie_time_seconds||0,a.totalFieldTimeSeconds+=e.total_field_time_seconds||0,"substitute"===e.started_as&&(a.substituteStarts+=1),e.was_captain&&(a.matchesAsCaptain+=1),e.got_fair_play_award&&(a.fairPlayAwards+=1)});return{success:!0,players:Array.from(y.values()).map(e=>{const t=e.totalDefenderSeconds+e.totalMidfielderSeconds+e.totalAttackerSeconds,a=e.matchesPlayed>0?e.totalFieldTimeSeconds/60/e.matchesPlayed:0,n=e.matchesPlayed>0?e.substituteStarts/e.matchesPlayed*100:0,r=t>0?e.totalDefenderSeconds/t*100:0,s=t>0?e.totalMidfielderSeconds/t*100:0,i=t>0?e.totalAttackerSeconds/t*100:0,o=e.totalGoalieSeconds+e.totalFieldTimeSeconds>0?e.totalGoalieSeconds/(e.totalGoalieSeconds+e.totalFieldTimeSeconds)*100:0;return{id:e.playerId,displayName:e.displayName,matchesPlayed:e.matchesPlayed,goalsScored:e.goalsScored,totalFieldTimeSeconds:e.totalFieldTimeSeconds,averageTimePerMatch:a,percentStartedAsSubstitute:Math.round(10*n)/10,percentTimeAsDefender:Math.round(10*r)/10,percentTimeAsMidfielder:Math.round(10*s)/10,percentTimeAsAttacker:Math.round(10*i)/10,percentTimeAsGoalkeeper:Math.round(10*o)/10,matchesAsCaptain:e.matchesAsCaptain,fairPlayAwards:e.fairPlayAwards}})}}catch(s){return console.error("\u274c Exception while getting player stats:",s),{success:!1,error:"Unexpected error: ".concat(s.message)}}}function el(e,t){return e>t?"win":e<t?"loss":"draw"}function tl(e,t){const{teamConfig:a,selectedFormation:n,periods:r=3,periodDurationMinutes:s=15,opponentTeam:i,captainId:o,matchType:l="league",venueType:c=Fs.DEFAULT_VENUE_TYPE,teamName:d}=e,u=(null===a||void 0===a?void 0:a.format)||xi.FORMATS.FORMAT_5V5,m=xi.FORMAT_CONFIGS[u]||xi.FORMAT_CONFIGS[xi.FORMATS.FORMAT_5V5],h=(null===m||void 0===m?void 0:m.defaultFormation)||xi.FORMATIONS.FORMATION_2_2;return{teamId:t,format:(null===a||void 0===a?void 0:a.format)||xi.FORMATS.FORMAT_5V5,formation:n||(null===a||void 0===a?void 0:a.formation)||h,periods:r,periodDurationMinutes:s,type:l,opponent:i||null,captainId:o||null,venueType:c||Fs.DEFAULT_VENUE_TYPE,teamName:d||null}}function al(e,t){const{ownScore:a,opponentScore:n,allPlayers:r}=e,s=r.find(e=>e.hasFairPlayAward);return{matchDurationSeconds:t,goalsScored:a||0,goalsConceded:n||0,outcome:el(a||0,n||0),fairPlayAwardId:(null===s||void 0===s?void 0:s.id)||null}}function nl(e){if(!e)return console.warn("\u26a0\ufe0f  No position provided to mapFormationPositionToRole"),(0,ki.x8)(Je.q.UNKNOWN);switch(e){case"goalie":return(0,ki.x8)(Je.q.GOALIE);case"leftDefender":case"rightDefender":case"defender":return(0,ki.x8)(Je.q.DEFENDER);case"left":case"right":case"leftMidfielder":case"rightMidfielder":case"centerMidfielder":return(0,ki.x8)(Je.q.MIDFIELDER);case"leftAttacker":case"rightAttacker":case"attacker":return(0,ki.x8)(Je.q.ATTACKER);case"substitute":case"substitute_1":case"substitute_2":case"substitute_3":case"substitute_4":case"substitute_5":return(0,ki.x8)(Je.q.SUBSTITUTE);default:return console.warn("\u26a0\ufe0f  Unexpected position value:",e),(0,ki.x8)(Je.q.UNKNOWN)}}function rl(e,t,a){var n,r,s,i,o;if((null===(n=e.stats)||void 0===n||!n.startedMatchAs)&&(null===(r=e.stats)||void 0===r||!r.startedAtPosition))return null;let l;return l=null!==(s=e.stats)&&void 0!==s&&s.startedAtRole?(0,ki.x8)(e.stats.startedAtRole):null!==(i=e.stats)&&void 0!==i&&i.startedAtPosition?nl(e.stats.startedAtPosition,e.stats.currentRole):(0,ki.x8)(Je.q.UNKNOWN),{player_id:e.id,match_id:t,started_as:l,was_captain:e.id===a||(null===(o=e.stats)||void 0===o?void 0:o.isCaptain)||!1,goals_scored:0,goalie_time_seconds:0,defender_time_seconds:0,midfielder_time_seconds:0,attacker_time_seconds:0,substitute_time_seconds:0,total_field_time_seconds:0,got_fair_play_award:!1}}function sl(e,t){var a,n,r;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(null===(a=e.stats)||void 0===a||!a.startedMatchAs)return null;const o=Math.max(0,e.stats.timeOnFieldSeconds||0),l=function(e,t,a){const n="goal_scored",r="goal_conceded";let s=0;return t&&Array.isArray(t)&&t.forEach(t=>{var i;t.type!==n&&t.type!==r||t.undone||(e[t.id]||(null===(i=t.data)||void 0===i?void 0:i.scorerId))===a&&s++}),0===s&&e&&"object"===typeof e&&(s=Object.values(e).filter(e=>e===a).length),s}(s,i,e.id);let c;return c=null!==(n=e.stats)&&void 0!==n&&n.startedAtRole?(0,ki.x8)(e.stats.startedAtRole):null!==(r=e.stats)&&void 0!==r&&r.startedAtPosition?nl(e.stats.startedAtPosition,e.stats.currentRole):(0,ki.x8)(Je.q.UNKNOWN),{player_id:e.id,match_id:t,goals_scored:l,goalie_time_seconds:e.stats.timeAsGoalieSeconds||0,defender_time_seconds:e.stats.timeAsDefenderSeconds||0,midfielder_time_seconds:e.stats.timeAsMidfielderSeconds||0,attacker_time_seconds:e.stats.timeAsAttackerSeconds||0,substitute_time_seconds:e.stats.timeAsSubSeconds||0,total_field_time_seconds:o,started_as:c,was_captain:e.stats.isCaptain||!1,got_fair_play_award:e.hasFairPlayAward||!1}}async function il(e,t){try{const a=["teamId","format","formation","periods","periodDurationMinutes","type","venueType"].filter(e=>!t[e]);if(a.length>0)return{success:!1,error:"Missing required fields: ".concat(a.join(", "))};if(!e)return{success:!1,error:"Match ID is required"};const n={format:t.format,formation:t.formation,periods:t.periods,period_duration_minutes:t.periodDurationMinutes,type:t.type,opponent:t.opponent||null,captain:t.captainId||null,venue_type:t.venueType,updated_at:(new Date).toISOString()},{error:r}=await Ur.from("match").update(n).eq("id",e).is("deleted_at",null).eq("state","pending");return r?(console.warn("\u26a0\ufe0f  Failed to update existing match:",r),{success:!1,error:"Database error: ".concat(r.message)}):{success:!0}}catch(a){return console.warn("\u26a0\ufe0f  Exception while updating existing match:",a),{success:!1,error:"Unexpected error: ".concat(a.message)}}}async function ol(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;try{if(!e)return{success:!1,error:"Match ID is required"};let r=t;n&&Array.isArray(n)&&n.length>0&&(r=t.filter(e=>n.includes(e.id)));const s=r.map(t=>rl(t,e,a)).filter(e=>null!==e);if(0===s.length)return{success:!0,inserted:0,updated:0};const{data:i,error:o}=await Ur.from("player_match_stats").upsert(s,{onConflict:"match_id,player_id"}).select("id");return o?(console.error("\u274c Failed to upsert player match stats:",o),{success:!1,error:"Database error: ".concat(o.message)}):{success:!0,inserted:(null===i||void 0===i?void 0:i.length)||0,updated:(null===i||void 0===i?void 0:i.length)||0}}catch(r){return console.warn("\u26a0\ufe0f  Exception while upserting player match stats:",r),{success:!1,error:"Unexpected error: ".concat(r.message)}}}async function ll(e,t){try{if(!e)return{success:!1,error:"Match ID is required"};if(!t||"object"!==typeof t)return{success:!1,error:"errors.configRequired"};const i=(0,n.A)({},t);if(t.formation&&t.teamConfig&&t.squadSelection){var a,r,s;const e={format:null===(a=t.teamConfig)||void 0===a?void 0:a.format,formation:null===(r=t.teamConfig)||void 0===r?void 0:r.formation,squadSize:null===(s=t.teamConfig)||void 0===s?void 0:s.squadSize};i.formation=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!e||!t)return yo(t);const n=yo(t),r=new Set(a),s=e=>!e||a.length>0&&!r.has(e)?null:e;n.goalie=s(e.goalie);const i=vo(t);return i&&((i.fieldPositions||[]).forEach(t=>{n[t]=s(e[t])}),(i.substitutePositions||[]).forEach(t=>{const a="substitute_1"===t&&e.substitute?"substitute":t;n[t]=s(e[a])})),n}(t.formation,e,t.squadSelection)}const{error:o}=await Ur.from("match").update({initial_config:i,updated_at:(new Date).toISOString()}).eq("id",e).is("deleted_at",null).eq("state","pending");return o?(console.error("\u274c Failed to save initial match config:",o),{success:!1,error:"Database error: ".concat(o.message)}):{success:!0}}catch(i){return console.error("\u274c Exception while saving initial match config:",i),{success:!1,error:"Unexpected error: ".concat(i.message)}}}async function cl(e){try{if(!e)return{success:!1,error:"Match ID is required"};await Ur.from("player_match_stats").delete().eq("match_id",e);const t=(new Date).toISOString(),{error:a}=await Ur.from("match").update({deleted_at:t},{returning:"minimal"}).eq("id",e).is("deleted_at",null).eq("state","pending");return a?(console.error("\u274c Failed to discard pending match:",a),{success:!1,error:"Database error: ".concat(a.message)}):{success:!0}}catch(t){return console.error("\u274c Exception while discarding pending match:",t),{success:!1,error:"Unexpected error: ".concat(t.message)}}}function dl(e,t,a){const n=Math.round(60*(a.timeAsDefender||0)),r=Math.round(60*(a.timeAsMidfielder||0)),s=Math.round(60*(a.timeAsAttacker||0)),i=Math.round(60*(a.timeAsGoalkeeper||0)),o=n+r+s,l=a.startingRole?Vo(a.startingRole):null;return{match_id:e,player_id:t,goals_scored:a.goalsScored,defender_time_seconds:n,midfielder_time_seconds:r,attacker_time_seconds:s,goalie_time_seconds:i,total_field_time_seconds:o,started_as:l,was_captain:a.wasCaptain,got_fair_play_award:a.receivedFairPlayAward,updated_at:(new Date).toISOString()}}function ul(e){const{formation:t,teamConfig:a,matchData:n,matchType:r,venueType:s=Fs.DEFAULT_VENUE_TYPE,opponentTeam:i,numPeriods:o,periodDurationMinutes:l,captainId:c,periodGoalieIds:d,selectedSquadIds:u}=e,m=function(e){return{format:e.format,formation:e.formation,squadSize:e.squadSize}}(a);return{formation:t,teamConfig:m,matchConfig:{format:n.format,matchType:r,venueType:s,opponentTeam:i,periods:o,periodDurationMinutes:l,captainId:c},periodGoalies:d,squadSelection:u}}async function ml(e){const{teamConfig:t,selectedFormation:a,numPeriods:n,periodDurationMinutes:r,opponentTeam:s,captainId:i,matchType:o,venueType:l=Fs.DEFAULT_VENUE_TYPE,formation:c,periodGoalieIds:d,selectedSquadIds:u,allPlayers:m,currentTeam:h,currentMatchId:p,matchCreated:f,setCurrentMatchId:g,setMatchCreated:v}=e;if(null===h||void 0===h||!h.id)return{success:!1,error:"Team context required for saving configuration."};try{var y;const e=tl({teamConfig:t,selectedFormation:a,periods:n,periodDurationMinutes:r,opponentTeam:(null===s||void 0===s?void 0:s.trim())||null,captainId:i,matchType:o,venueType:l,teamName:(null===(y=h.club)||void 0===y?void 0:y.name)||null},h.id),b=ul({formation:c,teamConfig:t,matchData:e,matchType:o,venueType:l,opponentTeam:s,numPeriods:n,periodDurationMinutes:r,captainId:i,periodGoalieIds:d,selectedSquadIds:u});let x;return x=p&&f?await async function(e){const{matchId:t,matchData:a,initialConfig:n}=e;try{const e=await il(t,a);return e.success?(ll(t,n).catch(e=>{console.warn("\u26a0\ufe0f Failed to update initial match config:",e)}),{success:!0}):(console.warn("\u26a0\ufe0f Failed to update pending match:",e.error),{success:!1,error:e.error})}catch(r){return console.error("\u274c Error updating match configuration:",r),{success:!1,error:"Failed to update match configuration: ".concat(r.message)}}}({matchId:p,matchData:e,initialConfig:b}):await async function(e){const{matchData:t,allPlayers:a,selectedSquadIds:n=[],initialConfig:r,setCurrentMatchId:s,setMatchCreated:i}=e;try{const e=await Ko(t,a,n);return e.success?(s(e.matchId),i(!0),Wo(e.matchId,{ownTeamName:t.teamName||null,opponentTeamName:t.opponent||null,totalPeriods:t.periods||null,periodDurationMinutes:t.periodDurationMinutes||null}).catch(e=>{console.warn("\u26a0\ufe0f Failed to log match_created event:",e)}),ll(e.matchId,r).catch(e=>{console.warn("\u26a0\ufe0f Failed to save initial match config:",e)}),{success:!0,matchId:e.matchId}):(console.warn("\u26a0\ufe0f Failed to create pending match:",e.error),{success:!1,error:e.error})}catch(o){return console.error("\u274c Error creating new match configuration:",o),{success:!1,error:"Failed to create match configuration: ".concat(o.message)}}}({matchData:e,allPlayers:m,selectedSquadIds:u,initialConfig:b,setCurrentMatchId:g,setMatchCreated:v}),x.success?{success:!0,matchId:x.matchId||p,message:"Configuration ".concat(p?"updated":"saved"," successfully")}:{success:!1,error:x.error}}catch(b){return console.error("\u274c Error managing match configuration:",b),{success:!1,error:"Failed to save configuration: ".concat(b.message)}}}const hl=Gs(Br.GAME_STATE);function pl(t){let{isLive:a=!1,pollingEnabled:n,refreshIntervalMs:r=6e4}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{t:s}=xe("common"),[i,o]=(0,e.useState)([]),[l,c]=(0,e.useState)(0),[d,u]=(0,e.useState)(!0),[m,h]=(0,e.useState)(null),[p,f]=(0,e.useState)(null),g=(0,e.useRef)(l),v="https://cyjdmcdmdercyxoojkvl.supabase.co",y="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN5amRtY2RtZGVyY3l4b29qa3ZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUzNTI1MTksImV4cCI6MjA3MDkyODUxOX0.MkjyGrTOud4xSr-PrATGkOFTLKjZzx6eoAsDaVsEVzk",b=(0,e.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const a=new URL("".concat(v,"/functions/v1/get-live-match-events"));a.searchParams.set("match_id",t),null!==e&&a.searchParams.set("since_ordinal",e.toString());const n=await fetch(a.toString(),{method:"GET",headers:{"Content-Type":"application/json",apikey:y,Authorization:"Bearer ".concat(y)}});if(!n.ok){const e=await n.json();throw new Error(e.message||"Failed to fetch events")}const r=await n.json();o(null!==e?e=>[...e,...r.events||[]]:r.events||[]),c(r.latest_ordinal||0),f(new Date),h(null)}catch(a){console.error("Failed to fetch match events:",a),h(a.message)}finally{u(!1)}},[t,y,v,s]);(0,e.useEffect)(()=>{o([]),c(0),h(null),u(!0),f(null)},[t]),(0,e.useEffect)(()=>{b()},[b]),(0,e.useEffect)(()=>{g.current=l},[l]);const x="boolean"===typeof n?n:a;return(0,e.useEffect)(()=>{if(!x)return;const e=setInterval(()=>{b(g.current)},r);return()=>clearInterval(e)},[b,x,r]),{events:i,isLoading:d,error:m,lastUpdateTime:p,latestOrdinal:l,refreshEvents:b}}const fl=[{value:"bells-echo",label:"Bells Echo",fileUrl:a.p+"static/media/mixkit-alert-bells-echo-765.15ded8cd4ae5bc50940e.wav",isDefault:!0},{value:"quick-chime",label:"Quick Chime",fileUrl:a.p+"static/media/mixkit-alert-quick-chime-766.11acdad11362f71ed168.wav",isDefault:!1},{value:"flute",label:"Flute",fileUrl:a.p+"static/media/mixkit-uplifting-flute-notification-2317.df9fcaa1a84c2834e1c5.wav",isDefault:!1},{value:"arabian-harp",label:"Arabian Harp",fileUrl:a.p+"static/media/mixkit-arabian-mystery-harp-notification-2489.7e3b4cec1ea193998233.wav",isDefault:!1},{value:"announcement-tones",label:"Announcement Tones",fileUrl:a.p+"static/media/mixkit-clear-announce-tones-2861.37a86cf8dab0bb4ad46a.wav",isDefault:!1},{value:"happy-bells",label:"Happy Bells",fileUrl:a.p+"static/media/mixkit-happy-bells-notification-937.72d5668f672aa6c30075.wav",isDefault:!1},{value:"magic-marimba",label:"Magic Marimba",fileUrl:a.p+"static/media/mixkit-magic-marimba-2820.4f3a8de8f96baa96756a.wav",isDefault:!1},{value:"magic-ring",label:"Magic Ring",fileUrl:a.p+"static/media/mixkit-magic-notification-ring-2344.967413f5ea50b2bf51ac.wav",isDefault:!1},{value:"positive-note",label:"Positive Note",fileUrl:a.p+"static/media/mixkit-positive-notification-951.60f7268a006d7476452e.wav",isDefault:!1}],gl=[{value:"en",label:"English"},{value:"sv",label:"Svenska"}],vl=[{value:"dark-ocean",label:"Dark Ocean"}],yl={audio:{enabled:!0,selectedSound:"bells-echo",volume:.7},language:"en",theme:"dark-ocean"},bl=Br.PREFERENCES,xl=Bs(bl,{audio:{selectedSound:null}});const wl=new class{constructor(){this.audioElements=new Map,this.loadingPromises=new Map,this.selectedSound=null,this.hasTriggeredFullPreload=!1,this.initializeWithLazyLoading()}initializeWithLazyLoading(){var e,t;const a=(null===(e=fl.find(e=>e.isDefault))||void 0===e?void 0:e.value)||"bells-echo",n=xl.loadState();this.selectedSound=(null===(t=n.audio)||void 0===t?void 0:t.selectedSound)||a,this.preloadEssentialSounds()}preloadEssentialSounds(){var e;const t=(null===(e=fl.find(e=>e.isDefault))||void 0===e?void 0:e.value)||"bells-echo",a=[this.selectedSound];t!==this.selectedSound&&a.push(t),a.forEach(e=>{this.loadSound(e,!0)})}preloadAllSounds(){this.hasTriggeredFullPreload||(this.hasTriggeredFullPreload=!0,fl.forEach(e=>{this.audioElements.has(e.value)||this.loadSound(e.value,!1)}))}loadSound(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.audioElements.has(e))return Promise.resolve();if(this.loadingPromises.has(e))return this.loadingPromises.get(e);const a=fl.find(t=>t.value===e);if(!a)return Promise.reject(new Error("Sound not found: ".concat(e)));const n=new Promise((n,r)=>{try{const i=new Audio;if(i.preload=t?"auto":"metadata",i.src=a.fileUrl,i.addEventListener("error",t=>{this.loadingPromises.delete(e),r(new Error("Failed to load audio: ".concat(e)))}),i.addEventListener("canplaythrough",()=>{this.audioElements.set(e,i),this.loadingPromises.delete(e),n()}),t)try{"function"===typeof i.load&&i.load()}catch(s){}}catch(i){this.loadingPromises.delete(e),r(i)}});return this.loadingPromises.set(e,n),n}async play(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.7,a=this.audioElements.get(e);if(!a)try{if(await this.loadSound(e,!0),a=this.audioElements.get(e),!a)throw new Error("Failed to load sound: ".concat(e))}catch(n){throw new Error("Sound not found: ".concat(e))}a.volume=Math.max(0,Math.min(1,t));try{a.currentTime=0,await a.play()}catch(n){throw"NotAllowedError"===n.name?new Error("Audio playback blocked by browser. User interaction may be required."):"NotSupportedError"===n.name?new Error("Audio format not supported by browser"):new Error("Failed to play audio: ".concat(n.message))}}stop(e){const t=this.audioElements.get(e);t&&(t.pause(),t.currentTime=0)}stopAll(){this.audioElements.forEach(e=>{e.pause(),e.currentTime=0})}isAvailable(e){const t=this.audioElements.get(e);return t&&t.readyState>=HTMLMediaElement.HAVE_ENOUGH_DATA}isLoading(e){return this.loadingPromises.has(e)}isLoaded(e){return this.audioElements.has(e)}getAvailableSounds(){return fl}updateSelectedSound(e){this.selectedSound=e,this.audioElements.has(e)||this.loadSound(e,!0)}triggerFullPreload(){setTimeout(()=>{this.preloadAllSounds()},100)}getLoadingStatus(){const e={};return fl.forEach(t=>{e[t.value]={loaded:this.isLoaded(t.value),loading:this.isLoading(t.value),available:this.isAvailable(t.value)}}),e}cleanup(){this.stopAll(),this.audioElements.clear(),this.loadingPromises.clear(),this.hasTriggeredFullPreload=!1}};const Sl=["Anna","Bea","Cleo","Doris","Emma","Fanny","Gina","Hanna","Ingrid","Josefin","Katrin","Lina","Mona","Nina"],kl="goalie";const Nl=function(e){return e&&"object"===typeof e?Si(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null):null},jl=e=>{const{formation:t,nextPlayerIdToSubOut:a,allPlayers:r,rotationQueue:s,teamConfig:i,selectedFormation:o,isSubTimerPaused:l=!1,substitutionCount:c=1}=e,d=Ns(),u=go(i,o),m={formation:t,nextPlayerIdToSubOut:a,allPlayers:r,rotationQueue:s,currentTimeEpoch:d,isSubTimerPaused:l,substitutionCount:c};try{const t=u.executeSubstitution(m);return(0,n.A)((0,n.A)({},e),{},{formation:t.newFormation,allPlayers:t.updatedPlayers,rotationQueue:t.newRotationQueue||e.rotationQueue,nextPlayerIdToSubOut:void 0!==t.newNextPlayerIdToSubOut?t.newNextPlayerIdToSubOut:e.nextPlayerIdToSubOut,nextPlayerToSubOut:t.newNextPlayerToSubOut||e.nextPlayerToSubOut,playersToHighlight:t.playersComingOnIds||[],lastSubstitutionTimestamp:d,substitutionResult:t})}catch(h){return lo(h,{category:so.GAME_LOGIC,operation:"calculateSubstitution",teamConfig:i,selectedFormation:o,nextPlayerIdToSubOut:a}),e}},Tl=(e,t)=>{const{allPlayers:a,formation:r,rotationQueue:s,nextPlayerIdToSubOut:i,teamConfig:o,selectedFormation:l}=e;if(!(0,wi.supportsInactiveUsers)(o))return e;const c=Ui(a,t);if(!c)return e;const d=Nl(o,l);if(!d)return e;const u=c.stats.isInactive;if(!d.substitutePositions.includes(c.stats.currentPositionKey))return e;let m=(0,n.A)({},r),h=[...s],p=i,f=a.map(e=>e.id===t?(0,n.A)((0,n.A)({},e),{},{stats:(0,n.A)((0,n.A)({},e.stats),{},{isInactive:!u})}):e);if(u){const e=Li(s,Vi(a));e.initialize(),e.reactivatePlayer(t),h=e.toArray();const o=((e,t,a,n)=>{const r={formation:{},players:{}},s=[];t.forEach(t=>{const r=a[t];if(r){const a=n.find(e=>e.id===r);s.push({playerId:r,position:t,isActive:a&&!a.stats.isInactive,isReactivatedPlayer:r===e})}});const i=s.filter(e=>e.isActive&&!e.isReactivatedPlayer),o=s.filter(e=>!e.isActive&&!e.isReactivatedPlayer);r.formation[t[0]]=e,r.players[e]={currentPositionKey:t[0],isInactive:!1};for(let c=0;c<i.length;c++){const{playerId:e}=i[c],a=t[c+1];a&&(r.formation[a]=e,r.players[e]={currentPositionKey:a,isInactive:!1})}const l=i.length+1;for(let c=0;c<o.length;c++){const{playerId:e}=o[c],a=t[l+c];a&&(r.formation[a]=e,r.players[e]={currentPositionKey:a,isInactive:!0})}return r})(t,d.substitutePositions,r,f);Object.entries(o.formation).forEach(e=>{let[t,a]=e;m[t]=a}),f=f.map(e=>o.players[e.id]?(0,n.A)((0,n.A)({},e),{},{stats:(0,n.A)((0,n.A)({},e.stats),o.players[e.id])}):e);const l=e.getNextActivePlayer(2);p=l.length>0?l[0]:i}else{const e=Li(s,Vi(a));if(e.initialize(),e.deactivatePlayer(t),h=e.toArray(),t===i&&e.activeSize()>0){const t=e.getNextActivePlayer(2);t.length>0&&(p=t[0])}const l=(0,wi.getBottomSubstitutePosition)(o),u=c.stats.currentPositionKey;if(l&&u!==l){const e=d.substitutePositions,a=e.indexOf(u),s=e.indexOf(l);for(let t=a+1;t<=s;t++){const a=r[e[t]];if(a){const r=e[t-1];m[r]=a,f=f.map(e=>e.id===a?(0,n.A)((0,n.A)({},e),{},{stats:(0,n.A)((0,n.A)({},e.stats),{},{currentPositionKey:r})}):e)}}m[l]=t,f=f.map(e=>e.id===t?(0,n.A)((0,n.A)({},e),{},{stats:(0,n.A)((0,n.A)({},e.stats),{},{currentPositionKey:l})}):e)}}return(0,n.A)((0,n.A)({},e),{},{formation:m,allPlayers:f,rotationQueue:h,nextPlayerIdToSubOut:p,playersToHighlight:[]})},Al=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const{rotationQueue:r}=e;if(!r||0===r.length)return e;if(!r.slice(0,a).includes(t))return e;const s=r.filter(e=>e!==t),i=Math.min(a,s.length),o=[...s.slice(0,i),t,...s.slice(i)];return(0,n.A)((0,n.A)({},e),{},{rotationQueue:o,playersToHighlight:[t]})};async function _l(e){let{teamId:t,matchId:a,displayName:n}=e;try{if(!t||!a)return{success:!1,error:"Team ID and match ID are required"};if(!n||!n.trim())return{success:!1,error:"Player name is required"};const{displayName:e,firstName:r,lastName:s}=(e=>{const t=e.trim();if(t.length>100)throw new Error("Player name too long");const a=t.replace(/[<>]/g,"").trim();if(!a)throw new Error("Player name is required");const n=a.split(" ").filter(Boolean);return{displayName:a,firstName:n[0]||a,lastName:n.length>1?n.slice(1).join(" "):null}})(n),i={team_id:t,match_id:a,first_name:r,last_name:s,display_name:e,on_roster:!1,jersey_number:null},{data:o,error:l}=await Ur.from("player").insert(i).select().single();return l?(console.error("Failed to create temporary player:",l),{success:!1,error:l.message}):{success:!0,player:o}}catch(r){return console.error("Exception creating temporary player:",r),{success:!1,error:r.message}}}function Cl(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{allPlayers:a,selectedSquadIds:r,captainId:s}=(e=>{let t=e.allPlayers;return t&&0!==t.length||(t=qi(Sl)),e.captainId&&t&&(t=t.map(t=>(0,n.A)((0,n.A)({},t),{},{stats:(0,n.A)((0,n.A)({},t.stats),{},{isCaptain:t.id===e.captainId})}))),{allPlayers:t,selectedSquadIds:e.selectedSquadIds||[],captainId:e.captainId||null}})(t),[i,o]=(0,e.useState)(a),[l,c]=(0,e.useState)(r),[d,u]=(0,e.useState)(s);(0,e.useEffect)(()=>{o(d?e=>e.map(e=>(0,n.A)((0,n.A)({},e),{},{stats:(0,n.A)((0,n.A)({},e.stats),{},{isCaptain:e.id===d})})):e=>e.map(e=>(0,n.A)((0,n.A)({},e),{},{stats:(0,n.A)((0,n.A)({},e.stats),{},{isCaptain:!1})})))},[d]);const m=(0,e.useCallback)(e=>{c(t=>{const a="function"===typeof e?e(t):e;if(!Array.isArray(a))return console.warn("setSelectedSquadIds expects an array of player IDs"),t;const r=Array.from(new Set(a)),s=new Set(r),i=t.filter(e=>!s.has(e));i.length>0&&o(e=>e.map(e=>i.includes(e.id)?(e=>e&&e.stats?(0,n.A)((0,n.A)({},e),{},{stats:(0,n.A)((0,n.A)({},e.stats),{},{startedMatchAs:null,startedAtRole:null,startedAtPosition:null,startLocked:!1,currentRole:null,currentStatus:Je.P.SUBSTITUTE,currentPositionKey:null,lastStintStartTimeEpoch:null})}):e)(e):e));return t.length===r.length&&t.every((e,t)=>e===r[t])?t:r})},[o,c]),h=(0,e.useCallback)((e,t,a)=>{if(!e||!t.length)return;Object.values(e).some(e=>"string"===typeof e?e:!("object"!==typeof e||!e)&&(e.defender||e.attacker))&&o(r=>r.map(r=>{if(!t.includes(r.id))return r;const{currentRole:s,currentStatus:i,currentPositionKey:o}=(0,wi.initializePlayerRoleAndStatus)(r.id,e,a);return r.stats.currentRole!==s||r.stats.currentStatus!==i||r.stats.currentPositionKey!==o?(0,n.A)((0,n.A)({},r),{},{stats:(0,n.A)((0,n.A)({},r.stats),{},{currentRole:s,currentStatus:i,currentPositionKey:o})}):r}))},[]),p=(0,e.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{teamId:a,matchId:r}=t;if(!a||!r){const t="temp_".concat(Date.now()),[a]=qi([e]),r=(0,n.A)((0,n.A)({},a),{},{id:t,isTemporary:!0});return o(e=>[...e,r]),m(e=>[...e,t]),{success:!0,player:r}}const s=await _l({teamId:a,matchId:r,displayName:e});if(!s.success)return s;const i=(0,n.A)((0,n.A)({},Hs(s.player)),{},{isTemporary:!0,matchId:s.player.match_id||r});return o(e=>[...e,i]),m(e=>[...e,s.player.id]),{success:!0,player:i}},[o,m]),f=(0,e.useCallback)(e=>{u(e)},[]),g=(0,e.useCallback)(function(e,t,a,r,s,o){let l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;if(7!==t.squadSize)return null;const d=Ui(i,e);if(!d)return null;const u=d.stats.isInactive;if(!("substitute_1"===d.stats.currentPositionKey||"substitute_2"===d.stats.currentPositionKey))return null;if(!u){const t=a.substitute_1,n=a.substitute_2,r=Ui(i,e===t?n:t);if(null!==r&&void 0!==r&&r.stats.isInactive)return console.warn("Cannot inactivate player: would result in both substitutes being inactive"),null}l&&l(!u,d.stats.currentPositionKey);const m=()=>{if(u){return Tl({formation:a,allPlayers:i,teamConfig:t,rotationQueue:r,nextPlayerIdToSubOut:s,nextPlayerToSubOut:o},e)}{const l=i.map(t=>t.id===e?(0,n.A)((0,n.A)({},t),{},{stats:(0,n.A)((0,n.A)({},t.stats),{},{isInactive:!0})}):t);return{formation:a,allPlayers:l,teamConfig:t,rotationQueue:r,nextPlayerIdToSubOut:s,nextPlayerToSubOut:o}}};if(!(c>0))return m();setTimeout(()=>m(),c)},[i]),v=(0,e.useCallback)(e=>{try{const t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e=e||[],t=t||[];const a=new Set(e.map(e=>e&&e.id).filter(Boolean)),n=new Set(t.map(e=>e&&e.id).filter(Boolean)),r=e.filter(e=>e&&e.id&&!n.has(e.id)),s=t.filter(e=>e&&e.id&&!a.has(e.id));return{needsSync:r.length>0,missingFromGame:r,extraInGame:s,summary:"Team: ".concat(e.length,", Game: ").concat(t.length,", Missing: ").concat(r.length)}}(e,i);if(t.needsSync){const t=Ws(e,i);return t.success?(o(t.players),{success:!0,message:t.message}):{success:!1,error:t.error}}return{success:!0,message:"No sync needed"}}catch(t){return console.error("\u274c Player sync error:",t),{success:!1,error:t.message}}},[i]),y=(0,e.useCallback)(()=>{u(null)},[]);return{allPlayers:i,selectedSquadIds:l,captainId:d,setAllPlayers:o,setSelectedSquadIds:m,setCaptainId:u,addTemporaryPlayer:p,setCaptain:f,clearCaptain:y,togglePlayerInactive:g,syncPlayersFromTeamRoster:v,updatePlayerRolesFromFormation:h,getPlayerState:()=>({allPlayers:i,selectedSquadIds:l,captainId:d})}}const Ml=(0,e.createContext)({preferences:yl,audioPreferences:yl.audio,updatePreferences:async()=>{},updateAudioPreferences:async()=>{},updateLanguagePreference:async()=>{},updateThemePreference:async()=>{},resetPreferences:()=>{},resetAudioPreferences:()=>{},preferencesLoading:!0}),Pl=()=>{const t=(0,e.useContext)(Ml);if(!t)throw new Error("usePreferences must be used within a PreferencesProvider");return t},El=Bs(bl,yl),Il=Bs(Gr.AUDIO_PREFERENCES_LEGACY,{});function Rl(t){let{children:a}=t;const[r,s]=(0,e.useState)(yl),[i,o]=(0,e.useState)(!0);(0,e.useEffect)(()=>{(()=>{try{const e=El.loadState();if(e&&e.audio){const t={audio:(0,n.A)((0,n.A)({},yl.audio),e.audio),language:e.language||yl.language,theme:e.theme||yl.theme};s(t)}else{const e=Il.loadState();if(e&&Object.keys(e).length>0){const t={audio:(0,n.A)((0,n.A)({},yl.audio),e),language:yl.language,theme:yl.theme};El.saveState(t),Il.clearState(),s(t)}else s(yl)}}catch(e){}finally{o(!1)}})()},[]),(0,e.useEffect)(()=>{if(!i){El.saveState(r)||console.warn("\u26a0\ufe0f  Failed to save preferences to localStorage. Preferences may not persist between sessions.")}},[r,i]);const l=(0,e.useCallback)(e=>{"object"===typeof e&&null!==e&&s(t=>(0,n.A)((0,n.A)({},t),e))},[]),c=(0,e.useCallback)(e=>{"object"===typeof e&&null!==e&&s(t=>{const a=(0,n.A)((0,n.A)({},t.audio),e);"boolean"!==typeof a.enabled&&(a.enabled=t.audio.enabled),("number"!==typeof a.volume||a.volume<0||a.volume>1)&&(a.volume=t.audio.volume),"string"===typeof a.selectedSound&&a.selectedSound.trim()||(a.selectedSound=t.audio.selectedSound),e.selectedSound&&e.selectedSound!==t.audio.selectedSound&&wl.updateSelectedSound(e.selectedSound);return(0,n.A)((0,n.A)({},t),{},{audio:a})})},[]),d=(0,e.useCallback)(e=>{"string"===typeof e&&s(t=>(0,n.A)((0,n.A)({},t),{},{language:e}))},[]),u=(0,e.useCallback)(e=>{"string"===typeof e&&s(t=>(0,n.A)((0,n.A)({},t),{},{theme:e}))},[]),m=(0,e.useCallback)(()=>{s(yl)},[]),h=(0,e.useCallback)(()=>{s(e=>(0,n.A)((0,n.A)({},e),{},{audio:yl.audio}))},[]),p={preferences:r,audioPreferences:r.audio,preferencesLoading:i,updatePreferences:l,updateAudioPreferences:c,updateLanguagePreference:d,updateThemePreference:u,resetPreferences:m,resetAudioPreferences:h};return(0,Ts.jsx)(Ml.Provider,{value:p,children:a})}var Ol=a(150);const Dl=Gs(Br.GAME_STATE),Fl=(e,t,a)=>{const n=(0,wi.getModeDefinition)(a);if(!n)return null;const r=["goalie",...n.fieldPositions,...n.substitutePositions];for(const s of r)if(t[s]===e)return s;return null},Ll=e=>"matchReport"===e?bi.STATS:Object.values(bi).includes(e)?e:bi.CONFIG;function ql(){var t;const{t:a}=xe("game"),{currentTeam:r,updateMatchActivityStatus:s,loadTeamPreferences:i}=vi(),{audioPreferences:o}=Pl(),{requestWakeLock:l,releaseWakeLock:c,playAlertSounds:d}=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const[a,n]=(0,e.useState)(null),r=(0,e.useCallback)(async()=>{if("wakeLock"in navigator&&!a)try{const e=await navigator.wakeLock.request("screen");n(e)}catch(e){console.warn("Wake lock request failed:",e)}},[a]),s=(0,e.useCallback)(async()=>{if(a)try{await a.release(),n(null)}catch(e){console.warn("Wake lock release failed:",e)}},[a]),i=(0,e.useCallback)(async()=>{if("vibrate"in navigator)try{navigator.vibrate([1e3,200,1e3])}catch(e){}if(t.enabled)try{await wl.play(t.selectedSound,t.volume)}catch(e){console.error("[AUDIO_ALERT] Audio playback failed:",e.message)}},[t]);return{wakeLock:a,requestWakeLock:r,releaseWakeLock:s,playAlertSounds:i,hasWakeLock:!!a}}(o),[u]=(0,e.useState)(()=>Dl.loadState()),m=Cl(u),{allPlayers:h,selectedSquadIds:p,captainId:f,setAllPlayers:g,setSelectedSquadIds:v,setCaptainId:y,addTemporaryPlayer:b,setCaptain:x,clearCaptain:w,togglePlayerInactive:S,syncPlayersFromTeamRoster:k,updatePlayerRolesFromFormation:N}=m,[j,T]=(0,e.useState)(()=>Ll(u.view)),[A,_]=(0,e.useState)(u.numPeriods),[C,M]=(0,e.useState)(u.periodDurationMinutes),[P,E]=(0,e.useState)(u.periodGoalieIds),I=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{teamConfig:a,selectedFormation:r}=(e=>{let t=e.teamConfig;if(!t){var a;const n=(null===(a=e.teamConfig)||void 0===a?void 0:a.format)||xi.FORMATS.FORMAT_5V5;t=(0,xi.createDefaultTeamConfig)(7,n)}let n=t;try{const e=(0,xi.validateAndCorrectTeamConfig)(t);n=(null===e||void 0===e?void 0:e.correctedConfig)||t}catch(o){var r,s;console.warn("\u26a0\ufe0f Failed to validate existing team config, falling back to defaults:",o),n=(0,xi.createDefaultTeamConfig)((null===(r=t)||void 0===r?void 0:r.squadSize)||7,(null===(s=t)||void 0===s?void 0:s.format)||xi.FORMATS.FORMAT_5V5)}let i=e.selectedFormation;return!i&&n&&(i=n.formation||xi.FORMATIONS.FORMATION_2_2),{teamConfig:n,selectedFormation:i}})(t),[s,i]=(0,e.useState)(a),[o,l]=(0,e.useState)(r||xi.FORMATIONS.FORMATION_2_2),c=(0,e.useCallback)(e=>{console.log("\ud83d\udcdd updateTeamConfig called:",{fullNewConfig:e});const{isValid:t,correctedConfig:a,corrections:n}=(0,xi.validateAndCorrectTeamConfig)(e);!t&&n.length>0&&console.log("\u26a0\ufe0f TEAM CONFIG CORRECTED:",{original:e,corrected:a,corrections:n}),i(a)},[]),d=(0,e.useCallback)(e=>{if(console.log("\ud83d\udd04 updateFormationSelection called:",{newFormation:e,"teamConfig.squadSize":null===s||void 0===s?void 0:s.squadSize}),l(e),s){console.log("\ud83d\udd04 updateFormationSelection: Updating team config with new formation");const t=(0,n.A)((0,n.A)({},s),{},{formation:e});c(t)}},[s,c]),u=(0,e.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;console.log("\ud83d\udd27 createTeamConfigFromSquadSize called:",{squadSize:e,selectedFormation:o});const a=t||(null===s||void 0===s?void 0:s.format)||xi.FORMATS.FORMAT_5V5,n=(0,xi.createTeamConfig)(a,e,o);return console.log("\ud83d\udd27 createTeamConfigFromSquadSize result:",{fullNewConfig:n}),c(n),n},[o,c,s]),m=(0,e.useCallback)(()=>s?o&&o!==s.formation?(0,n.A)((0,n.A)({},s),{},{formation:o}):s:null,[s,o]);return{teamConfig:s,selectedFormation:o,setTeamConfig:i,setSelectedFormation:l,updateTeamConfig:c,updateFormationSelection:d,createTeamConfigFromSquadSize:u,getFormationAwareTeamConfig:m,getTeamConfigState:()=>({teamConfig:s,selectedFormation:o})}}(u),{teamConfig:R,selectedFormation:O,setTeamConfig:D,setSelectedFormation:F,updateTeamConfig:L,updateFormationSelection:q,createTeamConfigFromSquadSize:U,getFormationAwareTeamConfig:B}=I,[G,z]=(0,e.useState)(u.alertMinutes),[V,H]=(0,e.useState)(u.currentPeriodNumber),[K,W]=(0,e.useState)(u.formation),[Y,J]=(0,e.useState)(u.nextPlayerToSubOut),[Q,$]=(0,e.useState)(u.nextPlayerIdToSubOut),[X,Z]=(0,e.useState)(u.rotationQueue),[ee,te]=(0,e.useState)(u.gameLog),[ae,ne]=(0,e.useState)(u.opponentTeam||""),[re,se]=(0,e.useState)(u.matchType||Ol.DEFAULT_MATCH_TYPE),[ie,oe]=(0,e.useState)(u.venueType||Fs.DEFAULT_VENUE_TYPE),[le,ce]=(0,e.useState)(u.lastSubstitutionTimestamp||null),de=(null===R||void 0===R?void 0:R.format)||xi.FORMATS.FORMAT_5V5,ue=(0,e.useMemo)(()=>(0,xi.getMinimumPlayersForFormat)(de),[de]),me=(0,e.useMemo)(()=>(0,xi.getMaximumPlayersForFormat)(de),[de]),he=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const[a,n]=(0,e.useState)(t.matchEvents||[]),[r,s]=(0,e.useState)(t.matchStartTime||null),[i,o]=(0,e.useState)(t.goalScorers||{}),[l,c]=(0,e.useState)(t.eventSequenceNumber||0),[d,u]=(0,e.useState)(t.lastEventBackup||null),[m,h]=(0,e.useState)(t.ownScore||0),[p,f]=(0,e.useState)(t.opponentScore||0),g=(0,e.useCallback)(()=>{const e=Fo(),t=Lo();if(!e&&0===t.length&&(r||a.length>0))return void Uo();const i=t.length!==a.length;let o=!1;t.length>0&&a.length>0&&(o=JSON.stringify(t)!==JSON.stringify(a)),(i||o||!r&&e)&&(e&&e!==r&&s(e),(i||o)&&n([...t]))},[a,r]),v=(0,e.useCallback)(()=>{g()},[g]);(0,e.useEffect)(()=>(Uo(),Ro(v)),[v]);const y=(0,e.useCallback)(()=>{h(e=>e+1)},[]),b=(0,e.useCallback)(()=>{f(e=>e+1)},[]),x=(0,e.useCallback)((e,t)=>{h(e),f(t)},[]),w=(0,e.useCallback)(()=>{h(0),f(0)},[]),S=(0,e.useCallback)(()=>{const e=Do();return n([]),s(null),o({}),c(0),u(null),e},[]);return{matchEvents:a,matchStartTime:r,goalScorers:i,eventSequenceNumber:l,lastEventBackup:d,ownScore:m,opponentScore:p,setMatchEvents:n,setMatchStartTime:s,setGoalScorers:o,setEventSequenceNumber:c,setLastEventBackup:u,setOwnScore:h,setOpponentScore:f,addGoalScored:y,addGoalConceded:b,setScore:x,resetScore:w,clearAllMatchEvents:S,syncMatchDataFromEventLogger:g,getEventState:()=>({matchEvents:a,matchStartTime:r,goalScorers:i,eventSequenceNumber:l,lastEventBackup:d,ownScore:m,opponentScore:p})}}(u),{matchEvents:pe,matchStartTime:fe,goalScorers:ge,eventSequenceNumber:ve,lastEventBackup:ye,ownScore:be,opponentScore:we,setMatchEvents:Se,setMatchStartTime:ke,setGoalScorers:Ne,setEventSequenceNumber:je,setLastEventBackup:Te,addGoalScored:Ae,addGoalConceded:_e,setScore:Ce,resetScore:Me,clearAllMatchEvents:Pe,syncMatchDataFromEventLogger:Ee}=he,Ie=(0,e.useCallback)(e=>{T(Ll(e))},[]),[Re,Oe]=(0,e.useState)(u.timerPauseStartTime||null),[De,Fe]=(0,e.useState)(u.totalMatchPausedDuration||0),[Le,qe]=(0,e.useState)(u.currentMatchId||null),[Ue,Be]=(0,e.useState)(u.matchCreated||!1),[Ge,ze]=(0,e.useState)(u.matchState||"not_started"),[Ve,He]=(0,e.useState)(!1),[Ke,We]=(0,e.useState)(""),[Ye,Qe]=(0,e.useState)(!1),[$e,Xe]=(0,e.useState)(0),Ze=(0,e.useRef)(null),[et,tt]=(0,e.useState)(u.hasActiveConfiguration||!1),[at,nt]=(0,e.useState)(null===(t=u.trackGoalScorer)||void 0===t||t);(0,e.useEffect)(()=>{s&&s(Ge)},[Ge,s]),(0,e.useEffect)(()=>{let e=!0;return(async()=>{if(null!==r&&void 0!==r&&r.id&&i)try{const t=await i(r.id);if(!e)return;"boolean"===typeof(null===t||void 0===t?void 0:t.trackGoalScorer)?nt(t.trackGoalScorer):nt(!0)}catch(t){console.warn("Failed to load goal tracking preference:",t)}})(),()=>{e=!1}},[null===r||void 0===r?void 0:r.id,i,j]);const rt=function(t,a,n){const{allPlayers:r,selectedSquadIds:s,numPeriods:i,periodGoalieIds:o,teamConfig:l,selectedFormation:c,periodDurationMinutes:d,opponentTeam:u,captainId:m,matchType:h,venueType:p,formation:f,currentMatchId:g,matchCreated:v}=t,{setCurrentMatchId:y,setMatchCreated:b}=a,{currentTeam:x}=n,w=(0,e.useCallback)(()=>hl.loadState(),[]),S=(0,e.useCallback)(async()=>{try{const e=await ml({teamConfig:l,selectedFormation:c,numPeriods:i,periodDurationMinutes:d,opponentTeam:u,captainId:m,matchType:h,venueType:p,formation:f,periodGoalieIds:o,selectedSquadIds:s,allPlayers:r,currentTeam:x,currentMatchId:g,matchCreated:v,setCurrentMatchId:y,setMatchCreated:b});return e.success||console.warn("\u26a0\ufe0f Failed to save match configuration:",e.error),e}catch(e){return console.error("\u274c Error saving match configuration:",e),{success:!1,error:e.message}}},[l,c,i,d,u,m,h,p,f,o,s,r,x,g,v,y,b]);return{loadPersistedState:w,clearPersistedState:(0,e.useCallback)(()=>hl.clearState(),[]),saveMatchConfiguration:S}}({allPlayers:h,selectedSquadIds:p,numPeriods:A,periodGoalieIds:P,teamConfig:R,selectedFormation:O,periodDurationMinutes:C,opponentTeam:ae,captainId:f,matchType:re,venueType:ie,formation:K,currentMatchId:Le,matchCreated:Ue,trackGoalScorer:at},{setCurrentMatchId:qe,setMatchCreated:Be,setAllPlayers:g},{currentTeam:r});(0,e.useEffect)(()=>{const e=B();N(K,p,e)},[K,R,O,p,B,N]),(0,e.useEffect)(()=>{const e=setTimeout(()=>{const e=(0,n.A)((0,n.A)((0,n.A)((0,n.A)({view:j},m.getPlayerState()),{},{numPeriods:A,periodDurationMinutes:C,periodGoalieIds:P},I.getTeamConfigState()),{},{alertMinutes:G,currentPeriodNumber:V,formation:K,nextPlayerToSubOut:Y,nextPlayerIdToSubOut:Q,rotationQueue:X,gameLog:ee,opponentTeam:ae,matchType:re,venueType:ie,lastSubstitutionTimestamp:le},he.getEventState()),{},{timerPauseStartTime:Re,totalMatchPausedDuration:De,captainId:f,currentMatchId:Le,matchCreated:Ue,matchState:Ge,hasActiveConfiguration:et,trackGoalScorer:at});Dl.saveGameState(e)},100);return()=>clearTimeout(e)},[m,j,A,C,P,I,G,V,K,Y,Q,X,ee,ae,re,ie,le,he,Re,De,f,Le,Ue,Ge,et,at]);const st=(0,e.useCallback)(function(e,t){const a=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)||P[e];if(W((0,wi.getInitialFormationTemplate)(R,a)),e>1&&t.length>0){const e=t[t.length-1],n=function(e,t,a,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!Ai(n,r||(null===n||void 0===n?void 0:n.formation)))return{formation:{goalie:e},rotationQueue:[],nextToRotateOff:null};const s=r||(null===n||void 0===n?void 0:n.formation)||xi.FORMATIONS.FORMATION_2_2;return s===xi.FORMATIONS.FORMATION_1_2_1?Ri(e,t,a,n):s===xi.FORMATIONS.FORMATION_2_2?Ii(e,t,a,n):_i(e,t,a,n,s)}(a,e.finalStatsSnapshotForAllPlayers,p.map(e=>h.find(t=>t.id===e)),R,O,e.formation),r=(0,wi.getInitialFormationTemplate)(R,a);Object.assign(r,n.formation),W(r),$(n.nextToRotateOff);const s=B(),i=(0,wi.getModeDefinition)(s),o=(null===i||void 0===i?void 0:i.fieldPositions)||[],l=o.find(e=>n.formation[e]===n.nextToRotateOff);J(l||o[0]),Z(n.rotationQueue)}else{W((0,wi.getInitialFormationTemplate)(R,a));const e=(0,wi.getModeDefinition)(R),t=(null===e||void 0===e?void 0:e.fieldPositions)||[];J(t[0]||"leftDefender"),Z([])}},[P,p,h,R,O,B]),it=(0,e.useCallback)(e=>{st(e,ee)},[st,ee]),ot=(0,e.useCallback)(async()=>{if(p.length<ue||p.length>me)return void alert(a("validation.selectPlayersCount",{min:ue,max:me}));const e=Array.from({length:A},(e,t)=>P[t+1]).every(Boolean);if(!e)return void alert(a("validation.assignGoaliePerPeriod"));const t=h.map(e=>{const t={startedMatchAs:null,startedAtRole:null,startedAtPosition:null,startLocked:!1,periodsAsGoalie:0,periodsAsDefender:0,periodsAsAttacker:0,periodsAsMidfielder:0,timeOnFieldSeconds:0,timeAsSubSeconds:0,timeAsGoalieSeconds:0,timeAsDefenderSeconds:0,timeAsAttackerSeconds:0,timeAsMidfielderSeconds:0,currentRole:null,currentStatus:null,lastStintStartTimeEpoch:0,currentPositionKey:null,isInactive:!1,isCaptain:!1,goals:0,saves:0,blocks:0,cards:[],hasFairPlayAward:!1};var a;return p.includes(e.id)?(0,n.A)((0,n.A)({},e),{},{stats:(0,n.A)((0,n.A)({},t),{},{isCaptain:(null===(a=e.stats)||void 0===a?void 0:a.isCaptain)||!1})}):(0,n.A)((0,n.A)({},e),{},{stats:(0,n.A)((0,n.A)({},t),{},{isCaptain:!1})})});g(t);try{const e=await ml({teamConfig:R,selectedFormation:O,numPeriods:A,periodDurationMinutes:C,opponentTeam:ae,captainId:f,matchType:re,venueType:ie,formation:K,periodGoalieIds:P,selectedSquadIds:p,allPlayers:t,currentTeam:r,currentMatchId:Le,matchCreated:Ue,setCurrentMatchId:qe,setMatchCreated:Be});e.success||console.warn("\u26a0\ufe0f Failed to save match configuration:",e.error)}catch(i){console.error("\u274c Error managing pending match:",i)}ze("not_started"),H(1),te([]);const s=(0,n.A)({},K);if(it(1),s&&((e,t)=>{if(!e||!t)return!1;const a=(0,wi.getModeDefinition)(t);return!!a&&a.positionOrder.some(t=>{const a=e[t];return Boolean(a)})})(s,B())){const e=K.goalie;W(t=>(0,n.A)((0,n.A)((0,n.A)({},t),s),{},{goalie:e||s.goalie}))}Ie(bi.PERIOD_SETUP)},[p,A,P,it,h,r,R,O,C,ae,f,re,ie,K,qe,g,ze,H,te,Ie,W,Le,Ue,B,ue,me,a]),lt=(0,e.useCallback)((e,t)=>{var n;const r=[];null!==e&&void 0!==e&&e.error&&r.push(e.error);const s=null===e||void 0===e||null===(n=e.playerStats)||void 0===n?void 0:n.failures;if(Array.isArray(s)&&s.length>0){const e=s.map(e=>Ui(t,e.playerId)).map(e=>(null===e||void 0===e?void 0:e.displayName)||(null===e||void 0===e?void 0:e.firstName)||(null===e||void 0===e?void 0:e.lastName)).filter(Boolean);e.length>0?r.push(a("persistence.playerStatsFailed",{names:e.join(", ")})):r.push(a("persistence.playerStatsFailedCount",{count:s.length}))}return r.join(" ")},[a]),ct=(0,e.useCallback)(function(e,t){const n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)||a("persistence.failedToSaveMatch"),r=lt(e,t);return r?"".concat(n,": ").concat(r):"".concat(n,".")},[lt,a]),dt=(0,e.useCallback)((e,t)=>{We(e),He(!0),Qe(!1),Xe(0),t&&(Ze.current=t)},[]),ut=(0,e.useCallback)(()=>{He(!1),We(""),Qe(!1),Xe(0)},[]),mt=(0,e.useCallback)(()=>{ze("finished"),Ie(bi.STATS)},[ze,Ie]),ht=(0,e.useCallback)(()=>{ut(),Ze.current=null,mt()},[ut,mt]),pt=(0,e.useCallback)((e,t)=>({matchId:Le,matchStartTime:fe,matchEndTimeEpoch:e,updatedPlayers:t,goalScorers:ge,matchEvents:pe,ownScore:be,opponentScore:we}),[Le,fe,ge,pe,be,we]),ft=(0,e.useCallback)(e=>{if(null===e||void 0===e||!e.matchId)return{error:a("persistence.cannotSaveNoMatchId")};if(!Array.isArray(e.updatedPlayers)||0===e.updatedPlayers.length)return{error:a("persistence.cannotSaveNoPlayerData")};let t=e.matchDurationSeconds;if(void 0===t||null===t){var r;const n=null!==(r=e.matchStartTime)&&void 0!==r?r:fe;if(!n)return{error:a("persistence.cannotSaveMissingStartTime")};t=Math.floor((e.matchEndTimeEpoch-n)/1e3)}const s=e.finalStats||al({ownScore:e.ownScore,opponentScore:e.opponentScore,allPlayers:e.updatedPlayers},t),i=Ho(s);if(!i.valid)return{error:a("persistence.cannotSaveIncompleteData",{fields:i.missingFields.join(", ")})};return 0===e.updatedPlayers.filter(e=>{var t,a;return(null===(t=e.stats)||void 0===t?void 0:t.startedMatchAs)||(null===(a=e.stats)||void 0===a?void 0:a.startedAtPosition)}).length?{error:a("persistence.cannotSaveNoParticipants")}:{payload:(0,n.A)((0,n.A)({},e),{},{finalStats:s,matchDurationSeconds:t})}},[fe,a]),gt=(0,e.useCallback)(async e=>{const{payload:t,error:a}=ft(e);if(a)return dt(a,e),{success:!1,error:a};const n=await Yo(t.matchId,t.finalStats,t.updatedPlayers,t.goalScorers,t.matchEvents);if(!n.success){const e=ct(n,t.updatedPlayers);return dt(e,t),n}return ut(),Ze.current=null,mt(),n},[ft,dt,ct,ut,mt]),vt=(0,e.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;const t=Ze.current;if(!t)return dt(a("persistence.cannotRetry")),{success:!1,error:"No pending match data"};const{payload:n,error:r}=ft(t);if(r)return dt(r,t),{success:!1,error:r};Qe(!0);let s=null;for(let o=1;o<=e;o++){if(Xe(o),We(a("persistence.retrying",{attempt:o,maxAttempts:e})),s=await Yo(n.matchId,n.finalStats,n.updatedPlayers,n.goalScorers,n.matchEvents),s.success)return Qe(!1),ut(),Ze.current=null,mt(),s;o<e&&await new Promise(e=>setTimeout(e,1e3*o))}Qe(!1);const i=ct(s,n.updatedPlayers,a("persistence.failedAfterRetries",{maxAttempts:e}));return dt(i,n),s||{success:!1,error:a("persistence.failedAfterRetries",{maxAttempts:e})}},[ft,dt,ut,ct,mt,a]),yt=(0,e.useCallback)(()=>{Pe()?(w(),qe(null),ze("not_started"),Be(!1),tt(!1),oe(Fs.DEFAULT_VENUE_TYPE)):console.warn("Failed to clear game events");const e=rt.clearPersistedState();return e||console.warn("Failed to clear game state"),e},[rt,Pe,w,oe]),bt=(0,e.useCallback)(function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(J(e),!t&&K&&K[e]){const t=K[e],a=Q;$(t),t!==a&&Z(e=>{const a=Li(e,Yi(h));return a.initialize(),a.removePlayer(t),a.addPlayer(t,0),a.toArray()})}},[K,Q,h]),xt=(0,e.useCallback)(e=>{const t=Ui(h,e);return null===t||void 0===t?void 0:t.stats.currentPositionKey},[h]),wt=(0,e.useCallback)(function(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e||!t||e===t)return console.warn("Invalid player IDs for position switch"),!1;const r=Ui(h,e),s=Ui(h,t);if(!r||!s)return console.warn("Players not found for position switch"),!1;if(r.id===K.goalie||s.id===K.goalie)return console.warn("Cannot switch positions with goalie"),!1;const i=r.stats.currentPositionKey,o=s.stats.currentPositionKey,l=(0,wi.getValidPositions)(R);if(!l.includes(i)||!l.includes(o))return console.warn("One or both players are not in valid positions for switching"),!1;W(a=>{const r=(0,n.A)({},a);return r[i]=t,r[o]=e,r});const c=Date.now();return g(r=>r.map(r=>{if(r.id===e){const e=(0,$i.Mf)(o)||r.stats.currentRole;return(0,n.A)((0,n.A)({},r),{},{stats:(0,n.A)((0,n.A)({},fo(r,e,c,a)),{},{currentPositionKey:o})})}if(r.id===t){const e=(0,$i.Mf)(i)||r.stats.currentRole;return(0,n.A)((0,n.A)({},r),{},{stats:(0,n.A)((0,n.A)({},fo(r,e,c,a)),{},{currentPositionKey:i})})}return r})),!0},[h,K,R,g]),St=(0,e.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e||e===K.goalie)return console.warn("Invalid new goalie ID or same as current goalie"),!1;const a=Ui(h,K.goalie),r=Ui(h,e);if(!a||!r)return console.warn("Goalie not found for switch"),!1;if(r.stats.isInactive)return console.warn("Cannot switch to inactive player as goalie"),!1;const s=r.stats.currentPositionKey;W(t=>{const a=(0,n.A)({},t);return a.goalie=e,a[s]=K.goalie,a});const i=Date.now();return g(a=>a.map(a=>{if(a.id===K.goalie){const e=to(a,i,t),r=(0,$i.Mf)(s)||Je.q.DEFENDER,o=s.includes("substitute")?Je.P.SUBSTITUTE:Je.P.ON_FIELD,l=fo((0,n.A)((0,n.A)({},a),{},{stats:e}),r,i,t);return l.currentStatus=o,l.currentPositionKey=s,(0,n.A)((0,n.A)({},a),{},{stats:l})}if(a.id===e){const e=to(a,i,t),r=fo((0,n.A)((0,n.A)({},a),{},{stats:e}),Je.q.GOALIE,i,t);return r.currentStatus=Je.P.GOALIE,r.currentPositionKey="goalie",(0,n.A)((0,n.A)({},a),{},{stats:r})}return a})),Z(t=>{const a=Li(t,Yi(h));return a.initialize(),a.removePlayer(e),a.addPlayer(K.goalie,"end"),a.toArray()}),!0},[h,K,g,W,Z]),kt=(0,e.useCallback)(()=>Wi(h,p,K.goalie),[h,p,K.goalie]),Nt=(0,e.useCallback)(async()=>{if(p.length<ue||p.length>me)return{success:!1,error:a("validation.selectPlayersCount",{min:ue,max:me})};if(null===r||void 0===r||!r.id)return{success:!1,error:a("validation.teamContextRequired")};try{const e=h.map(e=>{const t={startedMatchAs:null,startedAtRole:null,startedAtPosition:null,startLocked:!1,periodsAsGoalie:0,periodsAsDefender:0,periodsAsAttacker:0,periodsAsMidfielder:0,timeOnFieldSeconds:0,timeAsSubSeconds:0,timeAsGoalieSeconds:0,timeAsDefenderSeconds:0,timeAsAttackerSeconds:0,timeAsMidfielderSeconds:0,currentRole:null,currentStatus:null,lastStintStartTimeEpoch:0,currentPositionKey:null,isInactive:!1,isCaptain:!1,goals:0,saves:0,blocks:0,cards:[],hasFairPlayAward:!1};var a;return p.includes(e.id)?(0,n.A)((0,n.A)({},e),{},{stats:(0,n.A)((0,n.A)({},t),{},{isCaptain:(null===(a=e.stats)||void 0===a?void 0:a.isCaptain)||!1})}):(0,n.A)((0,n.A)({},e),{},{stats:(0,n.A)((0,n.A)({},t),{},{isCaptain:!1})})}),t=await ml({teamConfig:R,selectedFormation:O,numPeriods:A,periodDurationMinutes:C,opponentTeam:ae,captainId:f,matchType:re,venueType:ie,formation:K,periodGoalieIds:P,selectedSquadIds:p,allPlayers:e,currentTeam:r,currentMatchId:Le,matchCreated:Ue,setCurrentMatchId:qe,setMatchCreated:Be});return t.success?{success:!0,message:t.message,matchId:t.matchId}:{success:!1,error:t.error}}catch(e){return console.error("\u274c Error saving configuration:",e),{success:!1,error:a("persistence.failedToSaveConfigError",{error:e.message})}}},[p,A,P,r,R,O,C,ae,f,re,ie,Le,Ue,K,h,ue,me,a]),jt=(0,e.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{shouldNavigate:t=!1}=e,s=B();if(!s)return{success:!1,error:a("validation.completeFormationAssignment")};const i=(0,wi.getModeDefinition)(s);if(!i)return{success:!1,error:a("validation.completeFormationAssignment")};const o=[...i.fieldPositions,...i.substitutePositions],l=o.map(e=>K[e]).filter(Boolean),c=o.length,d=new Set(l).size;if(l.length!==c||d!==c||!K.goalie){const e=a("validation.assignAllPositions");return t?(alert(e),{success:!1,error:e}):{success:!1,error:e}}if(!Le)return{success:!1,error:a("validation.noActiveMatch")};try{var u,m,v;const e=Date.now(),t=B(),s=h.map(a=>{if(p.includes(a.id)){const{currentRole:r,currentStatus:s,currentPositionKey:i}=(0,wi.initializePlayerRoleAndStatus)(a.id,K,t),o=(0,n.A)({},a.stats);if(!o.startLocked){let e=null;s===Je.P.GOALIE?e=Je.q.GOALIE:s===Je.P.ON_FIELD?e=Je.q.FIELD_PLAYER:s===Je.P.SUBSTITUTE&&(e=Je.q.SUBSTITUTE),o.startedMatchAs=e,o.startedAtPosition=i,o.startedAtRole=r||null,o.startLocked=!1}return(0,n.A)((0,n.A)({},a),{},{stats:(0,n.A)((0,n.A)({},o),{},{currentRole:r,currentStatus:s,currentPositionKey:Fl(a.id,K,t),lastStintStartTimeEpoch:e})})}return a});g(s);const i={formation:K,teamConfig:{format:t.format,formation:t.formation,squadSize:t.squadSize},matchConfig:{format:t.format,periods:A,captainId:f,matchType:re,venueType:ie,opponentTeam:ae,periodDurationMinutes:C},periodGoalies:P,squadSelection:p};let o;if(1===V&&null!==r&&void 0!==r&&r.id){const e=tl({teamConfig:t,selectedFormation:O,periods:A,periodDurationMinutes:C,selectedSquadIds:p,allPlayers:s,opponentTeam:ae,captainId:f,matchType:re,venueType:ie},r.id);Le&&Ue?o=il(Le,e).then(e=>(e.success||console.warn("\u26a0\ufe0f  Failed to update match record:",e.error),e)).catch(e=>(console.warn("\u26a0\ufe0f  Exception during match update:",e),{success:!1,error:e.message})):(Be(!0),o=Ko(e,s,p).then(e=>e.success?(qe(e.matchId),{success:!0}):(console.warn("\u26a0\ufe0f  Failed to create match record:",e.error),{success:!1,error:e.error})).catch(e=>(console.warn("\u26a0\ufe0f  Exception during match creation:",e),{success:!1,error:e.message})))}else o=il(Le,tl({teamConfig:t,selectedFormation:O,periods:A,periodDurationMinutes:C,opponentTeam:ae,captainId:f,matchType:re,venueType:ie},null===r||void 0===r?void 0:r.id)).then(e=>(e.success||console.warn("\u26a0\ufe0f  Failed to update match record:",e.error),e)).catch(e=>(console.warn("\u26a0\ufe0f  Exception during match update:",e),{success:!1,error:e.message}));const l=ol(Le,s,f,p).then(e=>(e.success||console.warn("\u26a0\ufe0f  Failed to update player match stats:",e.error),e)).catch(e=>(console.warn("\u26a0\ufe0f  Exception during player stats update:",e),{success:!1,error:e.message})),c=ll(Le,i).then(e=>(e.success||console.warn("\u26a0\ufe0f  Failed to save initial config:",e.error),e)).catch(e=>(console.warn("\u26a0\ufe0f  Exception during initial config save:",e),{success:!1,error:e.message})),[d,y,b]=await Promise.allSettled([o,l,c]),x="fulfilled"===d.status?d.value:{success:!1,error:(null===(u=d.reason)||void 0===u?void 0:u.message)||"Match operation failed"},w="fulfilled"===y.status?y.value:{success:!1,error:(null===(m=y.reason)||void 0===m?void 0:m.message)||"Stats operation failed"},S="fulfilled"===b.status?b.value:{success:!1,error:(null===(v=b.reason)||void 0===v?void 0:v.message)||"Config operation failed"},k=x.success||w.success||S.success,N=[];return x.success||N.push("match update failed"),w.success||N.push("player stats update failed"),S.success||N.push("initial config save failed"),{success:k,message:k?N.length?a("persistence.configSavedWithWarnings"):a("persistence.configSaved"):a("persistence.failedToSaveConfig"),error:N.length?N.join(", "):void 0}}catch(y){return console.error("\u274c Error saving match configuration:",y),{success:!1,error:a("persistence.failedToSaveConfigError",{error:y.message})}}},[K,O,Le,h,p,A,C,ae,f,re,ie,null===r||void 0===r?void 0:r.id,P,V,Ue,Be,qe,g,B,a]),Tt=(0,e.useCallback)(async()=>await jt({shouldNavigate:!1}),[jt]);return{allPlayers:h,setAllPlayers:g,view:j,setView:Ie,selectedSquadIds:p,setSelectedSquadIds:v,numPeriods:A,setNumPeriods:_,periodDurationMinutes:C,setPeriodDurationMinutes:M,periodGoalieIds:P,setPeriodGoalieIds:E,teamConfig:R,setTeamConfig:D,selectedFormation:O,setSelectedFormation:F,alertMinutes:G,setAlertMinutes:z,currentPeriodNumber:V,setCurrentPeriodNumber:H,formation:K,setFormation:W,nextPlayerToSubOut:Y,setNextPlayerToSubOut:bt,nextPlayerIdToSubOut:Q,setNextPlayerIdToSubOut:$,rotationQueue:X,setRotationQueue:Z,gameLog:ee,setGameLog:te,opponentTeam:ae,setOpponentTeam:ne,matchType:re,setMatchType:se,venueType:ie,setVenueType:oe,ownScore:be,opponentScore:we,lastSubstitutionTimestamp:le,setLastSubstitutionTimestamp:ce,matchEvents:pe,setMatchEvents:Se,matchStartTime:fe,setMatchStartTime:ke,goalScorers:ge,setGoalScorers:Ne,eventSequenceNumber:ve,setEventSequenceNumber:je,lastEventBackup:ye,setLastEventBackup:Te,timerPauseStartTime:Re,setTimerPauseStartTime:Oe,totalMatchPausedDuration:De,setTotalMatchPausedDuration:Fe,captainId:f,setCaptainId:y,trackGoalScorer:at,setTrackGoalScorer:nt,currentMatchId:Le,setCurrentMatchId:qe,matchCreated:Ue,setMatchCreated:Be,matchState:Ge,setMatchState:ze,hasActiveConfiguration:et,setHasActiveConfiguration:tt,showMatchPersistenceError:Ve,persistenceErrorMessage:Ke,isMatchPersistenceRetrying:Ye,matchPersistenceRetryAttempt:$e,preparePeriod:it,preparePeriodWithGameLog:st,handleStartPeriodSetup:ot,handleStartGame:()=>{const e=B(),t=(0,wi.getModeDefinition)(e);if(!t)return void alert(a("validation.invalidFormation"));const r=[...t.fieldPositions,...t.substitutePositions],s=r.map(e=>K[e]).filter(Boolean),i=r.length;if(new Set(s).size!==i||s.length!==i||!K.goalie)return void alert(a("validation.completeFormation",{count:i}));const o=Object.values(K).filter(e=>"string"===typeof e).filter(e=>!p.includes(e));if(o.length>0&&console.warn("\u26a0\ufe0f  [handleStartGame] Non-selected players found in formation:",o),g(e=>e.map(e=>(0,n.A)((0,n.A)({},e),{},{hasFairPlayAward:!1}))),jt({shouldNavigate:!0}).then(e=>{e.success||console.warn("\u26a0\ufe0f  Failed to save match configuration:",e.error)}).catch(e=>{console.warn("\u26a0\ufe0f  Exception during match configuration save:",e)}),0===X.length){var l;const e=B(),t=(0,wi.getModeDefinition)(e),a=(null===t||void 0===t?void 0:t.fieldPositions)||[],n=(null===t||void 0===t?void 0:t.substitutePositions)||[];let r=[],s=null;const i=a.map(e=>K[e]).filter(Boolean),o=n.map(e=>K[e]).filter(Boolean),c=[...i,...o].map(e=>{var t;const a=h.find(t=>t.id===e);return{id:e,totalOutfieldTime:(null===a||void 0===a||null===(t=a.stats)||void 0===t?void 0:t.timeOnFieldSeconds)||0}}),d=c.filter(e=>i.includes(e.id)).sort((e,t)=>t.totalOutfieldTime-e.totalOutfieldTime),u=c.filter(e=>o.includes(e.id)).sort((e,t)=>e.totalOutfieldTime-t.totalOutfieldTime),m=((e,t,a)=>{if(!Array.isArray(e)||0===e.length)return e;const n=a.reduce((e,a)=>{const n=t[a];return n&&(e[n]=(0,$i.Mf)(a)),e},{}),r={[Je.q.DEFENDER]:[],[Je.q.MIDFIELDER]:[],[Je.q.ATTACKER]:[],other:[]};e.forEach(e=>{const t=n[e.id];r[t]?r[t].push(e):r.other.push(e)});const s=[Je.q.DEFENDER,Je.q.MIDFIELDER,Je.q.ATTACKER],i=[];let o=0;for(;s.some(e=>r[e].length>0);){let e=!1;for(let t=0;t<s.length;t++){const a=(o+t)%s.length,n=s[a];if(0!==r[n].length){i.push(r[n].shift()),o=(a+1)%s.length,e=!0;break}}if(!e)break}return[...i,...r.other]})(d,K,a);if(r=[...m.map(e=>e.id),...u.map(e=>e.id)],s=(null===(l=m[0])||void 0===l?void 0:l.id)||null,s&&r.length>=a.length){$(s),Z(r);const e=a.find(e=>K[e]===s);e&&J(e)}else console.warn("\ud83d\udd27 [handleStartGame] Could not initialize rotation queue - incomplete formation")}ze("pending"),Ie(bi.GAME),setTimeout(()=>{Ee()},100)},handleActualMatchStart:async()=>{const e=B(),t=Date.now(),a=h.map(a=>{if(!p.includes(a.id))return a;const{currentRole:r,currentStatus:s,currentPositionKey:i}=(0,wi.initializePlayerRoleAndStatus)(a.id,K,e),o=(0,n.A)({},a.stats);if(!o.startLocked){let e=o.startedMatchAs;s===Je.P.GOALIE?e=Je.q.GOALIE:s===Je.P.ON_FIELD?e=Je.q.FIELD_PLAYER:s===Je.P.SUBSTITUTE&&(e=Je.q.SUBSTITUTE),o.startedMatchAs=e,o.startedAtPosition=i,o.startedAtRole=r||null}return o.currentRole=r,o.currentStatus=s,o.currentPositionKey=i,o.lastStintStartTimeEpoch=t,o.startLocked=!0,(0,n.A)((0,n.A)({},a),{},{stats:o})});if(g(a),Le)try{await ol(Le,a,f,p)}catch(r){console.warn("\u26a0\ufe0f  Failed to upsert player stats on match start:",r)}if(Le)try{const e=await async function(e){try{if(!e)return{success:!1,error:"Match ID is required"};const t=(new Date).toISOString(),{error:a}=await Ur.from("match").update({state:"running",started_at:t,updated_at:t}).eq("id",e).is("deleted_at",null).eq("state","pending");return a?(console.error("\u274c Failed to start match:",a),{success:!1,error:"Database error: ".concat(a.message)}):{success:!0}}catch(r){return console.error("\u274c Exception while starting match:",r),{success:!1,error:"Unexpected error: ".concat(r.message)}}}(Le);e.success||console.warn("\u26a0\ufe0f  Failed to update match to running:",e.error)}catch(r){console.warn("\u26a0\ufe0f  Exception while updating match to running:",r)}ze("running"),l()},handleSubstitution:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=Date.now();ce(t),l();const a=go(R),n={formation:K,nextPlayerIdToSubOut:Q,allPlayers:h,rotationQueue:X,currentTimeEpoch:t,isSubTimerPaused:e};try{const e=a.executeSubstitution(n);W(e.newFormation),g(e.updatedPlayers),e.newRotationQueue&&Z(e.newRotationQueue),void 0!==e.newNextPlayerIdToSubOut&&$(e.newNextPlayerIdToSubOut),e.newNextPlayerToSubOut&&J(e.newNextPlayerToSubOut)}catch(r){console.error("Substitution failed:",r)}},handleEndPeriod:async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=Date.now(),a=Ki(h,p).map(e=>e.id),r=h.map(r=>{if(a.includes(r.id)){const a=to(r,t,e);return a.currentRole===Je.q.GOALIE?a.periodsAsGoalie+=1:a.currentRole===Je.q.DEFENDER?a.periodsAsDefender+=1:a.currentRole===Je.q.ATTACKER&&(a.periodsAsAttacker+=1),(0,n.A)((0,n.A)({},r),{},{stats:a})}return r});g(r);const s=r.filter(e=>p.includes(e.id)).map(e=>({id:e.id,displayName:e.displayName||null,firstName:e.firstName||null,lastName:e.lastName||null,jerseyNumber:e.jerseyNumber||null,stats:JSON.parse(JSON.stringify(e.stats))})),i={periodNumber:V,formation:JSON.parse(JSON.stringify(K)),finalStatsSnapshotForAllPlayers:s},o=[...ee,i];if(te(o),V<A)H(e=>e+1),st(V+1,o),Ie(bi.PERIOD_SETUP);else{c();const e=pt(t,r);Ze.current=e;const a=fe?Math.floor((t-fe)/1e3):null;null!==a&&(e.matchDurationSeconds=a,e.finalStats=al({ownScore:be,opponentScore:we,allPlayers:r},a));if(!(await gt(e)).success)return}},retryMatchPersistence:vt,continueWithoutSavingMatch:ht,addTemporaryPlayer:b,clearStoredState:yt,togglePlayerInactive:S,getInactivePlayerPosition:xt,switchPlayerPositions:wt,switchGoalie:St,getOutfieldPlayers:kt,addGoalScored:Ae,addGoalConceded:_e,setScore:Ce,resetScore:Me,setCaptain:x,playAlertSounds:d,updateTeamConfig:L,updateFormationSelection:q,createTeamConfigFromSquadSize:U,syncPlayersFromTeamRoster:k,handleSaveConfiguration:Nt,handleSavePeriodConfiguration:Tt}}const Ul={OWN_TEAM_NAME:"Own Team",DEFAULT_OPPONENT_TEAM_NAME:"Opponent"};const Bl=e=>{if(void 0===e||null===e||isNaN(e))return console.warn("formatTime received invalid value:",e,'returning "00:00"'),"00:00";const t=Math.max(0,Math.floor(e)),a=Math.floor(t/60),n=t%60;return"".concat(String(a).padStart(2,"0"),":").concat(String(n).padStart(2,"0"))},Gl=e=>{if(void 0===e||null===e||isNaN(e))return console.warn("formatMinutesAsTime received invalid value:",e,'returning "00:00"'),"00:00";const t=Math.max(0,Math.round(60*e)),a=Math.floor(t/3600),n=Math.floor(t%3600/60),r=t%60,s=String(n).padStart(2,"0"),i=String(r).padStart(2,"0");return a>0?"".concat(String(a).padStart(2,"0"),":").concat(s,":").concat(i):"".concat(s,":").concat(i)},zl=e=>{if(void 0===e||null===e||isNaN(e))return console.warn("formatSecondsAsTime received invalid value:",e,'returning "00:00:00"'),"00:00:00";const t=Math.max(0,Math.floor(e));return[Math.floor(t/3600),Math.floor(t%3600/60),t%60].map(e=>String(e).padStart(2,"0")).join(":")},Vl=e=>{if(void 0===e||null===e||isNaN(e))return console.warn("formatTimeDifference received invalid value:",e,'returning "+00:00"'),"+00:00";const t=e>=0?"+":"-",a=Math.abs(e);return t+Bl(a)},Hl=(e,t)=>{var a;const n=Kl(e),r=null!==(a=e.stats)&&void 0!==a&&a.isInactive?"".concat(n," (Inactive)"):n;if(t>1){const t=Bl(e.stats.timeOnFieldSeconds),a=e.stats.timeAsAttackerSeconds-e.stats.timeAsDefenderSeconds,n=Vl(a);return"".concat(r,"  \u23f1\ufe0f ").concat(t,"  \u2694\ufe0f ").concat(n)}return r},Kl=e=>{var t;const a=null===(t=e.stats)||void 0===t?void 0:t.isCaptain,n=e.displayName||e.firstName||"Unknown Player";return a?"".concat(n," (C)"):n},Wl=Bs(Br.TIMER_STATE,null),Yl=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!e||"object"!==typeof e)return[];return Object.entries(e).filter(e=>{let[,t]=e;return Boolean(t)}).map(e=>{let[a,n]=e;const r=(e=>{if(!e)return null;const a=t.find(t=>t.id===e);return a?Kl(a):null})(n);return{position:a,name:r||"Unknown"}})},Jl=(e,t)=>{if(!e)return 60*t;const a=Date.now();return 60*t-Math.floor((a-e)/1e3)},Ql=(e,t,a)=>{if(!e)return 0;const n=Date.now(),r=a||n,s=Math.floor((r-e-t)/1e3);return Math.max(0,s)};function $l(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;const l=(()=>{const e=(()=>{const e=Wl.loadState();return e&&Object.keys(e).length>0?e:null})();var t,a,n,r,s,i;return e?{isPeriodActive:null!==(t=e.isPeriodActive)&&void 0!==t&&t,periodStartTime:null!==(a=e.periodStartTime)&&void 0!==a?a:null,lastSubstitutionTime:null!==(n=e.lastSubstitutionTime)&&void 0!==n?n:null,secondLastSubstitutionTime:null!==(r=e.secondLastSubstitutionTime)&&void 0!==r?r:null,pauseStartTime:null!==(s=e.pauseStartTime)&&void 0!==s?s:null,totalPausedDuration:null!==(i=e.totalPausedDuration)&&void 0!==i?i:0}:{isPeriodActive:!1,periodStartTime:null,lastSubstitutionTime:null,secondLastSubstitutionTime:null,pauseStartTime:null,totalPausedDuration:0}})(),[c,d]=(0,e.useState)(l.isPeriodActive),[u,m]=(0,e.useState)(l.periodStartTime),[h,p]=(0,e.useState)(l.lastSubstitutionTime),[f,g]=(0,e.useState)(l.secondLastSubstitutionTime),[v,y]=(0,e.useState)(l.pauseStartTime),[b,x]=(0,e.useState)(l.totalPausedDuration),[w,S]=(0,e.useState)(0),k=(0,e.useRef)(null),N=(0,e.useRef)(null),[j,T]=(0,e.useState)(!1),A=(0,e.useMemo)(()=>Jl(u,t),[u,t,w]),_=(0,e.useMemo)(()=>Ql(h,b,v),[h,b,v,w]),C=null!==v;(0,e.useEffect)(()=>{if(a>0&&r&&_>=60*a&&c){const e=Math.floor(_/60);N.current===e||j||(N.current=e,T(!0),r())}else _<60*a&&j&&(T(!1),N.current=null)},[_,a,r,j,c,C,s,A,u,h,b,v,i]),(0,e.useEffect)(()=>{if(k.current&&(clearInterval(k.current),k.current=null),i&&c&&u){const e=()=>{S(e=>e+1)};e();const t=setInterval(e,1e3);k.current=t;const a=()=>{document.hidden||e()};return document.addEventListener("visibilitychange",a),()=>{clearInterval(t),document.removeEventListener("visibilitychange",a)}}},[i,c,u]);const M=(0,e.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=(0,n.A)({isPeriodActive:c,periodStartTime:u,lastSubstitutionTime:h,secondLastSubstitutionTime:f,pauseStartTime:v,totalPausedDuration:b},e);var a;a=t,Wl.saveState(a)},[c,u,h,f,v,b]),P=(0,e.useCallback)(()=>{const e=Date.now();g(h),p(e),x(0);const t=C?e:null;y(t),M({lastSubstitutionTime:e,secondLastSubstitutionTime:h,totalPausedDuration:0,pauseStartTime:t})},[h,C,M]),E=(0,e.useCallback)(e=>{const t=Date.now()-1e3*e;p(t),x(0),M({lastSubstitutionTime:t,totalPausedDuration:0})},[M]),I=(0,e.useCallback)(e=>{if(!C&&h){const n=Date.now();try{Io(wo.TIMER_PAUSED,{pauseType:"substitution",currentMatchTime:_o(n),periodNumber:s||1,subTimerSeconds:Ql(h,b,null),matchTimerSeconds:Jl(u,t),pauseReason:"substitution_pause",timerState:{beforePause:{isPaused:!1,lastSubstitutionTime:h,totalPausedDuration:b,pauseStartTime:null}}})}catch(a){console.error("Error logging timer pause event:",a)}y(n),e&&e(n,!0),M({pauseStartTime:n})}},[C,h,M,b,u,t,s]),R=(0,e.useCallback)(e=>{if(C&&v){const n=Date.now(),r=n-v,i=b+r;try{Io(wo.TIMER_RESUMED,{pauseType:"substitution",currentMatchTime:_o(n),periodNumber:s||1,pauseDurationMs:r,pauseDurationSeconds:Math.floor(r/1e3),subTimerSeconds:Ql(h,i,null),matchTimerSeconds:Jl(u,t),resumeReason:"substitution_resume",timerState:{beforeResume:{isPaused:!0,lastSubstitutionTime:h,totalPausedDuration:b,pauseStartTime:v},afterResume:{isPaused:!1,lastSubstitutionTime:h,totalPausedDuration:i,pauseStartTime:null}}})}catch(a){console.error("Error logging timer resume event:",a)}y(null),x(i),e&&e(n,!1),M({totalPausedDuration:i,pauseStartTime:null})}},[C,v,b,M,h,u,t,s]),O=(0,e.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;const c=Date.now();m(c),p(c),g(null),d(!0),y(null),x(0);try{if(1===e?Io(wo.MATCH_START,{timestamp:c,periodDurationMinutes:t,teamConfig:a,ownTeamName:n||"Own Team",opponentTeam:r||"Opponent",numPeriods:i||2,matchId:o,matchMetadata:{startTime:c,venue:null,weather:null,referee:null,plannedPeriods:i||2,periodDurationMinutes:t},startingLineup:Yl(s,l)}):Io(wo.PERIOD_START,{periodNumber:e,timestamp:c,periodDurationMinutes:t,startingFormation:s?JSON.parse(JSON.stringify(s)):null,teamConfig:a,matchId:o,periodMetadata:{startTime:c,plannedDurationMinutes:t,isFirstPeriod:!1},startingLineup:Yl(s,l)}),s&&s.goalie){let t=null;if(l){const e=l.find(e=>e.id===s.goalie);t=e?Kl(e):null}Io(wo.GOALIE_ASSIGNMENT,{goalieId:s.goalie,goalieName:t,eventType:"period_start",matchTime:_o(c),timestamp:c,periodNumber:e,teamConfig:a,description:t?"".concat(t," is goalie"):"Goalie assigned for period ".concat(e),matchId:o})}e>1&&Io(wo.INTERMISSION,{intermissionType:"end",precedingPeriodNumber:e-1,timestamp:c,matchTime:_o(c),periodMetadata:{endTime:c,previousPeriod:e-1,startingPeriod:e}})}catch(u){console.error("Error logging period/match start events:",u)}M({periodStartTime:c,lastSubstitutionTime:c,secondLastSubstitutionTime:null,isPeriodActive:!0,pauseStartTime:null,totalPausedDuration:0})},[M,t,o]),D=(0,e.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const s=Date.now();d(!1),k.current&&(clearInterval(k.current),k.current=null);try{if(a)Io(wo.MATCH_END,{timestamp:s,finalPeriodNumber:e,matchDurationMs:u?s-u:0,teamConfig:r,matchId:o,matchMetadata:{endTime:s,endReason:"normal_completion",wasCompleted:!0,totalPeriods:e}});else if(e){const a=u?s-u:0;Io(wo.PERIOD_END,{periodNumber:e,timestamp:s,periodDurationMs:a,periodDurationMinutes:Math.floor(a/6e4),periodDurationSeconds:Math.floor(a/1e3),plannedDurationMinutes:t,endingFormation:n?JSON.parse(JSON.stringify(n)):null,teamConfig:r,matchId:o,periodMetadata:{endTime:s,startTime:u,actualDurationMs:a,wasCompleted:!0,endReason:"normal_completion"}})}!a&&e&&Io(wo.INTERMISSION,{intermissionType:"start",followingPeriodNumber:e+1,timestamp:s,matchTime:_o(s),periodMetadata:{startTime:s,endingPeriod:e,nextPeriod:e+1}})}catch(i){console.error("Error logging period/match end events:",i)}M({isPeriodActive:!1})},[M,u,t,o]),F=(0,e.useCallback)(()=>{Wl.clearState()},[]),L=(0,e.useCallback)(()=>{d(!1),m(null),p(null),g(null),y(null),x(0),k.current&&(clearInterval(k.current),k.current=null),F()},[F]);return{matchTimerSeconds:A,subTimerSeconds:_,isPeriodActive:c,isSubTimerPaused:C,periodStartTime:u,lastSubstitutionTime:h,secondLastSubstitutionTime:f,resetSubTimer:P,restoreSubTimer:E,pauseSubTimer:I,resumeSubTimer:R,startTimers:O,stopTimers:D,clearTimerState:F,clearAllTimersForNewGame:L,setIsPeriodActive:d}}function Xl(t){const a=(0,e.useRef)([]),n=(0,e.useRef)(!1);(0,e.useEffect)(()=>{n.current||(window.history.replaceState({navigationLevel:0},"",window.location.href),n.current=!0);const e=e=>{if(a.current.length>0){e.preventDefault();const t=a.current.pop();t&&"function"===typeof t.navigationHandler&&t.navigationHandler(),a.current.length>0&&window.history.pushState({navigationLevel:a.current.length},"",window.location.href)}else t&&"function"===typeof t&&t()};return window.addEventListener("popstate",e),()=>{window.removeEventListener("popstate",e)}},[t]);return{pushNavigationState:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";"function"===typeof e?(a.current.push({navigationHandler:e,handlerName:t,registeredAt:Date.now()}),window.history.pushState({navigationLevel:a.current.length},"",window.location.href)):console.warn("pushNavigationState requires a function to handle navigation")},popNavigationState:()=>{if(a.current.length>0){var e,t;a.current.pop();((null===(e=window.history.state)||void 0===e?void 0:e.navigationLevel)||(null===(t=window.history.state)||void 0===t?void 0:t.modalLevel)||0)>0&&window.history.back()}},removeFromNavigationStack:()=>{a.current.length>0&&a.current.pop()},clearNavigationStack:()=>{var e,t;a.current=[];const n=(null===(e=window.history.state)||void 0===e?void 0:e.navigationLevel)||(null===(t=window.history.state)||void 0===t?void 0:t.modalLevel)||0;n>0&&window.history.go(-n)},hasActiveNavigationHandlers:()=>a.current.length>0}}const Zl=(0,e.createContext)({currentView:null,previousView:null,navigationHistory:[],navigateTo:()=>{},navigateBack:()=>{},getPreviousView:()=>null,clearHistory:()=>{},canNavigateBack:!1}),ec=Bs(Br.NAVIGATION_HISTORY,{history:[],timestamp:Date.now()}),tc=Object.values(bi),ac=new Set([bi.GAME]),nc=bi.CONFIG,rc=e=>e===bi.LIVE_MATCH?bi.STATS:nc;function sc(t){let{children:a}=t;const[n,r]=(0,e.useState)(()=>{const e=ec.loadState();if(e.timestamp&&Date.now()-e.timestamp>36e5)return ec.clearState(),[];if(!Array.isArray(e.history))return[];return e.history.map(e=>"matchReport"===e?bi.STATS:e).filter(e=>"string"===typeof e&&tc.includes(e))}),[s,i]=(0,e.useState)(null),o=(0,e.useRef)(!1),l=(0,e.useRef)({view:null,timestamp:0}),c=n.length>0?n[n.length-1]:null,d=n.length>0;(0,e.useEffect)(()=>{ec.saveState({history:n,timestamp:Date.now()})},[n]);const u=(0,e.useCallback)(function(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||"string"!==typeof e||!tc.includes(e))return console.warn("Invalid view for navigation:",e,"Expected one of:",tc),!1;if(o.current)return console.warn("Navigation already in progress, skipping:",e),!1;o.current=!0;try{if(s===e)return!0;const a=!ac.has(e)&&!t.skipHistory;return s&&a&&r(e=>{const t=[...e];return 0!==t.length&&t[t.length-1]===s||t.push(s),t.length>10?t.slice(-10):t}),i(String(e)),l.current={view:String(e),timestamp:Date.now()},!0}catch(a){return console.error("Error during navigation:",a),!1}finally{o.current=!1}},[s]),m=(0,e.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(o.current)return console.warn("NavigationHistory: Navigation already in progress, skipping navigateBack"),null;o.current=!0;try{if(n.length>0){const e=n[n.length-1];if(e&&"string"===typeof e&&tc.includes(e))return r(e=>e.slice(0,-1)),i(String(e)),String(e);console.error("NavigationHistory: Invalid target view from history:",e,"Expected one of:",tc)}const t=rc(s),a=e||t;return a&&"string"===typeof a&&tc.includes(a)?(i(String(a)),String(a)):(console.error("NavigationHistory: Invalid fallback view:",a,"Using CONFIG as final fallback"),i(bi.CONFIG),bi.CONFIG)}catch(t){return console.error("Error during back navigation:",t),i(bi.CONFIG),bi.CONFIG}finally{o.current=!1}},[n,s]),h=(0,e.useCallback)(()=>c,[c]),p=(0,e.useCallback)(()=>{r([]),i(null),ec.clearState()},[]),f=(0,e.useCallback)(e=>{if(e&&"string"===typeof e&&tc.includes(e)){if(Date.now()-l.current.timestamp<100&&l.current.view!==e)return;i(String(e))}},[]),g=(0,e.useCallback)(()=>rc(s),[s]),v=(0,e.useMemo)(()=>{const e={currentView:s,previousView:c,navigateTo:u,navigateBack:m,getPreviousView:h,clearHistory:p,syncCurrentView:f,getContextAwareFallback:g,canNavigateBack:d};return Object.defineProperty(e,"navigationHistory",{get:()=>[...n],enumerable:!0,configurable:!0}),e},[s,c,n,u,m,h,p,f,g,d]);return(0,Ts.jsx)(Zl.Provider,{value:v,children:a})}function ic(){const t=(0,e.useContext)(Zl);if(!t)throw new Error("useNavigationHistory must be used within a NavigationHistoryProvider");return t}const oc=["enableBrowserBack","fallbackView"];function lc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{enableBrowserBackIntegration:a=!1,fallbackView:r=null,onNavigate:s=null}=t,i=ic(),{pushNavigationState:o,removeFromNavigationStack:l,hasActiveNavigationHandlers:c}=Xl(),d=(0,e.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=i.navigateTo(e,t,a);if(n&&s)try{"function"===typeof s&&s(e,t)}catch(r){console.error("Error in external navigation callback:",r)}return n},[i,s]),u=(0,e.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=i.navigateBack(e||r);if(t&&s)try{"function"===typeof s?s(t):console.error("useNavigationHistory: onNavigate is not a function:",typeof s)}catch(a){console.error("Error in external navigation callback:",a)}return t},[i,s,r]),m=(0,e.useCallback)(()=>{if(!a)return null;return o(()=>{u()},"NavigationHistory-BackHandler"),()=>{l()}},[a,u,o,l]);return(0,e.useEffect)(()=>{if(a){return m()}},[a,m]),(0,n.A)((0,n.A)({},i),{},{navigateTo:d,navigateBack:u,registerBackHandler:m,hasActiveNavigationHandlers:c,isBackNavigationAvailable:i.canNavigateBack||c()})}const cc=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>Boolean(e)&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()},dc=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)};var uc={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const mc=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],hc=(0,e.forwardRef)((t,a)=>{let{color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,iconNode:d}=t,u=he(t,mc);return(0,e.createElement)("svg",(0,n.A)((0,n.A)((0,n.A)({ref:a},uc),{},{width:s,height:s,stroke:r,strokeWidth:o?24*Number(i)/Number(s):i,className:cc("lucide",l)},!c&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1})(u)&&{"aria-hidden":"true"}),u),[...d.map(t=>{let[a,n]=t;return(0,e.createElement)(a,n)}),...Array.isArray(c)?c:[c]])}),pc=["className"],fc=(t,a)=>{const r=(0,e.forwardRef)((r,s)=>{let{className:i}=r,o=he(r,pc);return(0,e.createElement)(hc,(0,n.A)({ref:s,iconNode:a,className:cc("lucide-".concat((l=dc(t),l.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase())),"lucide-".concat(t),i)},o));var l});return r.displayName=dc(t),r},gc=fc("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),vc=fc("cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]),yc=fc("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),bc=fc("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),xc=fc("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]),wc=fc("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),Sc=fc("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),kc=fc("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),Nc=fc("shuffle",[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]]),jc=fc("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Tc=fc("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);let Ac=0;const _c={sky:{bg:"bg-sky-500/20",text:"text-sky-400"},rose:{bg:"bg-rose-500/20",text:"text-rose-400"},emerald:{bg:"bg-emerald-500/20",text:"text-emerald-400"},amber:{bg:"bg-amber-500/20",text:"text-amber-400"},blue:{bg:"bg-blue-500/20",text:"text-blue-400"}},Cc={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg","2xl":"max-w-2xl"};function Mc(t){let{children:a,title:n,subtitle:r,icon:s,iconColor:i="sky",onClose:o,maxWidth:l="md",className:c=""}=t;const d=Boolean(s),u=Cc[l]||Cc.md,m=_c[i]||_c.sky,h=(0,e.useRef)(null),p=(0,e.useRef)(null);(0,e.useEffect)(()=>(0===Ac&&(document.body.style.overflow="hidden"),Ac++,()=>(Ac=Math.max(0,Ac-1),void(0===Ac&&(document.body.style.overflow="")))),[]),(0,e.useEffect)(()=>{p.current=document.activeElement;const e=requestAnimationFrame(()=>{h.current&&!h.current.contains(document.activeElement)&&h.current.focus()});return()=>{cancelAnimationFrame(e),p.current&&document.body.contains(p.current)&&p.current.focus()}},[]);const f="text-slate-400 hover:text-slate-300 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-offset-2 focus:ring-offset-slate-800 rounded";return(0,Ts.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:e=>{o&&e.target===e.currentTarget&&o()},children:(0,Ts.jsx)("div",{ref:h,className:"bg-slate-800 rounded-lg shadow-xl ".concat(u," w-full border border-slate-600 ").concat(d?"relative":""," ").concat(c),role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",tabIndex:-1,onKeyDown:e=>{if("Escape"===e.key&&o)return e.stopPropagation(),void o();if("Tab"===e.key&&h.current){const t=h.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(0===t.length)return;const a=t[0],n=t[t.length-1];e.shiftKey&&document.activeElement===a?(e.preventDefault(),n.focus()):e.shiftKey||document.activeElement!==n||(e.preventDefault(),a.focus())}},onClick:e=>e.stopPropagation(),children:d?(0,Ts.jsxs)(Ts.Fragment,{children:[o&&(0,Ts.jsx)("button",{className:"absolute top-3 right-3 ".concat(f),onClick:o,children:(0,Ts.jsx)(Tc,{className:"w-5 h-5"})}),(0,Ts.jsxs)("div",{className:"p-6",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-4 mb-4",children:[(0,Ts.jsx)("div",{className:"w-12 h-12 ".concat(m.bg," rounded-full flex items-center justify-center flex-shrink-0"),children:(0,Ts.jsx)(s,{className:"w-6 h-6 ".concat(m.text)})}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("h3",{id:"modal-title",className:"text-xl font-semibold text-slate-100",children:n}),r&&(0,Ts.jsx)("p",{className:"text-sm text-slate-400 mt-1",children:r})]})]}),a]})]}):(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsxs)("div",{className:"p-4 border-b border-slate-600 flex items-center justify-between",children:[(0,Ts.jsx)("h3",{id:"modal-title",className:"text-lg font-semibold text-sky-300",children:n}),o&&(0,Ts.jsx)("button",{className:f,onClick:o,children:(0,Ts.jsx)(Tc,{className:"w-5 h-5"})})]}),(0,Ts.jsx)("div",{className:"p-4",children:a})]})})})}const Pc=["value","onChange","placeholder","id","disabled","type","className","error","onFocus","onBlur","onKeyDown"],Ec=["value","onChange","placeholder","id","disabled","className","error","rows"],Ic=["onClick","children","Icon","variant","size","disabled","className","type"],Rc=e.forwardRef((e,t)=>{let{value:a,onChange:r,placeholder:s,id:i,disabled:o,type:l="text",className:c="",error:d=!1,onFocus:u,onBlur:m,onKeyDown:h}=e,p=he(e,Pc);return(0,Ts.jsx)("input",(0,n.A)({ref:t,type:l,id:i,value:a,onChange:r,onFocus:u,onBlur:m,onKeyDown:h,disabled:o,placeholder:s,className:"w-full px-3 py-1.5 bg-slate-600 border rounded-md text-slate-100 placeholder-slate-400 focus:outline-none focus:ring-2 transition-colors leading-tight h-[38px] ".concat(d?"border-rose-500 focus:ring-rose-400 focus:border-rose-500":"border-slate-500 focus:ring-sky-400 focus:border-sky-500"," ").concat(c)},p))});Rc.displayName="Input";const Oc=e.forwardRef((e,t)=>{let{value:a,onChange:r,placeholder:s,id:i,disabled:o,className:l="",error:c=!1,rows:d=3}=e,u=he(e,Ec);return(0,Ts.jsx)("textarea",(0,n.A)({ref:t,id:i,value:a,onChange:r,disabled:o,placeholder:s,rows:d,className:"w-full p-3 bg-slate-700 border rounded-lg text-slate-100 placeholder-slate-400 focus:outline-none focus:ring-2 focus:border-transparent resize-none ".concat(c?"border-rose-500 focus:ring-rose-400":"border-slate-500 focus:ring-sky-500"," ").concat(l)},u))});function Dc(e){let{value:t,onChange:a,options:n,placeholder:r,id:s,disabled:i,error:o=!1,className:l=""}=e;return(0,Ts.jsxs)("div",{className:"relative ".concat(l),children:[(0,Ts.jsxs)("select",{id:s,value:t,onChange:e=>a(e.target.value),disabled:i,className:"w-full appearance-none bg-slate-600 border text-slate-100 py-1.5 px-2.5 pr-7 rounded-md leading-tight focus:outline-none focus:ring-2 transition-colors h-[38px] ".concat(o?"border-rose-500 focus:ring-rose-400 focus:border-rose-500":"border-slate-500 focus:ring-sky-500 focus:border-sky-500"),children:[r&&(0,Ts.jsx)("option",{value:"",children:r}),n.map(e=>"object"===typeof e?(0,Ts.jsx)("option",{value:e.value,children:e.label},e.value):(0,Ts.jsx)("option",{value:e,children:e},e))]}),(0,Ts.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-slate-400",children:(0,Ts.jsx)(jc,{size:18})})]})}function Fc(t){let{value:a=[],onChange:n,options:r=[],placeholder:s="All",id:i,disabled:o=!1,className:l=""}=t;const{t:c}=xe("shared"),[d,u]=(0,e.useState)(!1),m=(0,e.useRef)(null),h=(0,e.useMemo)(()=>r.map(e=>"object"===typeof e?e:{value:e,label:String(e)}),[r]),p=(0,e.useMemo)(()=>new Set(a||[]),[a]),f=(0,e.useMemo)(()=>h.filter(e=>p.has(e.value)),[h,p]),g=f.length>0,v=(0,e.useMemo)(()=>0===f.length?s:1===f.length?f[0].label:f.length===h.length?c("multiSelect.allSelected"):f.length<=2?f.map(e=>e.label).join(", "):"".concat(f.length," ").concat(c("multiSelect.selected")),[h.length,s,f,c]);(0,e.useEffect)(()=>{if(!d)return;const e=e=>{m.current&&!m.current.contains(e.target)&&u(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[d]);return(0,Ts.jsxs)("div",{className:"relative ".concat(l),ref:m,children:[(0,Ts.jsxs)("button",{type:"button",id:i,onClick:()=>{o||u(e=>!e)},disabled:o,"aria-haspopup":"listbox","aria-expanded":d,className:"w-full bg-slate-600 border border-slate-500 text-slate-100 py-1.5 px-2.5 pr-7 rounded-md leading-tight focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500 transition-colors transition-shadow flex items-center justify-between gap-2 h-[38px] ".concat(o?"opacity-60 cursor-not-allowed":"cursor-pointer"," ").concat(g?"border-sky-300 shadow-[0_0_14px_rgba(125,211,252,0.65),0_0_28px_rgba(56,189,248,0.45)] ring-2 ring-sky-300/80 ring-offset-2 ring-offset-slate-800":""),children:[(0,Ts.jsx)("span",{className:"truncate text-left flex-1 ".concat(g?"text-sky-300":"text-slate-400"),children:v}),(0,Ts.jsx)(jc,{size:18,className:"shrink-0 transition-transform ".concat(d?"rotate-180":"")})]}),d&&(0,Ts.jsxs)("div",{role:"listbox","aria-multiselectable":"true",className:"absolute z-20 mt-1 w-full bg-slate-700 border border-slate-600 rounded-md shadow-lg max-h-60 overflow-y-auto",children:[0===h.length?(0,Ts.jsx)("div",{className:"px-3 py-2 text-sm text-slate-400",children:c("multiSelect.noOptions")}):(0,Ts.jsx)("ul",{className:"py-1",children:h.map(e=>{const t=p.has(e.value);return(0,Ts.jsx)("li",{children:(0,Ts.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 text-sm text-slate-100 hover:bg-slate-600 cursor-pointer",children:[(0,Ts.jsx)("input",{type:"checkbox",checked:t,onChange:()=>(e=>{if(o)return;const t=p.has(e)?(a||[]).filter(t=>t!==e):[...a||[],e];n(t)})(e.value),className:"h-4 w-4 rounded border-slate-500 text-sky-500 focus:ring-sky-500","aria-label":e.label}),(0,Ts.jsx)("span",{className:"truncate",children:e.label})]})},e.value)})}),(0,Ts.jsxs)("div",{className:"border-t border-slate-600 px-3 py-2 flex justify-between items-center gap-2 bg-slate-700 sticky bottom-0",children:[(a||[]).length>0&&(0,Ts.jsx)("button",{type:"button",onClick:()=>{o||n([])},className:"text-xs text-sky-400 hover:text-sky-300",children:c("multiSelect.clearSelection")}),(0,Ts.jsx)("button",{type:"button",onClick:()=>u(!1),className:"ml-auto text-sm px-3 py-1 bg-sky-600 hover:bg-sky-500 text-white rounded transition-colors",children:c("multiSelect.done")})]})]})]})}function Lc(e){let{onClick:t,children:a,Icon:r,variant:s="primary",size:i="md",disabled:o=!1,className:l="",type:c="button"}=e,d=he(e,Ic);const u={primary:"bg-sky-600 hover:bg-sky-500 text-white focus:ring-sky-500 ".concat(o?"opacity-50 cursor-not-allowed":""),secondary:"bg-slate-600 hover:bg-slate-500 text-sky-100 focus:ring-slate-500 ".concat(o?"opacity-50 cursor-not-allowed":""),danger:"bg-rose-600 hover:bg-rose-500 text-white focus:ring-rose-500 ".concat(o?"opacity-50 cursor-not-allowed":""),accent:"bg-emerald-600 hover:bg-emerald-500 text-white focus:ring-emerald-500 ".concat(o?"opacity-50 cursor-not-allowed":"")};return(0,Ts.jsxs)("button",(0,n.A)((0,n.A)({type:c,onClick:t,disabled:o,className:"".concat("font-semibold rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-800 transition-all duration-150 ease-in-out flex items-center justify-center space-x-2"," ").concat({sm:"px-2 py-1 text-xs",md:"px-3 py-1.5 text-sm",lg:"px-4 py-2 text-base"}[i]," ").concat(u[s]," ").concat(l)},d),{},{children:[r&&(0,Ts.jsx)(r,{className:"h-4 w-4 ".concat("lg"===i?"h-5 w-5":"")}),(0,Ts.jsx)("span",{children:a})]}))}function qc(e){let{isOpen:t,onConfirm:a,onCancel:n,title:r,message:s,confirmText:i,cancelText:o,variant:l="danger",confirmDisabled:c=!1,cancelDisabled:d=!1}=e;const{t:u}=xe("common");return t?(0,Ts.jsxs)(Mc,{title:r,onClose:n,children:[(0,Ts.jsx)("p",{className:"text-slate-200 mb-6",children:s}),(0,Ts.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 sm:justify-end",children:[(0,Ts.jsx)(Lc,{onClick:n,variant:"secondary",className:"sm:order-1",disabled:d,children:o||u("buttons.cancel")}),(0,Ts.jsx)(Lc,{onClick:a,variant:l,className:"sm:order-2",disabled:c,children:i||u("buttons.confirm")})]})]}):null}function Uc(e){let{isOpen:t,onClose:a,title:n,message:r,buttonText:s}=e;const{t:i}=xe("shared");return t?(0,Ts.jsxs)(Mc,{title:n,onClose:a,children:[(0,Ts.jsx)("p",{className:"text-slate-200 mb-6",children:r}),(0,Ts.jsx)("div",{className:"flex justify-center",children:(0,Ts.jsx)(Lc,{onClick:a,variant:"primary",children:s||i("ok")})})]}):null}function Bc(e){let{isOpen:t,onPrimary:a,onSecondary:n,onTertiary:r,title:s,message:i,primaryText:o,secondaryText:l,tertiaryText:c,primaryVariant:d="danger",secondaryVariant:u="secondary",tertiaryVariant:m="secondary"}=e;const{t:h}=xe("common");return t?(0,Ts.jsxs)(Mc,{title:s,children:[(0,Ts.jsx)("p",{className:"text-slate-200 mb-6",children:i}),(0,Ts.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,Ts.jsx)(Lc,{onClick:a,variant:d,children:o||h("buttons.confirm")}),(0,Ts.jsx)(Lc,{onClick:n,variant:u,children:l||h("buttons.cancel")}),(0,Ts.jsx)(Lc,{onClick:r,variant:m,children:c})]})]}):null}function Gc(e){let{isOpen:t,onSetNext:a,onRemoveFromNext:n,onSubNow:r,onCancel:s,onChangePosition:i,playerName:o,availablePlayers:l=[],showPositionChange:c=!1,showPositionOptions:d=!1,showSubstitutionOptions:u=!0,canSubstitute:m=!0,isPlayerAboutToSubOff:h=!1}=e;const{t:p}=xe(["modals","game"]);if(!t)return null;return(0,Ts.jsx)(Mc,{title:p(d?"fieldPlayer.changePositionTitle":"fieldPlayer.title"),onClose:s,children:d?(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)("p",{className:"text-slate-200 mb-6",children:p("fieldPlayer.selectPositionSwitch",{playerName:o})}),(0,Ts.jsxs)("div",{className:"flex flex-col gap-3 max-h-64 overflow-y-auto",children:[(0,Ts.jsx)(Lc,{onClick:()=>{i&&i(null)},variant:"secondary",children:p("fieldPlayer.back")}),l.map(e=>(0,Ts.jsxs)(Lc,{onClick:()=>i&&i(e.id),variant:"primary",className:"text-left",children:[Kl(e)," - ",p("game:formation.positions.".concat(e.stats.currentPositionKey))]},e.id))]})]}):(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)("p",{className:"text-slate-200 mb-6",children:p("fieldPlayer.message",{playerName:o})}),(0,Ts.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,Ts.jsx)(Lc,{onClick:s,variant:"secondary",children:p("fieldPlayer.cancel")}),u&&(0,Ts.jsxs)(Ts.Fragment,{children:[h?(0,Ts.jsx)(Lc,{onClick:n,variant:"primary",disabled:!m,title:p(m?"fieldPlayer.removeFromNext":"fieldPlayer.tooltipCannotModify"),children:p("fieldPlayer.removeFromNext")}):(0,Ts.jsx)(Lc,{onClick:a,variant:"primary",disabled:!m,title:p(m?"fieldPlayer.setToGoOffNext":"fieldPlayer.tooltipCannotSetNext"),children:p("fieldPlayer.setToGoOffNext")}),(0,Ts.jsx)(Lc,{onClick:r,variant:"danger",disabled:!m,title:p(m?"fieldPlayer.substituteNow":"fieldPlayer.tooltipCannotSubstitute"),children:p("fieldPlayer.substituteNow")})]}),c&&(0,Ts.jsx)(Lc,{onClick:()=>i&&i("show-options"),variant:"accent",children:p("fieldPlayer.changePosition")})]})]})})}function zc(e){let{isOpen:t,onInactivate:a,onActivate:n,onCancel:r,onSetAsNextToGoIn:s,onChangeNextPosition:i,playerName:o,isCurrentlyInactive:l,canSetAsNextToGoIn:c=!1,canChangeNextPosition:d=!1,availableNextPositions:u=[],showPositionSelection:m=!1}=e;const{t:h}=xe("modals");if(!t)return null;return(0,Ts.jsx)(Mc,{title:h(m?"substitute.changeNextPositionTitle":"substitute.title"),onClose:r,children:m?(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)("p",{className:"text-slate-200 mb-6",children:h("substitute.selectNextPosition",{playerName:o})}),(0,Ts.jsxs)("div",{className:"flex flex-col gap-3 max-h-64 overflow-y-auto",children:[(0,Ts.jsx)(Lc,{onClick:()=>{i&&i(null)},variant:"secondary",children:h("substitute.back")}),u.map(e=>(0,Ts.jsx)(Lc,{onClick:()=>i&&i(e.value),variant:"primary",className:"text-left",children:e.label},e.value))]})]}):(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)("p",{className:"text-slate-200 mb-6",children:h("substitute.message",{playerName:o})}),(0,Ts.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,Ts.jsx)(Lc,{onClick:r,variant:"secondary",children:h("substitute.cancel")}),d&&!l&&(0,Ts.jsx)(Lc,{onClick:()=>i&&i("show-options"),variant:"accent",children:h("substitute.changeNextPosition")}),c&&!l&&(0,Ts.jsx)(Lc,{onClick:s,variant:"accent",children:h("substitute.setToGoInNext")}),l?(0,Ts.jsx)(Lc,{onClick:n,variant:"primary",children:h("substitute.putBackInRotation",{playerName:o})}):(0,Ts.jsx)(Lc,{onClick:a,variant:"danger",children:h("substitute.takeOutOfRotation",{playerName:o})})]})]})})}function Vc(e){let{isOpen:t,onCancel:a,onSelectGoalie:n,currentGoalieName:r,availablePlayers:s=[]}=e;const{t:i}=xe(["modals","shared"]);return t?(0,Ts.jsxs)(Mc,{title:i("modals:goalie.title"),onClose:a,children:[(0,Ts.jsx)("p",{className:"text-slate-200 mb-6",children:i("modals:goalie.message",{goalieName:r})}),(0,Ts.jsxs)("div",{className:"flex flex-col gap-3 max-h-64 overflow-y-auto",children:[(0,Ts.jsx)(Lc,{onClick:a,variant:"secondary",children:i("modals:goalie.cancel")}),s.map(e=>(0,Ts.jsxs)(Lc,{onClick:()=>n(e.id),variant:e.isInactive?"secondary":"primary",disabled:e.isInactive,className:"text-left ".concat(e.isInactive?"opacity-50 cursor-not-allowed":""),children:[Kl(e)," ",e.isInactive?i("modals:goalie.inactive"):""]},e.id))]})]}):null}function Hc(t){let{isOpen:a,onCancel:r,ownScore:s,opponentScore:i,ownTeamName:o=Ul.OWN_TEAM_NAME,opponentTeam:l,matchEvents:c=[],goalScorers:d={},allPlayers:u=[],onAddGoalScored:m,onAddGoalConceded:h,onEditGoalScorer:p,onDeleteGoal:f,calculateMatchTime:g,formatTime:v,getPlayerName:y,allowScorerSelection:b=!0}=t;const{t:x}=xe(["modals","shared"]),w=l||x("shared:opponent"),S=e.useMemo(()=>{const e=c.filter(e=>[wo.GOAL_SCORED,wo.GOAL_CONCEDED].includes(e.type)).filter(e=>!e.undone).map(e=>{var t;const a=e.matchTime||(g?g(e.timestamp):"0:00"),r=d[e.id]||(null===(t=e.data)||void 0===t?void 0:t.scorerId),s=r&&y?y(r):null,i=b?s||x("scoreManager.unknownScorer"):x("scoreManager.scorerNotTracked");return(0,n.A)((0,n.A)({},e),{},{matchTime:a,scorerName:s,scorerLabel:i,isGoalScored:e.type===wo.GOAL_SCORED})}).sort((e,t)=>e.timestamp-t.timestamp);return e},[c,d,y,g,b,x]),k=()=>{r()};return a?(0,Ts.jsx)(Mc,{title:x("scoreManager.title"),onClose:k,maxWidth:"lg",children:(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between space-x-4 bg-slate-700 p-3 rounded-lg",children:[(0,Ts.jsxs)("div",{className:"text-center",children:[(0,Ts.jsx)("div",{className:"text-sm text-slate-300",children:o}),(0,Ts.jsx)("div",{className:"text-2xl font-bold text-sky-400",children:s})]}),(0,Ts.jsx)("div",{className:"text-2xl font-mono font-bold text-slate-400",children:"-"}),(0,Ts.jsxs)("div",{className:"text-center",children:[(0,Ts.jsx)("div",{className:"text-sm text-slate-300",children:w}),(0,Ts.jsx)("div",{className:"text-2xl font-bold text-sky-400",children:i})]})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("h4",{className:"text-sm font-medium text-slate-300 mb-2",children:x("scoreManager.goalsScored")}),(0,Ts.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:0===S.length?(0,Ts.jsx)("div",{className:"text-slate-400 text-sm italic text-center py-4",children:x("scoreManager.noGoalsRecorded")}):S.map(e=>{var t,a;const n=e.id;return(0,Ts.jsx)("div",{className:"p-3 rounded-lg border ".concat(e.isGoalScored?"bg-sky-900/30 border-sky-600/50":"bg-slate-700/50 border-slate-600"),children:(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("div",{className:"flex-1",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)("span",{className:"text-sm font-mono text-slate-300",children:e.matchTime}),(0,Ts.jsx)("span",{className:"text-sm text-slate-400",children:"|"}),(0,Ts.jsxs)("span",{className:"text-sm font-semibold text-slate-200",children:[(null===(t=e.data)||void 0===t?void 0:t.ownScore)||0,"-",(null===(a=e.data)||void 0===a?void 0:a.opponentScore)||0]}),e.isGoalScored&&(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)("span",{className:"text-sm text-slate-400",children:"|"}),(0,Ts.jsx)("span",{className:"text-sm text-sky-300",children:e.scorerLabel})]}),!e.isGoalScored&&(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)("span",{className:"text-sm text-slate-400",children:"|"}),(0,Ts.jsx)("span",{className:"text-sm text-slate-300",children:x("scoreManager.opponent")})]})]})}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[e.isGoalScored&&b&&(0,Ts.jsx)(Lc,{onClick:()=>(e=>{p&&p(e)})(n),variant:"secondary",size:"sm",children:x("scoreManager.edit")}),(0,Ts.jsx)(Lc,{onClick:()=>(e=>{f&&f(e)})(n),variant:"danger",size:"sm",children:x("scoreManager.delete")})]})]})},n)})})]}),(0,Ts.jsxs)("div",{className:"border-t border-slate-600 pt-4",children:[(0,Ts.jsx)("h4",{className:"text-sm font-medium text-slate-300 mb-2",children:x("scoreManager.addGoal")}),(0,Ts.jsxs)("div",{className:"flex gap-2",children:[(0,Ts.jsxs)(Lc,{onClick:m,variant:"primary",className:"flex-1",children:["+ ",o]}),(0,Ts.jsxs)(Lc,{onClick:h,variant:"secondary",className:"flex-1",children:["+ ",w]})]})]}),(0,Ts.jsx)("div",{className:"flex justify-center pt-4",children:(0,Ts.jsx)(Lc,{onClick:k,variant:"primary",children:x("scoreManager.close")})})]})}):null}function Kc(e){let{isOpen:t,onCancel:a,onSelectSubstitute:n,fieldPlayerName:r,availableSubstitutes:s=[]}=e;const{t:i}=xe("modals");return t?(0,Ts.jsxs)(Mc,{title:i("substituteSelection.title"),onClose:a,children:[(0,Ts.jsx)("p",{className:"text-slate-200 mb-6",children:i("substituteSelection.message",{fieldPlayerName:r})}),(0,Ts.jsxs)("div",{className:"flex flex-col gap-3 max-h-64 overflow-y-auto",children:[(0,Ts.jsx)(Lc,{onClick:a,variant:"secondary",children:i("substituteSelection.cancel")}),s.map(e=>(0,Ts.jsx)(Lc,{onClick:()=>n(e.id),variant:"primary",className:"text-left",children:Kl(e)},e.id))]})]}):null}function Wc(e){let{value:t,onChange:a,min:n=0,max:r=1,step:s=.1,className:i="",disabled:o=!1,id:l}=e;const c=(t-n)/(r-n)*100;return(0,Ts.jsxs)("div",{className:"relative ".concat(i),children:[(0,Ts.jsx)("input",{type:"range",id:l,min:n,max:r,step:s,value:t,onChange:e=>a(parseFloat(e.target.value)),disabled:o,className:"w-full h-2 bg-slate-600 rounded-lg appearance-none cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-offset-2 focus:ring-offset-slate-800",style:{background:"linear-gradient(to right, #0ea5e9 0%, #0ea5e9 ".concat(c,"%, #475569 ").concat(c,"%, #475569 100%)")}}),(0,Ts.jsx)("style",{dangerouslySetInnerHTML:{__html:'\n          input[type="range"]::-webkit-slider-thumb {\n            appearance: none;\n            height: 16px;\n            width: 16px;\n            border-radius: 50%;\n            background: #0ea5e9;\n            border: 2px solid #ffffff;\n            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n            cursor: pointer;\n            transition: background-color 0.15s ease-in-out;\n          }\n          input[type="range"]::-webkit-slider-thumb:hover {\n            background: #0284c7;\n          }\n          input[type="range"]::-moz-range-thumb {\n            height: 16px;\n            width: 16px;\n            border-radius: 50%;\n            background: #0ea5e9;\n            border: 2px solid #ffffff;\n            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n            cursor: pointer;\n            appearance: none;\n            transition: background-color 0.15s ease-in-out;\n          }\n          input[type="range"]::-moz-range-thumb:hover {\n            background: #0284c7;\n          }\n          input[type="range"]:disabled::-webkit-slider-thumb {\n            background: #64748b;\n            cursor: not-allowed;\n          }\n          input[type="range"]:disabled::-moz-range-thumb {\n            background: #64748b;\n            cursor: not-allowed;\n          }\n          input[type="range"]::-moz-range-track {\n            height: 8px;\n            background: transparent;\n            border: none;\n          }\n        '}})]})}Oc.displayName="Textarea";const Yc={error:"bg-rose-900/30 border-rose-600/50 text-rose-300",success:"bg-emerald-900/30 border-emerald-600/50 text-emerald-300",info:"bg-sky-900/30 border-sky-600/50 text-sky-300",warning:"bg-amber-900/30 border-amber-600/50 text-amber-300"};function Jc(e){let{variant:t="error",icon:a,children:n,className:r=""}=e;return(0,Ts.jsx)("div",{className:"rounded-lg border p-4 ".concat(Yc[t]," ").concat(r),children:(0,Ts.jsxs)("div",{className:"flex items-start gap-3",children:[a&&(0,Ts.jsx)(a,{className:"h-5 w-5 shrink-0 mt-0.5"}),(0,Ts.jsx)("div",{className:"text-sm",children:n})]})})}const Qc={default:"bg-slate-700 border-slate-600",dark:"bg-slate-800 border-slate-600",highlighted:"bg-sky-900/30 border-sky-600/50",subtle:"bg-slate-700/50 border-slate-600"},$c={sm:"p-3",md:"p-4",lg:"p-6"};function Xc(e){let{variant:t="default",padding:a="md",className:n="",children:r}=e;return(0,Ts.jsx)("div",{className:"rounded-lg border ".concat(Qc[t]," ").concat($c[a]," ").concat(n),children:r})}const Zc=[1,2,3],ed=[10,15,20,25,30],td=e=>[{value:0,label:e("common:alerts.noAlerts")},{value:1,label:"1:00"},{value:1.25,label:"1:15"},{value:1.5,label:"1:30"},{value:1.75,label:"1:45"},{value:2,label:"2:00"},{value:2.25,label:"2:15"},{value:2.5,label:"2:30"},{value:2.75,label:"2:45"},{value:3,label:"3:00"},{value:3.5,label:"3:30"},{value:4,label:"4:00"},{value:4.5,label:"4:30"},{value:5,label:"5:00"}],ad=Bs(Br.DEBUG_MODE,{enabled:!1}),nd=e=>{const t=[...e];for(let a=t.length-1;a>0;a--){const e=Math.floor(Math.random()*(a+1));[t[a],t[e]]=[t[e],t[a]]}return t},rd=()=>{"undefined"!==typeof window&&"function"===typeof window.scrollTo&&window.scrollTo({top:0,behavior:"smooth"})};function sd(e){if(!e)throw new Error("Match ID is required to generate live match URL");return"".concat(window.location.origin,"/live/").concat(e)}async function id(e){try{const t=sd(e);return navigator.clipboard&&navigator.clipboard.writeText?(await navigator.clipboard.writeText(t),{success:!0,url:t}):{success:!1,url:t,error:"Clipboard API not available"}}catch(t){console.error("Failed to copy live match URL:",t);return{success:!1,url:sd(e),error:t.message}}}const od=fc("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),ld=fc("rows-4",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M21 7.5H3",key:"1hm9pq"}],["path",{d:"M21 12H3",key:"2avoz0"}],["path",{d:"M21 16.5H3",key:"n7jzkj"}]]),cd=fc("repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]),dd=fc("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),ud=fc("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),md=fc("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),hd=fc("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),pd=fc("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),fd=fc("ghost",[["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}],["path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z",key:"uwwb07"}]]),gd=fc("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]),vd=fc("unlink",[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]]),yd=fc("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),bd=fc("pen-line",[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),xd=fc("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),wd=fc("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Sd=fc("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),kd=fc("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Nd=fc("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),jd=fc("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]]),Td=fc("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Ad={default:"text-slate-400 hover:text-slate-200",danger:"text-slate-400 hover:text-rose-400"},_d={sm:"p-1",md:"p-2"},Cd={sm:"h-4 w-4",md:"h-5 w-5"};function Md(e){let{onClick:t,icon:a,label:n,variant:r="default",size:s="md",disabled:i=!1,className:o=""}=e;return(0,Ts.jsx)("button",{type:"button",onClick:t,disabled:i,"aria-label":n,className:"rounded transition-colors focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-offset-2 focus:ring-offset-slate-800 ".concat(Ad[r]," ").concat(_d[s]," ").concat(i?"opacity-50 cursor-not-allowed":""," ").concat(o),children:a&&(0,Ts.jsx)(a,{className:Cd[s]})})}function Pd(e){let{label:t,htmlFor:a,error:n,required:r,children:s,className:i=""}=e;return(0,Ts.jsxs)("div",{className:i,children:[t&&(0,Ts.jsxs)("label",{htmlFor:a,className:"block text-sm font-medium text-slate-300 mb-2",children:[t,r&&(0,Ts.jsx)("span",{className:"text-rose-400 ml-1",children:"*"})]}),s,n&&(0,Ts.jsx)("p",{className:"text-rose-400 text-sm mt-1",children:n})]})}const Ed=fc("user-pen",[["path",{d:"M11.5 15H7a4 4 0 0 0-4 4v2",key:"15lzij"}],["path",{d:"M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1817ys"}],["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}]]),Id=fc("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),Rd=fc("dice-5",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"M16 8h.01",key:"cr5u4v"}],["path",{d:"M8 8h.01",key:"1e4136"}],["path",{d:"M8 16h.01",key:"18s6g9"}],["path",{d:"M16 16h.01",key:"1f9h7w"}],["path",{d:"M12 12h.01",key:"1mp3jc"}]]),Od={sm:"w-6 h-6 text-xs",md:"w-8 h-8 text-sm",lg:"w-10 h-10 text-base",xl:"w-12 h-12 text-lg"},Dd={sky:"bg-sky-600",emerald:"bg-emerald-600",slate:"bg-slate-600"};function Fd(e){let{size:t="md",color:a="sky",className:n="",children:r}=e;return(0,Ts.jsx)("div",{className:"".concat(Od[t]," ").concat(Dd[a]," rounded-full flex items-center justify-center shrink-0 text-white font-medium ").concat(n),children:r})}function Ld(t){let{onRestartMatch:a,onAddPlayer:n,onNavigateToTacticalBoard:r,currentView:s,teamConfig:i,allPlayers:o,selectedSquadIds:l,onNavigateTo:c,authModal:d,onOpenTeamAdminModal:u,onOpenPreferencesModal:m,onSignOut:h,currentMatchId:p,matchState:f}=t;const{t:g}=xe(["navigation","shared"]),[v,y]=(0,e.useState)(!1),[b,x]=(0,e.useState)({isOpen:!1,title:"",message:""}),{isAuthenticated:w,user:S,userProfile:k}=Cs(),{hasTeams:N,canManageTeam:j,hasPendingRequests:T,pendingRequestsCount:A,canViewStatistics:_}=vi(),C=()=>{y(!1),d.openSignup()},M="config"===s,P=()=>null!==k&&void 0!==k&&k.name?k.name:null!==S&&void 0!==S&&S.email?S.email.split("@")[0]:g("shared:user");return(0,Ts.jsxs)("div",{className:"relative",children:[(0,Ts.jsxs)("button",{onClick:()=>{y(!v)},className:"p-2 text-sky-400 hover:text-sky-300 focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-offset-2 focus:ring-offset-slate-900 rounded relative","aria-label":g("menu.ariaLabel"),children:[(0,Ts.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),T&&j&&(0,Ts.jsx)("div",{className:"absolute -top-0.5 -right-0.5 w-3 h-3 bg-red-500 rounded-full border-2 border-slate-900 flex items-center justify-center",children:(0,Ts.jsx)("span",{className:"text-white text-[6px] font-bold leading-none",children:A})})]}),v&&(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>y(!1)}),(0,Ts.jsx)("div",{className:"absolute right-0 mt-2 w-56 bg-slate-700 rounded-lg shadow-lg border border-slate-600 z-20",children:(0,Ts.jsxs)("div",{className:"py-1",children:[w?(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)("div",{className:"px-4 py-3 border-b border-slate-600",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ts.jsx)(Fd,{size:"md",children:P().charAt(0).toUpperCase()}),(0,Ts.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,Ts.jsx)("p",{className:"text-slate-100 text-sm font-medium truncate",children:P()}),(0,Ts.jsx)("p",{className:"text-slate-400 text-xs truncate",children:null===S||void 0===S?void 0:S.email})]})]})}),(0,Ts.jsx)("button",{onClick:()=>{y(!1),c&&c(bi.PROFILE)},className:"block w-full text-left px-4 py-2 text-sm text-slate-100 hover:bg-slate-600 hover:text-sky-400 transition-colors duration-200",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(Ed,{className:"w-4 h-4"}),(0,Ts.jsx)("span",{children:g("menu.profile")})]})}),(0,Ts.jsx)("button",{onClick:()=>{y(!1),m&&m()},className:"block w-full text-left px-4 py-2 text-sm text-slate-100 hover:bg-slate-600 hover:text-sky-400 transition-colors duration-200",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(yc,{className:"w-4 h-4"}),(0,Ts.jsx)("span",{children:g("menu.preferences")})]})}),N?(0,Ts.jsx)("button",{onClick:()=>{y(!1),c&&c(bi.TEAM_MANAGEMENT)},className:"block w-full text-left px-4 py-2 text-sm text-slate-100 hover:bg-slate-600 hover:text-sky-400 transition-colors duration-200",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(od,{className:"w-4 h-4"}),(0,Ts.jsx)("span",{children:g("menu.teamManagement")}),T&&j&&(0,Ts.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full flex items-center justify-center ml-1",children:(0,Ts.jsx)("span",{className:"text-white text-[6px] font-bold leading-none",children:A})})]})}):(0,Ts.jsx)("button",{onClick:()=>{y(!1),c&&c(bi.TEAM_MANAGEMENT)},className:"block w-full text-left px-4 py-2 text-sm text-slate-100 hover:bg-slate-600 hover:text-sky-400 transition-colors duration-200",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,Ts.jsx)("span",{children:g("menu.createTeam")})]})}),N&&(0,Ts.jsx)("button",{onClick:()=>{y(!1),c&&c(bi.TEAM_MATCHES)},className:"block w-full text-left px-4 py-2 text-sm text-slate-100 hover:bg-slate-600 hover:text-sky-400 transition-colors duration-200",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(Id,{className:"w-4 h-4"}),(0,Ts.jsx)("span",{children:g("menu.teamMatches")})]})}),_&&(0,Ts.jsx)("button",{onClick:()=>{y(!1),c&&_&&c(bi.STATISTICS)},className:"block w-full text-left px-4 py-2 text-sm text-slate-100 hover:bg-slate-600 hover:text-sky-400 transition-colors duration-200",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),(0,Ts.jsx)("span",{children:g("menu.statistics")})]})})]}):(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)("button",{onClick:()=>{y(!1),d.openLogin()},className:"block w-full text-left px-4 py-2 text-sm text-slate-100 hover:bg-slate-600 hover:text-sky-400 transition-colors duration-200",children:g("menu.signIn")}),(0,Ts.jsx)("button",{onClick:C,className:"block w-full text-left px-4 py-2 text-sm text-slate-100 hover:bg-slate-600 hover:text-sky-400 transition-colors duration-200",children:g("menu.createAccount")}),(0,Ts.jsx)("div",{className:"border-t border-slate-600 my-1"}),(0,Ts.jsxs)("div",{className:"px-4 py-2",children:[(0,Ts.jsx)("p",{className:"text-xs text-slate-400 mb-2",children:g("menu.signInToUnlock")}),(0,Ts.jsxs)("div",{className:"space-y-1",children:[(0,Ts.jsxs)("button",{onClick:C,className:"flex items-center justify-between w-full text-left py-1 text-xs text-slate-300 hover:text-sky-400 transition-colors",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),(0,Ts.jsx)("span",{children:g("menu.teamManagement")})]}),(0,Ts.jsx)("svg",{className:"w-3 h-3 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})]}),(0,Ts.jsxs)("button",{onClick:C,className:"flex items-center justify-between w-full text-left py-1 text-xs text-slate-300 hover:text-sky-400 transition-colors",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),(0,Ts.jsx)("span",{children:g("menu.statistics")})]}),(0,Ts.jsx)("svg",{className:"w-3 h-3 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})]}),(0,Ts.jsxs)("button",{onClick:C,className:"flex items-center justify-between w-full text-left py-1 text-xs text-slate-300 hover:text-sky-400 transition-colors",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903C6.69 5.97 9.217 4 12 4s5.31 1.97 5.88 4.097A4 4 0 0117 16H7z"})}),(0,Ts.jsx)("span",{children:g("menu.cloudSync")})]}),(0,Ts.jsx)("svg",{className:"w-3 h-3 text-slate-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})]})]})]}),(0,Ts.jsx)("div",{className:"border-t border-slate-600 my-1"})]}),(0,Ts.jsx)("button",{onClick:()=>{y(!1),r()},className:"block w-full text-left px-4 py-2 text-sm text-slate-100 hover:bg-slate-600 hover:text-sky-400 transition-colors duration-200",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(Rd,{className:"w-4 h-4"}),(0,Ts.jsx)("span",{children:g("menu.tacticalBoard")})]})}),(0,Ts.jsx)("button",{onClick:()=>{y(!1),n()},disabled:!M,className:"block w-full text-left px-4 py-2 text-sm transition-colors duration-200 ".concat(M?"text-slate-100 hover:bg-slate-600 hover:text-sky-400":"text-slate-400 cursor-not-allowed"),children:g("menu.addPlayer")}),w&&p&&("running"===f||"pending"===f)&&(0,Ts.jsx)("button",{onClick:async()=>{if(y(!1),p)try{const e=await id(p);e.success?x({isOpen:!0,title:g("liveMatchLink.linkCopied"),message:g("liveMatchLink.linkCopiedMessage")}):x({isOpen:!0,title:g("liveMatchLink.liveMatchUrl"),message:e.url})}catch(e){console.error("Failed to handle live link:",e),x({isOpen:!0,title:g("liveMatchLink.error"),message:g("liveMatchLink.errorMessage")})}else console.warn("No current match ID available")},className:"block w-full text-left px-4 py-2 text-sm text-slate-100 hover:bg-slate-600 hover:text-sky-400 transition-colors duration-200",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(Sc,{className:"w-4 h-4"}),(0,Ts.jsx)("span",{children:g("menu.getLiveMatchLink")})]})}),(0,Ts.jsx)("button",{onClick:()=>{y(!1),a()},className:"block w-full text-left px-4 py-2 text-sm text-slate-100 hover:bg-slate-600 hover:text-sky-400 transition-colors duration-200",children:g("menu.newGame")}),w&&(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)("div",{className:"border-t border-slate-600 my-1"}),(0,Ts.jsx)("button",{onClick:async()=>{y(!1);try{await h()}catch(e){console.error("Error signing out:",e)}},className:"block w-full text-left px-4 py-2 text-sm text-rose-300 hover:bg-slate-600 hover:text-rose-200 transition-colors duration-200",children:g("menu.signOut")})]})]})})]}),(0,Ts.jsx)(Uc,{isOpen:b.isOpen,onClose:()=>x({isOpen:!1,title:"",message:""}),title:b.title,message:b.message})]})}function qd(t){let{isOpen:a,onClose:n,onAddPlayer:r}=t;const{t:s}=xe("modals"),[i,o]=(0,e.useState)(""),l=()=>{o(""),n()};return a?(0,Ts.jsxs)(Mc,{title:s("addTemporaryPlayer.title"),onClose:l,children:[(0,Ts.jsx)("p",{className:"text-sm text-slate-400 mb-4",children:s("addTemporaryPlayer.description")}),(0,Ts.jsxs)("form",{onSubmit:e=>{e.preventDefault(),i.trim()&&(r(i.trim()),o(""),n())},children:[(0,Ts.jsxs)("div",{className:"mb-4",children:[(0,Ts.jsx)("label",{htmlFor:"playerName",className:"block text-sm font-medium text-slate-300 mb-2",children:s("addTemporaryPlayer.playerNameLabel")}),(0,Ts.jsx)(Rc,{id:"playerName",value:i,onChange:e=>o(Is(e.target.value)),placeholder:s("addTemporaryPlayer.playerNamePlaceholder"),maxLength:50,autoFocus:!0})]}),(0,Ts.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,Ts.jsx)("button",{type:"button",onClick:l,className:"px-4 py-2 text-slate-300 hover:text-slate-100 focus:outline-none focus:ring-2 focus:ring-slate-400 rounded",children:s("addTemporaryPlayer.cancel")}),(0,Ts.jsx)("button",{type:"submit",disabled:!i.trim(),className:"px-4 py-2 bg-sky-600 text-white rounded hover:bg-sky-700 focus:outline-none focus:ring-2 focus:ring-sky-400 disabled:opacity-50 disabled:cursor-not-allowed",children:s("addTemporaryPlayer.addPlayer")})]})]})]}):null}function Ud(t){let{children:a,content:n,position:r="bottom",trigger:s="click",className:i="",contentClassName:o=""}=t;const[l,c]=(0,e.useState)(!1),d=(0,e.useRef)(null),u="hover"===s;(0,e.useEffect)(()=>{if(!l)return;const e=e=>{d.current&&!d.current.contains(e.target)&&c(!1)},t=e=>{"Escape"===e.key&&c(!1)};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),document.addEventListener("keydown",t),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e),document.removeEventListener("keydown",t)}},[l]);const m=()=>c(!0),h=()=>c(!1);return(0,Ts.jsxs)("div",{ref:d,className:"relative inline-block ".concat(i),onMouseEnter:u?m:void 0,onMouseLeave:u?h:void 0,children:[(0,Ts.jsx)("div",{onClick:u?void 0:e=>{e.preventDefault(),e.stopPropagation(),c(!l)},onFocus:u?m:void 0,onBlur:u?h:void 0,className:"cursor-pointer",children:a}),l&&(0,Ts.jsx)("div",{className:"absolute z-50 ".concat((()=>{switch(r){case"top":return"bottom-full mb-2 left-1/2 transform -translate-x-1/2";case"bottom":default:return"top-full mt-2 left-1/2 transform -translate-x-1/2";case"left":return"right-full mr-2 top-1/2 transform -translate-y-1/2";case"right":return"left-full ml-2 top-1/2 transform -translate-y-1/2"}})()),onClick:e=>e.stopPropagation(),children:(0,Ts.jsx)("div",{className:"bg-slate-700 border border-slate-500 rounded-lg shadow-xl p-3 max-w-md min-w-[18rem] whitespace-normal ".concat(o),children:n})})]})}function Bd(e){let{label:t,colorClass:a="",icon:n,iconClassName:r="w-4 h-4",className:s="",children:i}=e;return(0,Ts.jsxs)("span",{className:"inline-flex items-center gap-1 rounded-full text-xs font-medium ".concat(a," ").concat(s),children:[n?(0,Ts.jsx)(n,{className:r}):null,(0,Ts.jsx)("span",{children:t}),i]})}var Gd=a(173),zd=a.n(Gd),Vd=a(950);function Hd(e){let{children:t}=e;return(0,Vd.createPortal)(t,document.body)}Hd.propTypes={children:zd().node.isRequired};const Kd={sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"};function Wd(e){let{size:t="lg",message:a,className:n=""}=e;return(0,Ts.jsxs)("div",{className:"flex flex-col items-center justify-center ".concat(n),children:[(0,Ts.jsx)("div",{className:"animate-spin rounded-full border-b-2 border-sky-400 ".concat(Kd[t])}),a&&(0,Ts.jsx)("p",{className:"text-slate-400 mt-3 text-sm",children:a})]})}function Yd(e){let{icon:t,title:a,message:n,actions:r,className:s=""}=e;return(0,Ts.jsxs)("div",{className:"bg-slate-700 p-8 rounded-lg border border-slate-600 text-center ".concat(s),children:[t&&(0,Ts.jsx)(t,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),(0,Ts.jsx)("div",{className:"text-slate-400",children:a}),n&&("string"===typeof n?(0,Ts.jsx)("p",{className:"text-slate-500 text-sm mt-2",children:n}):(0,Ts.jsx)("div",{className:"mt-2",children:n})),r&&(0,Ts.jsx)("div",{className:"mt-4 flex justify-center",children:r})]})}function Jd(e){let{title:t,actions:a,border:n=!1,icon:r,className:s=""}=e;return(0,Ts.jsxs)("div",{className:"flex items-center justify-between ".concat(n?"border-b border-slate-600 pb-3":""," ").concat(s),children:[(0,Ts.jsxs)("h3",{className:"text-lg font-semibold text-sky-300 flex items-center gap-2",children:[r&&(0,Ts.jsx)(r,{className:"h-5 w-5"}),t]}),a&&(0,Ts.jsx)("div",{className:"flex items-center gap-2",children:a})]})}const Qd={scroll:{nav:"flex space-x-0 min-w-max",container:"overflow-x-auto",active:"border-sky-400 text-sky-300 bg-slate-600/50",inactive:"border-transparent text-slate-400 hover:text-slate-300 hover:bg-slate-600/30",tab:"flex items-center space-x-2 px-2 sm:px-4 py-3 text-sm font-medium border-b-2 transition-colors relative flex-shrink-0 whitespace-nowrap",iconSize:"w-4 h-4",badge:"absolute -top-1 -right-1 bg-red-600 text-red-100 text-xs rounded-full w-5 h-5 flex items-center justify-center"},wrap:{nav:"flex flex-wrap gap-3 sm:gap-4 md:gap-8",container:"",active:"border-sky-400 text-sky-400",inactive:"border-transparent text-slate-400 hover:text-slate-300 hover:border-slate-300",tab:"flex items-center space-x-1 sm:space-x-2 py-2 sm:py-3 px-2 sm:px-1 border-b-2 font-medium text-sm transition-colors whitespace-nowrap",iconSize:"h-5 w-5",badge:"absolute -top-1 -right-1 bg-red-600 text-red-100 text-xs rounded-full w-5 h-5 flex items-center justify-center"},pill:{nav:"flex space-x-1",container:"bg-slate-700 p-1 rounded-lg",active:"bg-slate-600 text-slate-100",inactive:"text-slate-300 hover:text-slate-100 hover:bg-slate-600",tab:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm font-medium rounded-md transition-colors",iconSize:"w-4 h-4",badge:"bg-sky-500 text-sky-100 text-xs px-2 py-1 rounded-full"}};function $d(e){let{tabs:t,activeTab:a,onTabChange:n,variant:r="scroll",className:s=""}=e;const i=Qd[r]||Qd.scroll;return(0,Ts.jsx)("div",{className:"".concat(i.container," ").concat(s).trim(),children:(0,Ts.jsx)("nav",{className:i.nav,children:t.map(e=>{const t=e.id===a,r=e.icon;return(0,Ts.jsxs)("button",{onClick:()=>n(e.id),className:"".concat(i.tab," ").concat(t?i.active:i.inactive),children:[r&&(0,Ts.jsx)(r,{className:i.iconSize}),(0,Ts.jsx)("span",{children:e.label}),null!=e.badge&&(0,Ts.jsx)("span",{className:i.badge,children:e.badge})]},e.id)})})})}const Xd=fc("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Zd=fc("building",[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]]),eu=fc("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);function tu(e){var t,a;let{onCreateNew:n}=e;const{t:r}=xe("team"),{currentTeam:s,userTeams:i,switchCurrentTeam:o,loading:l,error:c}=vi();return l?(0,Ts.jsx)(Xc,{padding:"lg",children:(0,Ts.jsx)(Wd,{size:"sm",message:r("teamSelector.loading")})}):c?(0,Ts.jsx)(Jc,{variant:"error",children:c}):(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsx)(Jd,{title:r("teamSelector.title"),icon:od,actions:(0,Ts.jsx)(Lc,{onClick:n,variant:"secondary",size:"sm",Icon:Xd,children:r("teamSelector.newTeam")})}),s&&(0,Ts.jsx)("div",{className:"p-4 bg-sky-600/20 border border-sky-500 rounded-lg",children:(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("div",{className:"text-sky-200 font-medium",children:s.name}),(0,Ts.jsxs)("div",{className:"text-sky-300 text-sm flex items-center mt-1",children:[(0,Ts.jsx)(Zd,{className:"h-3 w-3 mr-1"}),null===(t=s.club)||void 0===t?void 0:t.name,(null===(a=s.club)||void 0===a?void 0:a.short_name)&&(0,Ts.jsxs)("span",{className:"text-sky-400 ml-1",children:["(",s.club.short_name,")"]})]})]}),(0,Ts.jsx)("div",{className:"text-sky-300 text-xs px-2 py-1 bg-sky-700/50 rounded",children:r("teamSelector.current")})]})}),i.length>0&&(0,Ts.jsxs)("div",{className:"space-y-2",children:[(0,Ts.jsx)("h4",{className:"text-sm font-medium text-slate-300",children:r("teamSelector.availableTeams",{count:i.length})}),(0,Ts.jsx)("div",{className:"space-y-1",children:i.map(e=>{var t,a;const n=(null===s||void 0===s?void 0:s.id)===e.id;return(0,Ts.jsx)("button",{onClick:()=>!n&&o(e.id),disabled:n,className:"w-full p-3 rounded-lg border transition-all text-left ".concat(n?"bg-sky-600/10 border-sky-500/50 cursor-default":"bg-slate-700 border-slate-600 hover:bg-slate-600 hover:border-slate-500 cursor-pointer"),children:(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsxs)("div",{className:"flex-1",children:[(0,Ts.jsx)("div",{className:"font-medium ".concat(n?"text-sky-200":"text-slate-100"),children:e.name}),(0,Ts.jsxs)("div",{className:"text-sm flex items-center mt-1 ".concat(n?"text-sky-300":"text-slate-400"),children:[(0,Ts.jsx)(Zd,{className:"h-3 w-3 mr-1"}),null===(t=e.club)||void 0===t?void 0:t.name,(null===(a=e.club)||void 0===a?void 0:a.short_name)&&(0,Ts.jsxs)("span",{className:"ml-1",children:["(",e.club.short_name,")"]})]}),(0,Ts.jsx)("div",{className:"text-xs mt-1 ".concat(n?"text-sky-400":"text-slate-500"),children:r("teamSelector.role",{role:e.userRole})})]}),!n&&(0,Ts.jsx)(eu,{className:"h-4 w-4 text-slate-400"})]})},e.id)})})]}),0===i.length&&(0,Ts.jsx)(Yd,{icon:od,title:r("teamSelector.noTeamsTitle"),message:r("teamSelector.noTeamsMessage"),actions:(0,Ts.jsx)(Lc,{onClick:n,variant:"primary",Icon:Xd,children:r("teamSelector.createOrJoin")})})]})}const au=fc("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),nu=fc("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),ru=fc("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);function su(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{initialValue:a="",blurCloseDelay:n=150}=t,[r,s]=(0,e.useState)(!1),[i,o]=(0,e.useState)(a),l=(0,e.useRef)(null),c=(0,e.useRef)(null),d=(0,e.useRef)(null),u=(0,e.useCallback)(()=>{d.current&&(clearTimeout(d.current),d.current=null)},[]),m=(0,e.useCallback)(()=>{u(),s(!0)},[u]),h=(0,e.useCallback)(()=>{u(),d.current=setTimeout(()=>s(!1),n)},[n,u]),p=(0,e.useCallback)(e=>{"Escape"===e.key&&(s(!1),c.current&&c.current.blur())},[]);return(0,e.useEffect)(()=>{o(a)},[a]),(0,e.useEffect)(()=>{const e=e=>{l.current&&!l.current.contains(e.target)&&s(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,e.useEffect)(()=>()=>{u()},[u]),{isOpen:r,setIsOpen:s,query:i,setQuery:o,containerRef:l,inputRef:c,handleFocus:m,handleBlur:h,handleKeyDown:p}}function iu(t){let{value:a,onChange:n,onSelect:r,onCreateNew:s,placeholder:i,disabled:o=!1}=t;const{t:l}=xe("team"),{searchClubs:c}=vi(),[d,u]=(0,e.useState)([]),[m,h]=(0,e.useState)(!1),{isOpen:p,setIsOpen:f,query:g,setQuery:v,containerRef:y,inputRef:b,handleFocus:x,handleBlur:w,handleKeyDown:S}=su({initialValue:a||""}),k=(0,e.useCallback)(async e=>{if(e.trim()){h(!0);try{const t=await c(e);u(t)}catch(t){console.error("Error searching clubs:",t),u([])}finally{h(!1)}}else u([])},[c]),{run:N,cancel:j}=function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;const n=(0,e.useRef)(t),r=(0,e.useRef)(null);(0,e.useEffect)(()=>{n.current=t},[t]),(0,e.useEffect)(()=>()=>{r.current&&clearTimeout(r.current)},[]);const s=(0,e.useCallback)(()=>{r.current&&(clearTimeout(r.current),r.current=null)},[]),i=(0,e.useCallback)(function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{var e;null===(e=n.current)||void 0===e||e.call(n,...t)},a)},[a]);return{run:i,cancel:s}}(k,300),T=(0,e.useCallback)(e=>{const t=e.target.value;v(t),null===n||void 0===n||n(t),f(!0),N(t)},[n,v,f,N]),A=(0,e.useCallback)(e=>{x(e),g.trim()&&(j(),k(g))},[x,g,j,k]),_=(0,e.useCallback)(e=>{v(e.name),f(!1),null===r||void 0===r||r(e)},[r,v,f]),C=(0,e.useCallback)(()=>{f(!1),null===s||void 0===s||s(g)},[s,g,f]);(0,e.useEffect)(()=>()=>{j()},[j]),(0,e.useEffect)(()=>{v(a||"")},[a,v]);const M=g.trim()&&0===d.length&&!m;return(0,Ts.jsxs)("div",{ref:y,className:"relative",children:[(0,Ts.jsxs)("div",{className:"relative",children:[(0,Ts.jsx)(Rc,{ref:b,value:g,onChange:T,onFocus:A,onBlur:w,onKeyDown:S,placeholder:i||l("clubAutocomplete.placeholder"),disabled:o,className:"pr-10"}),(0,Ts.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:m?(0,Ts.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-sky-400 border-t-transparent rounded-full"}):(0,Ts.jsx)(ru,{className:"h-4 w-4 text-slate-400"})})]}),p&&(d.length>0||M)&&(0,Ts.jsxs)("div",{className:"absolute z-10 mt-1 w-full bg-slate-700 border border-slate-500 rounded-md shadow-lg max-h-64 overflow-auto",children:[d.map(e=>(0,Ts.jsx)("button",{onClick:()=>_(e),className:"w-full px-3 py-2 text-left hover:bg-slate-600 focus:bg-slate-600 focus:outline-none transition-colors border-b border-slate-600 last:border-b-0",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(Zd,{className:"h-4 w-4 text-sky-400 flex-shrink-0"}),(0,Ts.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,Ts.jsx)("div",{className:"text-slate-100 font-medium truncate",children:e.long_name||e.name}),e.short_name&&(0,Ts.jsxs)("div",{className:"text-slate-400 text-xs truncate",children:["(",e.name,", ",e.short_name,")"]})]})]})},e.id)),M&&(0,Ts.jsx)("button",{onClick:C,className:"w-full px-3 py-2 text-left hover:bg-emerald-600/20 focus:bg-emerald-600/20 focus:outline-none transition-colors border-t border-slate-500",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(Xd,{className:"h-4 w-4 text-emerald-400 flex-shrink-0"}),(0,Ts.jsxs)("div",{className:"flex-1",children:[(0,Ts.jsx)("div",{className:"text-emerald-300 font-medium",children:l("clubAutocomplete.createNewClub")}),(0,Ts.jsxs)("div",{className:"text-emerald-400 text-xs",children:['"',g,'"']})]})]})}),!m&&0===d.length&&!M&&g.trim()&&(0,Ts.jsx)("div",{className:"px-3 py-2 text-slate-400 text-sm",children:l("clubAutocomplete.noClubsFound",{query:g})})]})]})}function ou(t){let{teams:a=[],onSelect:n,onCreateNew:r,placeholder:s,disabled:i=!1,loading:o=!1}=t;const{t:l}=xe("team"),{isOpen:c,setIsOpen:d,query:u,setQuery:m,containerRef:h,inputRef:p,handleFocus:f,handleBlur:g,handleKeyDown:v}=su(),y=(0,e.useMemo)(()=>{const e=u.trim().toLowerCase();if(!e)return a;const t=[],n=[];for(const r of a){const a=r.name.toLowerCase();a.startsWith(e)?t.push(r):a.includes(e)&&n.push(r)}return[...t,...n]},[a,u]),b=(0,e.useCallback)(e=>{m(e.target.value),d(!0)},[m,d]),x=(0,e.useCallback)(e=>{f(e)},[f]),w=(0,e.useCallback)(e=>{m(e.name),d(!1),null===n||void 0===n||n(e)},[n,m,d]),S=(0,e.useCallback)(()=>{d(!1),null===r||void 0===r||r(u)},[r,u,d]),k=(0,e.useMemo)(()=>{const e=u.trim().toLowerCase();return e&&a.some(t=>t.name.toLowerCase()===e)},[a,u]),N=u.trim()&&!k&&!o;return(0,Ts.jsxs)("div",{ref:h,className:"relative",children:[(0,Ts.jsxs)("div",{className:"relative",children:[(0,Ts.jsx)(Rc,{ref:p,value:u,onChange:b,onFocus:x,onBlur:g,onKeyDown:v,placeholder:s||l("teamAutocomplete.placeholder"),disabled:i,className:"pr-10"}),(0,Ts.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:o?(0,Ts.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-sky-400 border-t-transparent rounded-full"}):(0,Ts.jsx)(ru,{className:"h-4 w-4 text-slate-400"})})]}),c&&(y.length>0||N)&&(0,Ts.jsxs)("div",{className:"absolute z-10 mt-1 w-full bg-slate-700 border border-slate-500 rounded-md shadow-lg max-h-64 overflow-auto",children:[y.map(e=>(0,Ts.jsx)("button",{onClick:()=>w(e),className:"w-full px-3 py-2 text-left hover:bg-slate-600 focus:bg-slate-600 focus:outline-none transition-colors border-b border-slate-600 last:border-b-0",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(od,{className:"h-4 w-4 text-sky-400 flex-shrink-0"}),(0,Ts.jsx)("div",{className:"text-slate-100 font-medium truncate",children:e.name})]})},e.id)),N&&(0,Ts.jsx)("button",{onClick:S,className:"w-full px-3 py-2 text-left hover:bg-emerald-600/20 focus:bg-emerald-600/20 focus:outline-none transition-colors border-t border-slate-500",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(Xd,{className:"h-4 w-4 text-emerald-400 flex-shrink-0"}),(0,Ts.jsxs)("div",{className:"flex-1",children:[(0,Ts.jsx)("div",{className:"text-emerald-300 font-medium",children:l("teamAutocomplete.createNewTeam")}),(0,Ts.jsxs)("div",{className:"text-emerald-400 text-xs",children:['"',u,'"']})]})]})})]})]})}const lu=fc("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);function cu(t){let{club:a,onClose:n,onSuccess:r}=t;const{t:s}=xe("team"),{joinClub:i,loading:o,error:l}=vi(),[c,d]=(0,e.useState)(!1);return a?c?(0,Ts.jsx)(Mc,{title:s("clubJoin.successTitle"),children:(0,Ts.jsxs)("div",{className:"text-center",children:[(0,Ts.jsx)("div",{className:"animate-pulse mb-4",children:(0,Ts.jsx)(bc,{className:"h-12 w-12 text-emerald-400 mx-auto"})}),(0,Ts.jsx)("h3",{className:"text-lg font-semibold text-emerald-300 mb-2",children:s("clubJoin.successTitle")}),(0,Ts.jsx)("p",{className:"text-slate-400",children:s("clubJoin.successMessage",{clubName:a.long_name||a.name})})]})}):(0,Ts.jsxs)(Mc,{title:s("clubJoin.title"),onClose:n,children:[l&&(0,Ts.jsx)(Jc,{variant:"error",icon:lu,className:"mb-4",children:l}),(0,Ts.jsxs)("div",{className:"text-center mb-6",children:[(0,Ts.jsx)(Zd,{className:"h-12 w-12 text-sky-400 mx-auto mb-4"}),(0,Ts.jsx)("h3",{className:"text-lg font-semibold text-slate-100 mb-2",children:a.long_name||a.name}),a.short_name&&(0,Ts.jsxs)("p",{className:"text-slate-400 text-sm",children:["(",a.name,", ",a.short_name,")"]})]}),(0,Ts.jsx)(Xc,{variant:"subtle",className:"mb-6",children:(0,Ts.jsxs)("div",{className:"flex items-start gap-3",children:[(0,Ts.jsx)(od,{className:"h-5 w-5 text-sky-400 mt-0.5 flex-shrink-0"}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("p",{className:"text-slate-300 text-sm mb-2",children:(0,Ts.jsx)("strong",{children:s("clubJoin.joinBenefitsTitle")})}),(0,Ts.jsxs)("ul",{className:"text-slate-400 text-sm space-y-1",children:[(0,Ts.jsx)("li",{children:s("clubJoin.benefits.accessTeams")}),(0,Ts.jsx)("li",{children:s("clubJoin.benefits.requestJoin")}),(0,Ts.jsx)("li",{children:s("clubJoin.benefits.createTeams")})]})]})]})}),(0,Ts.jsxs)("div",{className:"flex gap-3",children:[(0,Ts.jsx)(Lc,{onClick:n,variant:"secondary",className:"flex-1",disabled:o,children:s("clubJoin.buttons.cancel")}),(0,Ts.jsx)(Lc,{onClick:async()=>{if(a)try{await i(a.id)&&(d(!0),setTimeout(()=>{r()},1500))}catch(e){console.error("Error joining club:",e)}},variant:"primary",className:"flex-1",disabled:o,Icon:o?null:bc,children:s(o?"clubJoin.buttons.joining":"clubJoin.buttons.joinClub")})]})]}):null}const du=fc("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]),uu=fc("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function mu(t){let{team:a,onClose:r,onSuccess:s,isStandaloneMode:i=!1}=t;const{t:o}=xe("team"),{requestTeamAccess:l,getTeamAccessRequests:c,getUserTeamRequests:d,approveTeamAccess:u,rejectTeamAccess:m,cancelTeamAccess:h,getTeamMembers:p,removeTeamMember:f,loading:g,error:v,isCoach:y,isTeamAdmin:b,canManageTeam:x}=vi(),[w,S]=(0,e.useState)("request"),[k,N]=(0,e.useState)({role:"coach",message:""}),[j,T]=(0,e.useState)([]),[A,_]=(0,e.useState)([]),[C,M]=(0,e.useState)([]),[P,E]=(0,e.useState)(""),[I,R]=(0,e.useState)(!1),O=(0,e.useCallback)(async()=>{if(!a)return;const e=await c(a.id);T(e)},[a,c]),D=(0,e.useCallback)(async()=>{if(!a)return;const e=(await d()).filter(e=>e.team.id===a.id);_(e)},[a,d]),F=(0,e.useCallback)(async()=>{if(!a)return;const e=await p(a.id);M(e)},[a,p]);(0,e.useEffect)(()=>{a&&(i||x?(O(),b&&F(),S("manage")):(D(),S("request")))},[a,x,b,i,O,F,D]);const L=async()=>{if(!a)return;await l(a.id,k.role,k.message.trim(),!0)&&(E(o("accessRequestModal.request.success.submitted")),R(!0),await D(),N({role:"coach",message:""}))},q=A.some(e=>"pending"===e.status);if(!a)return null;const U=[...x?[{id:"manage",label:o(b?"accessRequestModal.tabs.teamManagement":"accessRequestModal.tabs.manageRequests"),count:j.length}]:[],...i?[]:[{id:"request",label:o("accessRequestModal.tabs.request"),count:null}]];return(0,Ts.jsxs)(Mc,{title:o("accessRequestModal.header.title"),onClose:r,maxWidth:"2xl",children:[v&&(0,Ts.jsx)(Jc,{variant:"error",icon:lu,className:"mb-4",children:v}),U.length>1&&(0,Ts.jsx)("div",{className:"flex space-x-1 bg-slate-700 p-1 rounded-lg mb-4",children:U.map(e=>(0,Ts.jsxs)("button",{onClick:()=>S(e.id),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 text-sm font-medium rounded-md transition-colors ".concat(w===e.id?"bg-slate-600 text-slate-100":"text-slate-300 hover:text-slate-100 hover:bg-slate-600"),children:[e.label,null!==e.count&&e.count>0&&(0,Ts.jsx)("span",{className:"bg-amber-500 text-amber-900 text-xs px-2 py-1 rounded-full",children:e.count})]},e.id))}),(0,Ts.jsxs)("div",{className:"overflow-y-auto max-h-[calc(90vh-200px)]",children:["request"===w&&(()=>{var e;return(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{className:"text-center mb-6",children:[(0,Ts.jsx)(od,{className:"h-8 w-8 text-emerald-400 mx-auto mb-3"}),(0,Ts.jsx)("h3",{className:"text-lg font-semibold text-sky-300",children:o("accessRequestModal.request.header.title")}),(0,Ts.jsxs)("p",{className:"text-slate-400 text-sm mt-2",children:[o("accessRequestModal.request.header.subtitle")," ",(0,Ts.jsx)("strong",{children:null!==a&&void 0!==a&&null!==(e=a.club)&&void 0!==e&&e.long_name?"".concat(a.club.long_name," ").concat(a.name):null===a||void 0===a?void 0:a.name})]})]}),P?(0,Ts.jsx)(Jc,{variant:"success",children:P}):q&&!I?(0,Ts.jsx)("div",{className:"p-4 bg-amber-900/20 border border-amber-600/50 rounded-lg",children:(0,Ts.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Ts.jsx)(Sd,{className:"h-5 w-5 text-amber-600"}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("p",{className:"text-amber-100 font-medium",children:o("accessRequestModal.request.warnings.pendingTitle")}),(0,Ts.jsx)("p",{className:"text-amber-200 text-sm",children:o("accessRequestModal.request.warnings.pendingMessage")})]})]})}):P?null:(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsxs)(Pd,{label:o("accessRequestModal.request.form.roleLabel"),children:[(0,Ts.jsx)(Dc,{value:k.role,onChange:e=>N(t=>(0,n.A)((0,n.A)({},t),{},{role:e})),options:[{value:"coach",label:o("accessRequestModal.request.form.roles.coach")},{value:"parent",label:o("accessRequestModal.request.form.roles.parent")},{value:"admin",label:o("accessRequestModal.request.form.roles.admin")}]}),(0,Ts.jsx)("p",{className:"text-slate-500 text-xs mt-1",children:o("accessRequestModal.request.form.roleHint")})]}),(0,Ts.jsxs)(Pd,{label:o("accessRequestModal.request.form.messageLabel"),children:[(0,Ts.jsx)(Oc,{value:k.message,onChange:e=>N(t=>(0,n.A)((0,n.A)({},t),{},{message:e.target.value})),placeholder:o("accessRequestModal.request.form.messagePlaceholder"),rows:4,maxLength:500}),(0,Ts.jsx)("p",{className:"text-slate-500 text-xs mt-1",children:o("accessRequestModal.request.form.characterCount",{count:k.message.length})})]}),(0,Ts.jsxs)("div",{className:"flex justify-between",children:[(0,Ts.jsx)(Lc,{onClick:r,variant:"secondary",children:o("accessRequestModal.request.buttons.cancel")}),(0,Ts.jsx)(Lc,{onClick:L,disabled:g||!k.role,Icon:g?null:du,children:o(g?"accessRequestModal.request.buttons.sending":"accessRequestModal.request.buttons.sendRequest")})]})]}),P&&(0,Ts.jsx)("div",{className:"flex justify-center mt-4",children:(0,Ts.jsx)(Lc,{onClick:r,variant:"primary",children:o("accessRequestModal.request.buttons.close")})}),A.length>0&&(0,Ts.jsxs)("div",{className:"mt-6 pt-6 border-t border-slate-600",children:[(0,Ts.jsx)("h4",{className:"font-medium text-slate-200 mb-3",children:o("accessRequestModal.request.yourRequests.title")}),(0,Ts.jsx)("div",{className:"space-y-2",children:A.map(e=>(0,Ts.jsxs)("div",{className:"p-3",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsxs)("div",{children:[(0,Ts.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ts.jsxs)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full ".concat("pending"===e.status?"bg-amber-100 text-amber-800":"approved"===e.status?"bg-emerald-100 text-emerald-800":"bg-rose-100 text-rose-800"),children:["pending"===e.status&&(0,Ts.jsx)(Sd,{className:"h-3 w-3 mr-1"}),"approved"===e.status&&(0,Ts.jsx)(kd,{className:"h-3 w-3 mr-1"}),"rejected"===e.status&&(0,Ts.jsx)(uu,{className:"h-3 w-3 mr-1"}),o("accessRequestModal.request.status.".concat(e.status))]}),(0,Ts.jsx)("span",{className:"text-sm text-slate-400",children:o("accessRequestModal.request.yourRequests.role",{role:e.requested_role})})]}),(0,Ts.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:new Date(e.created_at).toLocaleDateString()})]}),"pending"===e.status&&(0,Ts.jsx)(Lc,{size:"sm",variant:"secondary",onClick:()=>(async e=>{await h(e)&&await D()})(e.id),disabled:g,children:o("accessRequestModal.request.yourRequests.cancel")})]}),e.message&&(0,Ts.jsxs)("p",{className:"text-sm text-slate-300 mt-2 p-2 bg-slate-700 rounded",children:['"',e.message,'"']}),e.review_notes&&(0,Ts.jsxs)("p",{className:"text-sm text-slate-400 mt-2 p-2 bg-slate-600 rounded",children:[(0,Ts.jsx)("strong",{children:o("accessRequestModal.request.yourRequests.reviewLabel")})," ",e.review_notes]})]},e.id))})]})]})})(),"manage"===w&&(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{className:"text-center mb-6",children:[(0,Ts.jsx)(md,{className:"h-8 w-8 text-sky-400 mx-auto mb-3"}),(0,Ts.jsxs)("h3",{className:"text-lg font-semibold text-sky-300",children:[o("accessRequestModal.manage.header.title"),b&&(0,Ts.jsx)("span",{className:"text-xs bg-emerald-600 text-emerald-100 px-2 py-1 rounded-full ml-2",children:o("accessRequestModal.manage.header.badgeAdmin")}),y&&!b&&(0,Ts.jsx)("span",{className:"text-xs bg-sky-600 text-sky-100 px-2 py-1 rounded-full ml-2",children:o("accessRequestModal.manage.header.badgeCoach")})]}),(0,Ts.jsxs)("p",{className:"text-slate-400 text-sm mt-2",children:[o("accessRequestModal.manage.header.subtitle")," ",(0,Ts.jsx)("strong",{children:null===a||void 0===a?void 0:a.name}),b&&(0,Ts.jsx)("span",{className:"block text-xs mt-1",children:o("accessRequestModal.manage.header.adminPrivileges")})]})]}),0===j.length?(0,Ts.jsxs)("div",{className:"text-center py-8",children:[(0,Ts.jsx)(kd,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),(0,Ts.jsx)("p",{className:"text-slate-400",children:o("accessRequestModal.manage.empty.title")}),(0,Ts.jsx)("p",{className:"text-slate-500 text-sm mt-2",children:o("accessRequestModal.manage.empty.description")})]}):(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsx)(Xc,{variant:"subtle",padding:"sm",className:"mb-4",children:(0,Ts.jsx)("p",{className:"text-xs text-slate-400",children:o("accessRequestModal.manage.privacyNotice")})}),j.map(e=>(0,Ts.jsx)("div",{className:"p-4",children:(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{className:"flex items-start justify-between",children:[(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("h4",{className:"font-medium text-slate-100",children:e.user.name||o("accessRequestModal.manage.request.unnamedUser")}),e.user_email&&(0,Ts.jsx)("p",{className:"text-sm text-slate-400 mt-0.5",children:e.user_email}),(0,Ts.jsxs)("p",{className:"text-sm text-slate-400 mt-1",children:[o("accessRequestModal.manage.request.requestedRole")," ",(0,Ts.jsx)("strong",{children:e.requested_role})]}),(0,Ts.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:[new Date(e.created_at).toLocaleDateString()," ",o("accessRequestModal.manage.request.atTime")," ",new Date(e.created_at).toLocaleTimeString()]})]}),(0,Ts.jsxs)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full bg-amber-100 text-amber-800",children:[(0,Ts.jsx)(Sd,{className:"h-3 w-3 mr-1"}),o("accessRequestModal.manage.request.statusPending")]})]}),e.message&&(0,Ts.jsxs)(Xc,{padding:"sm",children:[(0,Ts.jsx)("p",{className:"text-sm text-slate-200 font-medium mb-1",children:o("accessRequestModal.manage.request.messageLabel")}),(0,Ts.jsxs)("p",{className:"text-sm text-slate-300",children:['"',e.message,'"']})]}),(0,Ts.jsxs)("div",{className:"flex justify-end gap-2 pt-2 border-t border-slate-600",children:[(0,Ts.jsx)(Lc,{size:"sm",variant:"secondary",onClick:()=>(async(e,t)=>{await m(e,t)&&await O()})(e.id,o("accessRequestModal.manage.buttons.rejectReason")),disabled:g,Icon:uu,children:o("accessRequestModal.manage.buttons.reject")}),(0,Ts.jsx)(Lc,{size:"sm",onClick:()=>(async(e,t)=>{await u(e,t)&&(await O(),null===s||void 0===s||s(o("accessRequestModal.success.requestApproved")))})(e.id,e.requested_role),disabled:g,Icon:kd,children:o("accessRequestModal.manage.buttons.approve",{role:e.requested_role})})]})]})},e.id))]}),b&&(0,Ts.jsxs)("div",{className:"mt-8 pt-6 border-t border-slate-600",children:[(0,Ts.jsxs)("h4",{className:"font-medium text-slate-200 mb-4 flex items-center",children:[(0,Ts.jsx)(od,{className:"h-4 w-4 mr-2"}),o("accessRequestModal.manage.members.title",{count:C.length})]}),0===C.length?(0,Ts.jsx)("div",{className:"text-center py-4",children:(0,Ts.jsx)("p",{className:"text-slate-400",children:o("accessRequestModal.manage.members.empty")})}):(0,Ts.jsx)("div",{className:"space-y-3",children:C.map(e=>(0,Ts.jsx)(Xc,{padding:"sm",children:(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("h5",{className:"font-medium text-slate-100",children:e.user.name}),(0,Ts.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,Ts.jsx)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full ".concat("admin"===e.role?"bg-emerald-100 text-emerald-800":"coach"===e.role?"bg-sky-100 text-sky-800":"bg-slate-100 text-slate-800"),children:o("roleManagement.roles.".concat(e.role),{defaultValue:e.role})}),(0,Ts.jsx)("span",{className:"text-xs text-slate-500",children:o("accessRequestModal.manage.members.joined",{date:new Date(e.created_at).toLocaleDateString()})})]})]}),(0,Ts.jsx)("div",{className:"flex items-center",children:(0,Ts.jsx)(Lc,{size:"sm",variant:"danger",onClick:()=>(async e=>{window.confirm(o("accessRequestModal.manage.members.confirmRemove"))&&await f(e)&&(await F(),null===s||void 0===s||s(o("accessRequestModal.manage.members.removed")))})(e.id),disabled:g||"admin"===e.role,title:"admin"===e.role?o("accessRequestModal.manage.members.cannotRemoveAdmin"):o("accessRequestModal.manage.members.removeMember"),children:o("accessRequestModal.manage.members.remove")})})]})},e.id))})]})]})]})]})}const hu="club_selection",pu="club_creation",fu="team_selection",gu="team_creation",vu="player_creation",yu="complete";function bu(t){let{onComplete:a,onCancel:r}=t;const{t:s}=xe("team"),{createClub:i,getTeamsByClub:o,createTeam:l,createPlayer:c,switchCurrentTeam:d,isClubCreator:u,hasClubs:m,userClubs:h,loading:p,error:f,clearError:g}=vi(),[v,y]=(0,e.useState)(hu),[b,x]=(0,e.useState)(null),[w,S]=(0,e.useState)([]),[k,N]=(0,e.useState)(null),[j,T]=(0,e.useState)([]),[A,_]=(0,e.useState)(!1),[C,M]=(0,e.useState)(null),[P,E]=(0,e.useState)(!1),[I,R]=(0,e.useState)(null),[O,D]=(0,e.useState)(""),[F,L]=(0,e.useState)({name:"",shortName:"",longName:""}),[q,U]=(0,e.useState)({name:""}),[B,G]=(0,e.useState)({displayName:""}),[z,V]=(0,e.useState)({}),H=(0,e.useCallback)(()=>{V({}),g()},[g]);(0,e.useEffect)(()=>{if(m&&1===h.length){const e=h[0].club;x(e),o(e.id).then(e=>{S(e),y(fu)})}else m&&h.length,y(hu)},[m,h,o]);const K=(0,e.useCallback)(async e=>{if(H(),u(e)){x(e);const t=await o(e.id);S(t),y(fu)}else M(e),_(!0)},[o,H,u]),W=(0,e.useCallback)(e=>{const t=e.split(" ").filter(e=>e!==e.toUpperCase()).join(" ");L({name:t.trim()||e,shortName:"",longName:e}),y(pu)},[]),Y=(0,e.useCallback)(async()=>{if(H(),!F.name.trim())return void V({clubName:s("wizard.validation.clubNameRequired")});const e=await i({name:F.name.trim(),shortName:F.shortName.trim()||null,longName:F.longName.trim()||null});e&&(x(e),S([]),y(gu))},[F,i,H,s]),J=(0,e.useCallback)(e=>{U({name:e}),y(gu)},[]),Q=(0,e.useCallback)(e=>{g();const t=(0,n.A)((0,n.A)({},e),{},{club:b});R(t),E(!0)},[g,b]),$=(0,e.useCallback)(async()=>{if(H(),!q.name.trim())return void V({teamName:s("wizard.validation.teamNameRequired")});const e=await l({clubId:b.id,name:q.name.trim()});e&&(N(e),await d(e.id),y(vu))},[q,b,l,d,H,s]),X=(0,e.useCallback)(async()=>{if(H(),!B.displayName.trim())return void V({playerName:s("wizard.validation.playerNameRequired")});const e=B.displayName.trim(),[t,...a]=e.split(/\s+/),r=await c({firstName:t||e,lastName:a.length>0?a.join(" "):null,displayName:e});if(r){var i;const s=(0,n.A)((0,n.A)({},r),{},{displayName:r.display_name||e,firstName:r.first_name||t||e,lastName:null!==(i=r.last_name)&&void 0!==i?i:a.length>0?a.join(" "):null});T(e=>[...e,s]),G({displayName:""})}},[B,c,H,s]),Z=(0,e.useCallback)(()=>{y(yu),setTimeout(()=>{a()},1500)},[a]),ee=(0,e.useCallback)(async()=>{if(!C)return;_(!1),x(C);const e=await o(C.id);S(e),y(fu),M(null)},[C,o]),te=(0,e.useCallback)(()=>{_(!1),M(null)},[]),ae=(0,e.useCallback)(e=>{e&&(D(e),setTimeout(()=>{D("")},3e3)),setTimeout(()=>{E(!1),R(null),a()},e?1500:0)},[a]),ne=(0,e.useCallback)(()=>{E(!1),R(null)},[]),re=()=>(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{className:"text-center mb-6",children:[(0,Ts.jsx)(Zd,{className:"h-8 w-8 text-sky-400 mx-auto mb-3"}),(0,Ts.jsx)("h3",{className:"text-lg font-semibold text-sky-300",children:s("wizard.clubSelection.title")}),(0,Ts.jsx)("p",{className:"text-slate-400 text-sm mt-2",children:s("wizard.clubSelection.description")})]}),(0,Ts.jsx)(iu,{placeholder:s("wizard.clubSelection.placeholder"),onSelect:K,onCreateNew:W}),(0,Ts.jsx)("div",{className:"flex justify-end",children:(0,Ts.jsx)(Lc,{onClick:r,variant:"secondary",children:s("wizard.clubSelection.cancel")})})]});return(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsxs)(Xc,{padding:"lg",children:[f&&(0,Ts.jsx)(Jc,{variant:"error",className:"mb-4",children:f}),O&&(0,Ts.jsx)(Jc,{variant:"success",className:"mb-4",children:O}),(()=>{switch(v){case hu:return re();case pu:return(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{className:"text-center mb-6",children:[(0,Ts.jsx)(Zd,{className:"h-8 w-8 text-emerald-400 mx-auto mb-3"}),(0,Ts.jsx)("h3",{className:"text-lg font-semibold text-sky-300",children:s("wizard.clubCreation.title")}),(0,Ts.jsx)("p",{className:"text-slate-400 text-sm mt-2",children:s("wizard.clubCreation.description")})]}),(0,Ts.jsx)(Pd,{label:s("wizard.clubCreation.fullNameLabel"),htmlFor:"clubLongName",error:z.clubLongName,children:(0,Ts.jsx)(Rc,{id:"clubLongName",value:F.longName,onChange:e=>L(t=>(0,n.A)((0,n.A)({},t),{},{longName:Is(e.target.value)})),placeholder:s("wizard.clubCreation.fullNamePlaceholder"),error:!!z.clubLongName})}),(0,Ts.jsx)(Pd,{label:s("wizard.clubCreation.displayNameLabel"),htmlFor:"clubName",error:z.clubName,children:(0,Ts.jsx)(Rc,{id:"clubName",value:F.name,onChange:e=>L(t=>(0,n.A)((0,n.A)({},t),{},{name:Is(e.target.value)})),placeholder:s("wizard.clubCreation.displayNamePlaceholder"),error:!!z.clubName})}),(0,Ts.jsxs)(Pd,{label:s("wizard.clubCreation.shortNameLabel"),htmlFor:"clubShortName",children:[(0,Ts.jsx)(Rc,{id:"clubShortName",value:F.shortName,onChange:e=>L(t=>(0,n.A)((0,n.A)({},t),{},{shortName:Is(e.target.value)})),placeholder:s("wizard.clubCreation.shortNamePlaceholder")}),(0,Ts.jsx)("p",{className:"text-slate-500 text-xs mt-1",children:s("wizard.clubCreation.shortNameHelper")})]}),(0,Ts.jsx)("div",{className:"flex justify-end",children:(0,Ts.jsx)(Lc,{onClick:Y,disabled:p,Icon:p?null:au,children:s(p?"wizard.clubCreation.creating":"wizard.clubCreation.createButton")})})]});case fu:return(()=>{const e=s("wizard.teamSelection.description",{clubName:b.name}).split(/(<strong>.*?<\/strong>)/);return(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{className:"text-center mb-6",children:[(0,Ts.jsx)(od,{className:"h-8 w-8 text-sky-400 mx-auto mb-3"}),(0,Ts.jsx)("h3",{className:"text-lg font-semibold text-sky-300",children:s("wizard.teamSelection.title")}),(0,Ts.jsx)("p",{className:"text-slate-400 text-sm mt-2",children:e.map((e,t)=>{if(e.startsWith("<strong>")&&e.endsWith("</strong>")){const a=e.replace(/<\/?strong>/g,"");return(0,Ts.jsx)("strong",{children:a},t)}return(0,Ts.jsx)("span",{children:e},t)})})]}),(0,Ts.jsx)(ou,{teams:w,onSelect:Q,onCreateNew:J,placeholder:s("wizard.teamSelection.placeholder"),loading:p}),(0,Ts.jsx)("div",{className:"flex justify-end",children:(0,Ts.jsx)(Lc,{onClick:r,variant:"secondary",children:s("wizard.clubSelection.cancel")})})]})})();case gu:return(()=>{const e=s("wizard.teamCreation.description",{clubName:b.name}).split(/(<strong>.*?<\/strong>)/);return(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{className:"text-center mb-6",children:[(0,Ts.jsx)(od,{className:"h-8 w-8 text-emerald-400 mx-auto mb-3"}),(0,Ts.jsx)("h3",{className:"text-lg font-semibold text-sky-300",children:s("wizard.teamCreation.title")}),(0,Ts.jsx)("p",{className:"text-slate-400 text-sm mt-2",children:e.map((e,t)=>{if(e.startsWith("<strong>")&&e.endsWith("</strong>")){const a=e.replace(/<\/?strong>/g,"");return(0,Ts.jsx)("strong",{children:a},t)}return(0,Ts.jsx)("span",{children:e},t)})})]}),(0,Ts.jsxs)(Pd,{label:s("wizard.teamCreation.teamNameLabel"),htmlFor:"teamName",error:z.teamName,children:[(0,Ts.jsx)(Rc,{id:"teamName",value:q.name,onChange:e=>U(t=>(0,n.A)((0,n.A)({},t),{},{name:Is(e.target.value)})),placeholder:s("wizard.teamCreation.teamNamePlaceholder"),error:!!z.teamName}),(0,Ts.jsx)("p",{className:"text-slate-500 text-xs mt-1",children:s("wizard.teamCreation.teamNameHelper")})]}),(0,Ts.jsx)("div",{className:"flex justify-end",children:(0,Ts.jsx)(Lc,{onClick:$,disabled:p,Icon:p?null:au,children:s(p?"wizard.teamCreation.creating":"wizard.teamCreation.createButton")})})]})})();case vu:return(()=>{const e=s("wizard.playerCreation.description",{teamName:null===k||void 0===k?void 0:k.name}).split(/(<strong>.*?<\/strong>)/);return(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{className:"text-center mb-6",children:[(0,Ts.jsx)(bc,{className:"h-8 w-8 text-emerald-400 mx-auto mb-3"}),(0,Ts.jsx)("h3",{className:"text-lg font-semibold text-sky-300",children:s("wizard.playerCreation.title")}),(0,Ts.jsx)("p",{className:"text-slate-400 text-sm mt-2",children:e.map((e,t)=>{if(e.startsWith("<strong>")&&e.endsWith("</strong>")){const a=e.replace(/<\/?strong>/g,"");return(0,Ts.jsx)("strong",{children:a},t)}return(0,Ts.jsx)("span",{children:e},t)})})]}),(0,Ts.jsxs)("div",{className:"flex space-x-2",children:[(0,Ts.jsxs)("div",{className:"flex-1",children:[(0,Ts.jsx)(Rc,{value:B.displayName,onChange:e=>G(t=>(0,n.A)((0,n.A)({},t),{},{displayName:Is(e.target.value)})),placeholder:s("wizard.playerCreation.playerNamePlaceholder"),error:!!z.playerName,onKeyDown:e=>{"Enter"===e.key&&B.displayName.trim()&&X()}}),z.playerName&&(0,Ts.jsx)("p",{className:"text-rose-400 text-sm mt-1",children:z.playerName})]}),(0,Ts.jsx)(Lc,{onClick:X,disabled:p||!B.displayName.trim(),Icon:bc,children:s("wizard.playerCreation.addButton")})]}),j.length>0&&(0,Ts.jsxs)("div",{className:"space-y-2",children:[(0,Ts.jsx)("h4",{className:"text-sm font-medium text-slate-300",children:s("wizard.playerCreation.addedPlayersHeader",{count:j.length})}),(0,Ts.jsx)("div",{className:"max-h-32 overflow-y-auto space-y-1",children:j.map(e=>(0,Ts.jsx)("div",{className:"flex items-center p-2 bg-slate-700 rounded text-sm",children:(0,Ts.jsx)("span",{className:"text-slate-100",children:e.displayName||e.display_name||e.first_name})},e.id))})]}),(0,Ts.jsx)(Xc,{variant:"subtle",className:"text-center",children:(0,Ts.jsx)("p",{className:"text-slate-300 text-sm",children:s("wizard.playerCreation.laterNote")})}),(0,Ts.jsx)("div",{className:"flex justify-end",children:(0,Ts.jsx)(Lc,{onClick:Z,variant:"accent",Icon:nu,children:s("wizard.playerCreation.completeButton")})})]})})();case yu:return(()=>{const e=s("wizard.complete.description",{teamName:null===k||void 0===k?void 0:k.name}).split(/(<strong>.*?<\/strong>)/);return(0,Ts.jsxs)("div",{className:"text-center py-8",children:[(0,Ts.jsx)("div",{className:"animate-pulse",children:(0,Ts.jsx)(nu,{className:"h-12 w-12 text-emerald-400 mx-auto mb-4"})}),(0,Ts.jsx)("h3",{className:"text-lg font-semibold text-emerald-300 mb-2",children:s("wizard.complete.title")}),(0,Ts.jsx)("p",{className:"text-slate-400",children:e.map((e,t)=>{if(e.startsWith("<strong>")&&e.endsWith("</strong>")){const a=e.replace(/<\/?strong>/g,"");return(0,Ts.jsx)("strong",{children:a},t)}return(0,Ts.jsx)("span",{children:e},t)})})]})})();default:return re()}})()]}),A&&C&&(0,Ts.jsx)(cu,{club:C,onSuccess:ee,onClose:te}),P&&I&&(0,Ts.jsx)(mu,{team:I,onSuccess:ae,onClose:ne})]})}const xu=fc("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),wu=fc("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);function Su(t){var a;let{isOpen:r,onClose:s,team:i}=t;const{t:o}=xe("team"),{inviteUserToTeam:l,getTeamInvitations:c,refreshInvitation:d,deleteInvitation:u,loading:m,error:h}=vi(),{user:p}=Cs(),[f,g]=(0,e.useState)({email:"",role:"coach",message:""}),[v,y]=(0,e.useState)({}),[b,x]=(0,e.useState)(""),[w,S]=(0,e.useState)([]),[k,N]=(0,e.useState)([]),[j,T]=(0,e.useState)(!1),A=e=>new Date(e).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}),_=e=>{const t=new Date,a=new Date(e).getTime()-t.getTime();if(a<=0)return o("inviteModal.invitations.status.expired");const n=Math.floor(a/36e5),r=Math.floor(a%36e5/6e4);return n>0?o("inviteModal.invitations.details.hoursMinutesRemaining",{hours:n,minutes:r}):o("inviteModal.invitations.details.minutesRemaining",{minutes:r})},C=(0,e.useCallback)(async()=>{if(null!==i&&void 0!==i&&i.id){T(!0);try{const e=await c(i.id),t=(new Date).toISOString(),a=[],n=[];e.forEach(e=>{"pending"===e.status?e.expires_at&&e.expires_at<=t?n.push(e):a.push(e):"expired"===e.status&&n.push(e)}),S(a),N(n)}catch(h){console.error("Error fetching invitations:",h)}finally{T(!1)}}},[null===i||void 0===i?void 0:i.id,c]),M=(0,e.useRef)(!1);(0,e.useEffect)(()=>{const e=M.current,t=r;!e&&t?(g({email:"",role:"coach",message:""}),y({}),C()):e&&!t&&x(""),M.current=r},[r,C]),(0,e.useEffect)(()=>{const e=e=>{"Escape"===e.key&&r&&s()};return r&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[r,s]);const P=()=>v.general?v.general:h||null;return(0,e.useEffect)(()=>{if(b){const e=setTimeout(()=>{x("")},5e3);return()=>clearTimeout(e)}},[b]),r?(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)(Mc,{title:o("inviteModal.header.title"),subtitle:null!==i&&void 0!==i&&i.name?"".concat(null!==(a=i.club)&&void 0!==a&&a.long_name?"".concat(i.club.long_name," "):"").concat(i.name):o("inviteModal.header.teamFallback"),icon:xu,iconColor:"sky",onClose:s,className:"max-h-[90vh] overflow-y-auto",children:(0,Ts.jsxs)("div",{className:"space-y-6",children:[P()&&(0,Ts.jsx)(Jc,{variant:"error",icon:lu,children:P()}),(0,Ts.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={},t=Rs(f.email);return t?Os(t)||(e.email=o("inviteModal.validation.emailInvalid")):e.email=o("inviteModal.validation.emailRequired"),f.role||(e.role=o("inviteModal.validation.roleRequired")),Ds(f.message).length>500&&(e.message=o("inviteModal.validation.messageTooLong")),y(e),0===Object.keys(e).length})())try{const e=Rs(f.email),t=Ds(f.message);(await l({teamId:i.id,email:e,role:f.role,message:t})).success&&(x(o("inviteModal.success.invitationSent")),g({email:"",role:"coach",message:""}),C())}catch(h){console.error("Error sending invitation:",h),y({general:o("inviteModal.validation.sendFailed")})}},className:"space-y-4",children:[(0,Ts.jsx)(Pd,{label:o("inviteModal.form.labels.email"),htmlFor:"invite-email",error:v.email,children:(0,Ts.jsx)(Rc,{id:"invite-email",type:"email",value:f.email,onChange:e=>{const t=e.target.value;g(e=>(0,n.A)((0,n.A)({},e),{},{email:t})),v.email&&t&&Os(Rs(t))&&y(e=>(0,n.A)((0,n.A)({},e),{},{email:null}))},placeholder:o("inviteModal.form.placeholders.email"),disabled:m,error:!!v.email})}),(0,Ts.jsxs)(Pd,{label:o("inviteModal.form.labels.role"),htmlFor:"invite-role",error:v.role,children:[(0,Ts.jsx)(Dc,{id:"invite-role",value:f.role,onChange:e=>{g(t=>(0,n.A)((0,n.A)({},t),{},{role:e})),v.role&&e&&y(e=>(0,n.A)((0,n.A)({},e),{},{role:null}))},options:[{value:"coach",label:o("inviteModal.form.roles.coach")},{value:"parent",label:o("inviteModal.form.roles.parent")},{value:"player",label:o("inviteModal.form.roles.player")},...(null===p||void 0===p?void 0:p.id)===(null===i||void 0===i?void 0:i.created_by)?[{value:"admin",label:o("inviteModal.form.roles.admin")}]:[]],disabled:m,error:!!v.role}),(0,Ts.jsx)("p",{className:"text-slate-500 text-xs mt-1",children:o("inviteModal.form.hints.role")})]}),(0,Ts.jsxs)(Pd,{label:(0,Ts.jsxs)(Ts.Fragment,{children:[o("inviteModal.form.labels.message")," ",(0,Ts.jsx)("span",{className:"text-slate-500",children:o("inviteModal.form.hints.messageOptional")})]}),htmlFor:"invite-message",error:v.message,children:[(0,Ts.jsx)(Oc,{id:"invite-message",value:f.message,onChange:e=>{const t=e.target.value;var a;g(e=>(0,n.A)((0,n.A)({},e),{},{message:t})),!v.message||("string"!==typeof(a=t)||a.length>500||/<script/gi.test(a)||/javascript:/gi.test(a)||/on\w+\s*=/gi.test(a)||Es.test(a))||y(e=>(0,n.A)((0,n.A)({},e),{},{message:null}))},placeholder:o("inviteModal.form.placeholders.message"),error:!!v.message,rows:3,maxLength:500,disabled:m}),(0,Ts.jsx)("p",{className:"text-slate-500 text-xs mt-1",children:o("inviteModal.form.hints.characterCount",{count:f.message.length})})]}),(0,Ts.jsx)(Lc,{type:"submit",variant:"primary",size:"lg",disabled:m,className:"w-full",Icon:m?od:xu,children:o(m?"inviteModal.buttons.sending":"inviteModal.buttons.send")})]}),(0,Ts.jsxs)("div",{className:"border-t border-slate-600 pt-6 space-y-6",children:[(0,Ts.jsxs)("div",{children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,Ts.jsx)(Sd,{className:"w-5 h-5 text-amber-400"}),(0,Ts.jsxs)("h4",{className:"text-slate-300 font-medium",children:[o("inviteModal.invitations.pendingHeader"),w.length>0&&(0,Ts.jsx)("span",{className:"ml-2 text-sm font-normal text-slate-400",children:o("inviteModal.invitations.countLabel",{count:w.length})})]})]}),j?(0,Ts.jsx)(Wd,{size:"md",message:o("inviteModal.invitations.loading"),className:"py-4"}):0===w.length?(0,Ts.jsx)(Yd,{icon:xu,title:o("inviteModal.invitations.noPending"),className:"py-4 bg-transparent border-0"}):(0,Ts.jsx)("div",{className:"space-y-3",children:w.map(e=>(0,Ts.jsx)(Xc,{variant:"subtle",padding:"sm",children:(0,Ts.jsxs)("div",{className:"flex items-start justify-between",children:[(0,Ts.jsxs)("div",{className:"flex-1",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,Ts.jsx)("span",{className:"text-slate-300 font-medium text-sm",children:e.email}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Ts.jsx)(md,{className:"w-3 h-3 text-emerald-400"}),(0,Ts.jsx)("span",{className:"text-emerald-400 text-xs font-medium",children:e.role})]})]}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-slate-400",children:[(0,Ts.jsx)("span",{children:o("inviteModal.invitations.details.sent",{date:A(e.created_at)})}),e.expires_at&&(0,Ts.jsx)("span",{className:"font-medium text-amber-400",children:o("inviteModal.invitations.details.remaining",{time:_(e.expires_at)})})]})]}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Ts.jsx)("div",{className:"w-2 h-2 bg-amber-400 rounded-full"}),(0,Ts.jsx)("span",{className:"text-amber-400 text-xs font-medium",children:o("inviteModal.invitations.status.pending")})]})]})},e.id))})]}),k.length>0&&(0,Ts.jsxs)("div",{children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,Ts.jsx)(lu,{className:"w-5 h-5 text-rose-400"}),(0,Ts.jsxs)("h4",{className:"text-slate-300 font-medium",children:[o("inviteModal.invitations.expiredHeader"),(0,Ts.jsx)("span",{className:"ml-2 text-sm font-normal text-slate-400",children:o("inviteModal.invitations.countLabel",{count:k.length})})]})]}),(0,Ts.jsx)("div",{className:"space-y-3",children:k.map(e=>(0,Ts.jsx)(Xc,{variant:"subtle",padding:"sm",className:"border-rose-600/30",children:(0,Ts.jsxs)("div",{className:"flex items-start justify-between",children:[(0,Ts.jsxs)("div",{className:"flex-1",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,Ts.jsx)("span",{className:"text-slate-300 font-medium text-sm",children:e.email}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Ts.jsx)(md,{className:"w-3 h-3 text-emerald-400"}),(0,Ts.jsx)("span",{className:"text-emerald-400 text-xs font-medium",children:e.role})]})]}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-slate-400",children:[(0,Ts.jsx)("span",{children:o("inviteModal.invitations.details.sent",{date:A(e.created_at)})}),(0,Ts.jsx)("span",{className:"font-medium text-rose-400",children:o("inviteModal.invitations.status.expired")})]})]}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsxs)("button",{onClick:()=>(async e=>{try{const t=await d({invitationId:e.id,teamId:i.id,email:e.email,role:e.role,message:e.message||""});t.success?(x(t.message||o("inviteModal.success.invitationRefreshed")),C()):y({general:t.error||o("inviteModal.validation.sendFailed")})}catch(h){console.error("Error refreshing invitation:",h),y({general:o("inviteModal.validation.sendFailed")})}})(e),disabled:m,className:"flex items-center space-x-1 px-2 py-1 text-xs font-medium text-amber-400 hover:text-amber-300 hover:bg-amber-400/10 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:o("inviteModal.buttons.refresh"),children:[(0,Ts.jsx)(wu,{className:"w-3 h-3"}),(0,Ts.jsx)("span",{children:o("inviteModal.buttons.refresh")})]}),(0,Ts.jsxs)("button",{onClick:()=>(async e=>{try{const t=await u(e.id);t.success?(x(t.message||o("inviteModal.success.invitationDeleted")),C()):y({general:t.error||o("inviteModal.validation.sendFailed")})}catch(h){console.error("Error deleting invitation:",h),y({general:o("inviteModal.validation.sendFailed")})}})(e),disabled:m,className:"flex items-center space-x-1 px-2 py-1 text-xs font-medium text-rose-400 hover:text-rose-300 hover:bg-rose-400/10 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:o("inviteModal.buttons.delete"),children:[(0,Ts.jsx)(xd,{className:"w-3 h-3"}),(0,Ts.jsx)("span",{children:o("inviteModal.buttons.delete")})]})]})]})},e.id))})]})]}),(0,Ts.jsx)(Xc,{children:(0,Ts.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,Ts.jsx)(od,{className:"w-5 h-5 text-sky-400 flex-shrink-0 mt-0.5"}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("h4",{className:"text-slate-300 font-medium mb-2",children:o("inviteModal.info.title")}),(0,Ts.jsxs)("ul",{className:"text-slate-400 text-sm space-y-1",children:[(0,Ts.jsxs)("li",{children:["\u2022 ",o("inviteModal.info.steps.emailSent")]}),(0,Ts.jsxs)("li",{children:["\u2022 ",o("inviteModal.info.steps.accountSetup")]}),(0,Ts.jsxs)("li",{children:["\u2022 ",o("inviteModal.info.steps.autoAdded")]}),(0,Ts.jsxs)("li",{children:["\u2022 ",o("inviteModal.info.steps.manageRoles")]})]})]})]})})]})}),b&&(0,Ts.jsx)("div",{className:"fixed top-4 right-4 z-[60] max-w-sm animate-in slide-in-from-right duration-300",children:(0,Ts.jsx)("div",{className:"bg-emerald-600 text-white px-4 py-3 rounded-lg shadow-lg border border-emerald-500",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(kd,{className:"w-5 h-5 flex-shrink-0"}),(0,Ts.jsx)("span",{className:"text-sm font-medium",children:b})]})})})]}):null}const ku=fc("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);function Nu(t){let{isOpen:a,onClose:r,team:s,members:i,onRefresh:o,currentUserRole:l}=t;const{t:c}=xe("team"),{updateTeamMemberRole:d,removeTeamMember:u}=vi(),{user:m}=Cs(),[h,p]=(0,e.useState)({}),[f,g]=(0,e.useState)({}),[v,y]=(0,e.useState)(!1),[b,x]=(0,e.useState)(null),[w,S]=(0,e.useState)(null),[k,N]=(0,e.useState)(""),j=[{value:"admin",label:c("roleManagement.roles.admin"),description:c("roleManagement.roles.adminDescription")},{value:"coach",label:c("roleManagement.roles.coach"),description:c("roleManagement.roles.coachDescription")},{value:"player",label:c("roleManagement.roles.player"),description:c("roleManagement.roles.playerDescription")},{value:"parent",label:c("roleManagement.roles.parent"),description:c("roleManagement.roles.parentDescription")}];if((0,e.useEffect)(()=>{if(i&&i.length>0){const e={};i.forEach(t=>{e[t.id]=t.role}),p(e),g({})}},[i]),(0,e.useEffect)(()=>{if(k){const e=setTimeout(()=>N(""),3e3);return()=>clearTimeout(e)}},[k]),(0,e.useEffect)(()=>{if(w){const e=setTimeout(()=>S(null),5e3);return()=>clearTimeout(e)}},[w]),!a)return null;const T=()=>Object.values(h).filter(e=>"admin"===e).length,A=e=>{var t;return(null===(t=e.user)||void 0===t?void 0:t.id)===(null===m||void 0===m?void 0:m.id)},_=(e,t)=>{var a;const r=i.find(t=>t.id===e);r&&("coach"!==l||"admin"!==t?A(r)?S(c("roleManagement.errors.cannotModifySelf")):((e,t)=>("admin"===h[e.id]||"admin"===t)&&"admin"===e.role)(r,t)&&"super_admin"!==l?S(c("roleManagement.errors.cannotModifyAdmin")):((e,t)=>"admin"===h[e]&&"admin"!==t&&T()<=1)(e,t)?S(c("roleManagement.errors.lastAdminDemotion")):(p(a=>(0,n.A)((0,n.A)({},a),{},{[e]:t})),t!==(null===(a=i.find(t=>t.id===e))||void 0===a?void 0:a.role)?g(a=>(0,n.A)((0,n.A)({},a),{},{[e]:t})):g(t=>{const a=(0,n.A)({},t);return delete a[e],a})):S(c("roleManagement.errors.coachCannotPromote")))},C=Object.keys(f).length>0;return(0,Ts.jsxs)(Mc,{title:c("roleManagement.title"),icon:md,iconColor:"sky",onClose:r,maxWidth:"2xl",className:"max-h-[90vh] overflow-hidden",children:[(0,Ts.jsxs)("div",{className:"overflow-y-auto max-h-[60vh]",children:[w&&(0,Ts.jsx)(Jc,{variant:"error",icon:lu,className:"mb-4",children:w}),k&&(0,Ts.jsx)(Jc,{variant:"success",className:"mb-4",children:k}),(0,Ts.jsxs)("div",{className:"mb-6",children:[(0,Ts.jsx)("h3",{className:"text-lg font-medium text-slate-200 mb-2",children:null===s||void 0===s?void 0:s.name}),(0,Ts.jsx)("p",{className:"text-slate-400 text-sm mb-3",children:1!==i.length?c("roleManagement.managePermissionsPlural",{count:i.length}):c("roleManagement.managePermissions",{count:i.length})}),(0,Ts.jsxs)("div",{className:"bg-slate-800 border border-slate-600 rounded-lg p-3",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,Ts.jsx)(dd,{className:"w-4 h-4 text-amber-400"}),(0,Ts.jsx)("span",{className:"text-slate-200 text-sm font-medium",children:c("roleManagement.security.title")})]}),(0,Ts.jsxs)("ul",{className:"text-slate-400 text-xs space-y-1",children:[(0,Ts.jsx)("li",{children:c("roleManagement.security.cannotModifySelf")}),(0,Ts.jsx)("li",{children:c("roleManagement.security.adminProtected")}),(0,Ts.jsx)("li",{children:c("roleManagement.security.lastAdmin")})]})]})]}),(0,Ts.jsx)("div",{className:"space-y-4",children:i.map(e=>{var t,a,n,r,s,i,d;const m=h[e.id],p=e.role,g=f[e.id],y=b===e.id,w=A(e),k="admin"===e.role,C=T()<=1&&"admin"===m,M=!w&&(!k||"super_admin"===l),P=!w&&!k;return(0,Ts.jsx)(Xc,{className:g?"border-amber-500":"",children:(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsxs)("div",{className:"flex-1",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ts.jsxs)(Fd,{size:"lg",color:k?"emerald":"sky",className:"relative",children:[(null===(t=(null===(a=e.user)||void 0===a?void 0:a.name)||(null===(n=e.user)||void 0===n?void 0:n.email))||void 0===t?void 0:t.charAt(0).toUpperCase())||"?",k&&(0,Ts.jsx)("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-amber-500 rounded-full flex items-center justify-center",children:(0,Ts.jsx)(dd,{className:"w-2.5 h-2.5 text-amber-900"})})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)("p",{className:"text-slate-100 font-medium",children:(null===(r=e.user)||void 0===r?void 0:r.name)||(null===(s=e.user)||void 0===s||null===(i=s.email)||void 0===i?void 0:i.split("@")[0])||c("roleManagement.unknownUser")}),w&&(0,Ts.jsx)("span",{className:"hidden sm:inline-block text-xs px-2 py-0.5 bg-blue-600 text-blue-100 rounded-full",children:c("roleManagement.badges.you")}),C&&(0,Ts.jsxs)("span",{className:"hidden sm:flex text-xs px-2 py-0.5 bg-amber-600 text-amber-100 rounded-full items-center",children:[(0,Ts.jsx)(ku,{className:"w-3 h-3 mr-1"}),c("roleManagement.badges.lastAdmin")]})]}),(null===(d=e.user)||void 0===d?void 0:d.email)&&(0,Ts.jsx)("p",{className:"text-slate-400 text-sm",children:e.user.email})]})]}),g&&(0,Ts.jsxs)("div",{className:"mt-2 text-xs text-amber-400 flex items-center",children:[(0,Ts.jsx)(lu,{className:"w-3 h-3 mr-1"}),c("roleManagement.pendingChange",{from:p,to:f[e.id]})]})]}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ts.jsx)("div",{className:"min-w-[100px] sm:min-w-[140px]",children:M?(0,Ts.jsx)(Dc,{value:m,onChange:t=>_(e.id,t),options:j.filter(e=>"coach"!==l||"admin"!==e.value),disabled:v||y}):(0,Ts.jsxs)("div",{className:"px-3 py-2 bg-slate-600 border border-slate-500 rounded text-slate-300 text-sm flex items-center",children:[(0,Ts.jsx)(ku,{className:"w-3 h-3 mr-2"}),m]})}),(0,Ts.jsx)("button",{onClick:()=>(async e=>{var t,a;if(A(e))return void S(c("roleManagement.errors.cannotRemoveSelf"));if("admin"===e.role)return void S(c("roleManagement.errors.cannotRemoveAdmin"));const n=(null===(t=e.user)||void 0===t?void 0:t.name)||(null===(a=e.user)||void 0===a?void 0:a.email);if(window.confirm(c("roleManagement.confirmRemove",{name:n}))){x(e.id),S(null);try{await u(e.id),N(c("roleManagement.success.memberRemoved",{name:n})),o&&await o()}catch(r){console.error("Error removing team member:",r),S(r.message||c("roleManagement.errors.removeFailed"))}finally{x(null)}}})(e),disabled:v||y||!P,className:"p-2 transition-colors disabled:opacity-50 ".concat(P?"text-slate-400 hover:text-rose-400":"text-slate-600 cursor-not-allowed"),title:c(P?"roleManagement.tooltips.removeFromTeam":w?"roleManagement.tooltips.cannotRemoveSelf":"roleManagement.tooltips.cannotRemoveAdmin"),children:y?(0,Ts.jsx)("div",{className:"w-4 h-4 border-2 border-rose-400 border-t-transparent rounded-full animate-spin"}):(0,Ts.jsx)(xd,{className:"w-4 h-4"})})]})]})},e.id)})}),0===i.length&&(0,Ts.jsx)(Yd,{title:c("roleManagement.noMembers")})]}),(0,Ts.jsxs)("div",{className:"flex items-center justify-between pt-6 border-t border-slate-600",children:[(0,Ts.jsx)("div",{className:"text-sm text-slate-400",children:C&&(0,Ts.jsx)("span",{className:"text-amber-400",children:c("roleManagement.unsavedChanges",{count:Object.keys(f).length})})}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ts.jsx)(Lc,{onClick:r,variant:"secondary",disabled:v,children:c(C?"roleManagement.buttons.cancel":"roleManagement.buttons.close")}),C&&(0,Ts.jsx)(Lc,{onClick:async()=>{if(0!==Object.keys(f).length){y(!0),S(null);try{for(const[e,t]of Object.entries(f))await d(e,t);N(c("roleManagement.success.rolesUpdated",{count:Object.keys(f).length})),g({}),o&&await o()}catch(e){console.error("Error updating member roles:",e),S(e.message||c("roleManagement.errors.updateFailed"))}finally{y(!1)}}else S(c("roleManagement.errors.noChanges"))},variant:"primary",disabled:v,children:c(v?"roleManagement.buttons.saving":"roleManagement.buttons.saveChanges")})]})]})]})}function ju(t){let{team:a,onClose:r,onPlayerAdded:s,getAvailableJerseyNumbers:i}=t;const{t:o}=xe("team"),[l,c]=(0,e.useState)({first_name:"",last_name:"",display_name:"",jersey_number:"",on_roster:!0}),[d,u]=(0,e.useState)([]),[m,h]=(0,e.useState)(!1),[p,f]=(0,e.useState)({}),[g,v]=(0,e.useState)("");(0,e.useEffect)(()=>{(async()=>{if(null!==a&&void 0!==a&&a.id&&i){const e=await i(a.id);u(e)}})()},[null===a||void 0===a?void 0:a.id,i]);const y=(e,t)=>{c(a=>(0,n.A)((0,n.A)({},a),{},{[e]:t})),p[e]&&f(t=>(0,n.A)((0,n.A)({},t),{},{[e]:null}))},b=[{value:"",label:o("addRosterPlayerModal.jerseyNumber.noNumber")},...d.map(e=>({value:e.toString(),label:"#".concat(e)}))];return(0,Ts.jsx)(Mc,{title:o("addRosterPlayerModal.header.title"),subtitle:o("addRosterPlayerModal.header.subtitle",{teamName:a.name}),icon:bc,iconColor:"sky",onClose:r,children:(0,Ts.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return l.first_name.trim()?l.first_name.trim().length<2?e.first_name=o("addRosterPlayerModal.validation.firstNameMinLength"):l.first_name.trim().length>50&&(e.first_name=o("addRosterPlayerModal.validation.firstNameMaxLength")):e.first_name=o("addRosterPlayerModal.validation.firstNameRequired"),l.last_name&&l.last_name.trim().length>50&&(e.last_name=o("addRosterPlayerModal.validation.lastNameMaxLength")),l.display_name.trim()?l.display_name.trim().length<2?e.display_name=o("addRosterPlayerModal.validation.displayNameMinLength"):l.display_name.trim().length>50&&(e.display_name=o("addRosterPlayerModal.validation.displayNameMaxLength")):e.display_name=o("addRosterPlayerModal.validation.displayNameRequired"),l.jersey_number&&(l.jersey_number<1||l.jersey_number>100||!d.includes(parseInt(l.jersey_number)))&&(e.jersey_number=o("addRosterPlayerModal.validation.jerseyNumberInvalid")),f(e),0===Object.keys(e).length})()){h(!0);try{if(await s({first_name:l.first_name.trim(),last_name:l.last_name?l.last_name.trim():null,display_name:l.display_name.trim(),jersey_number:l.jersey_number?parseInt(l.jersey_number):null,on_roster:l.on_roster}),c({first_name:"",last_name:"",display_name:"",jersey_number:"",on_roster:!0}),f({}),v(o("addRosterPlayerModal.success.playerAdded",{playerName:l.display_name.trim()})),setTimeout(()=>v(""),2e3),null!==a&&void 0!==a&&a.id&&i){const e=await i(a.id);u(e)}setTimeout(()=>{const e=document.querySelector('input[name="first_name"]');e&&e.focus()},100)}catch(t){console.error("Error adding player:",t),f({general:t.message||o("addRosterPlayerModal.validation.failedToAdd")})}finally{h(!1)}}},className:"space-y-4",children:[g&&(0,Ts.jsx)(Jc,{variant:"success",children:g}),p.general&&(0,Ts.jsx)(Jc,{variant:"error",children:p.general}),(0,Ts.jsx)(Pd,{label:o("addRosterPlayerModal.form.labels.firstName"),error:p.first_name,children:(0,Ts.jsx)(Rc,{name:"first_name",value:l.first_name,onChange:e=>y("first_name",e.target.value),onBlur:()=>{l.first_name.trim()&&!l.display_name.trim()&&c(e=>(0,n.A)((0,n.A)({},e),{},{display_name:e.first_name.trim()}))},placeholder:o("addRosterPlayerModal.form.placeholders.firstName"),disabled:m,error:!!p.first_name})}),(0,Ts.jsx)(Pd,{label:o("addRosterPlayerModal.form.labels.lastName"),error:p.last_name,children:(0,Ts.jsx)(Rc,{name:"last_name",value:l.last_name,onChange:e=>y("last_name",e.target.value),placeholder:o("addRosterPlayerModal.form.placeholders.lastName"),disabled:m,error:!!p.last_name})}),(0,Ts.jsxs)(Pd,{label:o("addRosterPlayerModal.form.labels.displayName"),error:p.display_name,children:[(0,Ts.jsx)(Rc,{name:"display_name",value:l.display_name,onChange:e=>y("display_name",e.target.value),placeholder:o("addRosterPlayerModal.form.placeholders.displayName"),disabled:m,error:!!p.display_name}),(0,Ts.jsx)("p",{className:"mt-1 text-xs text-slate-400",children:o("addRosterPlayerModal.form.helperText.displayName")})]}),(0,Ts.jsxs)(Pd,{label:o("addRosterPlayerModal.form.labels.jerseyNumber"),error:p.jersey_number,children:[(0,Ts.jsx)(Dc,{value:l.jersey_number,onChange:e=>y("jersey_number",e),options:b,disabled:m,error:!!p.jersey_number}),0===d.length&&(0,Ts.jsx)("p",{className:"mt-1 text-sm text-amber-400",children:o("addRosterPlayerModal.jerseyNumber.allTaken")})]}),(0,Ts.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,Ts.jsx)(Lc,{type:"submit",variant:"primary",disabled:m,className:"flex-1",children:o(m?"addRosterPlayerModal.buttons.adding":"addRosterPlayerModal.buttons.addPlayer")}),(0,Ts.jsx)(Lc,{type:"button",variant:"secondary",onClick:r,disabled:m,children:o("addRosterPlayerModal.buttons.cancel")})]})]})})}function Tu(t){var a,r;let{player:s,team:i,onClose:o,onPlayerUpdated:l,getAvailableJerseyNumbers:c}=t;const{t:d}=xe("team"),[u,m]=(0,e.useState)({first_name:(null===s||void 0===s?void 0:s.first_name)||"",last_name:(null===s||void 0===s?void 0:s.last_name)||"",display_name:(null===s||void 0===s?void 0:s.display_name)||"",jersey_number:(null===s||void 0===s||null===(a=s.jersey_number)||void 0===a?void 0:a.toString())||"",on_roster:null===(r=null===s||void 0===s?void 0:s.on_roster)||void 0===r||r}),[h,p]=(0,e.useState)([]),[f,g]=(0,e.useState)(!1),[v,y]=(0,e.useState)({});(0,e.useEffect)(()=>{(async()=>{if(null!==i&&void 0!==i&&i.id&&c&&null!==s&&void 0!==s&&s.id){const e=await c(i.id,s.id);p(e)}})()},[null===i||void 0===i?void 0:i.id,null===s||void 0===s?void 0:s.id,c]);const b=(e,t)=>{m(a=>(0,n.A)((0,n.A)({},a),{},{[e]:t})),v[e]&&y(t=>(0,n.A)((0,n.A)({},t),{},{[e]:null}))},x=s.jersey_number,w=[{value:"",label:d("editRosterPlayerModal.jerseyNumber.noNumber")},...x?[{value:x.toString(),label:d("editRosterPlayerModal.jerseyNumber.currentLabel",{number:x})}]:[],...h.filter(e=>e!==x).map(e=>({value:e.toString(),label:"#".concat(e)}))];return s?(0,Ts.jsx)(Mc,{title:d("editRosterPlayerModal.header.title"),subtitle:d("editRosterPlayerModal.header.subtitle",{playerName:s.display_name}),icon:bd,iconColor:"sky",onClose:o,children:(0,Ts.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};if(u.first_name.trim()?u.first_name.trim().length<2?e.first_name=d("editRosterPlayerModal.validation.firstNameMinLength"):u.first_name.trim().length>50&&(e.first_name=d("editRosterPlayerModal.validation.firstNameMaxLength")):e.first_name=d("editRosterPlayerModal.validation.firstNameRequired"),u.last_name&&u.last_name.trim().length>50&&(e.last_name=d("editRosterPlayerModal.validation.lastNameMaxLength")),u.display_name.trim()?u.display_name.trim().length<2?e.display_name=d("editRosterPlayerModal.validation.displayNameMinLength"):u.display_name.trim().length>50&&(e.display_name=d("editRosterPlayerModal.validation.displayNameMaxLength")):e.display_name=d("editRosterPlayerModal.validation.displayNameRequired"),u.jersey_number){const t=parseInt(u.jersey_number);t<1||t>99?e.jersey_number=d("editRosterPlayerModal.validation.jerseyNumberRange"):t===s.jersey_number||h.includes(t)||(e.jersey_number=d("editRosterPlayerModal.validation.jerseyNumberTaken"))}return y(e),0===Object.keys(e).length})()){g(!0);try{const e={first_name:u.first_name.trim(),last_name:u.last_name?u.last_name.trim():null,display_name:u.display_name.trim(),jersey_number:u.jersey_number?parseInt(u.jersey_number):null,on_roster:u.on_roster};await l(s.id,e)}catch(t){console.error("Error updating player:",t),y({general:t.message||d("editRosterPlayerModal.validation.failedToUpdate")})}finally{g(!1)}}},className:"space-y-4",children:[v.general&&(0,Ts.jsx)(Jc,{variant:"error",children:v.general}),(0,Ts.jsx)(Pd,{label:d("editRosterPlayerModal.form.labels.firstName"),error:v.first_name,children:(0,Ts.jsx)(Rc,{name:"first_name",value:u.first_name,onChange:e=>b("first_name",e.target.value),onBlur:()=>{u.first_name.trim()&&!u.display_name.trim()&&m(e=>(0,n.A)((0,n.A)({},e),{},{display_name:e.first_name.trim()}))},placeholder:d("editRosterPlayerModal.form.placeholders.firstName"),disabled:f,error:!!v.first_name})}),(0,Ts.jsx)(Pd,{label:d("editRosterPlayerModal.form.labels.lastName"),error:v.last_name,children:(0,Ts.jsx)(Rc,{name:"last_name",value:u.last_name,onChange:e=>b("last_name",e.target.value),placeholder:d("editRosterPlayerModal.form.placeholders.lastName"),disabled:f,error:!!v.last_name})}),(0,Ts.jsxs)(Pd,{label:d("editRosterPlayerModal.form.labels.displayName"),error:v.display_name,children:[(0,Ts.jsx)(Rc,{name:"display_name",value:u.display_name,onChange:e=>b("display_name",e.target.value),placeholder:d("editRosterPlayerModal.form.placeholders.displayName"),disabled:f,error:!!v.display_name}),(0,Ts.jsx)("p",{className:"mt-1 text-xs text-slate-400",children:d("editRosterPlayerModal.form.helperText.displayName")})]}),(0,Ts.jsxs)(Pd,{label:d("editRosterPlayerModal.form.labels.jerseyNumber"),error:v.jersey_number,children:[(0,Ts.jsx)(Dc,{value:u.jersey_number,onChange:e=>b("jersey_number",e),options:w,disabled:f,error:!!v.jersey_number}),0===h.length&&!x&&(0,Ts.jsx)("p",{className:"mt-1 text-sm text-amber-400",children:d("editRosterPlayerModal.jerseyNumber.allTaken")})]}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ts.jsx)("input",{type:"checkbox",id:"on_roster",checked:u.on_roster,onChange:e=>b("on_roster",e.target.checked),disabled:f,className:"sr-only"}),(0,Ts.jsx)("div",{onClick:()=>!f&&b("on_roster",!u.on_roster),className:"w-4 h-4 rounded border-2 flex items-center justify-center cursor-pointer transition-colors ".concat(u.on_roster?"bg-emerald-600 border-emerald-600":"border-slate-400 hover:border-slate-300"," ").concat(f?"opacity-50 cursor-not-allowed":""),children:u.on_roster&&(0,Ts.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,Ts.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),(0,Ts.jsx)("label",{htmlFor:"on_roster",className:"text-sm text-slate-300 cursor-pointer ".concat(f?"opacity-50 cursor-not-allowed":""),children:d("editRosterPlayerModal.form.labels.onRoster")})]}),(0,Ts.jsxs)("div",{className:"bg-slate-700 rounded-lg p-3 border border-slate-600",children:[(0,Ts.jsx)("div",{className:"text-xs text-slate-400 mb-1",children:d("editRosterPlayerModal.playerInfo.header")}),(0,Ts.jsxs)("div",{className:"space-y-1",children:[(0,Ts.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,Ts.jsx)("span",{className:"text-slate-300",children:d("editRosterPlayerModal.playerInfo.created")}),(0,Ts.jsx)("span",{className:"text-slate-100",children:s.created_at?new Date(s.created_at).toLocaleDateString():d("editRosterPlayerModal.playerInfo.unknown")})]}),s.updated_at&&(0,Ts.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,Ts.jsx)("span",{className:"text-slate-300",children:d("editRosterPlayerModal.playerInfo.lastUpdated")}),(0,Ts.jsx)("span",{className:"text-slate-100",children:new Date(s.updated_at).toLocaleDateString()})]})]})]}),(0,Ts.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,Ts.jsx)(Lc,{type:"submit",variant:"primary",disabled:f,className:"flex-1",children:d(f?"editRosterPlayerModal.buttons.updating":"editRosterPlayerModal.buttons.updatePlayer")}),(0,Ts.jsx)(Lc,{type:"button",variant:"secondary",onClick:o,disabled:f,children:d("editRosterPlayerModal.buttons.cancel")})]})]})}):null}function Au(e){let{player:t,hasGameHistory:a,onClose:n,onConfirm:r}=e;const{t:s}=xe("team");if(!t)return null;const i=!a,o=t.display_name||t.displayName||t.first_name||s("deletePlayerModal.unknownPlayer"),l=o.charAt(0).toUpperCase();return(0,Ts.jsxs)(Mc,{title:s("deletePlayerModal.title"),subtitle:s(i?"deletePlayerModal.subtitleDelete":"deletePlayerModal.subtitleDeactivate"),icon:lu,iconColor:"rose",onClose:n,children:[(0,Ts.jsx)(Xc,{padding:"md",className:"mb-6",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ts.jsx)(Fd,{size:"xl",children:l}),(0,Ts.jsxs)("div",{className:"flex-1",children:[(0,Ts.jsx)("h3",{className:"text-slate-100 font-medium",children:o}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-slate-400",children:[t.jersey_number&&(0,Ts.jsxs)("span",{className:"flex items-center",children:[(0,Ts.jsx)("span",{className:"text-amber-400 mr-1",children:"#"}),t.jersey_number]}),(0,Ts.jsx)("span",{className:t.on_roster?"text-emerald-400":"text-slate-400",children:t.on_roster?s("deletePlayerModal.status.active"):s("deletePlayerModal.status.inactive")})]})]})]})}),(0,Ts.jsx)("div",{className:"bg-rose-900/20 border border-rose-600 rounded-lg p-4 mb-4",children:(0,Ts.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,Ts.jsx)(lu,{className:"w-5 h-5 text-rose-400 mt-0.5 flex-shrink-0"}),(0,Ts.jsxs)("div",{className:"space-y-2",children:[(0,Ts.jsx)("p",{className:"text-rose-200 font-medium",children:s("deletePlayerModal.warning.title")}),i?(0,Ts.jsxs)("ul",{className:"text-rose-300 text-sm space-y-1",children:[(0,Ts.jsx)("li",{children:s("deletePlayerModal.warning.permanentDeleteFull")}),(0,Ts.jsx)("li",{children:s("deletePlayerModal.warning.cannotUndo")})]}):(0,Ts.jsx)("ul",{className:"text-rose-300 text-sm space-y-1",children:(0,Ts.jsx)("li",{children:s("deletePlayerModal.warning.deactivatedFull")})})]})]})}),i&&(0,Ts.jsxs)(Xc,{padding:"md",className:"mb-6",children:[(0,Ts.jsx)("p",{className:"text-slate-200 font-medium mb-2",children:s("deletePlayerModal.whatHappensNext")}),(0,Ts.jsx)("ul",{className:"text-slate-300 text-sm space-y-1",children:(0,Ts.jsx)("li",{children:s("deletePlayerModal.deleteConsequences.jerseyAvailable")})})]}),!i&&(0,Ts.jsxs)(Xc,{padding:"md",className:"mb-6",children:[(0,Ts.jsx)("p",{className:"text-slate-200 font-medium mb-2",children:s("deletePlayerModal.whatHappensNext")}),(0,Ts.jsxs)("ul",{className:"text-slate-300 text-sm space-y-1",children:[(0,Ts.jsx)("li",{children:s("deletePlayerModal.deactivateConsequences.statsPreserved")}),(0,Ts.jsx)("li",{children:s("deletePlayerModal.deactivateConsequences.jerseyAvailable")}),(0,Ts.jsx)("li",{children:s("deletePlayerModal.deactivateConsequences.canReactivate")})]})]}),(0,Ts.jsxs)("div",{className:"flex space-x-3",children:[(0,Ts.jsx)(Lc,{onClick:r,variant:"danger",className:"flex-1 bg-rose-600 hover:bg-rose-700 text-white",Icon:xd,children:s(i?"deletePlayerModal.buttons.deletePlayer":"deletePlayerModal.buttons.deactivatePlayer")}),(0,Ts.jsx)(Lc,{onClick:n,variant:"secondary",className:"flex-1",children:s("deletePlayerModal.buttons.cancel")})]})]})}const _u={SPORTADMIN:{id:"sportadmin",name:"SportAdmin",description:"Swedish team management platform",features:["Practice Attendance","Upcoming Matches"],logo:a.p+"static/media/sportAdmin-250-80.dfeaf9e9a61cc94a466f.png",comingSoon:!1},SVENSKA_LAG:{id:"svenska_lag",name:"Svenska Lag",description:"Swedish team management platform",features:["Coming Soon"],logo:a.p+"static/media/svenskalag-250-80.d5a3d1c30942fe839ef5.png",comingSoon:!0},MYCLUB:{id:"myclub",name:"MyClub",description:"Team management platform",features:["Coming Soon"],logo:a.p+"static/media/myClub-250-80.8ab0b991a1bf68111605.png",comingSoon:!0}};function Cu(e){return Object.values(_u).find(t=>t.id===e)}function Mu(){return Object.values(_u)}const Pu="connected",Eu="disconnected",Iu="error",Ru="verifying",Ou="waiting",Du="running",Fu="completed",Lu="failed",qu="retrying",Uu="cancelled";async function Bu(e){if(!e)throw new Error("Team ID is required");const{data:t,error:a}=await Ur.from("connector").select("*").eq("team_id",e).order("created_at",{ascending:!1});if(a)throw console.error("Error fetching team connectors:",a),new Error("Failed to load connectors");return t||[]}async function Gu(e){if(!e)throw new Error("Connector ID is required");const{data:t,error:a}=await Ur.rpc("create_manual_sync_job",{p_connector_id:e});if(a)throw console.error("Error triggering manual sync:",a),new Error("Failed to trigger manual sync");return t}async function zu(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;if(!e)throw new Error("Connector ID is required");const{data:a,error:n}=await Ur.from("connector_sync_job").select("*").eq("connector_id",e).order("created_at",{ascending:!1}).limit(t);if(n)throw console.error("Error fetching sync jobs:",n),new Error("Failed to load sync jobs");return a||[]}async function Vu(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)throw new Error("Team ID is required");const a=await Bu(e);let n=Ur.from("connected_player").select("\n      id,\n      player_id,\n      player_name,\n      connector:connector_id (\n        id,\n        provider,\n        status,\n        team_id\n      )\n    ").eq("connector.team_id",e);t||(n=n.eq("is_dismissed",!1));const{data:r,error:s}=await n;if(s)throw console.error("Error fetching player connection details:",s),new Error("Failed to load player connection details");const i=new Map,o=[],l=a.some(e=>"disconnected"!==e.status);return null===r||void 0===r||r.forEach(e=>{const t=e.connector;if(!t)return void o.push({externalPlayerId:e.id,providerName:"Unknown connector",providerId:null,playerNameInProvider:e.player_name,connectorStatus:null,connectorId:null});const a=Cu(t.provider),n={externalPlayerId:e.id,providerName:(null===a||void 0===a?void 0:a.name)||t.provider,providerId:t.provider,playerNameInProvider:e.player_name,connectorStatus:t.status,connectorId:t.id};if(e.player_id){const t=i.get(e.player_id)||[];i.set(e.player_id,[...t,n])}else o.push(n)}),{matchedConnections:i,unmatchedExternalPlayers:o,hasConnectedProvider:l}}async function Hu(e,t,a){if(!e||!t||!a)throw new Error("External player ID, team ID, and addRosterPlayer function are required");const{data:n,error:r}=await Ur.from("connected_player").select("id, player_name, player_id").eq("id",e).single();if(r)throw console.error("Error fetching connected_player:",r),new Error("Failed to fetch player data from provider");if(!n)throw new Error("Connected player not found");if(n.player_id)throw new Error("This player has already been added to the roster");let s;try{s=(e=>{if(!e||"string"!==typeof e)throw new Error("Player name is required");const t=e.trim();if(t.length<2)throw new Error("Player name is too short (minimum 2 characters)");if(t.includes(",")){const e=t.split(",").map(e=>e.trim()).filter(Boolean);if(e.length>=2){const t=e[0],a=e[1];if(a.length<2)throw new Error("First name is too short (minimum 2 characters)");const n=a.substring(0,50),r=t.substring(0,50);return{first_name:n,last_name:r,display_name:"".concat(n," ").concat(r)}}if(1===e.length){const t=e[0].substring(0,50);return{first_name:t,last_name:null,display_name:t}}}const a=t.split(/\s+/).filter(Boolean);if(a.length>=2){const e=a[0],n=a.slice(1).join(" ");return{first_name:e.substring(0,50),last_name:n.substring(0,50),display_name:t.substring(0,100)}}const n=t.substring(0,50);return{first_name:n,last_name:null,display_name:n}})(n.player_name)}catch(l){throw console.error("Error parsing player name:",l),new Error("Invalid player name format: ".concat(l.message))}const i={first_name:s.first_name,last_name:s.last_name,display_name:s.first_name,on_roster:!0,jersey_number:null};let o;try{o=await a(t,i)}catch(co){throw console.error("Error creating roster player:",co),new Error("Failed to add player to roster: ".concat(co.message))}try{const{data:t,error:a}=await Ur.from("connected_player").update({player_id:o.id}).eq("id",e).is("player_id",null).select("id");if(a)throw a;if(!t||0===t.length)throw new Error("Connected player already matched")}catch(c){console.error("Error matching player to connected_player:",c);const{error:e}=await Ur.from("player").delete().eq("id",o.id);if(e&&console.error("Error cleaning up roster player after match failure:",e),"Connected player already matched"===c.message)throw new Error("This player has already been added to the roster");throw new Error("Player added to roster but failed to link to provider data")}return o}async function Ku(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)throw new Error("Team ID is required");try{const n=(await Bu(e)).filter(e=>"connected"===e.status);if(0===n.length)return[];const r=function(e){if(!e)return null;const t=new Date(e);return Number.isNaN(t.getTime())?null:(t.setHours(0,0,0,0),t)}(t),s=function(e){if(!e)return null;const t=new Date(e);return Number.isNaN(t.getTime())?null:(t.setHours(23,59,59,999),t)}(a),i=function(e,t){const a=[];if(e){const t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate();a.push("or(year.gt.".concat(t,",and(year.eq.").concat(t,",month.gt.").concat(n,"),and(year.eq.").concat(t,",month.eq.").concat(n,",day_of_month.gte.").concat(r,"))"))}if(t){const e=t.getFullYear(),n=t.getMonth()+1,r=t.getDate();a.push("or(year.lt.".concat(e,",and(year.eq.").concat(e,",month.lt.").concat(n,"),and(year.eq.").concat(e,",month.eq.").concat(n,",day_of_month.lte.").concat(r,"))"))}return 0===a.length?null:1===a.length?a[0]:"and(".concat(a.join(","),")")}(r,s),o=n.map(e=>e.id);let l=Ur.from("player_attendance").select("\n        id,\n        year,\n        month,\n        day_of_month,\n        total_practices,\n        total_attendance,\n        connected_player:connected_player_id (\n          player_id,\n          player_name,\n          connector:connector_id (\n            id,\n            provider\n          )\n        )\n      ").in("connected_player.connector.id",o).not("connected_player.player_id","is",null);i&&(l=l.or(i));const{data:c,error:d}=await l.order("year",{ascending:!0}).order("month",{ascending:!0}).order("day_of_month",{ascending:!0});if(d)throw console.error("Error fetching attendance data:",d),new Error("Failed to load attendance data");const u=(c||[]).filter(e=>{if(!r&&!s)return!0;const t=function(e){const t="number"===typeof e.year?e.year:1970,a="number"===typeof e.month?e.month:1,n="number"!==typeof e.day_of_month||Number.isNaN(e.day_of_month)?1:e.day_of_month;return new Date(t,a-1,n,0,0,0,0)}(e);return!(r&&t<r)&&!(s&&t>s)}),m=new Map,h=new Map;u.forEach(e=>{var t;const a=null===(t=e.connected_player)||void 0===t?void 0:t.player_id;if(!a)return;const n=function(e){let{year:t,month:a,day_of_month:n}=e;const r="number"!==typeof t||Number.isNaN(t)?1970:t,s="number"!==typeof n||Number.isNaN(n)?1:n,i="number"!==typeof a||Number.isNaN(a)?1:a,o=String(i).padStart(2,"0"),l=String(s).padStart(2,"0");return"".concat(r,"-").concat(o,"-").concat(l)}(e),r=Number.isFinite(e.total_attendance)?e.total_attendance:0;r>(h.get(n)||0)&&h.set(n,r),m.has(a)||m.set(a,{playerId:a,totalAttendance:0,attendanceRecords:[]});const s=m.get(a);s.totalAttendance+=r,s.attendanceRecords.push({date:n,year:e.year,month:e.month,day:e.day_of_month||1,practices:e.total_practices,attendance:e.total_attendance})});const p=Array.from(h.values()).filter(e=>e>0).reduce((e,t)=>e+t,0),f=Array.from(m.keys());if(0===f.length)return[];const{data:g,error:v}=await Ur.from("player").select("id, display_name, first_name").in("id",f).eq("team_id",e);if(v)throw console.error("Error fetching players:",v),new Error("Failed to load player data");const y=new Map;(g||[]).forEach(e=>{y.set(e.id,e.display_name||e.first_name||"Unknown Player")});const{data:b,error:x}=await Ur.from("team_preference").select("value").eq("team_id",e).eq("key","loanMatchWeight").maybeSingle();x&&console.error("Error loading loan match weight:",x);const w=null!==b&&void 0!==b&&b.value?parseFloat(b.value):.5,S=Number.isNaN(w)?.5:w;let k=Ur.from("player_loan").select("player_id, loan_date").in("player_id",f).eq("team_id",e);t&&(k=k.gte("loan_date",t.toISOString().slice(0,10))),a&&(k=k.lte("loan_date",a.toISOString().slice(0,10)));const{data:N,error:j}=await k;if(j)throw console.error("Error fetching loan matches:",j),new Error("Failed to load loan match data");const T=new Map;(N||[]).forEach(e=>{const t=e.player_id;T.set(t,(T.get(t)||0)+1)});let A=Ur.from("player_match_stats").select("\n        player_id,\n        match:match_id (\n          id,\n          team_id,\n          state,\n          deleted_at,\n          started_at\n        )\n      ").in("player_id",f);const{data:_,error:C}=await A;if(C)throw console.error("Error fetching match stats:",C),new Error("Failed to load match statistics");const M=new Map;(_||[]).forEach(n=>{if(!n.match||n.match.team_id!==e)return;if("finished"!==n.match.state)return;if(null!==n.match.deleted_at)return;if(t||a){const e=new Date(n.match.started_at);if(t&&e<t)return;if(a&&e>a)return}const r=n.player_id;M.set(r,(M.get(r)||0)+1)});const P=Array.from(m.entries()).map(e=>{let[t,a]=e;const n=y.get(t)||"Unknown Player",r=M.get(t)||0,s=T.get(t)||0,i=r+s*S,o=p>0?a.totalAttendance/p*100:0,l=i>0?a.totalAttendance/i:0;return{playerId:t,playerName:n,totalPractices:p,totalAttendance:a.totalAttendance,attendanceRate:Math.round(10*o)/10,matchesPlayed:r,loanMatches:s,weightedMatches:Math.round(100*i)/100,practicesPerMatch:Math.round(100*l)/100,attendanceRecords:a.attendanceRecords}});return P.sort((e,t)=>e.playerName.localeCompare(t.playerName)),P}catch(n){throw console.error("Error getting attendance stats:",n),n}}function Wu(t){let{rosterPlayer:a,unmatchedExternalPlayers:n,onClose:r,onMatched:s}=t;const{t:i}=xe("team"),[o,l]=(0,e.useState)(""),[c,d]=(0,e.useState)(!1),[u,m]=(0,e.useState)(null),h=(0,e.useMemo)(()=>[{value:"",label:i("playerMatching.selectProvider")},...n.map(e=>{const t="".concat(e.playerNameInProvider," (").concat(e.providerName,")");return{value:e.externalPlayerId,label:t}})],[n,i]);return a?(0,Ts.jsx)(Mc,{title:i("playerMatching.title"),subtitle:i("playerMatching.subtitle"),icon:ud,iconColor:"amber",onClose:r,children:(0,Ts.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),o){d(!0),m(null);try{const e=n.find(e=>e.externalPlayerId===o);await async function(e,t){if(!e||!t)throw new Error("External player ID and player ID are required");const{error:a}=await Ur.from("connected_player").update({player_id:t}).eq("id",e);if(a)throw console.error("Error matching player to connected_player:",a),new Error("Failed to match player")}(o,a.id),s&&await s(e||null,a),r()}catch(t){console.error("Error matching player:",t),m(t.message||i("playerMatching.errors.matchFailed"))}finally{d(!1)}}else m(i("playerMatching.errors.selectPlayer"))},className:"space-y-6",children:[u&&(0,Ts.jsx)(Jc,{variant:"error",children:u}),(0,Ts.jsxs)(Xc,{variant:"subtle",children:[(0,Ts.jsx)("h3",{className:"text-sm font-medium text-slate-300 mb-2",children:i("playerMatching.rosterPlayer")}),(0,Ts.jsxs)("div",{className:"text-lg font-semibold text-slate-100",children:[a.jersey_number&&"#".concat(a.jersey_number," - "),a.display_name]}),(0,Ts.jsxs)("div",{className:"text-sm text-slate-400 mt-1",children:[a.first_name," ",a.last_name]})]}),(0,Ts.jsxs)(Pd,{label:i("playerMatching.selectProviderLabel"),children:[(0,Ts.jsx)(Dc,{name:"provider_player",value:o,onChange:e=>{l(e),m(null)},options:h,disabled:c,error:!!u}),(0,Ts.jsx)("p",{className:"mt-2 text-xs text-slate-400",children:i("playerMatching.selectProviderHelp")})]}),(0,Ts.jsxs)("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t border-slate-600",children:[(0,Ts.jsx)(Lc,{type:"button",onClick:r,variant:"secondary",disabled:c,children:i("playerMatching.buttons.cancel")}),(0,Ts.jsx)(Lc,{type:"submit",variant:"primary",disabled:c||!o,Icon:ud,children:i(c?"playerMatching.buttons.matching":"playerMatching.buttons.matchPlayer")})]})]})}):null}function Yu(t){let{isOpen:a,onClose:r,onSave:s,players:i=[],loan:o=null,defaultPlayerId:l=""}=t;const{t:c}=xe("team"),d=Boolean(o),[u,m]=(0,e.useState)({playerIds:l?[l]:[],receivingTeamName:"",loanDate:""}),[h,p]=(0,e.useState)({}),[f,g]=(0,e.useState)(!1);(0,e.useEffect)(()=>{if(!a)return;const e=Array.isArray(null===o||void 0===o?void 0:o.playerIds)?o.playerIds:null!==o&&void 0!==o&&o.player_id?[o.player_id]:l?[l]:[];m({playerIds:e,receivingTeamName:(null===o||void 0===o?void 0:o.receivingTeamName)||(null===o||void 0===o?void 0:o.receiving_team_name)||"",loanDate:(null===o||void 0===o?void 0:o.loanDate)||(null===o||void 0===o?void 0:o.loan_date)||""}),p({}),g(!1)},[a,o,l]);const v=(0,e.useMemo)(()=>i.map(e=>({value:e.id,label:Gi(e)})).sort((e,t)=>{const a=u.playerIds.includes(e.value),n=u.playerIds.includes(t.value);return a&&!n?-1:!a&&n?1:e.label.localeCompare(t.label)}),[i,u.playerIds]),y=(e,t)=>{m(a=>(0,n.A)((0,n.A)({},a),{},{[e]:t})),h[e]&&p(t=>(0,n.A)((0,n.A)({},t),{},{[e]:null}))};return a?(0,Ts.jsx)(Mc,{title:c(d?"loanModal.header.titleEdit":"loanModal.header.titleNew"),subtitle:c(d?"loanModal.header.subtitleEdit":"loanModal.header.subtitleNew"),icon:cd,iconColor:"sky",onClose:r,children:(0,Ts.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return u.playerIds&&0!==u.playerIds.length||(e.playerIds=c("loanModal.validation.playersRequired")),u.receivingTeamName.trim()?u.receivingTeamName.trim().length>200&&(e.receivingTeamName=c("loanModal.validation.receivingTeamMaxLength")):e.receivingTeamName=c("loanModal.validation.receivingTeamRequired"),u.loanDate||(e.loanDate=c("loanModal.validation.loanDateRequired")),p(e),0===Object.keys(e).length})()){g(!0);try{await s({playerIds:u.playerIds,receivingTeamName:u.receivingTeamName.trim(),loanDate:u.loanDate}),r()}catch(t){console.error("Player loan save error:",t),p({general:(null===t||void 0===t?void 0:t.message)||c("loanModal.validation.saveFailed")})}finally{g(!1)}}},className:"space-y-4",children:[h.general&&(0,Ts.jsx)(Jc,{variant:"error",children:h.general}),(0,Ts.jsx)(Pd,{label:c("loanModal.form.labels.players"),error:h.playerIds,children:(0,Ts.jsx)(Fc,{value:u.playerIds,onChange:e=>y("playerIds",e),options:v,placeholder:c("loanModal.form.placeholders.players"),disabled:f})}),(0,Ts.jsx)(Pd,{label:c("loanModal.form.labels.receivingTeam"),error:h.receivingTeamName,children:(0,Ts.jsx)(Rc,{value:u.receivingTeamName,onChange:e=>y("receivingTeamName",e.target.value),placeholder:c("loanModal.form.placeholders.receivingTeam"),disabled:f,error:!!h.receivingTeamName})}),(0,Ts.jsx)(Pd,{label:c("loanModal.form.labels.loanDate"),error:h.loanDate,children:(0,Ts.jsx)(Rc,{type:"date",value:u.loanDate,onChange:e=>y("loanDate",e.target.value),disabled:f,error:!!h.loanDate})}),(0,Ts.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,Ts.jsx)(Lc,{type:"button",onClick:r,variant:"secondary",disabled:f,children:c("loanModal.buttons.cancel")}),(0,Ts.jsx)(Lc,{type:"submit",variant:"primary",disabled:f,children:c(f?"loanModal.buttons.saving":d?"loanModal.buttons.saveChanges":"loanModal.buttons.recordLoan")})]})]})}):null}const Ju=fc("circle-plus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),Qu=fc("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]),$u=fc("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Xu=fc("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);const Zu=.5,em=e=>e?e instanceof Date&&!Number.isNaN(e.getTime())?e.toISOString().slice(0,10):"string"===typeof e?e.length>=10?e.slice(0,10):e:null:null,tm=e=>e?e.toString().trim():"",am=()=>Zu;async function nm(e,t){let{teamId:a,receivingTeamName:n,loanDate:r}=t;try{if(!Array.isArray(e)||0===e.length)return{success:!1,error:"errors.loanPlayerRequired"};if(!a)return{success:!1,error:"Team ID is required"};const t=tm(n);if(!t)return{success:!1,error:"errors.loanTeamNameRequired"};if(t.length>200)return{success:!1,error:"errors.loanTeamNameTooLong"};const s=em(r);if(!s)return{success:!1,error:"errors.loanDateRequired"};const i=e.map(e=>({player_id:e,team_id:a,receiving_team_name:t,loan_date:s})),{data:o,error:l}=await Ur.from("player_loan").insert(i).select();return l?(console.error("Error recording player loans:",l),{success:!1,error:l.message||"errors.loanRecordFailed"}):{success:!0,loans:o||[]}}catch(s){return console.error("Exception recording player loans:",s),{success:!1,error:s.message||"errors.loanRecordFailed"}}}async function rm(){let{teamId:e,receivingTeamName:t,loanDate:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(!e)return{success:!1,error:"Team ID is required"};const n=tm(t);if(!n)return{success:!1,error:"errors.loanTeamNameRequired"};const r=em(a);if(!r)return{success:!1,error:"errors.loanDateRequired"};const{data:s,error:i}=await Ur.from("player_loan").delete().eq("team_id",e).eq("receiving_team_name",n).eq("loan_date",r).select();return i?(console.error("Error deleting match loans:",i),{success:!1,error:i.message||"Failed to delete match loans"}):{success:!0,deletedCount:(null===s||void 0===s?void 0:s.length)||0}}catch(n){return console.error("Exception deleting match loans:",n),{success:!1,error:n.message||"Failed to delete match loans"}}}async function sm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{if(!e)return{success:!1,error:"Team ID is required"};let a=Ur.from("player_loan").select("\n        id,\n        player_id,\n        team_id,\n        receiving_team_name,\n        loan_date,\n        created_at,\n        updated_at,\n        player:player_id (\n          id,\n          display_name,\n          first_name,\n          last_name,\n          jersey_number\n        )\n      ").eq("team_id",e).order("loan_date",{ascending:!1});const n=em(t.startDate),r=em(t.endDate);n&&(a=a.gte("loan_date",n)),r&&(a=a.lte("loan_date",r));const{data:s,error:i}=await a;return i?(console.error("Error fetching team loans:",i),{success:!1,error:i.message||"Failed to fetch team loans"}):{success:!0,loans:s||[]}}catch(a){return console.error("Exception fetching team loans:",a),{success:!1,error:a.message||"Failed to fetch team loans"}}}const im=[{id:"last-30-days",label:"Last 30 days",getValue:()=>{const e=new Date,t=new Date;return t.setDate(t.getDate()-30),{start:t,end:e}}},{id:"last-3-months",label:"Last 3 months",getValue:()=>{const e=new Date,t=new Date;return t.setMonth(t.getMonth()-3),{start:t,end:e}}},{id:"last-6-months",label:"Last 6 months",getValue:()=>{const e=new Date,t=new Date;return t.setMonth(t.getMonth()-6),{start:t,end:e}}},{id:"last-12-months",label:"Last 12 months",getValue:()=>{const e=new Date,t=new Date;return t.setFullYear(t.getFullYear()-1),{start:t,end:e}}},{id:"year-to-date",label:"Year to Date",getValue:()=>{const e=new Date;return{start:new Date(e.getFullYear(),0,1),end:e}}},{id:"all-time",label:"All time",getValue:()=>({start:null,end:null})}],om=e=>e?e.toISOString().split("T")[0]:"";function lm(t){let{startDate:a,endDate:n,selectedPresetId:r="all-time",onTimeRangeChange:s,className:i=""}=t;const{t:o,i18n:l}=xe("statistics"),c=(0,e.useMemo)(()=>(e=>[{id:"last-30-days",label:e("statistics:timeFilter.presets.last-30-days"),getValue:()=>{const e=new Date,t=new Date;return t.setDate(t.getDate()-30),{start:t,end:e}}},{id:"last-3-months",label:e("statistics:timeFilter.presets.last-3-months"),getValue:()=>{const e=new Date,t=new Date;return t.setMonth(t.getMonth()-3),{start:t,end:e}}},{id:"last-6-months",label:e("statistics:timeFilter.presets.last-6-months"),getValue:()=>{const e=new Date,t=new Date;return t.setMonth(t.getMonth()-6),{start:t,end:e}}},{id:"last-12-months",label:e("statistics:timeFilter.presets.last-12-months"),getValue:()=>{const e=new Date,t=new Date;return t.setFullYear(t.getFullYear()-1),{start:t,end:e}}},{id:"year-to-date",label:e("statistics:timeFilter.presets.year-to-date"),getValue:()=>{const e=new Date;return{start:new Date(e.getFullYear(),0,1),end:e}}},{id:"all-time",label:e("statistics:timeFilter.presets.all-time"),getValue:()=>({start:null,end:null})}])(o),[o]),d=(0,e.useCallback)(e=>{if(!e)return"";const t="sv"===l.language?"sv-SE":"en-US";return e.toLocaleDateString(t,{month:"short",day:"numeric",year:"numeric"})},[l.language]),[u,m]=(0,e.useState)(!1),[h,p]=(0,e.useState)(r),[f,g]=(0,e.useState)(""),[v,y]=(0,e.useState)(""),[b,x]=(0,e.useState)(!1),w=(0,e.useRef)(null);(0,e.useEffect)(()=>{p(r),"custom"===r?(x(!0),g(om(a)),y(om(n))):x(!1)},[r,a,n]),(0,e.useEffect)(()=>{const e=e=>{w.current&&!w.current.contains(e.target)&&m(!1)};if(u)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[u]);const S=(0,e.useMemo)(()=>{if("custom"===h)return o("timeFilter.custom");const e=c.find(e=>e.id===h);return e?e.label:o("timeFilter.allTime")},[h,o,c]),k=(0,e.useMemo)(()=>S&&"custom"!==h?S:a||n?a&&n?o("timeFilter.dateRange",{start:d(a),end:d(n)}):a?o("timeFilter.from",{date:d(a)}):n?o("timeFilter.until",{date:d(n)}):o("timeFilter.allTime"):o("timeFilter.allTime"),[a,n,S,h,o,d]),N=(0,e.useMemo)(()=>Boolean(a||n),[a,n]),j=e=>{if(p(e),x(!1),"custom"===e)return x(!0),g(om(a)),void y(om(n));const t=im.find(t=>t.id===e);if(t){const a=t.getValue();s(a.start,a.end,e),m(!1)}};return(0,Ts.jsxs)("div",{className:"relative ".concat(i),ref:w,children:[(0,Ts.jsxs)("div",{onClick:()=>m(!u),className:["cursor-pointer select-none bg-slate-700 border rounded-lg px-4 py-2.5 flex items-center space-x-3 transition-all duration-200 ease-in-out min-w-0 h-[38px]",u?"border-sky-500 bg-slate-600":"border-slate-600 hover:border-slate-500 hover:bg-slate-600",N?"shadow-[0_0_16px_rgba(125,211,252,0.65),0_0_32px_rgba(56,189,248,0.4)] ring-2 ring-sky-300/80 ring-offset-2 ring-offset-slate-800 border-sky-300":"","focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-offset-2 focus:ring-offset-slate-800"].join(" "),role:"button",tabIndex:0,"aria-haspopup":"listbox","aria-expanded":u,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),m(!u))},children:[(0,Ts.jsx)(Sd,{className:"h-4 w-4 text-sky-400 flex-shrink-0"}),(0,Ts.jsx)("span",{className:"text-sm font-medium truncate max-w-[200px] whitespace-nowrap ".concat(N?"text-sky-300":"text-slate-100"),children:k}),(0,Ts.jsx)(jc,{className:"h-4 w-4 text-sky-400 flex-shrink-0 transition-transform duration-200 ".concat(u?"rotate-180":"")})]}),u&&(0,Ts.jsx)("div",{className:"absolute right-0 top-full mt-2 w-80 bg-slate-800 border border-slate-600 rounded-lg shadow-xl z-50",children:(0,Ts.jsxs)("div",{className:"p-3",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,Ts.jsx)(Id,{className:"h-4 w-4 text-sky-400"}),(0,Ts.jsx)("h3",{className:"text-sm font-medium text-sky-400",children:o("timeFilter.selectTimeRange")})]}),(0,Ts.jsxs)("div",{className:"space-y-1 mb-4",children:[c.map(e=>(0,Ts.jsxs)("button",{onClick:()=>j(e.id),className:"w-full px-3 py-2 text-left text-sm rounded-md transition-colors flex items-center justify-between ".concat(h===e.id?"bg-sky-900/50 text-sky-300 border border-sky-600":"text-slate-300 hover:bg-slate-700 hover:text-slate-200"),children:[(0,Ts.jsx)("span",{children:e.label}),h===e.id&&(0,Ts.jsx)(nu,{className:"h-4 w-4"})]},e.id)),(0,Ts.jsxs)("button",{onClick:()=>j("custom"),className:"w-full px-3 py-2 text-left text-sm rounded-md transition-colors flex items-center justify-between ".concat("custom"===h?"bg-sky-900/50 text-sky-300 border border-sky-600":"text-slate-300 hover:bg-slate-700 hover:text-slate-200"),children:[(0,Ts.jsx)("span",{children:o("timeFilter.customRange")}),"custom"===h&&(0,Ts.jsx)(nu,{className:"h-4 w-4"})]})]}),b&&(0,Ts.jsx)("div",{className:"border-t border-slate-600 pt-3",children:(0,Ts.jsxs)("div",{className:"space-y-3",children:[(0,Ts.jsx)(Pd,{label:o("timeFilter.startDate"),children:(0,Ts.jsx)(Rc,{type:"date",value:f,onChange:e=>g(e.target.value),className:"text-sm"})}),(0,Ts.jsx)(Pd,{label:o("timeFilter.endDate"),children:(0,Ts.jsx)(Rc,{type:"date",value:v,onChange:e=>y(e.target.value),className:"text-sm"})}),(0,Ts.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,Ts.jsx)(Lc,{onClick:()=>{let e=null,t=null;if(f&&(e=new Date(f),isNaN(e.getTime())))return void alert(o("timeFilter.invalidStartDate"));if(v&&(t=new Date(v),isNaN(t.getTime())))return void alert(o("timeFilter.invalidEndDate"));if(e&&t&&e>t)return void alert(o("timeFilter.startBeforeEnd"));const a=new Date,n=new Date(a.getTime()+31536e6);e&&e>n?alert(o("timeFilter.startDateTooFar")):t&&t>n?alert(o("timeFilter.endDateTooFar")):(s(e,t,"custom"),m(!1))},variant:"primary",size:"sm",className:"flex-1",children:o("timeFilter.apply")}),(0,Ts.jsx)(Lc,{onClick:()=>{x(!1),m(!1),g(om(a)),y(om(n));const e=im.find(e=>{const t=e.getValue();return!(t.start||t.end||a||n)});p(e?e.id:"custom")},variant:"secondary",size:"sm",className:"flex-1",children:o("timeFilter.cancel")})]})]})})]})})]})}const cm=640,dm=1024,um=e=>{const t=Gi(e);return null!==e&&void 0!==e&&e.jersey_number?"#".concat(e.jersey_number," ").concat(t):t},mm=e=>{const t=(e=>{if(!e)return null;const t=new Date("".concat(e,"T00:00:00"));return Number.isNaN(t.getTime())?null:t})(e);if(!t)return!1;const a=new Date;return a.setHours(0,0,0,0),t>a};function hm(t){let{currentTeam:a,canManageTeam:n}=t;const{t:r}=xe("team"),{getTeamRoster:s}=vi(),{pushNavigationState:i,removeFromNavigationStack:o}=Xl(),l=(0,e.useCallback)(()=>"undefined"!==typeof window&&window.innerWidth<dm,[]),[c,d]=(0,e.useState)([]),[u,m]=(0,e.useState)([]),[h,p]=(0,e.useState)(!1),[f,g]=(0,e.useState)(null),[v,y]=(0,e.useState)(""),[b,x]=(0,e.useState)([]),[w,S]=(0,e.useState)([]),[k,N]=(0,e.useState)("all"),[j,T]=(0,e.useState)(!1),[A,_]=(0,e.useState)(null),[C,M]=(0,e.useState)(null),[P,E]=(0,e.useState)(()=>l()),[I,R]=(0,e.useState)(()=>l()),O=(0,e.useMemo)(()=>Bs(Br.PLAYER_LOANS_TIME_RANGE,{presetId:"all-time",customStartDate:null,customEndDate:null}),[]),D=(0,e.useRef)(null);D.current||(D.current=(e=>{const t=e.loadState(),a=(null===t||void 0===t?void 0:t.presetId)||"all-time";if("custom"===a){const e=e=>{if(!e)return null;const t=new Date(e);return Number.isNaN(t.getTime())?null:t};return{start:e(null===t||void 0===t?void 0:t.customStartDate),end:e(null===t||void 0===t?void 0:t.customEndDate),presetId:"custom"}}const n=im.find(e=>e.id===a),r=n?n.getValue():{start:null,end:null};return{start:r.start,end:r.end,presetId:n?a:"all-time"}})(O));const F=D.current,[L,q]=(0,e.useState)(F.start),[U,B]=(0,e.useState)(F.end),[G,z]=(0,e.useState)(F.presetId),V=(0,e.useMemo)(()=>new Map(u.map(e=>[e.id,e])),[u]),H=(0,e.useCallback)(async()=>{if(null===a||void 0===a||!a.id)return void d([]);p(!0),g(null);const e=e=>e?e.toISOString().slice(0,10):null,t=await sm(a.id,{startDate:e(L),endDate:"custom"===G&&U?e(U):null});t.success?d(t.loans||[]):(d([]),g(t.error||r("loansView.messages.loadFailed"))),p(!1)},[null===a||void 0===a?void 0:a.id,L,U,G,r]),K=(0,e.useCallback)(async()=>{if(null!==a&&void 0!==a&&a.id)try{const e=await s(a.id);m(e||[])}catch(e){console.error("Failed to load roster for loans:",e),m([]),g(r("loansView.messages.rosterLoadFailed"))}else m([])},[null===a||void 0===a?void 0:a.id,s,r]),W=(0,e.useCallback)(()=>{H(),K()},[H,K]);(0,e.useEffect)(()=>{"custom"===G?O.saveState({presetId:"custom",customStartDate:L?L.toISOString():null,customEndDate:U?U.toISOString():null}):O.saveState({presetId:G,customStartDate:null,customEndDate:null})},[L,U,G,O]),(0,e.useEffect)(()=>{H()},[H]),(0,e.useEffect)(()=>{K()},[K]),(0,e.useEffect)(()=>{if(!v)return;const e=setTimeout(()=>y(""),4e3);return()=>clearTimeout(e)},[v]),(0,e.useEffect)(()=>{const e=()=>{const e=l();E(t=>(t!==e&&R(a=>!(!e||t)||!!e&&a),e))};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[l]);const Y=(0,e.useMemo)(()=>u.map(e=>({value:e.id,label:um(e)})),[u]),J=(0,e.useMemo)(()=>{const e=new Set;return c.forEach(t=>{t.receiving_team_name&&e.add(t.receiving_team_name)}),Array.from(e).sort((e,t)=>e.localeCompare(t)).map(e=>({value:e,label:e}))},[c]),Q=(0,e.useMemo)(()=>b.length>0||w.length>0||"all"!==k||"all-time"!==G||Boolean(L)||Boolean(U),[b,w,k,G,L,U]),$=(0,e.useMemo)(()=>c.filter(e=>!("future"===k&&!mm(e.loan_date))&&(("past"!==k||!mm(e.loan_date))&&(!(b.length>0&&!b.includes(e.player_id))&&!(w.length>0&&!w.includes(e.receiving_team_name))))),[c,k,b,w]),X=(0,e.useMemo)(()=>((e,t,a)=>{const n=new Map;e.forEach(e=>{var r;const s=e.receiving_team_name||a("loansView.fallback.unknownTeam"),i=e.loan_date,o="".concat(s,"|").concat(i);n.has(o)||n.set(o,{matchKey:o,receivingTeamName:s,loanDate:i,playerIds:[],players:[],loanIds:[]});const l=n.get(o),c=e.player||t.get(e.player_id),d=c?Gi(c):a("loansView.fallback.unknownPlayerDeleted"),u=null!==(r=null===c||void 0===c?void 0:c.jersey_number)&&void 0!==r?r:null,m=!c;l.playerIds.push(e.player_id),l.players.push({id:e.player_id,displayName:d,jerseyNumber:u,isDeleted:m}),l.loanIds.push(e.id)});const r=Array.from(n.values());return r.forEach(e=>{e.players=[...e.players].sort((e,t)=>e.displayName.localeCompare(t.displayName))}),r.sort((e,t)=>{const a=t.loanDate.localeCompare(e.loanDate);return 0!==a?a:e.receivingTeamName.localeCompare(t.receivingTeamName)})})($,V,r),[$,V,r]),Z=(0,e.useMemo)(()=>{if(!A)return u.filter(e=>!e.match_id);const e=u.filter(e=>!e.match_id),t=new Map(e.map(e=>[e.id,e]));return A.players.forEach(e=>{t.has(e.id)||t.set(e.id,{id:e.id,display_name:e.displayName,jersey_number:e.jerseyNumber})}),Array.from(t.values())},[A,u]),ee=()=>{x([]),S([]),N("all"),q(null),B(null),z("all-time")},te=()=>{_(null),T(!0),i(()=>{T(!1),_(null)},"PlayerLoansView-LoanModal")};return(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,Ts.jsx)(Jd,{title:r("loansView.header.title"),icon:cd}),n&&(0,Ts.jsx)(Lc,{onClick:te,Icon:Ju,size:"sm",children:r("loansView.header.newLoanButton")})]}),(0,Ts.jsxs)("div",{className:"bg-slate-800 rounded-lg border border-slate-600 p-4 space-y-4",children:[(0,Ts.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[(0,Ts.jsxs)("div",{className:"flex items-center gap-2 text-slate-200 ".concat(P?"cursor-pointer":""),onClick:()=>P&&R(!I),children:[(0,Ts.jsx)(Qu,{className:"h-4 w-4 text-sky-400"}),(0,Ts.jsx)("span",{className:"text-sm font-semibold",children:r("loansView.filters.title")}),P&&(0,Ts.jsx)("button",{type:"button",className:"text-sky-400 hover:text-sky-300 transition-colors","aria-label":r(I?"loansView.filters.expandLabel":"loansView.filters.collapseLabel"),children:I?(0,Ts.jsx)(jc,{className:"h-4 w-4"}):(0,Ts.jsx)($u,{className:"h-4 w-4"})})]}),Q&&(0,Ts.jsx)("button",{type:"button",onClick:ee,className:"text-xs text-sky-400 hover:text-sky-300",children:r("loansView.filters.clearButton")})]}),(0,Ts.jsx)("div",{className:"".concat(P?I?"hidden":"block":""),children:(0,Ts.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{className:"block text-xs font-medium text-slate-400 mb-2",children:r("loansView.filters.labels.players")}),(0,Ts.jsx)(Fc,{value:b,onChange:x,options:Y,placeholder:r("loansView.filters.placeholders.allPlayers")})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{className:"block text-xs font-medium text-slate-400 mb-2",children:r("loansView.filters.labels.teams")}),(0,Ts.jsx)(Fc,{value:w,onChange:S,options:J,placeholder:r("loansView.filters.placeholders.allTeams")})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{className:"block text-xs font-medium text-slate-400 mb-2",children:r("loansView.filters.labels.status")}),(0,Ts.jsx)(Dc,{value:k,onChange:N,options:[{value:"all",label:r("loansView.filters.statusOptions.all")},{value:"future",label:r("loansView.filters.statusOptions.upcoming")},{value:"past",label:r("loansView.filters.statusOptions.past")}]})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{className:"block text-xs font-medium text-slate-400 mb-2",children:r("loansView.filters.labels.timePeriod")}),(0,Ts.jsx)(lm,{startDate:L,endDate:U,selectedPresetId:G,onTimeRangeChange:function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all-time";const n=e=>{if(!e)return null;const t=e instanceof Date?e:new Date(e);return Number.isNaN(t.getTime())?null:t};q(n(e)),B(n(t)),z(a)},className:"w-full"})]})]})})]}),f&&(0,Ts.jsx)(Jc,{variant:"error",children:(0,Ts.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,Ts.jsx)("span",{children:f}),(0,Ts.jsx)(Lc,{onClick:W,variant:"secondary",size:"sm",children:r("loansView.messages.retry")})]})}),v&&(0,Ts.jsx)(Jc,{variant:"success",children:v}),h?(0,Ts.jsx)("div",{className:"bg-slate-700 p-8 rounded-lg border border-slate-600 text-center",children:(0,Ts.jsx)("div",{className:"text-slate-400",children:r("loansView.emptyStates.loading")})}):(0,Ts.jsx)("div",{className:"bg-slate-700 p-4 rounded-lg border border-slate-600",children:(0,Ts.jsxs)("div",{className:"space-y-3",children:[X.map(e=>(0,Ts.jsxs)("div",{className:"bg-slate-800 p-4 rounded-lg border border-slate-600 hover:bg-slate-750 transition-colors",children:[(0,Ts.jsxs)("div",{className:"flex items-start justify-between gap-4 mb-3",children:[(0,Ts.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,Ts.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,Ts.jsx)("div",{className:"text-slate-200 font-semibold truncate",children:e.receivingTeamName}),mm(e.loanDate)&&(0,Ts.jsx)("span",{className:"bg-sky-900/50 border-sky-600 text-sky-200 px-2 py-1 rounded text-xs border",children:r("loansView.match.upcomingBadge")})]}),(0,Ts.jsxs)("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[(0,Ts.jsx)(Id,{className:"w-3 h-3"}),e.loanDate]})]}),n&&(0,Ts.jsxs)("div",{className:"flex items-center gap-1 shrink-0",children:[(0,Ts.jsx)("button",{type:"button",onClick:()=>(e=>{_(e),T(!0),i(()=>{T(!1),_(null)},"PlayerLoansView-LoanModal")})(e),className:"p-1 text-slate-400 hover:text-sky-400","aria-label":r("loansView.match.editLabel"),children:(0,Ts.jsx)(bd,{className:"w-4 h-4"})}),(0,Ts.jsx)(Md,{onClick:()=>(e=>{M(e),i(()=>M(null),"PlayerLoansView-DeleteMatch")})(e),icon:xd,label:r("loansView.match.deleteLabel"),variant:"danger",size:"sm"})]})]}),(0,Ts.jsxs)("div",{className:"space-y-2 mt-3 pt-3 border-t border-slate-600",children:[(0,Ts.jsx)("div",{className:"text-xs text-slate-400",children:r("loansView.match.playersLabel",{count:e.players.length})}),(0,Ts.jsx)("div",{className:"flex flex-wrap gap-2",children:e.players.map(e=>(0,Ts.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg ".concat(e.isDeleted?"bg-slate-700/60":"bg-slate-700"),children:[(0,Ts.jsx)(Fd,{size:"sm",children:e.jerseyNumber?(0,Ts.jsx)("span",{className:"font-semibold",children:e.jerseyNumber}):(0,Ts.jsx)(Xu,{className:"w-3 h-3"})}),(0,Ts.jsx)("span",{className:"text-sm ".concat(e.isDeleted?"text-slate-400":"text-slate-200"),children:e.displayName})]},e.id))})]})]},e.matchKey)),0===c.length&&(0,Ts.jsxs)("div",{className:"p-8 text-center text-slate-400",children:[(0,Ts.jsx)(cd,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,Ts.jsx)("p",{className:"text-lg font-medium mb-2",children:r("loansView.emptyStates.noLoans.title")}),(0,Ts.jsx)("p",{className:"text-sm mb-4",children:r("loansView.emptyStates.noLoans.description")}),n&&(0,Ts.jsx)(Lc,{onClick:te,Icon:Ju,children:r("loansView.emptyStates.noLoans.button")})]}),c.length>0&&0===X.length&&(0,Ts.jsxs)("div",{className:"p-8 text-center text-slate-400",children:[(0,Ts.jsx)(cd,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,Ts.jsx)("p",{className:"text-lg font-medium mb-2",children:r("loansView.emptyStates.noResults.title")}),(0,Ts.jsx)("p",{className:"text-sm mb-4",children:r("loansView.emptyStates.noResults.description")}),Q&&(0,Ts.jsx)(Lc,{onClick:ee,variant:"secondary",children:r("loansView.emptyStates.noResults.button")})]})]})}),j&&(0,Ts.jsx)(Yu,{isOpen:j,onClose:()=>{T(!1),_(null),o()},onSave:async e=>{let{playerIds:t,receivingTeamName:n,loanDate:s}=e;if(null===a||void 0===a||!a.id)throw new Error("Team ID is required");if(g(null),A){const e=await rm({teamId:a.id,receivingTeamName:A.receivingTeamName,loanDate:A.loanDate});if(!e.success)throw new Error(e.error||"Failed to update match")}const i=await nm(t,{teamId:a.id,receivingTeamName:n,loanDate:s});if(!i.success)throw new Error(i.error||"Failed to record loan");const o=A?1===t.length?"loansView.messages.loanUpdatedSingle":"loansView.messages.loanUpdatedMultiple":1===t.length?"loansView.messages.loanRecordedSingle":"loansView.messages.loanRecordedMultiple";y(r(o,{count:t.length})),await H()},players:Z,loan:A}),(0,Ts.jsx)(qc,{isOpen:Boolean(C),onCancel:()=>{M(null),o()},onConfirm:async()=>{if(null===a||void 0===a||!a.id||!C)return;const e=await rm({teamId:a.id,receivingTeamName:C.receivingTeamName,loanDate:C.loanDate});if(e.success)return y(r("loansView.messages.loanDeleted",{count:C.players.length})),M(null),o(),void await H();g(e.error||r("loansView.messages.deleteFailed"))},title:r("loansView.deleteConfirmation.title"),message:C?r("loansView.deleteConfirmation.message",{count:C.players.length,teamName:C.receivingTeamName,date:C.loanDate}):"",confirmText:r("loansView.deleteConfirmation.confirmButton"),cancelText:r("loansView.deleteConfirmation.cancelButton")})]})}const pm=fc("image-off",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M10.41 10.41a2 2 0 1 1-2.83-2.83",key:"1bzlo9"}],["line",{x1:"13.5",x2:"6",y1:"13.5",y2:"21",key:"1q0aeu"}],["line",{x1:"18",x2:"21",y1:"12",y2:"15",key:"5mozeu"}],["path",{d:"M3.59 3.59A1.99 1.99 0 0 0 3 5v14a2 2 0 0 0 2 2h14c.55 0 1.052-.22 1.41-.59",key:"mmje98"}],["path",{d:"M21 15V5a2 2 0 0 0-2-2H9",key:"43el77"}]]);function fm(e){let{provider:t,className:a=""}=e;const{t:n}=xe("connectors"),r="w-32 h-10 flex-shrink-0 overflow-hidden rounded-md border border-slate-600 bg-slate-800 ".concat(a).trim();if(null!==t&&void 0!==t&&t.logo)return(0,Ts.jsx)("div",{className:r,children:(0,Ts.jsx)("img",{src:t.logo,alt:n("providerLogo.logoAlt",{providerName:t.name}),className:"w-full h-full object-cover block"})});const s=(null===t||void 0===t?void 0:t.name)||n("providerLogo.fallbackLabel");return(0,Ts.jsx)("div",{className:"".concat(r," flex items-center justify-center px-2"),"aria-label":n("providerLogo.logoPlaceholder",{label:s}),children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-2 text-slate-200 text-sm font-medium truncate",children:[(0,Ts.jsx)(pm,{className:"w-4 h-4 text-slate-400","aria-hidden":"true"}),(0,Ts.jsx)("span",{className:"truncate",children:s})]})})}function gm(e){let{className:t="",label:a}=e;const{t:n}=xe("shared"),r="".concat("px-2 py-[3px] text-[10px] font-semibold bg-gradient-to-r from-amber-300 via-orange-400 to-rose-400 text-slate-900 rounded-full shadow-sm shadow-rose-900/30 border border-white/60"," ").concat(t).trim(),s=a||n("badges.comingSoon");return(0,Ts.jsx)("span",{className:r,children:s})}function vm(e){let{onNavigateToConnectors:t}=e;const{t:a}=xe(["connectors","navigation"]),n=Mu();return(0,Ts.jsxs)(Xc,{variant:"highlighted",className:"text-center",children:[(0,Ts.jsxs)("div",{className:"flex items-start space-x-3 mb-7",children:[(0,Ts.jsx)(ud,{className:"w-5 h-5 text-sky-400 mt-0.5 flex-shrink-0","aria-hidden":"true"}),(0,Ts.jsxs)("div",{className:"flex-1",children:[(0,Ts.jsx)("h3",{className:"text-sky-200 font-medium text-sm mb-1",children:a("connectors:onboarding.syncTitle")}),(0,Ts.jsx)("p",{className:"text-sky-300/80 text-xs",children:a("connectors:onboarding.syncDescription")})]})]}),(0,Ts.jsx)("div",{className:"flex items-center justify-center gap-4 mb-6 flex-wrap",children:n.map(e=>(0,Ts.jsxs)("div",{className:"relative ".concat(e.comingSoon?"opacity-60":""),children:[(0,Ts.jsx)(fm,{provider:e,className:"w-28 h-9"}),e.comingSoon&&(0,Ts.jsx)(gm,{className:"absolute -top-1.5 -right-1.5"})]},e.id))}),(0,Ts.jsx)("div",{className:"flex justify-center",children:(0,Ts.jsx)(Lc,{onClick:t,variant:"primary",size:"sm",Icon:au,children:a("navigation:goTo.connectors")})})]})}const ym=fc("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),bm=fc("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),xm=fc("unplug",[["path",{d:"m19 5 3-3",key:"yk6iyv"}],["path",{d:"m2 22 3-3",key:"19mgm9"}],["path",{d:"M6.3 20.3a2.4 2.4 0 0 0 3.4 0L12 18l-6-6-2.3 2.3a2.4 2.4 0 0 0 0 3.4Z",key:"goz73y"}],["path",{d:"M7.5 13.5 10 11",key:"7xgeeb"}],["path",{d:"M10.5 16.5 13 14",key:"10btkg"}],["path",{d:"m12 6 6 6 2.3-2.3a2.4 2.4 0 0 0 0-3.4l-2.6-2.6a2.4 2.4 0 0 0-3.4 0Z",key:"1snsnr"}]]),wm={[Pu]:kd,[Ru]:Sd,[Iu]:bm,[Eu]:uu},Sm={[Fu]:kd,[Du]:gd,[Lu]:uu,[qu]:wu,[Ou]:Sd};function km(t){let{connector:a,onManualSync:n,onDisconnect:r,onRetry:s,loading:i,latestSyncJob:o}=t;const{t:l}=xe("connectors"),[c,d]=(0,e.useState)(!1),u=Cu(a.provider),m=function(e,t){const a=t?{connected:t("connectors:statusLabels.connected"),verifying:t("connectors:statusLabels.verifying"),error:t("connectors:statusLabels.error"),disconnected:t("connectors:statusLabels.disconnected"),unknown:t("connectors:statusLabels.unknown")}:{connected:"Connected",verifying:"Verifying",error:"Error",disconnected:"Disconnected",unknown:"Unknown"};switch(e){case Pu:return{color:"bg-emerald-600 text-emerald-100",icon:"check-circle",label:a.connected};case Ru:return{color:"bg-yellow-600 text-yellow-100",icon:"loader",label:a.verifying};case Iu:return{color:"bg-rose-600 text-rose-100",icon:"alert-circle",label:a.error};case Eu:return{color:"bg-slate-600 text-slate-100",icon:"circle",label:a.disconnected};default:return{color:"bg-slate-600 text-slate-100",icon:"circle",label:a.unknown}}}(a.status,l),h=o?function(e,t){const a=t?{completed:t("connectors:syncStatusLabels.completed"),running:t("connectors:syncStatusLabels.running"),waiting:t("connectors:syncStatusLabels.waiting"),retrying:t("connectors:syncStatusLabels.retrying"),failed:t("connectors:syncStatusLabels.failed"),cancelled:t("connectors:syncStatusLabels.cancelled"),unknown:t("connectors:syncStatusLabels.unknown")}:{completed:"Completed",running:"Running",waiting:"Waiting",retrying:"Retrying",failed:"Failed",cancelled:"Cancelled",unknown:"Unknown"};switch(e){case Fu:return{color:"bg-emerald-600 text-emerald-100",icon:"check-circle",label:a.completed};case Du:return{color:"bg-sky-600 text-sky-100",icon:"loader",label:a.running};case Ou:return{color:"bg-yellow-600 text-yellow-100",icon:"clock",label:a.waiting};case qu:return{color:"bg-amber-600 text-amber-100",icon:"refresh-cw",label:a.retrying};case Lu:return{color:"bg-rose-600 text-rose-100",icon:"x-circle",label:a.failed};case Uu:return{color:"bg-slate-600 text-slate-100",icon:"x",label:a.cancelled};default:return{color:"bg-slate-600 text-slate-100",icon:"circle",label:a.unknown}}}(o.status,l):null,p=wm[a.status]||uu,f=o?Sm[o.status]:null;(0,e.useEffect)(()=>{d(i)},[i]);const g=e=>{if(!e)return l("connectorCard.never");return new Date(e).toLocaleString("sv-SE",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).replace(",","")},v=(null===o||void 0===o?void 0:o.status)===qu,y=a.status===Pu&&!c&&!v,b=a.status===Iu;return(0,Ts.jsxs)(Xc,{children:[(0,Ts.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,Ts.jsx)("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:(0,Ts.jsx)(fm,{provider:u})}),(0,Ts.jsx)(Bd,{icon:p,iconClassName:"w-4 h-4",label:m.label,colorClass:m.color,className:"px-3 py-1"})]}),(0,Ts.jsxs)("div",{className:"space-y-2 mb-4 text-sm",children:[a.last_verified_at&&(0,Ts.jsxs)("div",{className:"flex items-center text-slate-300",children:[(0,Ts.jsx)(kd,{className:"w-4 h-4 mr-2 text-emerald-400"}),(0,Ts.jsx)("span",{className:"text-slate-400",children:l("connectorCard.lastVerified")}),(0,Ts.jsx)("span",{className:"ml-2",children:g(a.last_verified_at)})]}),a.last_sync_at&&(0,Ts.jsxs)("div",{className:"flex items-center text-slate-300",children:[(0,Ts.jsx)(Sd,{className:"w-4 h-4 mr-2 text-sky-400"}),(0,Ts.jsx)("span",{className:"text-slate-400",children:l("connectorCard.lastSync")}),(0,Ts.jsx)("span",{className:"ml-2",children:g(a.last_sync_at)})]})]}),o&&(0,Ts.jsxs)(Xc,{variant:"dark",padding:"sm",className:"mb-4",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Ts.jsx)("span",{className:"text-slate-300 text-sm font-medium",children:l("connectorCard.connectionCreated")}),(0,Ts.jsx)(Bd,{icon:f,iconClassName:"w-3 h-3 ".concat(o.status===Du?"animate-spin":""),label:h.label,colorClass:h.color,className:"px-2 py-0.5"})]}),(0,Ts.jsxs)("div",{className:"text-slate-400 text-xs",children:[(0,Ts.jsxs)("div",{className:"flex items-center",children:[(0,Ts.jsx)(Id,{className:"w-3 h-3 mr-1"}),g(o.created_at)]}),o.error_message&&(0,Ts.jsxs)("div",{className:"mt-2 text-rose-300",children:[l("connectorCard.errorPrefix")," ",o.error_message]})]})]}),b&&a.last_error&&(0,Ts.jsxs)(Jc,{variant:"error",icon:bm,className:"mb-4",children:[(0,Ts.jsx)("p",{className:"font-medium",children:l("connectorCard.connectionError")}),(0,Ts.jsx)("p",{className:"text-xs mt-1 opacity-80",children:a.last_error})]}),(0,Ts.jsxs)("div",{className:"flex space-x-2",children:[b&&s?(0,Ts.jsx)(Lc,{onClick:s,variant:"primary",size:"sm",className:"flex-1",Icon:wu,disabled:c,children:l("connectorCard.buttons.retryConnection")}):(0,Ts.jsx)(Lc,{onClick:async()=>{d(!0);try{await n()}finally{setTimeout(()=>d(!1),1e3)}},variant:"primary",size:"sm",className:"flex-1",Icon:wu,disabled:!y,children:l(c?"connectorCard.buttons.syncing":"connectorCard.buttons.manualSync")}),(0,Ts.jsx)(Lc,{onClick:r,variant:"secondary",size:"sm",Icon:xm,disabled:c,children:l("connectorCard.buttons.disconnect")})]})]})}const Nm=fc("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);function jm(t){let{isOpen:a,onClose:r,team:s,onConnected:i}=t;const{t:o}=xe("connectors"),[l,c]=(0,e.useState)({username:"",password:""}),[d,u]=(0,e.useState)(!1),[m,h]=(0,e.useState)(!1),[p,f]=(0,e.useState)({}),[g,v]=(0,e.useState)(null);if(!a)return null;const y=(e,t)=>{c(a=>(0,n.A)((0,n.A)({},a),{},{[e]:t})),p[e]&&f(t=>(0,n.A)((0,n.A)({},t),{},{[e]:null})),g&&v(null)},b=()=>{m||(c({username:"",password:""}),f({}),v(null),u(!1),r())};return(0,Ts.jsx)(Mc,{title:o("sportAdminConnect.header.title"),subtitle:o("sportAdminConnect.header.subtitle"),icon:ud,iconColor:"sky",onClose:b,children:(0,Ts.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return l.username.trim()?l.username.length>100&&(e.username=o("sportAdminConnect.validation.usernameMaxLength")):e.username=o("sportAdminConnect.validation.usernameRequired"),l.password?l.password.length>200&&(e.password=o("sportAdminConnect.validation.passwordMaxLength")):e.password=o("sportAdminConnect.validation.passwordRequired"),f(e),0===Object.keys(e).length})()){h(!0),v(null);try{await i({username:l.username.trim(),password:l.password}),c({username:"",password:""}),f({}),u(!1)}catch(t){console.error("Error connecting SportAdmin:",t),v(t.message||o("sportAdminConnect.validation.connectionFailed"))}finally{h(!1)}}},className:"space-y-4",children:[(0,Ts.jsx)(Jc,{variant:"info",icon:Nm,className:"mb-6",children:(0,Ts.jsxs)("div",{className:"space-y-1",children:[(0,Ts.jsx)("p",{children:o("sportAdminConnect.info.description")}),(0,Ts.jsx)("p",{className:"text-xs opacity-80",children:o("sportAdminConnect.info.security")})]})}),g&&(0,Ts.jsx)(Jc,{variant:"error",className:"mb-4",children:g}),(0,Ts.jsxs)("div",{className:"mb-4",children:[(0,Ts.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-slate-300 mb-2",children:o("sportAdminConnect.form.labels.username")}),(0,Ts.jsx)(Rc,{id:"username",name:"username",type:"text",value:l.username,onChange:e=>y("username",e.target.value),placeholder:o("sportAdminConnect.form.placeholders.username"),disabled:m,autoFocus:!0}),p.username&&(0,Ts.jsx)("p",{className:"text-rose-400 text-sm mt-1",children:p.username})]}),(0,Ts.jsxs)("div",{className:"mb-6",children:[(0,Ts.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-300 mb-2",children:o("sportAdminConnect.form.labels.password")}),(0,Ts.jsxs)("div",{className:"relative",children:[(0,Ts.jsx)(Rc,{id:"password",name:"password",type:d?"text":"password",value:l.password,onChange:e=>y("password",e.target.value),placeholder:o("sportAdminConnect.form.placeholders.password"),disabled:m}),(0,Ts.jsx)("button",{type:"button",onClick:()=>u(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-300 transition-colors",disabled:m,tabIndex:-1,children:d?(0,Ts.jsx)(pd,{className:"w-4 h-4"}):(0,Ts.jsx)(hd,{className:"w-4 h-4"})})]}),p.password&&(0,Ts.jsx)("p",{className:"text-rose-400 text-sm mt-1",children:p.password})]}),(0,Ts.jsxs)("div",{className:"flex space-x-3",children:[(0,Ts.jsx)(Lc,{type:"submit",variant:"primary",className:"flex-1",disabled:m,Icon:ud,children:o(m?"sportAdminConnect.buttons.connecting":"sportAdminConnect.buttons.connect")}),(0,Ts.jsx)(Lc,{type:"button",onClick:b,variant:"secondary",className:"flex-1",disabled:m,children:o("sportAdminConnect.buttons.cancel")})]})]})})}function Tm(t){let{isOpen:a,onClose:n,connector:r,onConfirm:s}=t;const{t:i}=xe("connectors"),[o,l]=(0,e.useState)(!1),[c,d]=(0,e.useState)(null);if(!a||!r)return null;const u=Cu(r.provider),m=(null===u||void 0===u?void 0:u.name)||r.provider;return(0,Ts.jsxs)(Mc,{title:i("disconnect.title",{provider:m}),subtitle:i("disconnect.subtitle"),icon:lu,iconColor:"rose",onClose:n,children:[(0,Ts.jsx)(Jc,{variant:"error",icon:lu,className:"mb-6",children:(0,Ts.jsxs)("div",{className:"space-y-2",children:[(0,Ts.jsx)("p",{className:"font-medium",children:i("disconnect.confirmMessage",{provider:m})}),(0,Ts.jsxs)("ul",{className:"text-sm space-y-1 opacity-80",children:[(0,Ts.jsxs)("li",{children:["\u2022 ",i("disconnect.warningAutoSync")]}),(0,Ts.jsxs)("li",{children:["\u2022 ",i("disconnect.warningCredentials")]})]})]})}),(0,Ts.jsx)(Xc,{className:"mb-6",children:(0,Ts.jsxs)("ul",{className:"text-slate-200 text-sm space-y-1",children:[(0,Ts.jsxs)("li",{children:["\u2022 ",i("disconnect.reassureData")]}),(0,Ts.jsxs)("li",{children:["\u2022 ",i("disconnect.reassureReconnect")]})]})}),c&&(0,Ts.jsx)(Jc,{variant:"error",className:"mb-4",children:c}),(0,Ts.jsxs)("div",{className:"flex space-x-3",children:[(0,Ts.jsx)(Lc,{onClick:async()=>{try{l(!0),d(null),await s()}catch(e){console.error("Error disconnecting:",e),d(e.message||i("disconnect.errorFallback")),l(!1)}},variant:"danger",className:"flex-1 bg-rose-600 hover:bg-rose-700 text-white",Icon:xm,disabled:o,children:i(o?"disconnect.disconnecting":"disconnect.disconnect")}),(0,Ts.jsx)(Lc,{onClick:n,variant:"secondary",className:"flex-1",disabled:o,children:i("disconnect.cancel")})]})]})}function Am(t){const{t:a}=xe("common"),[n,r]=(0,e.useState)([]),[s,i]=(0,e.useState)(!1),[o,l]=(0,e.useState)(null),[c,d]=(0,e.useState)(null),u=(0,e.useCallback)(async()=>{if(t)try{i(!0),l(null);const e=await Bu(t);r(e)}catch(e){console.error("Error loading connectors:",e),l(e.message||a("errors.failedToLoadConnectors"))}finally{i(!1)}else r([])},[t,a]);(0,e.useEffect)(()=>{u()},[u]);const m=(0,e.useCallback)(async(e,n)=>{if(!t)throw new Error("Team ID is required");try{i(!0),l(null),await async function(e,t,a){if(!e||!t||null===a||void 0===a||!a.username||null===a||void 0===a||!a.password)throw new Error("Team ID, provider, username, and password are required");if(a.username.length>100)throw new Error("Username must be 100 characters or less");if(a.password.length>200)throw new Error("Password must be 200 characters or less");try{const{data:n,error:r}=await Ur.functions.invoke("connect-provider",{body:{team_id:e,provider:t,username:a.username,password:a.password}});if(r)throw console.error("Error connecting provider:",r),new Error(r.message||"Failed to connect provider");if(!n||n.error)throw new Error((null===n||void 0===n?void 0:n.error)||"Failed to connect provider");return n}catch(n){const e=n.message||"";if(e.includes("FunctionsRelayError")||e.includes("not found")||e.includes("Failed to send a request")||e.includes("CORS")||"FunctionsFetchError"===n.name)throw new Error("The connector service is not yet deployed. This feature will be available once the backend Edge Function is set up.");throw n}}(t,e,n),await u()}catch(r){throw console.error("Error connecting provider:",r),l(r.message||a("errors.failedToConnectProvider")),r}finally{i(!1)}},[t,u,a]),h=(0,e.useCallback)(async e=>{try{i(!0),l(null),await async function(e){if(!e)throw new Error("Connector ID is required");const{error:t}=await Ur.from("connector").delete().eq("id",e);if(t)throw console.error("Error disconnecting provider:",t),new Error("Failed to disconnect provider")}(e),await u()}catch(t){throw console.error("Error disconnecting provider:",t),l(t.message||a("errors.failedToDisconnectProvider")),t}finally{i(!1)}},[u,a]),p=(0,e.useCallback)(async e=>{try{d(e),l(null),await Gu(e),await u()}catch(t){throw console.error("Error triggering manual sync:",t),l(t.message||a("errors.failedToTriggerSync")),t}finally{d(null)}},[u,a]),f=(0,e.useCallback)(async e=>{try{i(!0),l(null),await async function(e){if(!e)throw new Error("Connector ID is required");const{error:t}=await Ur.from("connector").update({status:"verifying",last_error:null}).eq("id",e);if(t)throw console.error("Error retrying connector:",t),new Error("Failed to retry connector");try{await Gu(e)}catch(a){console.error("Error triggering manual sync during retry:",a);const{error:t}=await Ur.from("connector").update({status:"error",last_error:"Failed to queue verification job. Please try again."}).eq("id",e);throw t&&console.error("Error reverting connector status after sync failure:",t),new Error("Failed to queue verification job")}}(e),await u()}catch(t){throw console.error("Error retrying connector:",t),l(t.message||a("errors.failedToRetryConnector")),t}finally{i(!1)}},[u,a]),g=(0,e.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{return await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)throw new Error("Connector ID is required");const a=t||(new Date).getFullYear(),{data:n,error:r}=await Ur.from("player_attendance").select("\n      *,\n      connected_player:connected_player_id (\n        connector_id,\n        player_id,\n        player_name\n      )\n    ").eq("connected_player.connector_id",e).eq("year",a).order("connected_player.player_name",{ascending:!0}).order("month",{ascending:!0}).order("day_of_month",{ascending:!0});if(r)throw console.error("Error fetching player attendance:",r),new Error("Failed to load player attendance");return n||[]}(e,t)}catch(a){throw console.error("Error fetching attendance data:",a),a}},[]),v=(0,e.useCallback)(async e=>{try{return await async function(e){if(!e)throw new Error("Connector ID is required");const t=(new Date).toISOString().split("T")[0],{data:a,error:n}=await Ur.from("upcoming_match").select("*").eq("connector_id",e).gte("match_date",t).order("match_date",{ascending:!0});if(n)throw console.error("Error fetching upcoming matches:",n),new Error("Failed to load upcoming matches");return a||[]}(e)}catch(t){throw console.error("Error fetching upcoming matches:",t),t}},[]),y=(0,e.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;try{return await zu(e,t)}catch(a){throw console.error("Error fetching sync jobs:",a),a}},[]),b=(0,e.useCallback)(async e=>{try{return await async function(e){const t=await zu(e,1);return(null===t||void 0===t?void 0:t[0])||null}(e)}catch(t){throw console.error("Error fetching latest sync job:",t),t}},[]),x=(0,e.useCallback)(async e=>{if(!t)return null;try{return await async function(e,t){if(!e||!t)throw new Error("Team ID and provider are required");const{data:a,error:n}=await Ur.rpc("get_connector",{p_team_id:e,p_provider:t});if(n)throw console.error("Error fetching connector status:",n),new Error("Failed to load connector status");return(null===a||void 0===a?void 0:a[0])||null}(t,e)}catch(a){throw console.error("Error fetching connector status:",a),a}},[t]),w=(0,e.useCallback)(()=>{l(null)},[]);return{connectors:n,loading:s,error:o,syncingConnectorId:c,loadConnectors:u,connectProvider:m,disconnectProvider:h,manualSync:p,retryConnector:f,getAttendanceData:g,getUpcomingMatches:v,getRecentSyncJobs:y,getLatestSyncJob:b,getConnectorStatus:x,clearError:w}}function _m(t){let{team:a}=t;const{t:n}=xe("connectors"),{isTeamAdmin:r}=vi(),{connectors:s,loading:i,error:o,syncingConnectorId:l,connectProvider:c,disconnectProvider:d,manualSync:u,retryConnector:m,getLatestSyncJob:h,clearError:p}=Am(null===a||void 0===a?void 0:a.id),[f,g]=(0,e.useState)(!1),[v,y]=(0,e.useState)(!1),[b,x]=(0,e.useState)(null),[w,S]=(0,e.useState)(""),[k,N]=(0,e.useState)(!1),[j,T]=(0,e.useState)(""),[A,_]=(0,e.useState)({}),C=(0,e.useRef)(null);if((0,e.useEffect)(()=>{let e=!0;const t=async()=>{if(0===s.length)return void(e&&_({}));const t={};for(const e of s)try{const a=await h(e.id);a&&(t[e.id]=a)}catch(a){console.error("Error loading sync job for connector:",e.id,a)}e&&_(t)};return C.current&&(clearInterval(C.current),C.current=null),s.length>0?(t(),C.current=setInterval(t,3e4)):_({}),()=>{e=!1,C.current&&(clearInterval(C.current),C.current=null)}},[s,h]),(0,e.useEffect)(()=>{if(w){const e=setTimeout(()=>{S(""),N(!1)},k?1e4:5e3);return()=>clearTimeout(e)}},[w,k]),(0,e.useEffect)(()=>{if(j){const e=setTimeout(()=>{T("")},5e3);return()=>clearTimeout(e)}},[j]),!r)return null;const M=Mu(),P=s.map(e=>e.provider),E=e=>{(async function(e){if(!e)throw new Error("Team ID is required");try{const{data:t,error:a}=await Ur.functions.invoke("trigger-scraper-workflow",{body:{team_id:e}});return a?(console.error("Failed to trigger scraper workflow:",a),{success:!1,message:a.message||"Failed to trigger workflow"}):!t||t.error?(console.error("Scraper workflow trigger returned error:",null===t||void 0===t?void 0:t.error),{success:!1,message:(null===t||void 0===t?void 0:t.error)||"Failed to trigger workflow"}):t}catch(o){return console.error("Error triggering scraper workflow:",o),{success:!1,message:"Failed to trigger workflow"}}})(a.id).then(t=>{t.success?console.log(e):(console.warn("Failed to trigger scraper workflow, will run on schedule:",t.message),T(n("connectorsSection.immediateSyncFailed")))}).catch(e=>{console.warn("Error triggering scraper workflow:",e),T(n("connectorsSection.immediateSyncFailed"))})};return(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsx)("div",{className:"flex items-center justify-between",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ts.jsx)(ud,{className:"w-5 h-5 text-sky-400"}),(0,Ts.jsx)("h4",{className:"text-md font-medium text-slate-300",children:n("connectorsSection.title")})]})}),(0,Ts.jsx)(Jc,{variant:"info",icon:ym,children:n("connectorsSection.infoBanner")}),w&&(0,Ts.jsx)(Jc,{variant:"success",children:w}),j&&(0,Ts.jsx)(Jc,{variant:"warning",children:j}),o&&(0,Ts.jsx)(Jc,{variant:"error",children:(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("span",{children:o}),(0,Ts.jsx)("button",{onClick:p,className:"text-rose-300 hover:text-rose-100 text-xs underline ml-2",children:n("connectorsSection.dismiss")})]})}),i&&0===s.length&&(0,Ts.jsx)("div",{className:"py-8",children:(0,Ts.jsx)(Wd,{size:"md",message:n("connectorsSection.loadingConnectors")})}),s.length>0&&(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsx)("h5",{className:"text-sm font-medium text-slate-400",children:n("connectorsSection.connectedProviders")}),s.map(e=>(0,Ts.jsx)(km,{connector:e,onManualSync:()=>(async e=>{try{await u(e),S(n("connectorsSection.syncStarted")),E("Scraper workflow triggered for manual sync")}catch(t){console.error("Manual sync error:",t)}})(e.id),onDisconnect:()=>(e=>{x(e),y(!0)})(e),onRetry:()=>(async e=>{try{await m(e),S(n("connectorsSection.retryingConnection"))}catch(t){console.error("Retry error:",t)}})(e.id),loading:l===e.id,latestSyncJob:A[e.id]},e.id))]}),(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsx)("h5",{className:"text-sm font-medium text-slate-400",children:n("connectorsSection.availableProviders")}),(0,Ts.jsx)("div",{className:"grid grid-cols-1 gap-4",children:M.map(e=>{const t=P.includes(e.id),a=e.comingSoon;return(0,Ts.jsx)(Xc,{padding:"sm",className:"".concat(a?"opacity-60":t?"!border-emerald-600":""),children:(0,Ts.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,Ts.jsx)("div",{className:"flex items-center space-x-3 min-w-0",children:(0,Ts.jsx)(fm,{provider:e})}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[t&&(0,Ts.jsx)("span",{className:"px-2 py-1 bg-emerald-600 text-emerald-100 rounded text-xs font-medium",children:n("connectorsSection.connected")}),a&&(0,Ts.jsx)(gm,{className:"shrink-0"}),!t&&!a&&(0,Ts.jsx)(Lc,{onClick:()=>{e.id===_u.SPORTADMIN.id&&g(!0)},variant:"primary",size:"sm",className:"shrink-0",Icon:Xd,children:n("connectorsSection.connect")})]})]})},e.id)})})]}),(0,Ts.jsx)(jm,{isOpen:f,onClose:()=>g(!1),team:a,onConnected:async e=>{try{await c(_u.SPORTADMIN.id,e),g(!1),S(n("connectorsSection.connectedSuccess")),N(!0),E("Scraper workflow triggered for verification")}catch(t){throw t}}}),(0,Ts.jsx)(Tm,{isOpen:v,onClose:()=>{y(!1),x(null)},connector:b,onConfirm:async()=>{try{await d(b.id),y(!1),x(null),S(n("connectorsSection.disconnectedSuccess"))}catch(e){throw e}}})]})}const Cm={OVERVIEW:"overview",ROSTER:"roster",LOANS:"loans",ACCESS:"access",CONNECTORS:"connectors",PREFERENCES:"preferences"};function Mm(t){var a;let{onNavigateBack:n,openToTab:r,openAddRosterPlayerModal:s,onShowSuccessMessage:i}=t;const{t:o}=xe("team"),{user:l}=Cs(),{hasTeams:c,hasClubs:d,currentTeam:u,isTeamAdmin:m,canManageTeam:h,pendingRequestsCount:p,loading:f,getTeamAccessRequests:g,getTeamMembers:v}=vi(),{pushNavigationState:y,removeFromNavigationStack:b}=Xl(),x=(0,e.useMemo)(()=>Bs(Br.TEAM_MANAGEMENT_ACTIVE_TAB,{tab:Cm.OVERVIEW}),[]),w=(0,e.useRef)(!0),[S,k]=(0,e.useState)(()=>{if(r&&Object.values(Cm).includes(r))return r;const e=x.loadState();return e.tab&&Object.values(Cm).includes(e.tab)?e.tab:Cm.OVERVIEW}),[N,j]=(0,e.useState)(!1),[T,A]=(0,e.useState)(!1),[_,C]=(0,e.useState)(!1),[M,P]=(0,e.useState)(!1),[E,I]=(0,e.useState)([]),[R,O]=(0,e.useState)([]),[D,F]=(0,e.useState)(""),L=e.useMemo(()=>[{id:Cm.OVERVIEW,label:o("teamManagement.tabs.overview.label"),icon:od,description:o("teamManagement.tabs.overview.description")},h?{id:Cm.ROSTER,label:o("teamManagement.tabs.roster.label"),icon:ld,description:o("teamManagement.tabs.roster.description")}:null,h?{id:Cm.LOANS,label:o("teamManagement.tabs.loans.label"),icon:cd,description:o("teamManagement.tabs.loans.description")}:null,m?{id:Cm.ACCESS,label:o("teamManagement.tabs.access.label"),icon:dd,description:o("teamManagement.tabs.access.description"),badge:p>0?p:null}:null,m?{id:Cm.CONNECTORS,label:o("teamManagement.tabs.connectors.label"),icon:ud,description:o("teamManagement.tabs.connectors.description")}:null,h?{id:Cm.PREFERENCES,label:o("teamManagement.tabs.preferences.label"),icon:yc,description:o("teamManagement.tabs.preferences.description")}:null].filter(Boolean),[m,h,p,o]);(0,e.useEffect)(()=>{if(w.current)w.current=!1;else if(L.length>0){if(!L.some(e=>e.id===S)){const e=L[0].id;k(e)}}},[S,L]),(0,e.useEffect)(()=>{x.saveState({tab:S})},[S,x]);const q=(0,e.useCallback)(async()=>{if(!u)return;if(m){const e=await g(u.id);I(e)}const e=await v(u.id);O(e)},[u,m,g,v]);(0,e.useEffect)(()=>{q()},[q]),(0,e.useEffect)(()=>{if(D){const e=setTimeout(()=>{F("")},3e3);return()=>clearTimeout(e)}},[D]);const U=()=>{j(!0)},B=()=>{j(!1),F(o("teamManagement.success.teamCreated")),q()},G=()=>{j(!1)},z=()=>{P(!0),y(()=>{P(!1)})};if(f)return(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("h1",{className:"text-2xl font-bold text-sky-300",children:o("teamManagement.header.title")}),(0,Ts.jsx)(Lc,{onClick:n,variant:"secondary",size:"sm",children:o("teamManagement.header.back")})]}),(0,Ts.jsx)("div",{className:"p-2 bg-slate-700 rounded-lg border border-slate-600",children:(0,Ts.jsx)(Wd,{size:"sm",message:o("teamManagement.loading.teamInfo")})})]});if(!l)return null;if(N||!d||d&&!c)return(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("h1",{className:"text-2xl font-bold text-sky-300",children:o("teamManagement.header.teamSetup")}),(0,Ts.jsx)(Lc,{onClick:n,variant:"secondary",size:"sm",children:o("teamManagement.header.back")})]}),(0,Ts.jsx)(bu,{onComplete:B,onCancel:G})]});if(!u)return(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("h1",{className:"text-2xl font-bold text-sky-300",children:o("teamManagement.header.title")}),(0,Ts.jsx)(Lc,{onClick:n,variant:"secondary",size:"sm",children:o("teamManagement.header.back")})]}),(0,Ts.jsx)(tu,{onCreateNew:U})]});return(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("h1",{className:"text-2xl font-bold text-sky-300",children:o("teamManagement.header.title")}),(0,Ts.jsx)(Lc,{onClick:n,variant:"secondary",size:"sm",children:o("teamManagement.header.back")})]}),D&&(0,Ts.jsx)(Jc,{variant:"success",children:D}),(0,Ts.jsxs)("div",{className:"bg-slate-700 rounded-lg border border-slate-600 overflow-hidden",children:[(0,Ts.jsx)("div",{className:"bg-gradient-to-r from-sky-600 to-sky-700 px-6 py-4",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Ts.jsx)("div",{className:"w-12 h-12 bg-sky-800 rounded-full flex items-center justify-center border-2 border-sky-400",children:(0,Ts.jsx)(od,{className:"w-6 h-6 text-sky-100"})}),(0,Ts.jsxs)("div",{className:"flex-1",children:[(0,Ts.jsx)("h2",{className:"text-xl font-bold text-white",children:u.name}),(0,Ts.jsx)("p",{className:"text-sky-200 opacity-90",children:(null===(a=u.club)||void 0===a?void 0:a.long_name)||o("teamManagement.teamHeader.noClub")})]}),(0,Ts.jsxs)("div",{className:"text-right",children:[(0,Ts.jsx)("div",{className:"text-sky-200 text-sm",children:o(m?"teamManagement.teamHeader.roleAdmin":h?"teamManagement.teamHeader.roleCoach":"teamManagement.teamHeader.roleUser")}),(0,Ts.jsxs)("div",{className:"text-sky-300 text-xs",children:[R.length," ",1!==R.length?o("teamManagement.teamHeader.usersPlural"):o("teamManagement.teamHeader.users")]})]})]})}),(0,Ts.jsx)("div",{className:"border-b border-slate-600",children:(0,Ts.jsx)($d,{tabs:L,activeTab:S,onTabChange:k,variant:"scroll"})}),(0,Ts.jsx)("div",{className:"p-2",children:(()=>{switch(S){case Cm.OVERVIEW:return(0,Ts.jsx)(Pm,{team:u,members:R});case Cm.ACCESS:return(0,Ts.jsx)(Em,{team:u,pendingRequests:E,onRefresh:q,onShowModal:()=>A(!0),onShowInviteModal:()=>C(!0),onShowRoleModal:z});case Cm.ROSTER:return(0,Ts.jsx)(Im,{team:u,onRefresh:q,onNavigateToConnectors:()=>k("connectors"),activeTab:S,openAddPlayerModal:s});case Cm.LOANS:return(0,Ts.jsx)(hm,{currentTeam:u,canManageTeam:h});case Cm.CONNECTORS:return(0,Ts.jsx)(Rm,{team:u,onRefresh:q});case Cm.PREFERENCES:return(0,Ts.jsx)(Om,{team:u,onRefresh:q,onShowFloatingSuccess:i});default:return(0,Ts.jsx)(Pm,{team:u,members:R})}})()})]}),T&&(0,Ts.jsx)(mu,{team:u,onClose:()=>A(!1),onSuccess:()=>{A(!1),F(o("teamManagement.success.accessProcessed")),q()},isStandaloneMode:!0}),_&&(0,Ts.jsx)(Su,{isOpen:_,onClose:()=>C(!1),team:u}),M&&(0,Ts.jsx)(Nu,{isOpen:M,onClose:()=>{P(!1),b()},team:u,members:R,onRefresh:async()=>{await q()},currentUserRole:(null===u||void 0===u?void 0:u.userRole)||"member"})]})}function Pm(e){var t;let{team:a,members:n}=e;const{t:r}=xe("team");return(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("h3",{className:"text-lg font-semibold text-slate-200 mb-4",children:r("teamManagement.overview.title")}),(0,Ts.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:r("teamManagement.overview.teamName")}),(0,Ts.jsx)("span",{className:"text-slate-100 text-sm font-medium",children:a.name})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:r("teamManagement.overview.club")}),(0,Ts.jsx)("div",{className:"space-y-1",children:(null===(t=a.club)||void 0===t?void 0:t.long_name)&&(0,Ts.jsx)("div",{className:"text-slate-100 text-sm",children:(0,Ts.jsx)("span",{className:"font-medium",children:a.club.long_name})})})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:r("teamManagement.overview.teamCreated")}),(0,Ts.jsx)("span",{className:"text-slate-100 text-sm font-medium",children:a.created_at?new Date(a.created_at).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}):r("teamManagement.overview.unknown")})]})]})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("h3",{className:"text-lg font-semibold text-slate-200 mb-4",children:r("teamManagement.overview.teamUsers")}),(0,Ts.jsxs)("div",{className:"space-y-2",children:[n.sort((e,t)=>{var a,n,s,i,o,l;const c=(null===(a=e.user)||void 0===a?void 0:a.name)||(null===(n=e.user)||void 0===n||null===(s=n.email)||void 0===s?void 0:s.split("@")[0])||r("teamManagement.overview.unknownUser"),d=(null===(i=t.user)||void 0===i?void 0:i.name)||(null===(o=t.user)||void 0===o||null===(l=o.email)||void 0===l?void 0:l.split("@")[0])||r("teamManagement.overview.unknownUser");return c.localeCompare(d)}).map(e=>{var t,a,n,s;return(0,Ts.jsxs)("div",{className:"flex items-center justify-between py-2 px-3 bg-slate-800 rounded-lg",children:[(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("span",{className:"text-slate-100 font-medium",children:(null===(t=e.user)||void 0===t?void 0:t.name)||(null===(a=e.user)||void 0===a||null===(n=a.email)||void 0===n?void 0:n.split("@")[0])||r("teamManagement.overview.unknownUser")}),(null===(s=e.user)||void 0===s?void 0:s.email)&&(0,Ts.jsxs)("span",{className:"text-slate-400 text-sm ml-2",children:["(",e.user.email,")"]})]}),(0,Ts.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat("admin"===e.role?"bg-emerald-600 text-emerald-100":"coach"===e.role?"bg-sky-600 text-sky-100":"player"===e.role?"bg-purple-600 text-purple-100":"parent"===e.role?"bg-orange-600 text-orange-100":"bg-slate-600 text-slate-100"),children:r("roleManagement.roles.".concat(e.role),{defaultValue:e.role})})]},e.id)}),0===n.length&&(0,Ts.jsx)(Yd,{title:r("teamManagement.overview.noUsers")})]})]})]})}function Em(e){let{team:t,pendingRequests:a,onRefresh:n,onShowModal:r,onShowInviteModal:s,onShowRoleModal:i}=e;const{t:o}=xe("team");return(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("h3",{className:"text-lg font-semibold text-slate-200",children:o("teamManagement.access.title")}),(0,Ts.jsx)(Lc,{onClick:r,variant:"primary",size:"sm",children:o("teamManagement.access.manageAccess")})]}),(0,Ts.jsxs)(Xc,{variant:"dark",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,Ts.jsx)(dd,{className:"w-5 h-5 text-sky-400"}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("p",{className:"text-slate-200 font-medium",children:1!==a.length?o("teamManagement.access.pendingRequestsPlural",{count:a.length}):o("teamManagement.access.pendingRequests",{count:a.length})}),(0,Ts.jsx)("p",{className:"text-slate-400 text-sm",children:a.length>0?o("teamManagement.access.reviewDescription"):o("teamManagement.access.noPendingDescription")})]})]}),a.length>0&&(0,Ts.jsx)(Lc,{onClick:r,variant:"primary",size:"sm",Icon:dd,children:o("teamManagement.access.reviewRequests")})]}),(0,Ts.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Ts.jsxs)(Xc,{variant:"dark",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,Ts.jsx)(bc,{className:"w-5 h-5 text-sky-400"}),(0,Ts.jsx)("h4",{className:"text-slate-200 font-medium",children:o("teamManagement.access.inviteUsers")})]}),(0,Ts.jsx)("p",{className:"text-slate-400 text-sm mb-3",children:o("teamManagement.access.inviteDescription")}),(0,Ts.jsx)(Lc,{variant:"primary",size:"sm",onClick:s,Icon:bc,children:o("teamManagement.access.invitations")})]}),(0,Ts.jsxs)(Xc,{variant:"dark",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,Ts.jsx)(md,{className:"w-5 h-5 text-sky-400"}),(0,Ts.jsx)("h4",{className:"text-slate-200 font-medium",children:o("teamManagement.access.memberRoles")})]}),(0,Ts.jsx)("p",{className:"text-slate-400 text-sm mb-3",children:o("teamManagement.access.rolesDescription")}),(0,Ts.jsx)(Lc,{variant:"primary",size:"sm",onClick:i,Icon:md,children:o("teamManagement.access.manageRoles")})]})]})]})}function Im(t){let{team:a,onRefresh:r,onNavigateToConnectors:s,activeTab:i,openAddPlayerModal:o}=t;const{t:l}=xe("team"),{getTeamRoster:c,addRosterPlayer:d,updateRosterPlayer:u,removeRosterPlayer:m,refreshTeamPlayers:h,checkPlayerGameHistory:p,getAvailableJerseyNumbers:f}=vi(),[g,v]=(0,e.useState)([]),[y,b]=(0,e.useState)(!1),[x,w]=(0,e.useState)(null),[S,k]=(0,e.useState)(""),[N,j]=(0,e.useState)(!1),[T,A]=(0,e.useState)(!1),[_,C]=(0,e.useState)(null),[M,P]=(0,e.useState)(null),[E,I]=(0,e.useState)(!1),[R,O]=(0,e.useState)(null),[D,F]=(0,e.useState)(null),[L,q]=(0,e.useState)(!1),[U,B]=(0,e.useState)({matchedConnections:new Map,unmatchedExternalPlayers:[],hasConnectedProvider:!1}),[G,z]=(0,e.useState)(null),[V,H]=(0,e.useState)(null),K=(0,e.useRef)(!1),W=(0,e.useCallback)(async()=>{if(null!==a&&void 0!==a&&a.id)try{b(!0),w(null);const e=await c(a.id);v(e||[])}catch(e){console.error("Error loading roster:",e),w(e.message||l("teamManagement.roster.error.loadFailed"))}finally{b(!1)}},[null===a||void 0===a?void 0:a.id,c,l]),Y=(0,e.useCallback)(async()=>{if(null!==a&&void 0!==a&&a.id)try{const e=await Vu(a.id,N);B(e)}catch(e){console.error("Error loading player connections:",e)}},[null===a||void 0===a?void 0:a.id,N]);(0,e.useEffect)(()=>{W()},[W]),(0,e.useEffect)(()=>{Y()},[Y]),(0,e.useEffect)(()=>{i===Cm.ROSTER&&Y()},[i,Y]),(0,e.useEffect)(()=>{o&&!K.current&&i===Cm.ROSTER&&(A(!0),K.current=!0)},[o,i]),(0,e.useEffect)(()=>{if(S){const e=setTimeout(()=>{k("")},5e3);return()=>clearTimeout(e)}},[S]);const J=(0,e.useMemo)(()=>{const e=g.filter(e=>e.on_roster||N).sort((e,t)=>{const a=e.display_name||"",n=t.display_name||"";return a.localeCompare(n)});if(!U.hasConnectedProvider)return e;const t=(U.unmatchedExternalPlayers||[]).filter(e=>"connected"===e.connectorStatus).map(e=>({id:"ghost-".concat(e.externalPlayerId),isGhost:!0,externalPlayerId:e.externalPlayerId,display_name:e.playerNameInProvider,playerNameInProvider:e.playerNameInProvider,providerName:e.providerName,connectorId:e.connectorId})).sort((e,t)=>e.display_name.localeCompare(t.display_name));return[...e,...t]},[g,N,U]),Q=Qi(g,U.hasConnectedProvider),$=async e=>{try{H(e.externalPlayerId),w(null),await async function(e){if(!e)throw new Error("External player ID is required");const{data:{user:t},error:a}=await Ur.auth.getUser();a&&console.error("Error getting current user:",a);let n=null;if(t){const{data:e}=await Ur.from("user_profile").select("id").eq("id",t.id).single();n=(null===e||void 0===e?void 0:e.id)||null}const{data:r,error:s}=await Ur.from("connected_player").update({is_dismissed:!0,dismissed_at:(new Date).toISOString(),dismissed_by:n}).eq("id",e).is("player_id",null).select();if(s)throw console.error("Error dismissing ghost player:",s),new Error("Failed to dismiss player");if(!r||0===r.length)throw new Error("Player has already been matched or dismissed");return r[0]}(e.externalPlayerId),await W(),await Y(),k(l("teamManagement.roster.success.ghostDismissed",{playerName:e.playerNameInProvider}))}catch(x){console.error("Error dismissing ghost player:",x),w(x.message||l("teamManagement.roster.error.dismissFailed"))}finally{H(null)}},X=()=>{A(!0)};return y&&0===g.length?(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsx)("div",{className:"flex items-center justify-between",children:(0,Ts.jsx)("h3",{className:"text-lg font-semibold text-slate-200",children:l("teamManagement.roster.title")})}),(0,Ts.jsx)(Wd,{size:"sm",message:l("teamManagement.roster.loadingRoster"),className:"py-8"})]}):(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ts.jsx)("h3",{className:"text-lg font-semibold text-slate-200",children:l("teamManagement.roster.title")}),(0,Ts.jsxs)("span",{className:"text-sm text-slate-400",children:["\u2022 ",l("teamManagement.roster.playersCount",{count:g.filter(e=>e.on_roster).length})]})]}),(0,Ts.jsx)(Lc,{onClick:X,variant:"primary",size:"sm",Icon:bc,children:l("teamManagement.roster.addPlayer")})]}),x&&(0,Ts.jsx)(Jc,{variant:"error",children:x}),S&&(0,Ts.jsx)(Jc,{variant:"success",children:S}),g.filter(e=>!e.on_roster).length>0&&(0,Ts.jsx)("div",{className:"flex items-center justify-end",children:(0,Ts.jsxs)("button",{onClick:()=>j(!N),className:"flex items-center space-x-2 px-3 py-2 text-sm text-slate-300 hover:text-slate-100 transition-colors",children:[N?(0,Ts.jsx)(hd,{className:"w-4 h-4"}):(0,Ts.jsx)(pd,{className:"w-4 h-4"}),(0,Ts.jsx)("span",{children:l(N?"teamManagement.roster.hideFormer":"teamManagement.roster.showFormer")})]})}),(0,Ts.jsx)("div",{className:"bg-slate-800 rounded-lg border border-slate-600 overflow-hidden",children:0===J.length?(0,Ts.jsx)("div",{className:"text-center py-8 text-slate-400",children:0===g.length?(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)(od,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),(0,Ts.jsx)("p",{className:"text-lg font-medium mb-2",children:l("teamManagement.roster.noPlayersYet")}),(0,Ts.jsx)("p",{className:"text-sm mb-4",children:l("teamManagement.roster.buildRoster")}),(0,Ts.jsx)("div",{className:"flex justify-center",children:(0,Ts.jsx)(Lc,{onClick:X,variant:"primary",size:"sm",Icon:bc,children:l("teamManagement.roster.addFirstPlayer")})}),Q&&(0,Ts.jsx)("div",{className:"mt-4 px-4",children:(0,Ts.jsx)(vm,{onNavigateToConnectors:s})})]}):(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)(od,{className:"w-8 h-8 mx-auto mb-2 text-sky-200 opacity-50"}),(0,Ts.jsx)("p",{className:"text-sm text-sky-200",children:l("teamManagement.roster.noActivePlayers")}),Q&&(0,Ts.jsx)("div",{className:"mt-4 px-4",children:(0,Ts.jsx)(vm,{onNavigateToConnectors:s})})]})}):(0,Ts.jsx)("div",{className:"overflow-x-auto",children:(0,Ts.jsxs)("table",{className:"w-full",children:[(0,Ts.jsx)("thead",{className:"bg-slate-700",children:(0,Ts.jsxs)("tr",{children:[(0,Ts.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider",children:l("teamManagement.roster.table.player")}),(0,Ts.jsx)("th",{className:"px-2 py-3 text-center text-xs font-medium text-slate-300",title:l("teamManagement.roster.table.connectionStatus"),children:(0,Ts.jsx)(ud,{className:"w-4 h-4 inline-block"})}),(0,Ts.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-slate-300 uppercase tracking-wider",children:l("teamManagement.roster.table.number")}),(0,Ts.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-slate-300 uppercase tracking-wider",children:l("teamManagement.roster.table.actions")})]})}),(0,Ts.jsx)("tbody",{className:"divide-y divide-slate-600",children:J.map(e=>{if(e.isGhost)return(0,Ts.jsxs)("tr",{className:"bg-slate-800/30 border-l-2 border-slate-600",children:[(0,Ts.jsx)("td",{className:"px-4 py-3",children:(0,Ts.jsxs)("div",{className:"flex items-center",children:[(0,Ts.jsx)(Fd,{size:"md",color:"slate",className:"mr-3",children:(0,Ts.jsx)(fd,{className:"w-4 h-4 text-slate-400"})}),(0,Ts.jsxs)("div",{className:"flex flex-col",children:[(0,Ts.jsx)("span",{className:"font-medium text-slate-400 italic",children:e.display_name}),(0,Ts.jsx)("span",{className:"text-xs text-slate-500",children:l("teamManagement.roster.ghost.from",{provider:e.providerName})})]})]})}),(0,Ts.jsx)("td",{className:"px-2 py-3 text-center"}),(0,Ts.jsx)("td",{className:"px-4 py-3",children:(0,Ts.jsx)("span",{className:"text-slate-500 text-sm",children:"-"})}),(0,Ts.jsx)("td",{className:"px-4 py-3 text-right",children:(0,Ts.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[(0,Ts.jsx)("button",{onClick:()=>(async e=>{let t=!1;try{z(e.externalPlayerId),w(null),await Hu(e.externalPlayerId,a.id,d),await W(),await Y(),k(l("teamManagement.roster.success.ghostAdded",{playerName:e.playerNameInProvider}))}catch(x){console.error("Error accepting ghost player:",x),w(x.message||l("teamManagement.roster.error.addFailed")),t=!0}finally{if(z(null),t)try{await h(a.id)}catch(n){console.error("Error refreshing team players after ghost accept failure:",n)}}})(e),disabled:G===e.externalPlayerId||V===e.externalPlayerId,className:"px-3 py-1.5 bg-sky-600 hover:bg-sky-500 disabled:bg-slate-600 disabled:cursor-not-allowed text-white rounded text-sm font-medium transition-colors flex items-center space-x-1",children:G===e.externalPlayerId?(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)(gd,{className:"w-4 h-4 animate-spin"}),(0,Ts.jsx)("span",{children:l("teamManagement.roster.ghost.adding")})]}):(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)(bc,{className:"w-4 h-4"}),(0,Ts.jsx)("span",{children:l("teamManagement.roster.ghost.accept")})]})}),(0,Ts.jsx)("button",{onClick:()=>$(e),disabled:G===e.externalPlayerId||V===e.externalPlayerId,className:"px-3 py-1.5 bg-slate-600 hover:bg-slate-500 disabled:bg-slate-700 disabled:cursor-not-allowed text-white rounded text-sm font-medium transition-colors flex items-center space-x-1",children:V===e.externalPlayerId?(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)(gd,{className:"w-4 h-4 animate-spin"}),(0,Ts.jsx)("span",{children:l("teamManagement.roster.ghost.dismissing")})]}):(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)(Tc,{className:"w-4 h-4"}),(0,Ts.jsx)("span",{children:l("teamManagement.roster.ghost.dismiss")})]})})]})})]},e.id);const t=e.last_name?"".concat(e.first_name," ").concat(e.last_name):e.first_name;return(0,Ts.jsxs)("tr",{className:"hover:bg-slate-700 transition-colors ".concat(e.on_roster?"":"opacity-60"),children:[(0,Ts.jsx)("td",{className:"px-4 py-3",children:(0,Ts.jsxs)("div",{className:"flex items-center",children:[(0,Ts.jsx)(Fd,{size:"md",color:e.on_roster?"sky":"slate",className:"mr-3",children:e.display_name.charAt(0).toUpperCase()}),(0,Ts.jsxs)("span",{className:"font-medium ".concat(e.on_roster?"text-slate-100":"text-slate-100 italic"),children:[t,!e.on_roster&&(0,Ts.jsxs)("span",{className:"text-slate-400 ml-2",children:["(",l("teamManagement.roster.player.former"),")"]})]})]})}),(0,Ts.jsx)("td",{className:"px-2 py-3 text-center",children:(()=>{const t=U.matchedConnections.get(e.id),a=t&&t.length>0,n=U.hasConnectedProvider&&!a;if(!a&&!n)return null;const r=a?ud:vd,s=a?"text-emerald-400 hover:text-emerald-300":"text-amber-400 hover:text-amber-300",i=(0,Ts.jsx)("div",{className:"text-xs space-y-2",children:a?(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)("div",{className:"font-semibold text-slate-100",children:l("teamManagement.roster.connection.connectedProviders")}),t.map((e,t)=>(0,Ts.jsxs)("div",{className:"space-y-1",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(ud,{className:"w-3 h-3 text-emerald-400"}),(0,Ts.jsx)("span",{className:"text-slate-200",children:e.providerName})]}),(0,Ts.jsxs)("div",{className:"pl-5 text-slate-300",children:[l("teamManagement.roster.connection.matchedAs")," ",(0,Ts.jsx)("span",{className:"font-medium",children:e.playerNameInProvider})]})]},t))]}):(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)("div",{className:"font-semibold text-amber-200",children:l("teamManagement.roster.connection.needsMatching")}),(0,Ts.jsx)("div",{className:"text-slate-300",children:l("teamManagement.roster.connection.notMatched")}),U.unmatchedExternalPlayers.length>0&&(0,Ts.jsx)("button",{className:"mt-2 w-full px-3 py-1.5 bg-sky-600 hover:bg-sky-500 text-white rounded text-xs font-medium transition-colors",onClick:t=>{t.stopPropagation(),O(e)},children:l("teamManagement.roster.connection.matchPlayer")})]})});return(0,Ts.jsx)(Ud,{content:i,position:"bottom",children:(0,Ts.jsx)(r,{className:"w-4 h-4 ".concat(s," transition-colors")})})})()}),(0,Ts.jsx)("td",{className:"px-4 py-3",children:e.jersey_number?(0,Ts.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-amber-600 text-amber-100",children:[(0,Ts.jsx)(yd,{className:"w-3 h-3 mr-1"}),e.jersey_number]}):(0,Ts.jsx)("span",{className:"text-slate-400 text-sm",children:"-"})}),(0,Ts.jsx)("td",{className:"px-4 py-3 text-right",children:(0,Ts.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[(0,Ts.jsx)("button",{onClick:()=>(e=>{C(e)})(e),className:"p-1 text-slate-400 hover:text-sky-400 transition-colors",title:l("teamManagement.roster.player.editTitle"),children:(0,Ts.jsx)(bd,{className:"w-4 h-4"})}),(0,Ts.jsx)("button",{onClick:()=>(e=>{F(e),q(!0)})(e),className:"p-1 text-slate-400 hover:text-emerald-400 transition-colors",title:l("teamManagement.roster.player.loanTitle"),children:(0,Ts.jsx)(cd,{className:"w-4 h-4"})}),(0,Ts.jsx)(Md,{onClick:()=>(async e=>{P(e);try{const t=await p(e.id);I(t)}catch(x){console.error("Error checking player game history:",x),I(!1)}})(e),icon:xd,label:l("teamManagement.roster.player.removeTitle"),variant:"danger",size:"sm"})]})})]},e.id)})})]})})}),Q&&J.length>0&&(0,Ts.jsx)("div",{className:"mt-4",children:(0,Ts.jsx)(vm,{onNavigateToConnectors:s})}),T&&(0,Ts.jsx)(ju,{team:a,onClose:()=>A(!1),onPlayerAdded:async e=>{try{await d(a.id,e),await W(),r&&r()}catch(x){console.error("Error in handlePlayerAdded:",x)}},getAvailableJerseyNumbers:f}),_&&(0,Ts.jsx)(Tu,{player:_,team:a,onClose:()=>C(null),onPlayerUpdated:async(e,t)=>{try{await u(e,t),C(null),await W(),r&&r()}catch(x){console.error("Error in handlePlayerUpdated:",x)}},getAvailableJerseyNumbers:f}),M&&(0,Ts.jsx)(Au,{player:M,hasGameHistory:E,onClose:()=>P(null),onConfirm:async()=>{if(M)try{const e=await m(M.id);P(null),I(!1),"deactivated"===e.operation?k(l("teamManagement.roster.success.playerDeactivated",{playerName:M.display_name})):k(l("teamManagement.roster.success.playerRemoved",{playerName:M.display_name})),await W(),r&&r()}catch(x){console.error("Error in handlePlayerDeleted:",x),w(x.message||l("teamManagement.roster.error.loadFailed"))}}}),R&&U.unmatchedExternalPlayers.length>0&&(0,Ts.jsx)(Wu,{rosterPlayer:R,unmatchedExternalPlayers:U.unmatchedExternalPlayers,onClose:()=>O(null),onMatched:async(e,t)=>{e&&t&&B(a=>{const r=new Map(a.matchedConnections),s=r.get(t.id)||[],i={attendanceId:e.attendanceId,providerName:e.providerName,providerId:e.providerId,playerNameInProvider:e.playerNameInProvider,connectorStatus:e.connectorStatus,connectorId:e.connectorId};r.set(t.id,[...s,i]);const o=a.unmatchedExternalPlayers.filter(t=>t.attendanceId!==e.attendanceId);return(0,n.A)((0,n.A)({},a),{},{matchedConnections:r,unmatchedExternalPlayers:o})}),await Y(),k(l("teamManagement.roster.success.playerMatched"))}}),L&&(0,Ts.jsx)(Yu,{isOpen:L,onClose:()=>{q(!1),F(null)},onSave:async e=>{let{playerIds:t,receivingTeamName:n,loanDate:r}=e;if(null===a||void 0===a||!a.id)throw new Error("Team ID is required");const s=await nm(t,{teamId:a.id,receivingTeamName:n,loanDate:r});if(!s.success)throw new Error(s.error||"Failed to record loan");if(1===t.length){const e=Gi(g.find(e=>e.id===t[0])||D);return void k(l("teamManagement.roster.success.loanRecorded",{playerName:e}))}k(l("teamManagement.roster.success.loanRecordedMultiple",{count:t.length}))},players:g,defaultPlayerId:(null===D||void 0===D?void 0:D.id)||""})]})}function Rm(e){let{team:t,onRefresh:a}=e;return(0,Ts.jsx)("div",{className:"space-y-6",children:(0,Ts.jsx)(_m,{team:t,onRefresh:a})})}function Om(t){let{team:a,onRefresh:r,onShowFloatingSuccess:s}=t;const{t:i}=xe("team"),{loadTeamPreferences:o,saveTeamPreferences:l,getTeamRoster:c}=vi(),[d,u]=(0,e.useState)(di),[m,h]=(0,e.useState)(!0),[p,f]=(0,e.useState)(null),[g,v]=(0,e.useState)(null),[y,b]=(0,e.useState)(di.teamCaptain),[x,w]=(0,e.useState)(""),[S,k]=(0,e.useState)([]),[N,j]=(0,e.useState)(!1),T=(0,e.useRef)(!1),A=(0,e.useRef)(!1),_=(0,e.useRef)(null);(0,e.useEffect)(()=>()=>{_.current&&clearTimeout(_.current)},[]);const C=(0,e.useCallback)(e=>"assign_each_match"===e?"assign_each_match":"permanent"===e||e&&"none"!==e?"permanent":"none",[]);(0,e.useEffect)(()=>{(async()=>{if(null!==a&&void 0!==a&&a.id){T.current=!1,A.current=!1;try{h(!0),f(null);const e=await o(a.id),t=(0,n.A)((0,n.A)({},di),e),r=C(t.teamCaptain),s="permanent"===r&&"permanent"===t.teamCaptain?"":t.teamCaptain||"";b(r),w("permanent"===r&&s?s:""),u((0,n.A)((0,n.A)({},t),{},{teamCaptain:"permanent"===r?s:t.teamCaptain}))}catch(e){console.error("Failed to load preferences:",e),f(i("teamManagement.preferences.errors.loadFailed"))}finally{h(!1),T.current=!0}}else T.current=!1})()},[null===a||void 0===a?void 0:a.id,o,C,i]),(0,e.useEffect)(()=>{(async()=>{if(null!==a&&void 0!==a&&a.id)try{j(!0);const e=await c(a.id);k(e||[])}catch(e){console.error("Failed to load roster:",e),f(i("teamManagement.preferences.errors.loadRosterFailed"))}finally{j(!1)}})()},[null===a||void 0===a?void 0:a.id,c,i]);const M=(0,e.useCallback)(e=>{const t=(0,xi.getValidFormations)(e,6).includes(d.formation),a=(xi.FORMAT_CONFIGS[e]||xi.FORMAT_CONFIGS[xi.FORMATS.FORMAT_5V5]).defaultFormation;u(r=>(0,n.A)((0,n.A)({},r),{},{matchFormat:e,formation:t?r.formation:a}))},[d.formation]),P=(0,e.useCallback)(e=>{const t=e.display_name||[e.first_name,e.last_name].filter(Boolean).join(" ").trim()||i("teamManagement.preferences.unnamedPlayer");return e.jersey_number?"#".concat(e.jersey_number," ").concat(t):t},[i]),E=(0,e.useMemo)(()=>{const e=S.filter(e=>e.on_roster),t=[...e.length>0?e:S].sort((e,t)=>{const a=(e.display_name||[e.first_name,e.last_name].filter(Boolean).join(" ")).trim(),n=(t.display_name||[t.first_name,t.last_name].filter(Boolean).join(" ")).trim();return a.localeCompare(n)}),a=t.map(e=>({value:e.id,label:P(e)}));return"permanent"===y&&x&&!a.some(e=>e.value===x)&&a.unshift({value:x,label:i("teamManagement.preferences.previousCaptain")}),a},[S,P,y,x,i]),I=(0,e.useCallback)(e=>{b(e),u("permanent"!==e?t=>(0,n.A)((0,n.A)({},t),{},{teamCaptain:e}):e=>(0,n.A)((0,n.A)({},e),{},{teamCaptain:x||""}))},[x]),R=(0,e.useCallback)(e=>{w(e),u(t=>(0,n.A)((0,n.A)({},t),{},{teamCaptain:e}))},[]);return(0,e.useEffect)(()=>{if(null===a||void 0===a||!a.id)return;if(!T.current)return;if(!A.current)return void(A.current=!0);const e="permanent"===y?x:y;if(v(null),"permanent"===y&&!e)return void f(i("teamManagement.preferences.errors.selectCaptain"));if(["9v9","11v11"].includes(d.matchFormat))return void f(i("teamManagement.preferences.errors.unsupportedFormat"));const t=(0,n.A)((0,n.A)({},d),{},{teamCaptain:e});let o=!0;return(async()=>{try{if(f(null),await l(a.id,t),!o)return;s?s(i("teamManagement.preferences.success.saved")):(v(i("teamManagement.preferences.success.saved")),_.current&&clearTimeout(_.current),_.current=setTimeout(()=>v(null),3e3)),r&&r()}catch(e){if(console.error("Failed to save preferences:",e),!o)return;f(i("teamManagement.preferences.errors.saveFailed")),v(null)}})(),()=>{o=!1}},[d,y,x,null===a||void 0===a?void 0:a.id,r,l,s,i]),m?(0,Ts.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,Ts.jsx)("div",{className:"text-slate-400",children:i("teamManagement.preferences.loadingPreferences")})}):(0,Ts.jsxs)("div",{className:"space-y-6",children:[!s&&g&&(0,Ts.jsx)(Jc,{variant:"success",children:g}),p&&(0,Ts.jsx)(Jc,{variant:"error",children:p}),(0,Ts.jsx)("div",{className:"flex items-center justify-between",children:(0,Ts.jsx)("h3",{className:"text-lg font-semibold text-slate-200",children:i("teamManagement.preferences.title")})}),(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("h4",{className:"text-md font-medium text-slate-300 flex items-center",children:[(0,Ts.jsx)(wd,{className:"w-4 h-4 mr-2"}),i("teamManagement.preferences.matchSettings")]}),(0,Ts.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Ts.jsx)(Pd,{label:i("teamManagement.preferences.matchFormat"),children:(0,Ts.jsx)(Dc,{value:d.matchFormat,onChange:M,options:[{value:"5v5",label:"5v5"},{value:"7v7",label:"7v7"},{value:"9v9",label:"9v9 (".concat(i("teamManagement.preferences.comingSoon"),")")},{value:"11v11",label:"11v11 (".concat(i("teamManagement.preferences.comingSoon"),")")}]})}),(0,Ts.jsx)(Pd,{label:i("teamManagement.preferences.formation"),children:(0,Ts.jsx)(Dc,{value:d.formation,onChange:e=>u(t=>(0,n.A)((0,n.A)({},t),{},{formation:e})),options:(0,xi.getValidFormations)(d.matchFormat,6).map(e=>{const t=xi.FORMATION_DEFINITIONS[e],a="available"===t.status;return{value:e,label:a?t.label:"".concat(t.label," (").concat(i("teamManagement.preferences.comingSoon"),")"),disabled:!a}})})})]})]}),(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("h4",{className:"text-md font-medium text-slate-300 flex items-center",children:[(0,Ts.jsx)(Sd,{className:"w-4 h-4 mr-2"}),i("teamManagement.preferences.timeSettings")]}),(0,Ts.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Ts.jsx)(Pd,{label:i("teamManagement.preferences.periodLength"),children:(0,Ts.jsx)("input",{type:"number",min:"5",max:"45",value:d.periodLength,onChange:e=>u(t=>(0,n.A)((0,n.A)({},t),{},{periodLength:parseInt(e.target.value,10)})),className:"w-full px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-sky-500"})}),(0,Ts.jsx)(Pd,{label:i("teamManagement.preferences.numPeriods"),children:(0,Ts.jsx)(Dc,{value:d.numPeriods,onChange:e=>u(t=>(0,n.A)((0,n.A)({},t),{},{numPeriods:parseInt(e,10)})),options:[{value:1,label:"1 ".concat(i("teamManagement.preferences.period"))},{value:2,label:"2 ".concat(i("teamManagement.preferences.periods"))},{value:3,label:"3 ".concat(i("teamManagement.preferences.periods"))},{value:4,label:"4 ".concat(i("teamManagement.preferences.periods"))}]})})]})]}),(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("h4",{className:"text-md font-medium text-slate-300 flex items-center",children:[(0,Ts.jsx)(md,{className:"w-4 h-4 mr-2"}),i("teamManagement.preferences.substitutionSettings")]}),(0,Ts.jsx)("div",{className:"space-y-3",children:(0,Ts.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,Ts.jsx)("input",{type:"checkbox",checked:d.alternateRoles,onChange:e=>u(t=>(0,n.A)((0,n.A)({},t),{},{alternateRoles:e.target.checked})),className:"sr-only"}),(0,Ts.jsx)("div",{className:"w-4 h-4 rounded border-2 mr-3 flex items-center justify-center ".concat(d.alternateRoles?"bg-sky-600 border-sky-600":"border-slate-400"),children:d.alternateRoles&&(0,Ts.jsx)(kd,{className:"w-3 h-3 text-white"})}),(0,Ts.jsx)("span",{className:"text-slate-300",children:i("teamManagement.preferences.alternateRoles")}),(0,Ts.jsx)(Ud,{content:(0,Ts.jsxs)("div",{className:"text-xs",children:[(0,Ts.jsx)("div",{className:"font-semibold text-slate-100 mb-2",children:i("teamManagement.preferences.alternateRolesTooltip.title")}),(0,Ts.jsx)("div",{className:"text-slate-300",children:i("teamManagement.preferences.alternateRolesTooltip.description")})]}),position:"right",children:(0,Ts.jsx)(Nd,{className:"w-4 h-4 ml-2 text-slate-400 hover:text-slate-300 transition-colors cursor-pointer"})})]})}),(0,Ts.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(0,Ts.jsx)(Pd,{label:i("teamManagement.preferences.substitutionLogic"),children:(0,Ts.jsx)(Dc,{value:d.substitutionLogic,onChange:e=>u(t=>(0,n.A)((0,n.A)({},t),{},{substitutionLogic:e})),options:[{value:"equal_time",label:i("teamManagement.preferences.substitutionOptions.equalTime")},{value:"same_role",label:i("teamManagement.preferences.substitutionOptions.sameRole")}]})})})]}),(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("h4",{className:"text-md font-medium text-slate-300 flex items-center",children:[(0,Ts.jsx)(jd,{className:"w-4 h-4 mr-2"}),i("teamManagement.preferences.gameFeatures")]}),(0,Ts.jsx)("div",{className:"space-y-3",children:(0,Ts.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,Ts.jsx)("input",{type:"checkbox",checked:d.trackGoalScorer,onChange:e=>u(t=>(0,n.A)((0,n.A)({},t),{},{trackGoalScorer:e.target.checked})),className:"sr-only"}),(0,Ts.jsx)("div",{className:"w-4 h-4 rounded border-2 mr-3 flex items-center justify-center ".concat(d.trackGoalScorer?"bg-sky-600 border-sky-600":"border-slate-400"),children:d.trackGoalScorer&&(0,Ts.jsx)(kd,{className:"w-3 h-3 text-white"})}),(0,Ts.jsx)("span",{className:"text-slate-300",children:i("teamManagement.preferences.trackGoalScorer")})]})}),(0,Ts.jsx)(Pd,{label:i("teamManagement.preferences.fairPlayAward"),children:(0,Ts.jsx)(Dc,{value:d.fairPlayAward,onChange:e=>u(t=>(0,n.A)((0,n.A)({},t),{},{fairPlayAward:e})),options:[{value:"none",label:i("teamManagement.preferences.fairPlayOptions.none")},{value:"league_only",label:i("teamManagement.preferences.fairPlayOptions.leagueOnly")},{value:"competitive",label:i("teamManagement.preferences.fairPlayOptions.competitive")},{value:"all_games",label:i("teamManagement.preferences.fairPlayOptions.allGames")}]})}),(0,Ts.jsxs)(Pd,{label:i("teamManagement.preferences.teamCaptain"),children:[(0,Ts.jsx)(Dc,{value:y,onChange:I,options:[{value:"none",label:i("teamManagement.preferences.teamCaptainOptions.none")},{value:"permanent",label:i("teamManagement.preferences.teamCaptainOptions.permanent")},{value:"assign_each_match",label:i("teamManagement.preferences.teamCaptainOptions.assignEach")}]}),"permanent"===y&&(0,Ts.jsxs)("div",{className:"mt-3 space-y-1",children:[(0,Ts.jsx)("label",{className:"block text-xs font-medium text-slate-400",children:i("teamManagement.preferences.permanentCaptain")}),(0,Ts.jsx)(Dc,{value:x,onChange:R,options:E,placeholder:i(N?"teamManagement.preferences.loadingPlayers":"teamManagement.preferences.selectCaptain"),disabled:N||0===E.length}),!N&&0===E.length&&(0,Ts.jsx)("p",{className:"text-xs text-slate-400",children:i("teamManagement.preferences.addPlayersForCaptain")})]})]})]}),(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("h4",{className:"text-md font-medium text-slate-300 flex items-center",children:[(0,Ts.jsx)(Td,{className:"w-4 h-4 mr-2"}),i("teamManagement.preferences.statistics")]}),(0,Ts.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(0,Ts.jsxs)(Pd,{label:i("teamManagement.preferences.loanMatchWeight"),children:[(0,Ts.jsx)(Dc,{value:String(d.loanMatchWeight),onChange:e=>u(t=>(0,n.A)((0,n.A)({},t),{},{loanMatchWeight:parseFloat(e)})),options:[{value:"1.0",label:i("teamManagement.preferences.loanWeightOptions.full")},{value:"0.5",label:i("teamManagement.preferences.loanWeightOptions.half")},{value:"0.0",label:i("teamManagement.preferences.loanWeightOptions.none")}]}),(0,Ts.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:i("teamManagement.preferences.loanWeightDescription")})]})})]})]})}function Dm(e){let{firstProviderName:t,onNavigateToRoster:a}=e;const{t:n}=xe(["connectors","navigation"]);return(0,Ts.jsxs)(Xc,{variant:"highlighted",className:"text-center",children:[(0,Ts.jsxs)("div",{className:"flex items-start space-x-3 mb-4",children:[(0,Ts.jsx)(od,{className:"w-5 h-5 text-sky-400 mt-0.5 flex-shrink-0","aria-hidden":"true"}),(0,Ts.jsxs)("div",{className:"flex-1",children:[(0,Ts.jsx)("h3",{className:"text-sky-200 font-medium text-sm mb-1",children:n("connectors:unmappedBanner.title")}),(0,Ts.jsx)("p",{className:"text-sky-300/80 text-xs",children:n("connectors:unmappedBanner.description",{providerName:t})})]})]}),(0,Ts.jsx)("div",{className:"flex justify-center",children:(0,Ts.jsx)(Lc,{onClick:a,variant:"primary",Icon:au,children:n("navigation:goTo.rosterManagement")})})]})}const Fm=Bs(Br.MATCH_HISTORY,{matches:[]}),Lm=Bs(Br.CURRENT_TEAM_ID,{teamId:null});const qm=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.userId=e,this.isAuthenticated=!!e}setUserId(e){this.userId=e,this.isAuthenticated=!!e}async saveMatch(e){try{return this.isAuthenticated?await this.saveMatchToCloud(e):this.saveMatchToLocal(e)}catch(t){if(console.error("Error saving match data:",t),this.isAuthenticated)return this.saveMatchToLocal(e);throw t}}saveMatchToLocal(e){try{const t=this.getLocalMatches(),a=(0,n.A)((0,n.A)({id:"local_".concat(Date.now())},e),{},{savedAt:(new Date).toISOString(),source:"local"});t.push(a);const r=t.slice(-10);return Fm.saveState({matches:r}),{success:!0,match:a,storage:"local"}}catch(t){return console.error("Error saving match to localStorage:",t),{success:!1,error:t.message,storage:"local"}}}async saveMatchToCloud(e){if(!this.userId)throw new Error("User ID required for cloud storage");try{var t,a;const n=await this.getCurrentTeamId();if(!n)throw new Error("errors.noTeamSelected");const r=(null===e||void 0===e?void 0:e.format)||(null===e||void 0===e||null===(t=e.teamConfig)||void 0===t?void 0:t.format)||xi.FORMATS.FORMAT_5V5,s=(null===e||void 0===e||null===(a=e.teamConfig)||void 0===a?void 0:a.formation)||(null===e||void 0===e?void 0:e.formation)||"2-2",{data:i,error:o}=await Ur.from("match").insert([{team_id:n,format:r,formation:s,periods:e.numPeriods||3,period_duration_minutes:e.periodDurationMinutes||15,match_duration_seconds:(e.periodDurationMinutes||15)*(e.numPeriods||3)*60,finished_at:(new Date).toISOString(),type:"friendly",opponent:e.opponentTeam||"Opponent",captain:e.captainId||null,goals_scored:e.ownScore||0,goals_conceded:e.opponentScore||0,outcome:this.calculateMatchOutcome(e.ownScore,e.opponentScore),state:"finished"}]).select().single();if(o)throw new Error("Failed to save match: ".concat(o.message));return e.players&&e.players.length>0&&await this.savePlayerStats(i.id,e.players,n),e.matchEvents&&e.matchEvents.length>0&&await this.saveMatchEvents(i.id,e.matchEvents),{success:!0,match:i,storage:"cloud",message:"errors.matchSavedSuccess"}}catch(n){return console.error("Error saving match to cloud:",n),{success:!1,error:n.message,storage:"cloud"}}}async savePlayerStats(e,t,a){try{const a=t.filter(e=>null!==e.stats.startedMatchAs).map(a=>{var n;return{match_id:e,player_id:a.cloudId||null,goals_scored:a.stats.goals||0,substitutions_in:a.stats.substitutionsIn||0,substitutions_out:a.stats.substitutionsOut||0,goalie_time_seconds:a.stats.timeAsGoalieSeconds||0,defender_time_seconds:a.stats.timeAsDefenderSeconds||0,midfielder_time_seconds:a.stats.timeAsMidfielderSeconds||0,attacker_time_seconds:a.stats.timeAsAttackerSeconds||0,substitute_time_seconds:(a.stats.totalTimeSeconds||0)-(a.stats.timeOnFieldSeconds||0),started_as:this.mapPlayerRoleToDatabase(a.stats.startedAtRole||a.stats.startedMatchAs),was_captain:a.isCaptain||!1,got_fair_play_award:a.fairPlayAward||!1,team_mode:(null===(n=t[0])||void 0===n?void 0:n.teamMode)||"individual_6"}});if(a.length>0){const{error:e}=await Ur.from("player_match_stats").insert(a);e&&console.error("Error saving player stats:",e)}}catch(n){console.error("Error in savePlayerStats:",n)}}async saveMatchEvents(e,t){try{if(!e||!Array.isArray(t)||0===t.length)return{success:!0,skipped:!0,reason:"no_events"};const{count:a,error:n}=await Ur.from("match_log_event").select("id",{count:"exact",head:!0}).eq("match_id",e);if(n)return console.error("Error checking existing match events:",n),{success:!1,error:n.message};if((a||0)>0)return{success:!0,skipped:!0,reason:"already_synced"};const r=t.flatMap(t=>{const a=Bo.transformEventForDatabase(t,e);return a?Array.isArray(a)?a:[a]:[]});if(0===r.length)return{success:!0,skipped:!0,reason:"no_mappable_events"};const{error:s}=await Ur.from("match_log_event").insert(r);return s?(console.error("Error saving match events:",s),{success:!1,error:s.message}):{success:!0,inserted:r.length}}catch(a){return console.error("Error in saveMatchEvents:",a),{success:!1,error:a.message}}}async getMatchHistory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;try{return this.isAuthenticated?await this.getCloudMatchHistory(e):this.getLocalMatchHistory(e)}catch(t){return console.error("Error getting match history:",t),this.isAuthenticated?this.getLocalMatchHistory(e):{success:!1,matches:[],error:t.message}}}getLocalMatchHistory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;try{const t=this.getLocalMatches();return{success:!0,matches:t.slice(-e).reverse(),storage:"local",total:t.length}}catch(t){return console.error("Error getting local match history:",t),{success:!1,matches:[],error:t.message,storage:"local"}}}async getCloudMatchHistory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;if(!this.userId)throw new Error("User ID required for cloud storage");try{const{data:t,error:a}=await Ur.from("match").select("\n          *,\n          team:team_id (\n            id,\n            name,\n            club:club_id (\n              name,\n              short_name\n            )\n          ),\n          player_match_stats (*)\n        ").eq("team.team_user.user_id",this.userId).is("deleted_at",null).order("finished_at",{ascending:!1}).limit(e);if(a)throw new Error("Failed to fetch match history: ".concat(a.message));return{success:!0,matches:t||[],storage:"cloud",total:(null===t||void 0===t?void 0:t.length)||0}}catch(t){return console.error("Error getting cloud match history:",t),{success:!1,matches:[],error:t.message,storage:"cloud"}}}async migrateLocalDataToCloud(){if(!this.isAuthenticated)throw new Error("User must be authenticated to migrate data");try{const t=this.getLocalMatches();if(0===t.length)return{success:!0,migrated:0,message:"No local data to migrate"};let a=0;const n=[];for(const r of t)try{const e=await this.saveMatchToCloud(r);e.success?a++:n.push("Match ".concat(r.id,": ").concat(e.error))}catch(e){n.push("Match ".concat(r.id,": ").concat(e.message))}return a>0&&0===n.length&&Fm.clearState(),{success:!0,migrated:a,total:t.length,errors:n,message:"Successfully migrated ".concat(a," of ").concat(t.length," matches")}}catch(e){return console.error("Error migrating local data to cloud:",e),{success:!1,error:e.message}}}getLocalMatches(){const e=Fm.loadState();return Array.isArray(e.matches)?e.matches:[]}async getCurrentTeamId(){const e=Lm.loadState();if(e.teamId)return e.teamId;const{data:t,error:a}=await Ur.from("team_user").select("team_id").eq("user_id",this.userId).limit(1);return a||!t||0===t.length?null:t[0].team_id}calculateMatchOutcome(e,t){return e>t?"win":e<t?"loss":"draw"}mapPlayerRoleToDatabase(e){const t=(0,ki.GY)(e);return t&&t!==Je.q.UNKNOWN?(0,ki.x8)(t):(0,ki.x8)(Je.q.SUBSTITUTE)}},Um=/\S+@\S+\.\S+/,Bm=8,Gm=!1,zm=!1,Vm=!0,Hm=!1,Km={email:{required:"Email is required",invalid:"Please enter a valid email address"},password:{required:"Password is required",tooShort:"Password must be at least ".concat(Bm," characters"),missingNumber:"Password must contain at least one number",missingSpecialChar:"Password must contain at least one special character"},confirmPassword:{required:"Please confirm your password",mismatch:"Passwords do not match"},otp:{required:"Verification code is required",invalid:"Please enter a valid 6-digit code",tooShort:"Verification code must be 6 digits",notNumeric:"Verification code must contain only numbers"},general:{unexpected:"An unexpected error occurred. Please try again."}},Wm=e=>e?{email:{required:e("validation.email.required"),invalid:e("validation.email.invalid")},password:{required:e("validation.password.required"),tooShort:e("validation.password.tooShort"),missingNumber:e("validation.password.missingNumber"),missingSpecialChar:e("validation.password.missingSpecialChar")},confirmPassword:{required:e("validation.confirmPassword.required"),mismatch:e("validation.confirmPassword.mismatch")},otp:{required:e("validation.otp.required"),invalid:e("validation.otp.invalid"),tooShort:e("validation.otp.tooShort"),notNumeric:e("validation.otp.notNumeric")},general:{unexpected:e("validation.general.unexpected")}}:Km,Ym=function(e){const t=Wm((arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).t);return e&&e.trim()?Um.test(e.trim())?{isValid:!0,error:null}:{isValid:!1,error:t.email.invalid}:{isValid:!1,error:t.email.required}},Jm=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{skipComplexity:a=!1}=t,n=Wm(t.t);return e?a?{isValid:!0,error:null}:e.length<Bm?{isValid:!1,error:n.password.tooShort}:Vm&&!/(?=.*\d)/.test(e)?{isValid:!1,error:n.password.missingNumber}:Gm&&zm&&!/(?=.*[a-z])(?=.*[A-Z])/.test(e)?{isValid:!1,error:n.password.missingUppercase}:Hm&&!/(?=.*[!@#$%^&*])/.test(e)?{isValid:!1,error:n.password.missingSpecialChar}:{isValid:!0,error:null}:{isValid:!1,error:n.password.required}},Qm=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a={},n=Ym(e.email,t);n.isValid||(a.email=n.error);const r=Jm(e.password,t);r.isValid||(a.password=r.error);const s=function(e,t){const a=Wm((arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).t);return t?e!==t?{isValid:!1,error:a.confirmPassword.mismatch}:{isValid:!0,error:null}:{isValid:!1,error:a.confirmPassword.required}}(e.password,e.confirmPassword,t);return s.isValid||(a.confirmPassword=s.error),{isValid:0===Object.keys(a).length,errors:a}},$m=function(e){const t=Wm((arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).t);if(!e||!e.trim())return{isValid:!1,error:t.otp.required};const a=e.trim();return 6!==a.length?{isValid:!1,error:t.otp.tooShort}:/^\d{6}$/.test(a)?{isValid:!0,error:null}:{isValid:!1,error:t.otp.notNumeric}};Km.general.unexpected;const Xm=e=>{if(!e)return null;let t="";t="string"===typeof e?e:e.message?e.message:e.error_description?e.error_description:e.msg?e.msg:W.t("auth:errors.unknownError",{defaultValue:"Unknown error"});const a={"Invalid login credentials":W.t("auth:errors.invalidCredentials",{defaultValue:"Invalid email or password. Please check your credentials and try again."}),"Email not confirmed":W.t("auth:errors.emailNotConfirmed",{defaultValue:"Please verify your email with the 6-digit code we sent you."}),"User already registered":W.t("auth:errors.userAlreadyRegistered",{defaultValue:"An account with this email already exists. Please sign in instead."}),"Password should be at least 6 characters":W.t("auth:errors.passwordTooShort",{defaultValue:"Password must be at least 6 characters long."}),"Signup requires a valid password":W.t("auth:errors.invalidPassword",{defaultValue:"Please enter a valid password."}),"Unable to validate email address":W.t("auth:errors.invalidEmail",{defaultValue:"Please enter a valid email address."}),"Email address not found":W.t("auth:errors.emailNotFound",{defaultValue:"No account found with this email address."}),"Too many requests":W.t("auth:errors.tooManyRequests",{defaultValue:"Too many attempts. Please wait a moment before trying again."}),"Network request failed":W.t("auth:errors.connectionError",{defaultValue:"Connection error. Please check your internet connection and try again."}),"Failed to fetch":W.t("auth:errors.connectionError",{defaultValue:"Connection error. Please check your internet connection and try again."}),NetworkError:W.t("auth:errors.networkError",{defaultValue:"Network error. Please try again."}),TypeError:W.t("auth:validation.general.unexpected",{defaultValue:"An unexpected error occurred. Please try again."}),default:W.t("auth:validation.general.unexpected",{defaultValue:Km.general.unexpected})};for(const[n,r]of Object.entries(a))if("default"!==n&&t.toLowerCase().includes(n.toLowerCase()))return r;return a.default},Zm=e=>{if(!e)return!1;const t="string"===typeof e?e:e.message||"";return!["AbortError","CancelledError","TimeoutError"].some(e=>t.toLowerCase().includes(e.toLowerCase()))},eh=e=>{let{formErrors:t={},authError:a=null,generalError:n=null}=e;if(n)return Xm(n);if(a&&Zm(a))return Xm(a);const r=Object.values(t).find(e=>e);return r||null},th=function(e){const t={banner:{container:e?"bg-rose-900/50 border border-rose-600 rounded-lg p-3":"hidden",text:"text-rose-200 text-sm"},inline:{container:e?"text-rose-400 text-sm mt-1":"hidden",text:""},field:{container:e?"border-rose-500 focus:ring-rose-400 focus:border-rose-500":"",text:e?"text-rose-400 text-sm mt-1":"hidden"}};return t[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"banner"]||t.banner};function ah(t){let{onSwitchToSignup:a,onSwitchToReset:r,onSwitchToVerify:s,onClose:i,initialEmail:o=""}=t;const{t:l}=xe("auth"),[c,d]=(0,e.useState)(o),[u,m]=(0,e.useState)(""),[h,p]=(0,e.useState)({}),{signIn:f,loading:g,authError:v,clearAuthError:y}=Cs();e.useEffect(()=>{o&&o!==c&&d(o)},[o,c]),e.useEffect(()=>{v&&y()},[c,u,v,y]);const b=()=>{const{isValid:e,errors:t}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a={},r=Ym(e.email,t);r.isValid||(a.email=r.error);const s=Jm(e.password,(0,n.A)({skipComplexity:!0},t));return s.isValid||(a.password=s.error),{isValid:0===Object.keys(a).length,errors:a}}({email:c,password:u},{t:l});return p(t),e},x=async e=>{if(e.preventDefault(),b())try{const{user:e,error:t}=await f(c,u);if(t){if(t.message&&t.message.toLowerCase().includes("email not confirmed"))return void s(c);p({general:t.message})}else e&&i()}catch(t){p({general:l("login.errors.unexpected")})}},w=eh({formErrors:{},authError:v,generalError:h.general}),S=th(!!w,"banner");return(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"text-center",children:[(0,Ts.jsx)("h2",{className:"text-2xl font-bold text-sky-300",children:l("login.header.title")}),(0,Ts.jsx)("p",{className:"text-slate-400 mt-2",children:l("login.header.subtitle")})]}),w&&(0,Ts.jsx)("div",{className:S.container,children:(0,Ts.jsx)("p",{className:S.text,children:w})}),(0,Ts.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[(0,Ts.jsx)(Pd,{label:l("login.form.emailLabel"),htmlFor:"email",error:h.email,children:(0,Ts.jsx)(Rc,{id:"email",type:"email",value:c,onChange:e=>d(e.target.value),placeholder:l("login.form.emailPlaceholder"),disabled:g,className:th(!!h.email,"field").container})}),(0,Ts.jsx)(Pd,{label:l("login.form.passwordLabel"),htmlFor:"password",error:h.password,children:(0,Ts.jsx)(Rc,{id:"password",type:"password",value:u,onChange:e=>m(e.target.value),placeholder:l("login.form.passwordPlaceholder"),disabled:g,className:th(!!h.password,"field").container})}),(0,Ts.jsx)(Lc,{type:"submit",onClick:x,variant:"primary",size:"lg",disabled:g,className:"w-full",children:l(g?"login.form.submittingButton":"login.form.submitButton")})]}),(0,Ts.jsxs)("div",{className:"space-y-3 text-center",children:[(0,Ts.jsx)("button",{type:"button",onClick:()=>r(c),className:"text-sky-400 hover:text-sky-300 text-sm transition-colors",disabled:g,children:l("login.links.forgotPassword")}),(0,Ts.jsxs)("div",{className:"text-slate-400 text-sm",children:[l("login.links.noAccount")," ",(0,Ts.jsx)("button",{type:"button",onClick:a,className:"text-sky-400 hover:text-sky-300 font-medium transition-colors",disabled:g,children:l("login.links.signUp")})]})]})]})}function nh(t){let{email:a,onSuccess:r,onSwitchToLogin:s,onClose:i}=t;const{t:o}=xe("auth"),[l,c]=(0,e.useState)(""),[d,u]=(0,e.useState)({}),[m,h]=(0,e.useState)(0),[p,f]=(0,e.useState)(!1),[g,v]=(0,e.useState)({isExpired:!1,minutesRemaining:60}),{verifyOtp:y,resendOtp:b,loading:x,authError:w,clearAuthError:S}=Cs(),k=(0,e.useRef)(null);(0,e.useEffect)(()=>{k.current&&k.current.focus()},[]),(0,e.useEffect)(()=>{w&&S()},[l,w,S]),(0,e.useEffect)(()=>{let e;return m>0&&(e=setTimeout(()=>h(m-1),1e3)),()=>clearTimeout(e)},[m]),(0,e.useEffect)(()=>{const e=()=>{const e=(e=>{if(!e)return{isExpired:!1,minutesRemaining:60,sentTime:null};try{const t="sport-wizard-otp-sent-".concat(e.toLowerCase().trim()),a=localStorage.getItem(t);if(!a)return{isExpired:!1,minutesRemaining:60,sentTime:null};const n=parseInt(a,10);if(isNaN(n))return{isExpired:!1,minutesRemaining:60,sentTime:null};const r=Ns(),s=Math.floor((r-n)/1e3/60);return{isExpired:s>=59,minutesRemaining:Math.max(0,59-s),sentTime:n}}catch(t){return console.warn("Failed to check OTP expiry:",t),{isExpired:!1,minutesRemaining:60,sentTime:null}}})(a);v(e)};e();const t=setInterval(e,6e4);return()=>clearInterval(t)},[a]);const N=async e=>{if(e.preventDefault(),(()=>{const{isValid:e,error:t}=$m(l,{t:o});return e?(u({}),!0):(u({code:t}),!1)})())try{const{user:e,error:t}=await y(a,l);t?u({general:t.message}):e&&r()}catch(t){u({general:o("emailVerification.errors.unexpected")})}},j=async()=>{if(!(m>0))try{const{error:e}=await b(a,"signup");e?u({general:e.message}):(c(""),h(60),u({}),v({isExpired:!1,minutesRemaining:59}))}catch(e){u({general:o("emailVerification.errors.resendFailed")})}},T=eh({formErrors:{},authError:w,generalError:d.general}),A=th(!!T,"banner");return(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"text-center",children:[(0,Ts.jsx)("div",{className:"w-16 h-16 bg-sky-600 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,Ts.jsx)("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),(0,Ts.jsx)("h2",{className:"text-2xl font-bold text-sky-300",children:o("emailVerification.header.title")}),(0,Ts.jsxs)("p",{className:"text-slate-400 mt-2",children:[o("emailVerification.header.sentTo")," ",(0,Ts.jsx)("span",{className:"text-slate-300 font-medium",children:a})]})]}),T&&(0,Ts.jsx)("div",{className:A.container,children:(0,Ts.jsx)("p",{className:A.text,children:T})}),g.isExpired?(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)(Jc,{variant:"warning",className:"text-center",children:[(0,Ts.jsx)("p",{className:"text-amber-300 font-medium mb-2",children:o("emailVerification.expiry.title")}),(0,Ts.jsx)("p",{className:"text-amber-200 text-sm",children:o("emailVerification.expiry.description")})]}),(0,Ts.jsx)(Lc,{type:"button",onClick:j,variant:"primary",size:"lg",disabled:m>0||x,className:"w-full",children:x?o("emailVerification.expiry.sendingButton"):m>0?o("emailVerification.expiry.cooldownButton",{seconds:m}):o("emailVerification.expiry.sendNewButton")}),(0,Ts.jsxs)("p",{className:"text-slate-400 text-sm text-center",children:[o("emailVerification.expiry.confirmMessage")," ",(0,Ts.jsx)("span",{className:"text-slate-300 font-medium",children:a})]})]}):(0,Ts.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,Ts.jsxs)(Pd,{label:o("emailVerification.form.codeLabel"),htmlFor:"verification-code",error:d.code,children:[(0,Ts.jsx)(Rc,{ref:k,id:"verification-code",type:"text",inputMode:"numeric",pattern:"[0-9]*",value:l,onChange:e=>{let t=e.target.value;t=t.replace(/\D/g,"").slice(0,6),c(t),d.code&&u(e=>(0,n.A)((0,n.A)({},e),{},{code:null}))},onKeyDown:e=>{"Enter"===e.key&&6===l.length&&N(e)},placeholder:o("emailVerification.form.codePlaceholder"),disabled:x,className:"text-center text-lg tracking-widest ".concat(th(!!d.code,"field").container),maxLength:6,autoComplete:"one-time-code","aria-label":o("emailVerification.form.codePlaceholder"),"aria-describedby":"code-help-text"}),(0,Ts.jsx)("p",{id:"code-help-text",className:"text-slate-500 text-xs mt-1",children:o("emailVerification.form.codeHint")})]}),(0,Ts.jsx)(Lc,{type:"submit",onClick:N,variant:"primary",size:"lg",disabled:x||6!==l.length,className:"w-full",children:o(x?"emailVerification.form.submittingButton":"emailVerification.form.submitButton")})]}),(0,Ts.jsxs)("div",{className:"text-center",children:[(0,Ts.jsxs)("button",{type:"button",onClick:()=>f(!p),className:"inline-flex items-center gap-2 text-slate-400 hover:text-slate-300 text-sm font-medium transition-colors",disabled:x,"aria-expanded":p,"aria-controls":"help-section","aria-label":o(p?"emailVerification.help.toggleButtonHide":"emailVerification.help.toggleButtonShow"),children:[(0,Ts.jsx)("span",{children:o("emailVerification.help.toggleButton")}),p?(0,Ts.jsx)($u,{className:"h-4 w-4"}):(0,Ts.jsx)(jc,{className:"h-4 w-4"})]}),p&&(0,Ts.jsxs)("div",{id:"help-section",className:"mt-4 space-y-4 text-left bg-slate-700 rounded-lg p-4",role:"region","aria-labelledby":"help-title",children:[(0,Ts.jsx)("div",{className:"text-center pb-3 border-b border-slate-600",children:(0,Ts.jsx)("button",{type:"button",onClick:j,disabled:m>0||x,className:"text-sky-400 hover:text-sky-300 font-medium transition-colors disabled:text-slate-500 disabled:cursor-not-allowed","aria-label":m>0?o("emailVerification.help.resendCooldown",{seconds:m}):o("emailVerification.help.resendButton"),children:m>0?o("emailVerification.help.resendCooldown",{seconds:m}):o("emailVerification.help.resendButton")})}),(0,Ts.jsxs)("div",{className:"space-y-3",children:[(0,Ts.jsx)("h4",{id:"help-title",className:"text-slate-300 font-medium text-sm",children:o("emailVerification.help.title")}),(0,Ts.jsxs)("div",{className:"space-y-2 text-xs text-slate-400",children:[(0,Ts.jsxs)("div",{className:"flex items-start gap-2",children:[(0,Ts.jsx)("span",{className:"text-slate-500 mt-0.5",children:"\u2022"}),(0,Ts.jsx)("span",{children:o("emailVerification.help.tips.spam")})]}),(0,Ts.jsxs)("div",{className:"flex items-start gap-2",children:[(0,Ts.jsx)("span",{className:"text-slate-500 mt-0.5",children:"\u2022"}),(0,Ts.jsx)("span",{children:o("emailVerification.help.tips.wait")})]}),(0,Ts.jsxs)("div",{className:"flex items-start gap-2",children:[(0,Ts.jsx)("span",{className:"text-slate-500 mt-0.5",children:"\u2022"}),(0,Ts.jsx)("span",{children:o("emailVerification.help.tips.checkEmail",{email:(0,Ts.jsx)("span",{className:"text-slate-300 font-medium",children:a})})})]}),(0,Ts.jsxs)("div",{className:"flex items-start gap-2",children:[(0,Ts.jsx)("span",{className:"text-slate-500 mt-0.5",children:"\u2022"}),(0,Ts.jsx)("span",{children:o("emailVerification.help.tips.provider")})]})]})]}),(0,Ts.jsxs)("div",{className:"pt-3 border-t border-slate-600",children:[(0,Ts.jsx)("h4",{className:"text-slate-300 font-medium text-sm mb-2",children:o("emailVerification.help.enumeration.title")}),(0,Ts.jsxs)("div",{className:"space-y-2 text-xs text-slate-400",children:[(0,Ts.jsx)("p",{children:o("emailVerification.help.enumeration.description")}),(0,Ts.jsxs)("p",{children:[(0,Ts.jsx)("strong",{className:"text-slate-300",children:o("emailVerification.help.enumeration.whyTitle")})," ",o("emailVerification.help.enumeration.whyDescription")]}),(0,Ts.jsx)("div",{className:"pt-2",children:(0,Ts.jsx)("button",{type:"button",onClick:s,className:"text-sky-400 hover:text-sky-300 text-sm font-medium transition-colors",disabled:x,"aria-label":o("emailVerification.help.enumeration.signInLink"),children:o("emailVerification.help.enumeration.signInLink")})})]})]})]})]}),(0,Ts.jsxs)("div",{className:"text-center space-y-2",children:[(0,Ts.jsxs)("div",{className:"text-slate-400 text-sm",children:[o("emailVerification.footer.hasAccount")," ",(0,Ts.jsx)("button",{type:"button",onClick:s,className:"text-sky-400 hover:text-sky-300 font-medium transition-colors",disabled:x,"aria-label":o("emailVerification.footer.signInLink"),children:o("emailVerification.footer.signInLink")})]}),(0,Ts.jsx)("button",{type:"button",onClick:i,className:"text-slate-400 hover:text-slate-300 text-sm transition-colors",disabled:x,"aria-label":o("emailVerification.footer.closeButton"),children:o("emailVerification.footer.closeButton")})]})]})}function rh(t){let{onSwitchToLogin:a,onClose:r}=t;const{t:s}=xe("auth"),[i,o]=(0,e.useState)({email:"",password:"",confirmPassword:""}),[l,c]=(0,e.useState)({}),[d,u]=(0,e.useState)(!1),[m,h]=(0,e.useState)(""),{signUp:p,loading:f,authError:g,clearAuthError:v}=Cs();e.useEffect(()=>{g&&v()},[i,g,v]);const y=(e,t)=>{o(a=>(0,n.A)((0,n.A)({},a),{},{[e]:t})),l[e]&&c(t=>(0,n.A)((0,n.A)({},t),{},{[e]:null}))},b=async e=>{if(e.preventDefault(),(()=>{const{isValid:e,errors:t}=Qm(i,{t:s});return c(t),e})())try{const{user:e,error:t,message:a}=await p(i.email,i.password);t?c({general:t.message}):a?(h(i.email),u(!0),o({email:"",password:"",confirmPassword:""})):e&&r()}catch(t){c({general:s("signup.errors.unexpected")})}},x=()=>{r()},w=eh({formErrors:{},authError:g,generalError:l.general}),S=th(!!w,"banner");return d?(0,Ts.jsx)(nh,{email:m,onSuccess:x,onSwitchToLogin:a,onClose:r}):(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"text-center",children:[(0,Ts.jsx)("h2",{className:"text-2xl font-bold text-sky-300",children:s("signup.header.title")}),(0,Ts.jsx)("p",{className:"text-slate-400 mt-2",children:s("signup.header.subtitle")})]}),w&&(0,Ts.jsx)("div",{className:S.container,children:(0,Ts.jsx)("p",{className:S.text,children:w})}),(0,Ts.jsxs)("form",{onSubmit:b,className:"space-y-4",children:[(0,Ts.jsx)(Pd,{label:s("signup.form.emailLabel"),htmlFor:"email",error:l.email,children:(0,Ts.jsx)(Rc,{id:"email",type:"email",value:i.email,onChange:e=>y("email",e.target.value),placeholder:s("signup.form.emailPlaceholder"),disabled:f,className:th(!!l.email,"field").container})}),(0,Ts.jsxs)(Pd,{label:s("signup.form.passwordLabel"),htmlFor:"password",error:l.password,children:[(0,Ts.jsx)(Rc,{id:"password",type:"password",value:i.password,onChange:e=>y("password",e.target.value),placeholder:s("signup.form.passwordPlaceholder"),disabled:f,className:th(!!l.password,"field").container}),(0,Ts.jsx)("p",{className:"text-slate-500 text-xs mt-1",children:s("signup.form.passwordRequirements")})]}),(0,Ts.jsx)(Pd,{label:s("signup.form.confirmPasswordLabel"),htmlFor:"confirmPassword",error:l.confirmPassword,children:(0,Ts.jsx)(Rc,{id:"confirmPassword",type:"password",value:i.confirmPassword,onChange:e=>y("confirmPassword",e.target.value),placeholder:s("signup.form.confirmPasswordPlaceholder"),disabled:f,className:th(!!l.confirmPassword,"field").container})}),(0,Ts.jsx)(Lc,{type:"submit",onClick:b,variant:"primary",size:"lg",disabled:f,className:"w-full",children:s(f?"signup.form.submittingButton":"signup.form.submitButton")})]}),(0,Ts.jsx)("div",{className:"text-center",children:(0,Ts.jsxs)("div",{className:"text-slate-400 text-sm",children:[s("signup.links.hasAccount")," ",(0,Ts.jsx)("button",{type:"button",onClick:a,className:"text-sky-400 hover:text-sky-300 font-medium transition-colors",disabled:f,children:s("signup.links.signIn")})]})})]})}function sh(){const e=new URLSearchParams(window.location.search),t=e.get("access_token"),a=e.get("refresh_token"),n=e.get("type"),r=!(!t||!a||"recovery"!==n),s=e.get("code"),i=!!s;return{hasTokens:r||i,format:r?"tokens":i?"code":null,tokens:{accessToken:t,refreshToken:a,type:n},code:s}}function ih(){if("undefined"!==typeof window&&window.history&&window.history.replaceState){const e=new URL(window.location);e.searchParams.delete("access_token"),e.searchParams.delete("refresh_token"),e.searchParams.delete("type"),e.searchParams.delete("code"),window.history.replaceState({},document.title,e.toString())}}const oh="email",lh="update";function ch(t){let{onSwitchToLogin:a,onClose:r,initialEmail:s=""}=t;const{t:i}=xe("auth"),[o,l]=(0,e.useState)(s),[c,d]=(0,e.useState)(""),[u,m]=(0,e.useState)(""),[h,p]=(0,e.useState)(""),[f,g]=(0,e.useState)({}),[v,y]=(0,e.useState)(""),[b,x]=(0,e.useState)(oh),{resetPassword:w,verifyOtp:S,updatePassword:k,loading:N,authError:j,clearAuthError:T,user:A}=Cs();(0,e.useEffect)(()=>{const{hasTokens:e,format:t}=sh();e&&"tokens"===t&&(x(lh),ih())},[]),(0,e.useEffect)(()=>{s&&s!==o&&l(s)},[s,o]),(0,e.useEffect)(()=>{j&&T()},[o,c,u,h,j,T]),(0,e.useEffect)(()=>{(function(e){const{hasTokens:t}=sh();return t&&!!e})(A)&&(x(lh),ih())},[A]);const _=async e=>{if(e.preventDefault(),(()=>{const e={};return o.trim()?/\S+@\S+\.\S+/.test(o)||(e.email=i("auth:passwordReset.errors.emailInvalid")):e.email=i("auth:passwordReset.errors.emailRequired"),g(e),0===Object.keys(e).length})())try{const{error:e,message:t}=await w(o);e?g({general:e.message}):t&&y(t)}catch(t){g({general:i("auth:passwordReset.errors.unexpected")})}},C=async e=>{if(e.preventDefault(),(()=>{const{isValid:e,error:t}=$m(c,{t:i});return e?(g({}),!0):(g({code:t}),!1)})())try{const{user:e,error:t}=await S(o,c,"recovery");t?g({general:t.message}):e&&(x(lh),y(""),g({}))}catch(t){g({general:i("auth:passwordReset.errors.unexpected")})}},M=async e=>{if(e.preventDefault(),(()=>{const e={};return u.trim()?u.length<8&&(e.newPassword=i("auth:passwordReset.errors.newPasswordTooShort")):e.newPassword=i("auth:passwordReset.errors.newPasswordRequired"),h.trim()?u!==h&&(e.confirmPassword=i("auth:passwordReset.errors.passwordsMismatch")):e.confirmPassword=i("auth:passwordReset.errors.confirmPasswordRequired"),g(e),0===Object.keys(e).length})())try{const{error:e,message:t}=await k(u);if(e)g({general:e.message});else if(t){const e=i(A?"auth:passwordReset.update.success.messageWithUser":"auth:passwordReset.update.success.messageWithoutUser");y(e)}}catch(t){g({general:i("auth:passwordReset.errors.unexpected")})}},P=()=>f.general?f.general:j||null;return v?(0,Ts.jsxs)("div",{className:"space-y-6 text-center",children:[(0,Ts.jsxs)("div",{className:"text-center",children:[(0,Ts.jsx)("div",{className:"w-16 h-16 bg-emerald-600 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,Ts.jsx)("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,Ts.jsx)("h2",{className:"text-2xl font-bold text-sky-300",children:i(b===lh?"auth:passwordReset.update.success.title":"auth:passwordReset.code.success.title")}),(0,Ts.jsx)("p",{className:"text-slate-400 mt-2",children:v})]}),b!==lh&&(0,Ts.jsx)(Jc,{variant:"info",children:(0,Ts.jsxs)("div",{className:"space-y-2 text-sky-200 text-sm",children:[(0,Ts.jsxs)("p",{children:[i("auth:passwordReset.code.success.sentTo")," ",(0,Ts.jsx)("strong",{children:o})]}),(0,Ts.jsx)("p",{children:i("auth:passwordReset.code.success.instructions")}),(0,Ts.jsx)("p",{className:"text-slate-400",children:i("auth:passwordReset.code.success.spamNote")})]})}),b===lh?(0,Ts.jsxs)("div",{className:"space-y-3",children:[(0,Ts.jsx)(Lc,{onClick:A?r:a,variant:"primary",size:"lg",className:"w-full",children:i(A?"auth:passwordReset.update.success.continueButton":"auth:passwordReset.update.success.signInButton")}),(0,Ts.jsx)("button",{type:"button",onClick:r,className:"block text-slate-400 hover:text-slate-300 text-sm transition-colors mx-auto",children:i("auth:passwordReset.update.success.closeButton")})]}):(0,Ts.jsxs)("div",{className:"space-y-4",children:[P()&&(0,Ts.jsx)(Jc,{variant:"error",children:P()}),(0,Ts.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,Ts.jsxs)(Pd,{label:i("auth:passwordReset.code.form.codeLabel"),htmlFor:"reset-code",error:f.code,children:[(0,Ts.jsx)(Rc,{id:"reset-code",type:"text",inputMode:"numeric",pattern:"[0-9]*",value:c,onChange:e=>{let t=e.target.value.replace(/\D/g,"").slice(0,6);d(t),f.code&&g(e=>(0,n.A)((0,n.A)({},e),{},{code:null}))},placeholder:i("auth:passwordReset.code.form.codePlaceholder"),disabled:N,className:"text-center text-lg tracking-widest",error:!!f.code,maxLength:6,autoComplete:"one-time-code"}),(0,Ts.jsx)("p",{className:"text-slate-500 text-xs mt-1",children:i("auth:passwordReset.code.form.codeHint")})]}),(0,Ts.jsx)(Lc,{type:"submit",variant:"primary",size:"lg",disabled:N||6!==c.length,className:"w-full",children:i(N?"auth:passwordReset.code.form.submittingButton":"auth:passwordReset.code.form.submitButton")})]}),(0,Ts.jsxs)("div",{className:"text-center space-y-2",children:[(0,Ts.jsx)("button",{type:"button",onClick:()=>{y(""),l(""),d(""),g({}),x(oh)},className:"text-sky-400 hover:text-sky-300 text-sm transition-colors",disabled:N,children:i("auth:passwordReset.code.links.resend")}),(0,Ts.jsx)("button",{type:"button",onClick:r,className:"block text-slate-400 hover:text-slate-300 text-sm transition-colors mx-auto",children:i("auth:passwordReset.code.links.close")})]})]})]}):b===oh?(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"text-center",children:[(0,Ts.jsx)("h2",{className:"text-2xl font-bold text-sky-300",children:i("auth:passwordReset.email.header.title")}),(0,Ts.jsx)("p",{className:"text-slate-400 mt-2",children:i("auth:passwordReset.email.header.subtitle")})]}),P()&&(0,Ts.jsx)(Jc,{variant:"error",children:P()}),(0,Ts.jsxs)("form",{onSubmit:_,className:"space-y-4",children:[(0,Ts.jsx)(Pd,{label:i("auth:passwordReset.email.form.emailLabel"),htmlFor:"reset-email",error:f.email,children:(0,Ts.jsx)(Rc,{id:"reset-email",type:"email",value:o,onChange:e=>{l(e.target.value),f.email&&g(e=>(0,n.A)((0,n.A)({},e),{},{email:null}))},placeholder:i("auth:passwordReset.email.form.emailPlaceholder"),disabled:N,error:!!f.email})}),(0,Ts.jsx)(Lc,{type:"submit",variant:"primary",size:"lg",disabled:N,className:"w-full",children:i(N?"auth:passwordReset.email.form.submittingButton":"auth:passwordReset.email.form.submitButton")})]}),(0,Ts.jsxs)(Xc,{children:[(0,Ts.jsx)("h4",{className:"text-slate-300 font-medium mb-2",children:i("auth:passwordReset.email.info.title")}),(0,Ts.jsx)("ul",{className:"text-slate-400 text-sm space-y-1",children:i("auth:passwordReset.email.info.steps",{returnObjects:!0}).map((e,t)=>(0,Ts.jsxs)("li",{children:["\u2022 ",e]},t))})]}),(0,Ts.jsx)("div",{className:"text-center",children:(0,Ts.jsx)("button",{type:"button",onClick:a,className:"text-sky-400 hover:text-sky-300 text-sm transition-colors",disabled:N,children:i("auth:passwordReset.email.links.backToLogin")})})]}):b===lh?(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"text-center",children:[(0,Ts.jsx)("div",{className:"w-16 h-16 bg-emerald-600 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,Ts.jsx)("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,Ts.jsx)("h2",{className:"text-2xl font-bold text-sky-300",children:i("auth:passwordReset.update.header.title")}),(0,Ts.jsx)("p",{className:"text-slate-400 mt-2",children:i("auth:passwordReset.update.header.subtitle")})]}),P()&&(0,Ts.jsx)(Jc,{variant:"error",children:P()}),(0,Ts.jsxs)("form",{onSubmit:M,className:"space-y-4",children:[(0,Ts.jsx)(Pd,{label:i("auth:passwordReset.update.form.newPasswordLabel"),htmlFor:"new-password",error:f.newPassword,children:(0,Ts.jsx)(Rc,{id:"new-password",type:"password",value:u,onChange:e=>{m(e.target.value),f.newPassword&&g(e=>(0,n.A)((0,n.A)({},e),{},{newPassword:null}))},placeholder:i("auth:passwordReset.update.form.newPasswordPlaceholder"),disabled:N,error:!!f.newPassword})}),(0,Ts.jsx)(Pd,{label:i("auth:passwordReset.update.form.confirmPasswordLabel"),htmlFor:"confirm-password",error:f.confirmPassword,children:(0,Ts.jsx)(Rc,{id:"confirm-password",type:"password",value:h,onChange:e=>{p(e.target.value),f.confirmPassword&&g(e=>(0,n.A)((0,n.A)({},e),{},{confirmPassword:null}))},placeholder:i("auth:passwordReset.update.form.confirmPasswordPlaceholder"),disabled:N,error:!!f.confirmPassword})}),(0,Ts.jsx)(Lc,{type:"submit",variant:"primary",size:"lg",disabled:N,className:"w-full",children:i(N?"auth:passwordReset.update.form.submittingButton":"auth:passwordReset.update.form.submitButton")})]}),(0,Ts.jsxs)(Xc,{children:[(0,Ts.jsx)("h4",{className:"text-slate-300 font-medium mb-2",children:i("auth:passwordReset.update.requirements.title")}),(0,Ts.jsx)("ul",{className:"text-slate-400 text-sm space-y-1",children:i("auth:passwordReset.update.requirements.items",{returnObjects:!0}).map((e,t)=>(0,Ts.jsxs)("li",{children:["\u2022 ",e]},t))})]})]}):null}const dh={LOGIN:"login",SIGNUP:"signup",RESET:"reset",VERIFY:"verify"};function uh(t){let{isOpen:a,onClose:n,initialMode:r=dh.LOGIN,initialEmail:s=""}=t;const{t:i}=xe("auth"),[o,l]=(0,e.useState)(r),[c,d]=(0,e.useState)(s),[u,m]=(0,e.useState)("");if((0,e.useEffect)(()=>{a&&l(r)},[a,r]),(0,e.useEffect)(()=>{s&&d(s)},[s]),(0,e.useEffect)(()=>{a||d("")},[a]),!a)return null;const h=function(){d(arguments.length>0&&void 0!==arguments[0]?arguments[0]:""),l(dh.RESET)},p=()=>{d(""),l(dh.LOGIN)},f=()=>{d(""),l(dh.SIGNUP)},g=function(){m(arguments.length>0&&void 0!==arguments[0]?arguments[0]:""),l(dh.VERIFY)},v=o===dh.LOGIN?i("authModal.titles.login"):o===dh.SIGNUP?i("authModal.titles.signup"):o===dh.RESET?i("authModal.titles.reset"):i("authModal.titles.verify");return(0,Ts.jsx)(Mc,{title:v,onClose:n,className:"max-h-[90vh] overflow-y-auto",children:(()=>{switch(o){case dh.LOGIN:return(0,Ts.jsx)(ah,{onSwitchToSignup:f,onSwitchToReset:h,onSwitchToVerify:g,onClose:n,initialEmail:c});case dh.SIGNUP:return(0,Ts.jsx)(rh,{onSwitchToLogin:p,onClose:n});case dh.RESET:return(0,Ts.jsx)(ch,{onSwitchToLogin:p,onClose:n,initialEmail:c});case dh.VERIFY:return(0,Ts.jsx)(nh,{email:u,onSuccess:n,onSwitchToLogin:p,onClose:n});default:return null}})()})}function mh(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dh.LOGIN;const[a,n]=(0,e.useState)(!1),[r,s]=(0,e.useState)(t),[i,o]=(0,e.useState)(""),l=function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";s(arguments.length>0&&void 0!==arguments[0]?arguments[0]:t),o(e),n(!0)};return{isOpen:a,mode:r,initialEmail:i,openModal:l,closeModal:()=>{n(!1),o("")},switchMode:e=>{s(e)},openLogin:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return l(dh.LOGIN,e)},openSignup:()=>l(dh.SIGNUP),openReset:()=>l(dh.RESET)}}function hh(e){const t=mh();return e||t}function ph(e){let{onSignIn:t,onSignUp:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{handleSignIn:()=>{e.openLogin(),null===t||void 0===t||t()},handleSignUp:()=>{e.openSignup(),null===a||void 0===a||a()}}}function fh(e){let{authModal:t,variant:a="inline",signInText:n,signUpText:r,onSignIn:s,onSignUp:i,className:o=""}=e;const{t:l}=xe("auth"),c=hh(t),{handleSignIn:d,handleSignUp:u}=ph(c,{onSignIn:s,onSignUp:i}),m=n||l("authButtons.signIn"),h=r||l("authButtons.createAccount");return"stacked"===a?(0,Ts.jsxs)("div",{className:"space-y-3 ".concat(o),children:[(0,Ts.jsx)(Lc,{onClick:u,variant:"primary",size:"lg",className:"w-full",children:h}),(0,Ts.jsx)(Lc,{onClick:d,variant:"secondary",size:"lg",className:"w-full",children:m})]}):"compact"===a?(0,Ts.jsxs)("div",{className:"flex gap-2 ".concat(o),children:[(0,Ts.jsx)(Lc,{onClick:d,variant:"secondary",size:"sm",children:m}),(0,Ts.jsx)(Lc,{onClick:u,variant:"primary",size:"sm",children:h})]}):(0,Ts.jsxs)("div",{className:"flex gap-3 justify-center ".concat(o),children:[(0,Ts.jsx)(Lc,{onClick:d,variant:"secondary",size:"sm",children:m}),(0,Ts.jsx)(Lc,{onClick:u,variant:"primary",size:"sm",children:h})]})}function gh(e){let{feature:t,description:a,requireProfile:n=!1,title:r,benefits:s=[],variant:i="card",icon:o,authModal:l}=e;const{t:c}=xe("auth"),d=hh(l),u=t||c("anonymousAlert.defaultFeature"),m=a||c("anonymousAlert.defaultDescription"),h=[c("anonymousAlert.defaultBenefits.saveData"),c("anonymousAlert.defaultBenefits.accessHistory"),c("anonymousAlert.defaultBenefits.manageTeams"),c("anonymousAlert.defaultBenefits.neverLose")],p=s.length>0?s:h,f=r||(n?c("anonymousAlert.completeProfile"):c("anonymousAlert.signInToUse",{feature:u}));return"minimal"===i?(0,Ts.jsxs)("div",{className:"text-center py-2",children:[(0,Ts.jsx)("p",{className:"text-slate-400 text-sm mb-3",children:m}),(0,Ts.jsx)(fh,{authModal:d,variant:"compact",signUpText:c("anonymousAlert.signUpButton"),className:"justify-center"})]}):"inline"===i?(0,Ts.jsx)(Xc,{variant:"highlighted",children:(0,Ts.jsxs)("div",{className:"flex items-start space-x-3",children:[o||(0,Ts.jsx)("div",{className:"w-10 h-10 bg-sky-600 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,Ts.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,Ts.jsxs)("div",{className:"flex-1",children:[(0,Ts.jsx)("h3",{className:"font-semibold text-sky-300 text-sm",children:f}),(0,Ts.jsx)("p",{className:"text-slate-400 text-sm mt-1",children:m}),(0,Ts.jsx)("div",{className:"mt-3",children:(0,Ts.jsx)(fh,{authModal:d,variant:"compact",signUpText:c("anonymousAlert.createAccountButton")})})]})]})}):(0,Ts.jsx)(Xc,{padding:"lg",children:(0,Ts.jsxs)("div",{className:"text-center",children:[(0,Ts.jsx)("div",{className:"mx-auto w-16 h-16 bg-sky-600 rounded-full flex items-center justify-center mb-4",children:o||(0,Ts.jsx)("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n?(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"}):(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,Ts.jsx)("h2",{className:"text-xl font-bold text-sky-300 mb-2",children:f}),(0,Ts.jsx)("p",{className:"text-slate-400 mb-6",children:m}),p.length>0&&(0,Ts.jsxs)("div",{className:"bg-slate-800 rounded-lg p-4 mb-6",children:[(0,Ts.jsx)("h3",{className:"text-sm font-semibold text-slate-300 mb-3",children:c("anonymousAlert.benefitsTitle")}),(0,Ts.jsx)("ul",{className:"space-y-2 text-sm text-slate-400",children:p.map((e,t)=>(0,Ts.jsxs)("li",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)("svg",{className:"w-4 h-4 text-emerald-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,Ts.jsx)("span",{children:e})]},t))})]}),(0,Ts.jsx)(fh,{authModal:d,variant:"stacked",signUpText:c("anonymousAlert.createFreeAccountButton")}),(0,Ts.jsx)("p",{className:"text-xs text-slate-500 mt-4",children:c("anonymousAlert.finePrint")})]})})}function vh(t){let{children:a,feature:n,description:r,onAuthRequired:s,showPreview:i=!1,preview:o,actionText:l,inline:c=!1,compact:d=!1,authModal:u}=t;const{t:m}=xe("auth"),{isAuthenticated:h,loading:p}=Cs(),f=hh(u),[g,v]=(0,e.useState)(!1),y=n||m("featureGate.defaultFeature"),b=r||m("featureGate.defaultDescription"),x=l||m("featureGate.defaultActionText");if(p)return(0,Ts.jsx)("div",{className:"flex items-center justify-center p-2",children:(0,Ts.jsx)("div",{className:"text-slate-400 text-sm",children:m("featureGate.loading")})});if(h)return a;s&&!g&&s();return g?(0,Ts.jsxs)("div",{className:"space-y-4",children:[o&&(0,Ts.jsxs)("div",{className:"relative",children:[(0,Ts.jsx)("div",{className:"opacity-50 pointer-events-none",children:o}),(0,Ts.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-800 to-transparent"})]}),(0,Ts.jsx)(gh,{feature:y,description:b,variant:c?"inline":"card",authModal:f})]}):d?(0,Ts.jsxs)(Xc,{variant:"dark",padding:"sm",className:"flex items-center justify-between",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ts.jsx)("div",{className:"w-8 h-8 bg-sky-600 rounded-lg flex items-center justify-center",children:(0,Ts.jsx)("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("p",{className:"text-slate-300 text-sm font-medium",children:m("featureGate.signInRequired")}),(0,Ts.jsx)("p",{className:"text-slate-400 text-xs",children:b})]})]}),(0,Ts.jsx)(fh,{authModal:f,variant:"compact",signUpText:m("featureGate.signUp")})]}):(0,Ts.jsxs)("div",{className:"space-y-4",children:[i&&o&&(0,Ts.jsxs)("div",{className:"relative",children:[(0,Ts.jsx)("div",{className:"opacity-30 pointer-events-none select-none",children:o}),(0,Ts.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-slate-800 via-slate-800/70 to-transparent"}),(0,Ts.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,Ts.jsxs)("div",{className:"bg-slate-900/90 backdrop-blur-sm rounded-lg p-4 border border-slate-600 max-w-sm text-center",children:[(0,Ts.jsx)("div",{className:"w-10 h-10 bg-sky-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:(0,Ts.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,Ts.jsx)("h3",{className:"font-semibold text-sky-300 text-sm mb-2",children:m("featureGate.unlock",{feature:y})}),(0,Ts.jsx)("p",{className:"text-slate-400 text-xs mb-4",children:b}),(0,Ts.jsx)(fh,{authModal:f,variant:"compact",signUpText:m("featureGate.signUp"),className:"grid grid-cols-2 gap-2"})]})})]}),!i&&(0,Ts.jsxs)(Xc,{variant:"dark",padding:"lg",className:"text-center",children:[(0,Ts.jsx)("div",{className:"w-12 h-12 bg-sky-600 rounded-lg flex items-center justify-center mx-auto mb-4",children:(0,Ts.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,Ts.jsx)("h3",{className:"font-semibold text-sky-300 mb-2",children:x}),(0,Ts.jsx)("p",{className:"text-slate-400 text-sm mb-4",children:b}),(0,Ts.jsx)(fh,{authModal:f,variant:"inline"}),(0,Ts.jsx)("button",{onClick:()=>{v(!0)},className:"text-sky-400 hover:text-sky-300 text-xs mt-3 transition-colors",children:m("featureGate.learnMore")})]})]})}const yh=fc("sword",[["path",{d:"m11 19-6-6",key:"s7kpr"}],["path",{d:"m5 21-2-2",key:"1kw20b"}],["path",{d:"m8 16-4 4",key:"1oqv8h"}],["path",{d:"M9.5 17.5 21 6V3h-3L6.5 14.5",key:"pkxemp"}]]),bh=fc("hand",[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]]),xh=fc("arrow-down-up",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"m21 8-4-4-4 4",key:"1c9v7m"}],["path",{d:"M17 4v16",key:"7dpous"}]]),wh=a.p+"static/media/full-field-perspective.491cc468e78065fb33e7.png";function Sh(e){let{formation:t,className:a=""}=e;const{t:n}=xe("configuration");if(!t)return null;const r=(()=>{switch(t){case xi.FORMATIONS.FORMATION_2_2:return{name:n("formationPreview.formations.2-2.name"),description:n("formationPreview.formations.2-2.description"),positions:[{name:n("formationPreview.positions.leftAttacker"),icon:yh,x:38,y:25,color:"text-blue-400"},{name:n("formationPreview.positions.rightAttacker"),icon:yh,x:62,y:25,color:"text-blue-400"},{name:n("formationPreview.positions.leftDefender"),icon:dd,x:35,y:55,color:"text-blue-400"},{name:n("formationPreview.positions.rightDefender"),icon:dd,x:65,y:55,color:"text-blue-400"},{name:n("formationPreview.positions.goalie"),icon:bh,x:50,y:88,color:"text-blue-400"}],roles:[{role:n("formationPreview.roles.defenders"),count:2,color:"text-blue-400"},{role:n("formationPreview.roles.attackers"),count:2,color:"text-red-400"}]};case xi.FORMATIONS.FORMATION_1_2_1:return{name:n("formationPreview.formations.1-2-1.name"),description:n("formationPreview.formations.1-2-1.description"),positions:[{name:n("formationPreview.positions.attacker"),icon:yh,x:50,y:20,color:"text-blue-400"},{name:n("formationPreview.positions.leftMid"),icon:xh,x:30,y:45,color:"text-blue-400"},{name:n("formationPreview.positions.rightMid"),icon:xh,x:70,y:45,color:"text-blue-400"},{name:n("formationPreview.positions.defender"),icon:dd,x:50,y:65,color:"text-blue-400"},{name:n("formationPreview.positions.goalie"),icon:bh,x:50,y:88,color:"text-blue-400"}],roles:[{role:n("formationPreview.roles.defender"),count:1,color:"text-blue-400"},{role:n("formationPreview.roles.midfielders"),count:2,color:"text-yellow-400"},{role:n("formationPreview.roles.attacker"),count:1,color:"text-red-400"}]};case xi.FORMATIONS.FORMATION_2_2_2:return{name:n("formationPreview.formations.2-2-2.name"),description:n("formationPreview.formations.2-2-2.description"),positions:[{name:n("formationPreview.positions.leftAttacker"),icon:yh,x:38,y:18,color:"text-blue-400"},{name:n("formationPreview.positions.rightAttacker"),icon:yh,x:62,y:18,color:"text-blue-400"},{name:n("formationPreview.positions.leftMidfielder"),icon:xh,x:35,y:40,color:"text-blue-400"},{name:n("formationPreview.positions.rightMidfielder"),icon:xh,x:65,y:40,color:"text-blue-400"},{name:n("formationPreview.positions.leftDefender"),icon:dd,x:32,y:62,color:"text-blue-400"},{name:n("formationPreview.positions.rightDefender"),icon:dd,x:68,y:62,color:"text-blue-400"},{name:n("formationPreview.positions.goalie"),icon:bh,x:50,y:88,color:"text-blue-400"}],roles:[{role:n("formationPreview.roles.defenders"),count:2,color:"text-blue-400"},{role:n("formationPreview.roles.midfielders"),count:2,color:"text-yellow-400"},{role:n("formationPreview.roles.attackers"),count:2,color:"text-red-400"}]};case xi.FORMATIONS.FORMATION_2_3_1:return{name:n("formationPreview.formations.2-3-1.name"),description:n("formationPreview.formations.2-3-1.description"),positions:[{name:n("formationPreview.positions.attacker"),icon:yh,x:50,y:18,color:"text-blue-400"},{name:n("formationPreview.positions.leftMidfielder"),icon:xh,x:32,y:38,color:"text-blue-400"},{name:n("formationPreview.positions.centerMidfielder"),icon:xh,x:50,y:42,color:"text-blue-400"},{name:n("formationPreview.positions.rightMidfielder"),icon:xh,x:68,y:38,color:"text-blue-400"},{name:n("formationPreview.positions.leftDefender"),icon:dd,x:35,y:63,color:"text-blue-400"},{name:n("formationPreview.positions.rightDefender"),icon:dd,x:65,y:63,color:"text-blue-400"},{name:n("formationPreview.positions.goalie"),icon:bh,x:50,y:88,color:"text-blue-400"}],roles:[{role:n("formationPreview.roles.defenders"),count:2,color:"text-blue-400"},{role:n("formationPreview.roles.midfielders"),count:3,color:"text-yellow-400"},{role:n("formationPreview.roles.attacker"),count:1,color:"text-red-400"}]};default:return null}})();return r?(0,Ts.jsxs)(Xc,{variant:"dark",className:a,children:[(0,Ts.jsxs)("div",{className:"mb-3",children:[(0,Ts.jsx)("h4",{className:"text-sm font-medium text-sky-200 mb-1",children:r.name}),(0,Ts.jsx)("p",{className:"text-xs text-slate-400",children:r.description})]}),(0,Ts.jsx)("div",{className:"relative rounded-md border border-sky-700 bg-center bg-no-repeat aspect-[15/6] sm:aspect-[15/6] md:aspect-[15/6]",style:{backgroundImage:"url(".concat(wh,")"),backgroundSize:"100% auto"},children:r.positions.map((e,t)=>{const a=e.icon;return(0,Ts.jsxs)("div",{className:"absolute transform -translate-x-1/2 -translate-y-1/2 group",style:{left:"".concat(e.x,"%"),top:"".concat(e.y,"%")},children:[(0,Ts.jsx)("div",{className:"w-6 h-6 rounded-full bg-slate-700 border-2 border-slate-500 flex items-center justify-center ".concat(e.color," transition-all group-hover:scale-110"),children:(0,Ts.jsx)(a,{className:"w-3 h-3"})}),(0,Ts.jsx)("div",{className:"absolute top-7 left-1/2 transform -translate-x-1/2 bg-slate-900 px-1 py-0.5 rounded text-xs text-slate-300 whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity z-10",children:e.name})]},t)})}),(0,Ts.jsx)("div",{className:"flex justify-between text-xs"})]}):null}const kh=fc("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);function Nh(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{t:n}=xe("common"),r="number"===typeof a.limit&&a.limit>0?a.limit:100,[s,i]=(0,e.useState)([]),[o,l]=(0,e.useState)(!1),[c,d]=(0,e.useState)(null),u=(0,e.useRef)(null),m=(0,e.useRef)(0),h=(0,e.useCallback)(async e=>{m.current+=1;const t=m.current;if(!e)return i([]),d(null),void l(!1);l(!0),d(null);const a=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a="number"===typeof t.limit&&t.limit>0?t.limit:100;if(!e)return{success:!0,names:[]};try{const{data:t,error:n}=await Ur.from("match").select("opponent, started_at").eq("team_id",e).not("opponent","is",null).neq("opponent","").is("deleted_at",null).order("started_at",{ascending:!1}).limit(a);if(n)return console.error("Failed to load opponent name history:",n),{success:!1,names:[],error:"Failed to load opponent history."};const r=new Set,s=[];return(t||[]).forEach(e=>{const t=null!==e&&void 0!==e&&e.opponent?String(e.opponent).trim():"";if(!t)return;const a=t.toLowerCase();r.has(a)||(r.add(a),s.push(t))}),{success:!0,names:s}}catch(n){return console.error("Unexpected error retrieving opponent history:",n),{success:!1,names:[],error:"Unexpected error loading opponent history."}}}(e,{limit:r});m.current===t&&(a.success?i(a.names):(d(a.error||n("errors.failedToLoadOpponentNames")),i([])),l(!1))},[r,n]);(0,e.useEffect)(()=>{t!==u.current&&(u.current=t,h(t))},[t,h]);return{names:s,loading:o,error:c,refresh:(0,e.useCallback)(()=>t?h(t):Promise.resolve(),[t,h])}}function jh(t){let{teamId:a,value:n,onChange:r,onSelect:s,placeholder:i,disabled:o=!1,inputId:l}=t;const{t:c}=xe("configuration"),{names:d,loading:u,error:m}=Nh(a),{isOpen:h,setIsOpen:p,query:f,setQuery:g,containerRef:v,inputRef:y,handleFocus:b,handleBlur:x,handleKeyDown:w}=su({initialValue:n||""}),[S,k]=(0,e.useState)(-1),N=(0,e.useMemo)(()=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n="number"===typeof a.limit&&a.limit>0?a.limit:8,r=t.trim().toLowerCase();if(!r)return[];const s=new Set,i=[],o=[];return e.forEach(e=>{if(!e)return;const t=String(e).trim();if(!t)return;const a=t.toLowerCase();return s.has(a)?void 0:a.startsWith(r)?(i.push(t),void s.add(a)):void(a.includes(r)&&(o.push(t),s.add(a)))}),[...i,...o].slice(0,n)}(d,f,{limit:8}),[d,f]),j=h&&N.length>0,T=h&&!u&&f.trim().length>0&&0===N.length;(0,e.useEffect)(()=>{h||k(-1)},[h]),(0,e.useEffect)(()=>{j||-1===S?j&&S>=N.length&&k(N.length>0?N.length-1:-1):k(-1)},[N.length,S,j]);const A=(0,e.useCallback)(e=>{const t=e.target.value;g(t),null===r||void 0===r||r(t),p(t.trim().length>0),k(-1)},[r,g,p]),_=(0,e.useCallback)(e=>{b(e),!h&&f.trim()&&p(!0)},[b,f,h,p]),C=(0,e.useCallback)(e=>{g(e),p(!1),k(-1),s?s(e):null===r||void 0===r||r(e)},[s,r,g,p]),M=(0,e.useCallback)(e=>"ArrowDown"===e.key?0===N.length?void w(e):(e.preventDefault(),p(!0),void k(e=>e<0||e>=N.length-1?0:e+1)):"ArrowUp"===e.key?0===N.length?void w(e):(e.preventDefault(),p(!0),void k(e=>e<=0?N.length-1:e-1)):"Enter"===e.key&&h&&S>=0&&S<N.length?(e.preventDefault(),void C(N[S])):void w(e),[N,C,w,S,h,p]);return(0,Ts.jsxs)("div",{ref:v,className:"relative",children:[(0,Ts.jsxs)("div",{className:"relative",children:[(0,Ts.jsx)(Rc,{ref:y,id:l,value:f,onChange:A,onFocus:_,onBlur:x,onKeyDown:M,placeholder:i||c("matchDetails.opponentPlaceholder"),maxLength:50,disabled:o,"aria-autocomplete":"list","aria-expanded":j,"aria-activedescendant":S>=0?"".concat(l||"opponentTeam","-option-").concat(S):void 0,autoComplete:"off"}),(0,Ts.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:u?(0,Ts.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-sky-400 border-t-transparent rounded-full"}):(0,Ts.jsx)(ru,{className:"h-4 w-4 text-slate-400"})})]}),m&&(0,Ts.jsx)("p",{className:"mt-1 text-xs text-rose-300",children:m}),j&&(0,Ts.jsx)("div",{className:"absolute z-10 mt-1 w-full bg-slate-700 border border-slate-500 rounded-md shadow-lg max-h-56 overflow-auto",role:"listbox","aria-label":c("matchDetails.opponentSuggestions.ariaLabel"),children:N.map((e,t)=>{const a=t===S,n="".concat(l||"opponentTeam","-option-").concat(t);return(0,Ts.jsx)("button",{type:"button",id:n,className:"w-full px-3 py-2 text-left transition-colors border-b border-slate-600 last:border-b-0 hover:bg-slate-600 focus:bg-slate-600 focus:outline-none ".concat(a?"bg-sky-600 text-white":""),onMouseDown:e=>e.preventDefault(),onClick:()=>C(e),onMouseEnter:()=>k(t),role:"option","aria-selected":a,children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(kh,{className:"h-4 w-4 text-sky-300 flex-shrink-0"}),(0,Ts.jsx)("span",{className:"text-slate-100",children:e})]})},e.toLowerCase())})}),T&&(0,Ts.jsx)("div",{className:"absolute z-10 mt-1 w-full bg-slate-700 border border-slate-500 rounded-md shadow-lg p-3 text-slate-300 text-sm",children:c("matchDetails.opponentSuggestions.noMatches",{query:f})})]})}const Th=fc("log-in",[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]]),Ah=fc("thumbs-up",[["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}],["path",{d:"M7 10v12",key:"1qc93n"}]]),_h=e=>{let{isOpen:t,onClose:a,onConfirm:n,featureName:r,loading:s=!1,error:i=null,successMessage:o=null,infoMessage:l=null,isAuthenticated:c=!1,authModal:d=null,children:u}=e;const{t:m}=xe("modals");if(!t)return null;const h=o||l?kd:i?lu:ym,p=o?"emerald":l?"sky":i?"rose":"sky",f=m(o?"featureVote.voteRecorded":l?"featureVote.voteAlreadyRecorded":i?"featureVote.voteFailed":"featureVote.featureComingSoon");return(0,Ts.jsxs)(Mc,{title:f,icon:h,iconColor:p,onClose:a,children:[o?(0,Ts.jsx)("p",{className:"text-emerald-100 mb-4",children:o}):l?(0,Ts.jsx)("p",{className:"text-sky-100 mb-4",children:l}):i?(0,Ts.jsx)("p",{className:"text-rose-100 mb-4",children:i}):(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("p",{className:"text-slate-300 mb-4",children:m("featureVote.featureDescription",{featureName:r})}),(0,Ts.jsx)("div",{className:"text-xs text-slate-400 mb-6",children:u})]}),(0,Ts.jsxs)("div",{className:"flex justify-end space-x-3 mt-2",children:[(0,Ts.jsx)(Lc,{onClick:a,variant:"secondary",children:m(o||l?"featureVote.close":"featureVote.cancel")}),!o&&!l&&(0,Ts.jsx)(Ts.Fragment,{children:c?(0,Ts.jsx)(Lc,{onClick:n,Icon:s?void 0:Ah,disabled:s,children:s?m("featureVote.submitting"):m("featureVote.voteFor",{featureName:r})}):(0,Ts.jsx)(Lc,{onClick:()=>{var e;d&&(null===(e=d.current)||void 0===e||e.showModal())},Icon:Th,children:m("featureVote.signInToVote")})})]})]})};async function Ch(e){try{if(!e)return{shouldShow:!1,pendingMatches:[]};const{data:t,error:a}=await Ur.from("match").select("*").eq("team_id",e).is("deleted_at",null).eq("state","pending").order("created_at",{ascending:!1});if(a)return console.warn("\u26a0\ufe0f Failed to check for pending matches:",a),{shouldShow:!1,pendingMatches:[]};const r=(null===t||void 0===t?void 0:t.filter(e=>e.initial_config&&Object.keys(e.initial_config).length>0))||[],s=r.length>0;if(!s)return{shouldShow:s,pendingMatches:[]};const i=Array.from(new Set(r.map(e=>e.created_by).filter(Boolean)));let o=new Map;if(i.length>0){const{data:e,error:t}=await Ur.from("user_profile").select("id, name").in("id",i);t?console.warn("\u26a0\ufe0f Failed to fetch creator profiles for pending matches:",t):null!==e&&void 0!==e&&e.length&&(o=new Map(e.map(e=>[e.id,e.name])))}return{shouldShow:s,pendingMatches:r.map(e=>{const t=o.get(e.created_by)||null;return(0,n.A)((0,n.A)({},e),{},{created_by_profile:t?{id:e.created_by,name:t}:null,creatorName:t})})}}catch(t){return console.error("\u274c Exception while checking for pending matches:",t),{shouldShow:!1,pendingMatches:[]}}}function Mh(e){try{var t,a,n,r,s,i;if(!function(e){if(!e||"object"!==typeof e)return!1;const t=["teamConfig","matchConfig","squadSelection"];for(const s of t)if(!e[s])return!1;const{teamConfig:a}=e;if(!a.formation||!a.squadSize)return!1;const{matchConfig:n}=e;if(!n.format||!n.periods||!n.periodDurationMinutes)return!1;const{squadSelection:r}=e;return!(!Array.isArray(r)||0===r.length)}(e))return console.warn("\u26a0\ufe0f Invalid pending match config, cannot create resume data"),null;const o=e.teamConfig||{};return{squadSelection:e.squadSelection||[],periods:(null===(t=e.matchConfig)||void 0===t?void 0:t.periods)||3,periodDurationMinutes:(null===(a=e.matchConfig)||void 0===a?void 0:a.periodDurationMinutes)||15,opponentTeam:(null===(n=e.matchConfig)||void 0===n?void 0:n.opponentTeam)||"",matchType:(null===(r=e.matchConfig)||void 0===r?void 0:r.matchType)||"league",venueType:(null===(s=e.matchConfig)||void 0===s?void 0:s.venueType)||Fs.DEFAULT_VENUE_TYPE,captainId:(null===(i=e.matchConfig)||void 0===i?void 0:i.captainId)||null,teamConfig:o,formation:o.formation||"2-2",formationData:e.formation||(0,wi.getInitialFormationTemplate)(o),periodGoalies:e.periodGoalies||{}}}catch(o){return console.error("\u274c Failed to create resume data:",o),null}}function Ph(t){let{isOpen:a,onClose:n,onResume:r,onDiscard:s,pendingMatches:i=[],isLoading:o=!1,error:l=""}=t;const{t:c}=xe(["modals","configuration"]),[d,u]=(0,e.useState)(null),[m,h]=(0,e.useState)(null);if(!a)return null;const p=()=>{o||d||m||n()},f=e=>{const t=new Date(e),a=t.toLocaleDateString(),n=t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return c("pendingMatchResume.dateAtTime",{date:a,time:n})};return(0,Ts.jsxs)(Mc,{title:c("pendingMatchResume.title"),subtitle:0===i.length?c("pendingMatchResume.noMatchesFound"):c("pendingMatchResume.matchesFound",{count:i.length}),icon:Sd,iconColor:"blue",onClose:p,maxWidth:"lg",className:"max-h-[90vh] flex flex-col",children:[(0,Ts.jsxs)("div",{className:"flex-1 overflow-hidden flex flex-col -mb-6 -mx-6",children:[l&&(0,Ts.jsx)(Jc,{variant:"error",className:"mx-6 mt-6",children:l}),0===i.length&&!l&&(0,Ts.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center p-8 text-center",children:[(0,Ts.jsx)("div",{className:"w-16 h-16 bg-slate-700 rounded-full flex items-center justify-center mb-4",children:(0,Ts.jsx)(Sd,{className:"w-8 h-8 text-slate-400"})}),(0,Ts.jsx)("h3",{className:"text-lg font-medium text-slate-300 mb-2",children:c("pendingMatchResume.noPendingMatches")}),(0,Ts.jsx)("p",{className:"text-sm text-slate-400 mb-6 max-w-sm",children:c("pendingMatchResume.noPendingDescription")}),(0,Ts.jsx)(Lc,{onClick:p,variant:"accent",Icon:Xd,disabled:o,children:c("pendingMatchResume.continueToConfigureNew")})]}),i.length>0&&(0,Ts.jsx)("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:i.map(e=>{var t;const{initial_config:a,opponent:n,created_at:i,id:l,creatorName:p,created_by_profile:g}=e,v=(null===a||void 0===a?void 0:a.matchConfig)||{},y=(null===a||void 0===a?void 0:a.teamConfig)||{},b=p||(null===g||void 0===g?void 0:g.name)||null,x=n||v.opponentTeam||c("pendingMatchResume.unknownOpponent"),w=v.matchType||"match",S=v.periods||3,k=v.periodDurationMinutes||15,N=y.squadSize||(null===a||void 0===a||null===(t=a.squadSelection)||void 0===t?void 0:t.length)||0,j=y.formation||c("pendingMatchResume.unknownFormation");return(0,Ts.jsxs)("div",{className:"bg-slate-700 rounded-lg border border-slate-600 p-4 hover:bg-slate-650 transition-colors",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,Ts.jsxs)("h3",{className:"text-base font-medium text-slate-200 flex items-center space-x-2",children:[(0,Ts.jsx)(wd,{className:"w-4 h-4 text-slate-400"}),(0,Ts.jsx)("span",{children:c("pendingMatchResume.vsOpponent",{opponent:x})})]}),(0,Ts.jsxs)("div",{className:"flex flex-col items-end space-y-1 text-xs text-slate-400",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Ts.jsx)(Id,{className:"w-3 h-3"}),(0,Ts.jsx)("span",{children:f(i)})]}),b&&(0,Ts.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Ts.jsx)(Xu,{className:"w-3 h-3"}),(0,Ts.jsx)("span",{children:c("pendingMatchResume.createdBy",{name:b})})]})]})]}),(0,Ts.jsxs)("div",{className:"bg-slate-600 rounded-lg p-3 mb-4 space-y-2 text-sm",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("span",{className:"text-slate-400",children:c("pendingMatchResume.typeLabel")}),(0,Ts.jsx)("span",{className:"font-medium text-slate-200",children:c("configuration:matchTypes.".concat(w,".label"),w)})]}),(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("span",{className:"text-slate-400",children:c("pendingMatchResume.formatLabel")}),(0,Ts.jsx)("span",{className:"font-medium text-slate-200",children:c("pendingMatchResume.periodsFormat",{periods:S,duration:k})})]}),(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("span",{className:"text-slate-400",children:c("pendingMatchResume.squadLabel")}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Ts.jsx)(od,{className:"w-4 h-4 text-slate-400"}),(0,Ts.jsx)("span",{className:"font-medium text-slate-200",children:c("pendingMatchResume.squadInfo",{size:N,formation:j})})]})]})]}),(0,Ts.jsxs)("div",{className:"flex space-x-2",children:[(0,Ts.jsx)(Lc,{onClick:()=>(async e=>{if(!o&&!m){h(e);try{await r(e)}finally{h(null)}}})(l),variant:"accent",size:"sm",className:"flex-1 bg-emerald-600 hover:bg-emerald-700",disabled:o||d||m,Icon:m===l?void 0:kc,children:c(m===l?"pendingMatchResume.resuming":"pendingMatchResume.resumeSetup")}),(0,Ts.jsx)(Lc,{onClick:()=>(async e=>{if(!o&&!d){u(e);try{await s(e)}finally{u(null)}}})(l),variant:"danger",size:"sm",disabled:o||d||m,Icon:d===l?void 0:xd,children:c(d===l?"pendingMatchResume.deleting":"pendingMatchResume.delete")})]})]},l)})}),i.length>0&&(0,Ts.jsxs)("div",{className:"border-t border-slate-600 p-6 flex-shrink-0",children:[(0,Ts.jsxs)("div",{className:"flex space-x-3",children:[(0,Ts.jsx)(Lc,{onClick:p,variant:"accent",className:"flex-1",disabled:o||d||m,Icon:Xd,children:c("pendingMatchResume.configureNewMatch")}),(0,Ts.jsx)(Lc,{onClick:p,variant:"secondary",className:"px-6",disabled:o||d||m,children:c("pendingMatchResume.cancel")})]}),(0,Ts.jsx)("div",{className:"mt-4 p-2 bg-slate-700/50 rounded-lg",children:(0,Ts.jsx)("p",{className:"text-xs text-slate-400 text-center",children:(0,Ts.jsx)("strong",{children:c("pendingMatchResume.tip")})})})]})]}),o&&(0,Ts.jsx)("div",{className:"absolute inset-0 bg-slate-800 bg-opacity-75 flex items-center justify-center",children:(0,Ts.jsx)(Wd,{size:"md",message:c("pendingMatchResume.processing")})})]})}const Eh=5;async function Ih(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Eh;if(!e)throw new Error("Connector ID is required");const a=new Date,n=new Date(a);n.setDate(n.getDate()+t);const r=a.toISOString().split("T")[0],s=n.toISOString().split("T")[0],{data:i,error:o}=await Ur.from("upcoming_match").select("opponent, match_date").eq("connector_id",e).gte("match_date",r).lte("match_date",s).order("match_date",{ascending:!0});if(o)throw console.error("Failed to fetch upcoming matches for connector:",o),new Error("Failed to load upcoming matches");return i||[]}async function Rh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{lookaheadDays:a=Eh}=t;if(!e)return{opponent:null,reason:"missing-team"};try{const t=(await Bu(e)||[]).filter(e=>e.status===Pu);if(0===t.length)return{opponent:null,reason:"no-active-connector"};const r=await async function(e){if(!e)throw new Error("Team ID is required");const{data:t,error:a}=await Ur.from("match").select("opponent").eq("team_id",e).eq("state","pending").is("deleted_at",null);if(a)throw console.error("Failed to fetch pending matches for team:",a),new Error("Failed to load pending matches");return t||[]}(e);console.info("[OpponentPrefill] Pending matches for team %s: %o",e,(r||[]).map(e=>({opponent:e.opponent||null})));const s=new Set((r||[]).map(e=>(e.opponent||"").trim().toLowerCase()).filter(Boolean)),i=[];for(const e of t)try{const t=await Ih(e.id,a);console.info("[OpponentPrefill] Upcoming matches for connector %s within %d days: %o",e.id,a,t.map(e=>({opponent:e.opponent||null,matchDate:e.match_date}))),t.forEach(t=>{const a=(t.opponent||"").trim();if(!a)return;const n=a.toLowerCase();s.has(n)||i.push({connectorId:e.id,opponent:a,matchDate:t.match_date})})}catch(n){console.warn("Failed to load upcoming matches for connector during opponent suggestion:",n)}if(0===i.length)return{opponent:null,reason:"no-eligible-upcoming"};i.sort((e,t)=>new Date(e.matchDate)-new Date(t.matchDate));const o=i[0];return{opponent:o.opponent,connectorId:o.connectorId,matchDate:o.matchDate,reason:"matched"}}catch(n){return console.error("Failed to suggest upcoming opponent:",n),{opponent:null,reason:"error",error:n.message||"Failed to suggest opponent"}}}const Oh=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,Dh=e=>"string"===typeof e&&Oh.test(e),Fh=Bs(Br.TEAM_PREFERENCES_CACHE,{teamId:null,fetchedAt:0,preferences:{}}),Lh=Bs(Br.TEAM_MANAGEMENT_ACTIVE_TAB,{tab:Cm.OVERVIEW});function qh(t){var a,r,s;let{allPlayers:i,setAllPlayers:o,selectedSquadIds:l,setSelectedSquadIds:c,numPeriods:d,setNumPeriods:u,periodDurationMinutes:m,setPeriodDurationMinutes:h,periodGoalieIds:p,setPeriodGoalieIds:f,teamConfig:g,updateTeamConfig:v,selectedFormation:y,setSelectedFormation:b,updateFormationSelection:x,createTeamConfigFromSquadSize:w,formation:S,setFormation:k,alertMinutes:N,setAlertMinutes:j,handleStartPeriodSetup:T,handleSaveConfiguration:A,selectedSquadPlayers:_,opponentTeam:C,setOpponentTeam:M,matchType:P,setMatchType:E,venueType:I,setVenueType:R,captainId:O,setCaptain:D,debugMode:F=!1,authModal:L,syncPlayersFromTeamRoster:q,setCurrentMatchId:U,currentMatchId:B,setMatchCreated:G,hasActiveConfiguration:z,setHasActiveConfiguration:V,clearStoredState:H,configurationSessionId:K=0,resumeMatchId:W,onNavigateBack:Y,onNavigateTo:J,onOpenTemporaryPlayerModal:Q,pushNavigationState:$,removeFromNavigationStack:X}=t;const{t:Z}=xe(["configuration","common"]),[ee,te]=e.useState(!1),[ae,ne]=e.useState(null),[re,se]=e.useState({loading:!1,message:""}),[ie,oe]=e.useState({loading:!1,message:"",error:null}),[le,ce]=e.useState({isOpen:!1,title:"",message:""}),[de,ue]=(0,e.useState)(!1),[me,he]=(0,e.useState)([]),[pe,fe]=(0,e.useState)(!1),[ge,ve]=(0,e.useState)(!1),[ye,be]=(0,e.useState)(()=>{try{return"true"===sessionStorage.getItem("sport-wizard-pending-modal-closed")}catch(e){return!1}}),[we,Se]=(0,e.useState)(null),[ke,Ne]=(0,e.useState)(null),[je,Te]=(0,e.useState)(!1),[Ae,_e]=(0,e.useState)(null),[Ce,Me]=(0,e.useState)({}),[Pe,Ee]=(0,e.useState)({matchedConnections:new Map,unmatchedExternalPlayers:[],hasConnectedProvider:!1}),Ie=(null===g||void 0===g?void 0:g.format)||xi.FORMATS.FORMAT_5V5,Re=null!==I&&void 0!==I?I:Fs.DEFAULT_VENUE_TYPE,Oe=e.useMemo(()=>(0,xi.getMinimumPlayersForFormat)(Ie),[Ie]),De=e.useMemo(()=>(0,xi.getMaximumPlayersForFormat)(Ie),[Ie]),Fe=(null===(a=xi.FORMAT_CONFIGS[Ie])||void 0===a?void 0:a.label)||Ie,Le=l.length>=Oe,qe=l.length>De,Ue=Le&&!qe,Be=(0,e.useRef)(!1),Ge=(0,e.useRef)(!1),ze=(0,e.useRef)(!1),Ve=(0,e.useRef)(!1),He=(0,e.useRef)(null),Ke=(0,e.useRef)(K),We=(0,e.useRef)(!1),Ye=(0,e.useRef)(null),Je=(0,e.useRef)(null),Qe=(0,e.useRef)(!1),$e=(0,e.useRef)(null),Xe=(0,e.useRef)({status:"idle",appliedSessionId:null,pendingSessionId:null}),Ze=e.useCallback(e=>{Xe.current=(0,n.A)((0,n.A)({},Xe.current),e)},[]),et=e.useCallback(()=>{Xe.current={status:"idle",appliedSessionId:null,pendingSessionId:null}},[]),tt=e.useCallback(()=>{Ze({status:"applying"})},[Ze]),at=e.useCallback(e=>{const{pendingSessionId:t}=Xe.current;Ze({status:"idle",appliedSessionId:e,pendingSessionId:t===e?null:t})},[Ze]),nt=e.useCallback(e=>{Ze({appliedSessionId:e})},[Ze]),rt=e.useCallback(e=>{Ze({pendingSessionId:e})},[Ze]);e.useEffect(()=>()=>{Be.current=!1,Ge.current=!1,Ve.current=!1,ze.current=!1,et(),He.current&&(clearTimeout(He.current),He.current=null)},[et]);const{isAuthenticated:st,user:it,sessionDetectionResult:ot}=Cs(),{currentTeam:lt,teamPlayers:ct,hasTeams:dt,hasClubs:ut,loading:mt,loadTeamPreferences:ht}=vi(),pt=null===ot||void 0===ot?void 0:ot.type,ft=pt===hs,gt=e.useRef(mt),vt=e.useRef(z),yt=e.useRef(g),bt=e.useRef(l.length),xt=e.useRef((null===S||void 0===S?void 0:S.goalie)||null),wt=e.useRef(je);e.useEffect(()=>{gt.current=mt},[mt]),e.useEffect(()=>{vt.current=z},[z]),e.useEffect(()=>{yt.current=g},[g]),e.useEffect(()=>{bt.current=l.length},[l.length]),e.useEffect(()=>{xt.current=(null===S||void 0===S?void 0:S.goalie)||null},[null===S||void 0===S?void 0:S.goalie]),e.useEffect(()=>{wt.current=je},[je]),e.useEffect(()=>{null!==it&&void 0!==it&&it.id||be(!1)},[null===it||void 0===it?void 0:it.id]),e.useEffect(()=>($&&$(()=>{fe(!1),te(!1),Y()}),()=>{X&&X()}),[$,X,Y]),e.useEffect(()=>{let e=!0;return(async()=>{if(st&&null!==lt&&void 0!==lt&&lt.id)try{const t=new Date,a=new Date(t);a.setMonth(t.getMonth()-6);const n=await Zo(lt.id,a,t);if(!e)return;if(null!==n&&void 0!==n&&n.success&&Array.isArray(n.players)){const e={};n.players.forEach(t=>{t.id&&(e[t.id]=t.matchesAsCaptain||0)}),Me(e)}else null!==n&&void 0!==n&&n.error&&console.error("Failed to load captain history:",n.error),Me({})}catch(t){e&&Me({}),console.error("Captain history load error:",t)}else Me({})})(),()=>{e=!1}},[st,null===lt||void 0===lt?void 0:lt.id]);const St=e.useCallback(async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{t&&ve(!0),Se(null);const a=await Ch(e);a.shouldShow&&a.pendingMatches.length>0&&(he(a.pendingMatches),fe(!0))}catch(a){console.error("\u274c Failed to check for pending matches:",a),Se({message:Z("configuration:pendingMatch.errors.checkFailed"),detail:a.message,canRetry:!0})}finally{ve(!1)}},[Z]);e.useEffect(()=>{(null===ot||void 0===ot?void 0:ot.type)!==ms||null===lt||void 0===lt||!lt.id||mt||ye||setTimeout(()=>{St(lt.id,!1)},1500)},[ot,null===lt||void 0===lt?void 0:lt.id,mt,ye,St]);const kt=e.useCallback(()=>{null!==lt&&void 0!==lt&&lt.id&&St(lt.id,!0)},[null===lt||void 0===lt?void 0:lt.id,St]),Nt=e.useCallback(e=>{if(e)if(ge)Qe.current=!0;else{Qe.current=!1,Se(null),he([]),fe(!1),be(!1);try{sessionStorage.removeItem("sport-wizard-pending-modal-closed")}catch(t){}St(e,!0)}},[St,ge]),jt=e.useCallback(async e=>{if(!e||!ht)return null;const t=await ht(e,{forceRefresh:!0});return _e(t||null),t},[ht,_e]),Tt=e.useCallback(e=>{var t;if(!e||0===Object.keys(e).length)return;const a=yt.current,n=e.matchFormat,r=Object.values(xi.FORMATS).includes(n),s=(null===a||void 0===a?void 0:a.format)||xi.FORMATS.FORMAT_5V5,i=r?n:s,o=(0,xi.getMinimumPlayersForFormat)(i),l=(0,xi.getMaximumPlayersForFormat)(i),c=(null===a||void 0===a?void 0:a.squadSize)||bt.current||o,d=Math.min(Math.max(c,o),l),m=(0,xi.getValidFormations)(i,d),p=e.formation,f=(null===(t=xi.FORMAT_CONFIGS[i])||void 0===t?void 0:t.defaultFormation)||xi.FORMATIONS.FORMATION_2_2,g=p?xi.FORMATION_DEFINITIONS[p]:null,y=p&&m.includes(p)&&"coming-soon"!==(null===g||void 0===g?void 0:g.status)?p:f,x=(0,xi.createTeamConfig)(i,d,y);v(x),b(y);const w=(0,wi.getInitialFormationTemplate)(x,xt.current);w&&"function"===typeof k&&k(w),Zc.includes(e.numPeriods)&&u(e.numPeriods),ed.includes(e.periodLength)&&h(e.periodLength)},[v,b,k,u,h]),At=e.useCallback(async e=>{if(null===lt||void 0===lt||!lt.id)return;const t=()=>Ve.current||Ge.current||wt.current;if(Xe.current.appliedSessionId===e)return;if(gt.current||"applying"===Xe.current.status||t())return void rt(e);tt();let a=!0;try{const n=await jt(lt.id);if(t())return rt(e),void(a=!1);if(vt.current)return;Tt(n)}catch(n){console.error("Failed to apply team preferences:",n)}finally{a?at(e):Ze({status:"idle"});const t=Xe.current.pendingSessionId;t&&t!==e&&null!==lt&&void 0!==lt&&lt.id&&!gt.current&&(rt(null),At(t))}},[null===lt||void 0===lt?void 0:lt.id,jt,Tt,rt,tt,at,Ze]);e.useEffect(()=>{void 0!==K&&null!==K&&Ke.current!==K&&(Ke.current=K,$e.current=null,K&&(null!==lt&&void 0!==lt&&lt.id&&!mt?Nt(lt.id):We.current=!0))},[K,null===lt||void 0===lt?void 0:lt.id,mt,Nt]),e.useEffect(()=>{We.current&&null!==lt&&void 0!==lt&&lt.id&&!mt&&(We.current=!1,Nt(lt.id))},[null===lt||void 0===lt?void 0:lt.id,mt,Nt]),e.useEffect(()=>{if(void 0===K||null===K)return;if(!pt)return;const{appliedSessionId:e}=Xe.current;if(ft&&null===e)return nt(K),void rt(null);e!==K&&(null!==lt&&void 0!==lt&&lt.id&&!mt?At(K):rt(K))},[K,null===lt||void 0===lt?void 0:lt.id,mt,At,pt,ft,nt,rt]),e.useEffect(()=>{if(null===lt||void 0===lt||!lt.id||mt)return;const e=Xe.current.pendingSessionId;null!==e&&void 0!==e&&(Xe.current.appliedSessionId!==e?At(e):rt(null))},[null===lt||void 0===lt?void 0:lt.id,mt,At,rt]),e.useEffect(()=>{ge||Qe.current&&(Qe.current=!1,null!==lt&&void 0!==lt&&lt.id&&!mt?Nt(lt.id):We.current=!0)},[ge,null===lt||void 0===lt?void 0:lt.id,mt,Nt]);const _t=e.useCallback(()=>{fe(!1),be(!0),sessionStorage.setItem("sport-wizard-pending-modal-closed","true"),M(""),E("league"),R(Fs.DEFAULT_VENUE_TYPE),D(null),Te(!1),Ne(null),Ge.current=!1,nt(null),rt(K),H(),At(K)},[M,E,R,D,H,K,At,nt,rt]);e.useEffect(()=>{_e(null)},[null===lt||void 0===lt?void 0:lt.id,K]);const Ct=e.useCallback(()=>{fe(!1),be(!0),sessionStorage.setItem("sport-wizard-pending-modal-closed","true")},[]),Mt=e.useCallback(async e=>{if(!e)return;const t=await async function(e){try{if(!e)return{success:!1,error:"Match ID is required"};const{data:t,error:a}=await Ur.from("player").select("*").eq("match_id",e).eq("on_roster",!1);return a?{success:!1,error:a.message}:{success:!0,players:t||[]}}catch(t){return{success:!1,error:t.message}}}(e);if(!t.success||0===t.players.length)return;const a=t.players.map(e=>(0,n.A)((0,n.A)({},Hs(e)),{},{isTemporary:!0,matchId:e.match_id}));o(e=>{const t=new Set(e.map(e=>e.id)),n=a.filter(e=>!t.has(e.id));return n.length>0?[...e,...n]:e})},[o]),Pt=e.useCallback(async e=>{if(null!==e&&void 0!==e&&e.initial_config){ve(!0);try{const t=Mh(e.initial_config);t?(Ct(),Ne(t),U(e.id),G(!0),console.log("\u2705 Resume match: Set currentMatchId to",e.id,"and matchCreated to true"),await Mt(e.id)):(console.error("\u274c Failed to create resume data from pending match"),Ct())}catch(t){console.error("\u274c Error resuming pending match:",t),Ct()}finally{ve(!1)}}else console.error("\u274c MATCH SELECTION ERROR: No match found or missing initial_config")},[Ct,U,G,Mt,ve,Ne]),Et=e.useCallback(async e=>{if(!e)return null;const t=me.find(t=>t.id===e);if(null!==t&&void 0!==t&&t.initial_config)return t;if(null===lt||void 0===lt||!lt.id)return null;return(await Ch(lt.id)).pendingMatches.find(t=>t.id===e)||null},[me,null===lt||void 0===lt?void 0:lt.id]),It=e.useCallback(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{trackRequest:a=!1}=t;if(e&&(!a||Ye.current!==e))try{const t=await Et(e);if(null===t||void 0===t||!t.initial_config)return void console.error("\u274c MATCH SELECTION ERROR: No match found or missing initial_config");await Pt(t)}catch(n){console.error("\u274c Error resuming pending match:",n)}finally{a&&(Ye.current=e),Je.current===e&&(Je.current=null)}},[Pt,Et]),[Rt,Ot]=(0,e.useState)({loading:!1,message:"",error:null}),[Dt,Ft]=(0,e.useState)(!1),{submitVote:Lt,loading:qt,error:Ut,successMessage:Bt,infoMessage:Gt,clearMessages:zt,isAuthenticated:Vt}=(()=>{const{t:t}=xe("configuration"),{user:a}=Cs(),[n,r]=(0,e.useState)(!1),[s,i]=(0,e.useState)(null),[o,l]=(0,e.useState)(""),[c,d]=(0,e.useState)("");return{submitVote:(0,e.useCallback)(async(e,n)=>{if(!a)return i(t("formationVoting.errors.loginRequired")),{success:!1,error:"Authentication required"};r(!0),i(null),l(""),d("");try{const{data:a,error:r}=await Ur.rpc("submit_formation_vote",{p_formation:e,p_format:n});if(r)throw new Error(r.message||t("formationVoting.errors.submitFailed"));if("duplicate_vote"===a.error)return d(a.message||t("formationVoting.messages.duplicateVote",{formation:e,format:n})),{success:!1,error:"duplicate_vote",message:a.message};if(!a.success)throw new Error(a.error||t("formationVoting.errors.voteSubmissionFailed"));return l(a.message||t("formationVoting.messages.voteRecorded",{formation:e})),{success:!0,message:a.message}}catch(s){const e=s.message||t("formationVoting.errors.submitFailed");return i(e),console.error("Formation vote submission error:",s),{success:!1,error:e}}finally{r(!1)}},[a,t]),loading:n,error:s,successMessage:o,infoMessage:c,clearMessages:(0,e.useCallback)(()=>{i(null),l(""),d("")},[]),isAuthenticated:!!a}})();e.useEffect(()=>{if(Ve.current)return;const e=!!lt,t=(ct||[]).filter(e=>!1!==e.on_roster),a=t.length>0;if(!e||!a||!!!q)return void(ze.current=!0);(async()=>{se({loading:!0,message:Z("configuration:sync.syncing")}),ze.current=!1;try{const e=q(t);e.success?(se({loading:!1,message:"No sync needed"===e.message?"":Z("configuration:sync.syncSuccess",{message:e.message})}),ze.current=!0,"No sync needed"!==e.message&&setTimeout(()=>{se(e=>(0,n.A)((0,n.A)({},e),{},{message:""}))},3e3)):(se({loading:!1,message:Z("configuration:sync.syncFailed",{error:e.error})}),ze.current=!1)}catch(e){console.error("ConfigurationScreen sync error:",e),se({loading:!1,message:Z("configuration:sync.syncError",{error:e.message})}),ze.current=!1}})()},[lt,null===lt||void 0===lt?void 0:lt.id,ct,q,Z]);(0,e.useEffect)(()=>{if(null!==it&&void 0!==it&&it.id){qm.setUserId(it.id);const e=qm.getLocalMatches(),t=Array.isArray(e)&&e.length>0;Ft(t)}else qm.setUserId(null),Ft(!1)},[it]),(0,e.useEffect)(()=>{(async()=>{if(null!==lt&&void 0!==lt&&lt.id&&st)try{const e=await Vu(lt.id);Ee(e)}catch(e){console.error("Error loading connection details:",e)}else Ee({matchedConnections:new Map,unmatchedExternalPlayers:[],hasConnectedProvider:!1})})()},[null===lt||void 0===lt?void 0:lt.id,st]);const Ht=(ct||[]).filter(e=>!1!==e.on_roster),Kt=st&&lt&&0===Ht.length,Wt=e.useMemo(()=>B?i.filter(e=>e.isTemporary&&e.matchId===B):[],[i,B]),Yt=Ht.map(e=>({id:e.id,displayName:e.display_name,firstName:e.first_name,lastName:e.last_name,jerseyNumber:e.jersey_number,isTemporary:!1})),Jt=Wt.map(e=>({id:e.id,displayName:e.displayName,firstName:e.firstName,lastName:e.lastName,jerseyNumber:e.jerseyNumber,isTemporary:!0})),Qt=e.useMemo(()=>{if(!st||!lt)return i;const e=new Set(Yt.map(e=>e.id));return[...Yt,...Jt.filter(t=>!e.has(t.id))]},[st,lt,i,Yt,Jt]),$t=e.useMemo(()=>new Set(l),[l]),Xt=Qt.length>0&&Qt.every(e=>$t.has(e.id))&&l.length===Qt.length,Zt=null!==(r=null===Pe||void 0===Pe?void 0:Pe.hasConnectedProvider)&&void 0!==r&&r,ea=Boolean(lt&&st)&&Qi(ct,Zt),ta=Ht.length,aa=((null===Pe||void 0===Pe?void 0:Pe.unmatchedExternalPlayers)||[]).filter(e=>"connected"===e.connectorStatus),na=aa.length>0,ra=na?aa[0].providerName:"",sa=Boolean(lt&&st)&&ta<4&&na;e.useEffect(()=>{Ve.current||je||Kt&&l.length>0&&(null===ot||void 0===ot?void 0:ot.type)===ms&&c([])},[Kt,l.length,c,ot,je]),e.useEffect(()=>{(null===ot||void 0===ot?void 0:ot.type)===ms&&(Be.current=!1,Ge.current=!1,Ve.current=!1,He.current&&(clearTimeout(He.current),He.current=null))},[ot]);const[ia,oa]=(0,e.useState)(!1);e.useEffect(()=>{(null===ot||void 0===ot?void 0:ot.type)!==ms&&oa(!1)},[null===ot||void 0===ot?void 0:ot.type]),e.useEffect(()=>{(null===ot||void 0===ot?void 0:ot.type)!==ms||z||je||Ve.current||ia||!H||(oa(!0),H(),M(""),f({}),D(null),nt(null),rt(K))},[ot,z,je,ia,H,K,nt,rt]),e.useEffect(()=>{if(!st||!lt)return;if(0===Ht.length&&0===Wt.length)return;const e=Ht.map(e=>({id:e.id,displayName:e.display_name,firstName:e.first_name,lastName:e.last_name,jerseyNumber:e.jersey_number,stats:{timeOnFieldSeconds:0,timeAsAttackerSeconds:0,timeAsDefenderSeconds:0,timeAsGoalieSeconds:0,timeAsMidfielderSeconds:0,currentStatus:"substitute",currentPosition:null,currentRole:null,isInactive:!1,lastStintStartTimeEpoch:null}})),t=new Set(e.map(e=>e.id)),a=[...e,...Wt.filter(e=>!t.has(e.id))],n=i.map(e=>({id:e.id,name:e.displayName})),r=a.map(e=>({id:e.id,name:e.displayName}));JSON.stringify(n)!==JSON.stringify(r)&&o(a)},[st,lt,Ht,Wt,i,o]),e.useEffect(()=>{if(!re.loading&&ke&&!Ve.current&&!Ge.current){Ve.current=!0,He.current=setTimeout(()=>{Ve.current&&(console.warn("\u26a0\ufe0f Resume processing timeout - auto-resetting stuck state after 10 seconds"),Ve.current=!1,He.current=null)},1e4);try{if(ke.teamConfig&&(console.log("\ud83d\udd04 RESUME: Restoring team config:",{fullConfig:ke.teamConfig}),v(ke.teamConfig),ke.formation||ke.teamConfig.formation)){const e=ke.formation||ke.teamConfig.formation;console.log("\ud83d\udd04 RESUME: Syncing formation UI state:",e),b(e)}ke.periods&&u(ke.periods),ke.periodDurationMinutes&&h(ke.periodDurationMinutes),void 0!==ke.opponentTeam&&M(ke.opponentTeam),ke.matchType&&E(ke.matchType),ke.venueType&&R(ke.venueType),ke.captainId&&D(ke.captainId),ke.squadSelection&&(console.log("\ud83d\udd04 RESUME: Restoring squad selection (final step):",ke.squadSelection),c(ke.squadSelection)),ke.periodGoalies&&f(ke.periodGoalies),ke.formationData&&(console.log("\ud83d\udd04 RESUME: Restoring formation data with position assignments:",ke.formationData),k(ke.formationData)),Be.current=!0,Ge.current=!0,Ve.current=!1,Te(!0),V(!0),He.current&&(clearTimeout(He.current),He.current=null)}catch(e){console.error("\u274c Resume data processing failed:",e),Be.current=!1,Ge.current=!1,Ve.current=!1,He.current&&(clearTimeout(He.current),He.current=null)}}},[ke,c,u,h,M,E,D,v,x,f]),e.useEffect(()=>{ke||(Ve.current=!1,He.current&&(clearTimeout(He.current),He.current=null))},[ke]);const la=e.useCallback(e=>{c(t=>{const a="function"===typeof e?e(t):e,n=Array.isArray(a)?Array.from(new Set(a)):[];return n.length===t.length&&n.every(e=>t.includes(e))?t:(n.length>0&&V(!0),n.length>=Oe&&n.length<=De&&!Ve.current?(console.log("\u26a1 AUTO-CONFIG: Squad selection changed, triggering createTeamConfigFromSquadSize:",{squadSize:n.length,currentTeamConfig:g}),w(n.length,Ie)):Ve.current&&console.log("\ud83d\udee1\ufe0f AUTO-CONFIG: Skipped during resume processing to prevent override"),O&&!n.includes(O)&&D(null),n)})},[c,De,V,Oe,Ve,w,Ie,g,O,D]),ca=e.useMemo(()=>{const e=null===Ae||void 0===Ae?void 0:Ae.teamCaptain;return e&&Dh(e)?e:null},[Ae]);e.useEffect(()=>{ca&&(O||l.length<Oe||l.includes(ca)&&D(ca))},[ca,O,l,Oe,D]),e.useEffect(()=>{var e;if(O)return;if(null===lt||void 0===lt||!lt.id)return;if(l.length<Oe)return;const t=Fh.loadState();if(null===t||void 0===t||!t.teamId||t.teamId!==lt.id)return;if(!t.fetchedAt||Date.now()-t.fetchedAt>864e5)return;const a=null===(e=t.preferences)||void 0===e?void 0:e.teamCaptain;a&&"none"!==a&&Dh(a)&&l.includes(a)&&_e(e=>e||t.preferences||null)},[O,null===lt||void 0===lt?void 0:lt.id,l,Oe,_e]);const da=e.useCallback(()=>{if(Xt||0===Qt.length)return;const e=Qt.map(e=>e.id);la(e)},[Xt,Qt,la]),ua=e.useCallback(()=>{ue(!0),$&&$(()=>{ue(!1)},"add-player-options")},[$]),ma=e.useCallback(()=>{ue(!1),X&&X()},[X]),ha=e.useCallback(()=>{ma(),J&&J(bi.TEAM_MANAGEMENT,{openToTab:Cm.ROSTER,openAddRosterPlayerModal:!0})},[ma,J]),pa=e.useCallback(()=>{ma(),Q&&Q()},[ma,Q]),fa=e.useMemo(()=>{const e=_.map(e=>{var t;const a=null!==(t=Ce[e.id])&&void 0!==t?t:0,n=Kl(e);return{value:e.id,label:"".concat(n," (").concat(a,")"),captainCount:a,playerLabel:n}}).sort((e,t)=>e.captainCount!==t.captainCount?e.captainCount-t.captainCount:e.playerLabel.localeCompare(t.playerLabel,void 0,{sensitivity:"base"})).map(e=>{let{value:t,label:a}=e;return{value:t,label:a}});return[{value:"",label:Z("configuration:captain.noCaptain")},...e]},[Ce,_,Z]),ga=e.useCallback(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{markActive:a=!0}=t,n=Is(e);a&&n.trim()&&V(!0),M(n)},[V,M]),va=e.useCallback(e=>{ga(e)},[ga]),ya=e.useCallback(e=>{va(e)},[va]),ba=()=>{Lh.saveState({tab:Cm.ROSTER}),J(bi.TEAM_MANAGEMENT)},xa=e.useCallback(e=>{if(!g)return;const t=xi.FORMAT_CONFIGS[e]||xi.FORMAT_CONFIGS[xi.FORMATS.FORMAT_5V5],a=(0,xi.getValidFormations)(e,l.length),n=t.defaultFormation||xi.FORMATIONS.FORMATION_2_2,r=a.includes(y)?y:n,s=g.squadSize||l.length||t.fieldPlayers+1,i=(0,xi.createTeamConfig)(e,s,r);b(r),v(i);const o=(0,wi.getInitialFormationTemplate)(i,(null===S||void 0===S?void 0:S.goalie)||null);o&&"function"===typeof k&&k(o),V(!0)},[g,l.length,y,S,k,b,v,V]);e.useEffect(()=>{const e=null===lt||void 0===lt?void 0:lt.id;if(!e||mt)return;if(je)return;const t="".concat(e,"-").concat(K||0);if(C&&C.trim().length>0)return void($e.current!==t&&($e.current=t));if($e.current===t)return;let a=!1;return(async()=>{$e.current=t;try{const t=await Rh(e);!a&&null!==t&&void 0!==t&&t.opponent&&ga(t.opponent,{markActive:!1})}catch(n){console.error("Failed to auto-populate opponent from upcoming matches:",n)}})(),()=>{a=!0}},[null===lt||void 0===lt?void 0:lt.id,mt,C,je,ga,K]);const wa=e.useCallback(async e=>{await It(e)},[It]),Sa=e.useCallback(async e=>{if(e){ve(!0);try{await cl(e),he(t=>t.filter(t=>t.id!==e)),me.length<=1&&_t()}catch(t){console.error("\u274c Error discarding pending match:",t),_t()}finally{ve(!1)}}},[me,_t]);e.useEffect(()=>{W&&Ye.current!==W&&(Je.current=W);const e=Je.current;e&&Ye.current!==e&&(null===lt||void 0===lt||!lt.id||mt||ge||It(e,{trackRequest:!0}))},[W,null===lt||void 0===lt?void 0:lt.id,mt,ge,It]),e.useEffect(()=>()=>{Je.current=null,Ye.current=null},[]);return!st||ut&&(!ut||dt)&&lt?(0,Ts.jsxs)("div",{className:"space-y-4",children:[st&&lt&&(0,Ts.jsxs)("div",{className:"p-3 bg-sky-600/20 border border-sky-500 rounded-lg",children:[(0,Ts.jsx)("div",{className:"text-sky-200 font-medium",children:Z("configuration:teamBanner.label",{clubName:(null===(s=lt.club)||void 0===s?void 0:s.name)||"",teamName:lt.name})}),re.loading&&(0,Ts.jsxs)("div",{className:"text-sky-300 text-sm mt-1",children:["\ud83d\udd04 ",re.message]}),!re.loading&&re.message&&(0,Ts.jsx)("div",{className:"text-sky-300 text-sm mt-1",children:re.message})]}),we&&(0,Ts.jsx)("div",{className:"p-3 bg-red-900/30 border border-red-500/50 rounded-lg",children:(0,Ts.jsx)("div",{className:"flex items-start space-x-3",children:(0,Ts.jsxs)("div",{className:"flex-1",children:[(0,Ts.jsx)("div",{className:"text-red-300 font-medium text-sm",children:Z("configuration:pendingMatch.errors.title")}),(0,Ts.jsx)("div",{className:"text-red-200 text-sm mt-1",children:we.message}),!1,we.canRetry&&(0,Ts.jsx)("div",{className:"mt-2",children:(0,Ts.jsx)(Lc,{onClick:kt,variant:"outline",size:"sm",disabled:ge,className:"text-red-300 border-red-500/50 hover:bg-red-500/20",children:Z(ge?"configuration:pendingMatch.errors.retrying":"configuration:pendingMatch.errors.tryAgain")})})]})})}),st?(0,Ts.jsxs)("div",{className:"space-y-3",children:[Dt&&(0,Ts.jsx)("div",{className:"p-4 bg-emerald-900/30 border border-emerald-600/50 rounded-lg",children:(0,Ts.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,Ts.jsx)("div",{className:"w-10 h-10 bg-emerald-600 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,Ts.jsx)(gc,{className:"w-5 h-5 text-white"})}),(0,Ts.jsxs)("div",{className:"flex-1",children:[(0,Ts.jsx)("h3",{className:"font-semibold text-emerald-300 text-sm",children:Z("configuration:dataMigration.title")}),(0,Ts.jsx)("p",{className:"text-emerald-200 text-sm mt-1",children:Z("configuration:dataMigration.description")}),(0,Ts.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,Ts.jsx)(Lc,{onClick:async()=>{Ot({loading:!0,message:Z("configuration:dataMigration.migratingFull"),error:null});try{const e=await qm.migrateLocalDataToCloud();e.success?(Ot({loading:!1,message:e.message,error:null}),Ft(!1),setTimeout(()=>{Ot({loading:!1,message:"",error:null})},5e3)):Ot({loading:!1,message:"",error:e.error||Z("dataMigration.failed")})}catch(e){Ot({loading:!1,message:"",error:Z("dataMigration.failedWithError",{error:e.message})})}},variant:"primary",size:"sm",disabled:Rt.loading,className:"bg-emerald-600 hover:bg-emerald-700",children:Rt.loading?Z("configuration:dataMigration.migrating"):Z("configuration:dataMigration.migrateButton")}),(0,Ts.jsx)(Lc,{onClick:()=>{Ft(!1)},variant:"secondary",size:"sm",disabled:Rt.loading,children:Z("configuration:dataMigration.laterButton")})]})]})]})}),Rt.message&&(0,Ts.jsxs)(Jc,{variant:"success",children:["\u2713 ",Rt.message]}),Rt.error&&(0,Ts.jsx)(Jc,{variant:"error",children:Rt.error}),ie.message&&(0,Ts.jsx)(Jc,{variant:"success",children:ie.message}),ie.error&&(0,Ts.jsx)(Jc,{variant:"error",children:ie.error})]}):(0,Ts.jsx)(vh,{feature:"cloud synchronization",description:Z("configuration:cloudSync.featureDescription"),variant:"inline",authModal:L,children:(0,Ts.jsx)("div",{className:"p-4 bg-slate-800 border border-slate-600 rounded-lg opacity-50",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ts.jsx)(vc,{className:"w-8 h-8 text-slate-400"}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("div",{className:"text-slate-300 font-medium",children:Z("configuration:cloudSync.available")}),(0,Ts.jsx)("div",{className:"text-slate-400 text-sm",children:Z("configuration:cloudSync.description")})]})]})})}),(0,Ts.jsxs)("h2",{className:"text-xl font-semibold text-sky-300 flex items-center",children:[(0,Ts.jsx)(yc,{className:"mr-2 h-6 w-6"}),Z("configuration:header.title")]}),(0,Ts.jsxs)(Xc,{padding:"sm",children:[(0,Ts.jsx)("h3",{className:"text-base font-medium text-sky-200 mb-2",children:Kt?Z("configuration:squad.addPlayerTitle"):Z("configuration:squad.selectTitle",{count:l.length})}),Kt?(0,Ts.jsx)("div",{className:"text-center py-8",children:sa?(0,Ts.jsx)(Dm,{firstProviderName:ra,onNavigateToRoster:ba}):(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)(bc,{className:"w-12 h-12 mx-auto mb-3 text-slate-400"}),(0,Ts.jsx)("p",{className:"text-lg font-medium text-slate-300 mb-2",children:Z("configuration:squad.noPlayers.title")}),(0,Ts.jsx)("p",{className:"text-sm text-slate-400 mb-4",children:Z("configuration:squad.noPlayers.description")}),(0,Ts.jsx)("div",{className:"flex justify-center",children:(0,Ts.jsx)(Lc,{onClick:ua,variant:"primary",Icon:bc,children:Z("configuration:squad.addPlayer")})})]})}):(0,Ts.jsxs)(Ts.Fragment,{children:[sa&&(0,Ts.jsx)("div",{className:"mb-3",children:(0,Ts.jsx)(Dm,{firstProviderName:ra,onNavigateToRoster:ba})}),(0,Ts.jsx)("div",{className:"flex justify-end mb-2",children:(0,Ts.jsx)(Lc,{onClick:da,variant:"secondary",size:"sm",disabled:Xt||0===Qt.length,children:Z(Xt?"configuration:squad.allSelected":"configuration:squad.selectAll")})}),(0,Ts.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:Qt.map(e=>(0,Ts.jsxs)("label",{className:"flex items-center space-x-2 p-1.5 rounded-md cursor-pointer transition-all ".concat(l.includes(e.id)?"bg-sky-600 text-white":"bg-slate-600 hover:bg-slate-500"),children:[(0,Ts.jsx)("input",{type:"checkbox",checked:l.includes(e.id),onChange:()=>{return t=e.id,void la(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"form-checkbox h-5 w-5 text-sky-500 bg-slate-800 border-slate-500 rounded focus:ring-sky-400"}),(0,Ts.jsx)("span",{children:Kl(e)}),e.isTemporary&&(0,Ts.jsx)("span",{className:"text-xs text-slate-300",children:Z("configuration:squad.temporaryLabel")})]},e.id))}),(0,Ts.jsx)("div",{className:"flex justify-center mt-3",children:(0,Ts.jsx)(Lc,{onClick:ua,variant:"secondary",size:"sm",Icon:bc,children:Z("configuration:squad.addPlayer")})}),qe&&(0,Ts.jsx)("p",{className:"mt-2 text-xs text-amber-300",children:Z("configuration:squad.exceededFormat",{count:l.length,format:Fe,max:De})})]})]}),ea&&(0,Ts.jsx)("div",{className:"mt-4",children:(0,Ts.jsx)(vm,{onNavigateToConnectors:()=>{Lh.saveState({tab:Cm.CONNECTORS}),J(bi.TEAM_MANAGEMENT)}})}),(0,Ts.jsxs)(Xc,{padding:"sm",className:"space-y-4",children:[(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{htmlFor:"opponentTeam",className:"block text-sm font-medium text-sky-200 mb-1",children:Z("configuration:matchDetails.opponentLabel")}),(0,Ts.jsx)(jh,{teamId:null===lt||void 0===lt?void 0:lt.id,value:C,onChange:va,onSelect:ya,inputId:"opponentTeam",placeholder:Z("configuration:matchDetails.opponentPlaceholder")})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{htmlFor:"matchType",className:"block text-sm font-medium text-sky-200 mb-1",children:Z("configuration:matchDetails.matchTypeLabel")}),(0,Ts.jsx)(Dc,{id:"matchType",value:P,onChange:e=>{E(e),V(!0)},options:(0,Ol.getMatchTypeOptions)(Z).map(e=>({value:e.value,label:e.label}))})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{htmlFor:"venueType",className:"block text-sm font-medium text-sky-200 mb-1",children:Z("configuration:matchDetails.venueLabel")}),(0,Ts.jsx)(Dc,{id:"venueType",value:Re,onChange:e=>{R(e),V(!0)},options:(0,Fs.getVenueTypeOptions)(Z).map(e=>({value:e.value,label:e.label}))})]})]}),(0,Ts.jsxs)(Xc,{padding:"sm",className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{htmlFor:"numPeriods",className:"block text-sm font-medium text-sky-200 mb-1",children:Z("configuration:gameSettings.periodsLabel")}),(0,Ts.jsx)(Dc,{value:d,onChange:e=>u(Number(e)),options:Zc,id:"numPeriods"})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{htmlFor:"periodDuration",className:"block text-sm font-medium text-sky-200 mb-1",children:Z("configuration:gameSettings.durationLabel")}),(0,Ts.jsx)(Dc,{value:m,onChange:e=>h(Number(e)),options:ed,id:"periodDuration"})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{htmlFor:"alertMinutes",className:"block text-sm font-medium text-sky-200 mb-1",children:Z("configuration:gameSettings.alertLabel")}),(0,Ts.jsx)(Dc,{value:N,onChange:e=>j(Number(e)),options:td(Z),id:"alertMinutes"})]})]}),(0,Ts.jsxs)(Xc,{padding:"sm",children:[(0,Ts.jsxs)("h3",{className:"text-base font-medium text-sky-200 mb-2 flex items-center",children:[(0,Ts.jsx)(xc,{className:"mr-2 h-4 w-4"}),Z("configuration:formation.header")]}),(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{htmlFor:"matchFormat",className:"block text-sm font-medium text-sky-200 mb-1",children:Z("configuration:formation.formatLabel")}),(0,Ts.jsx)(Dc,{id:"matchFormat",value:Ie,onChange:e=>xa(e),options:Object.values(xi.FORMATS).map(e=>{var t;return{value:e,label:(null===(t=xi.FORMAT_CONFIGS[e])||void 0===t?void 0:t.label)||e}})})]}),(0,Ts.jsxs)("div",{className:"space-y-3",children:[(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{htmlFor:"formation",className:"block text-sm font-medium text-sky-200 mb-1",children:Z("configuration:formation.formationLabel")}),(0,Ts.jsx)(Dc,{id:"formation",value:y,onChange:e=>(e=>{const t=xi.FORMATION_DEFINITIONS[e];t&&"coming-soon"===t.status?(ne(e),te(!0)):x(e)})(e),options:(0,xi.getValidFormations)(Ie,l.length).map(e=>{const t=xi.FORMATION_DEFINITIONS[e],a="coming-soon"===t.status?" ".concat(Z("configuration:formation.comingSoonSuffix")):"";return{value:e,label:"".concat(t.label).concat(a)}})})]}),(0,Ts.jsx)(Sh,{formation:y,className:"mt-3"})]}),!Ue&&Le&&(0,Ts.jsx)("p",{className:"text-xs text-amber-300",children:Z("configuration:formation.formatExceeded",{count:l.length,format:Fe,max:De})})]})]}),Ue&&(0,Ts.jsxs)(Xc,{padding:"sm",children:[(0,Ts.jsx)("h3",{className:"text-base font-medium text-sky-200 mb-2",children:Z("configuration:goalies.header")}),(0,Ts.jsx)("div",{className:"space-y-2",children:Array.from({length:d},(e,t)=>t+1).map(e=>(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{htmlFor:"goalie_p".concat(e),className:"block text-sm font-medium text-sky-200 mb-1",children:Z("configuration:goalies.periodLabel",{period:e})}),(0,Ts.jsx)(Dc,{id:"goalie_p".concat(e),value:p[e]||"",onChange:t=>((e,t)=>{V(!0),f(a=>{const r=(0,n.A)((0,n.A)({},a),{},{[e]:t});if(1===e)for(let e=2;e<=d;e++)a[e]!==a[1]&&a[e]||(r[e]=t);return r})})(e,t),options:_.map(e=>({value:e.id,label:Kl(e)})),placeholder:Z("configuration:goalies.placeholder")})]},e))})]}),l.length>=Oe&&"none"!==(null===Ae||void 0===Ae?void 0:Ae.teamCaptain)&&(0,Ts.jsxs)(Xc,{padding:"sm",children:[(0,Ts.jsx)("h3",{className:"text-base font-medium text-sky-200 mb-2",children:Z("configuration:captain.header")}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{htmlFor:"captain",className:"block text-sm font-medium text-sky-200 mb-1",children:Z("configuration:captain.label")}),(0,Ts.jsx)(Dc,{id:"captain",value:O||"",onChange:e=>(e=>{const t=""===e?null:e;t&&V(!0),D(t)})(e),options:fa}),(0,Ts.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:Z("configuration:captain.hint")})]})]}),st&&lt&&A&&(0,Ts.jsx)(Lc,{onClick:async()=>{if(A){oe({loading:!0,message:Z("configuration:saveConfig.saving"),error:null});try{const e=await A();e.success?(oe({loading:!1,message:Z("configuration:saveConfig.savedSuccess",{message:e.message||Z("configuration:saveConfig.savedSuccessDefault")}),error:null}),rd(),setTimeout(()=>{oe(e=>(0,n.A)((0,n.A)({},e),{},{message:""}))},3e3)):oe({loading:!1,message:"",error:e.error||Z("configuration:saveConfig.errors.failed")})}catch(e){console.error("Save configuration error:",e),oe({loading:!1,message:"",error:Z("configuration:saveConfig.errors.failedWithMessage",{error:e.message})})}}else console.warn("handleSaveConfiguration is not provided")},disabled:ie.loading||!Ue,variant:"secondary",Icon:wc,children:ie.loading?Z("configuration:buttons.savingConfig"):Z("configuration:buttons.saveConfig")}),st&&lt&&A&&(0,Ts.jsx)(Lc,{onClick:async()=>{if(A)if(st&&lt){oe({loading:!0,message:Z("configuration:liveLinkNotifications.creating"),error:null});try{const e=await A();if(e.success){const t=e.matchId;if(!t)throw new Error(Z("configuration:saveConfig.errors.noMatchId"));const a=await id(t);a.success?ce({isOpen:!0,title:Z("configuration:liveLinkNotifications.linkCopied"),message:Z("configuration:liveLinkNotifications.linkCopiedMessage")}):ce({isOpen:!0,title:Z("configuration:liveLinkNotifications.liveMatchUrl"),message:a.url}),oe({loading:!1,message:"",error:null})}else oe({loading:!1,message:"",error:e.error||Z("configuration:liveLinkNotifications.failed")})}catch(e){console.error("Get live link error:",e),oe({loading:!1,message:"",error:Z("configuration:liveLinkNotifications.failedWithError",{error:e.message})})}}else ce({isOpen:!0,title:Z("configuration:liveLinkNotifications.authRequired"),message:Z("configuration:liveLinkNotifications.authRequiredMessage")});else console.warn("handleSaveConfiguration is not provided")},disabled:ie.loading||!Ue,variant:"secondary",Icon:Sc,children:ie.loading?Z("configuration:buttons.creatingLink"):Z("configuration:buttons.getLiveLink")}),(0,Ts.jsx)(Lc,{onClick:T,disabled:!Ue||!Array.from({length:d},(e,t)=>p[t+1]).every(Boolean),Icon:kc,children:Z("configuration:buttons.proceedToPeriod")}),F&&(0,Ts.jsx)(Lc,{onClick:()=>{c([]),f({}),D(null);const e=Ie===xi.FORMATS.FORMAT_7V7,t=e?10:7,a=e?xi.FORMATS.FORMAT_7V7:xi.FORMATS.FORMAT_5V5,n=(s=t)>=(r=Qt).length?nd(r):nd(r).slice(0,s);var r,s;const i=n.map(e=>e.id);let o;if(c(i),e){const e=[xi.FORMATIONS.FORMATION_2_2_2,xi.FORMATIONS.FORMATION_2_3_1].filter(e=>{var t;return"available"===(null===(t=xi.FORMATION_DEFINITIONS[e])||void 0===t?void 0:t.status)});o=e.length>0?e[Math.floor(Math.random()*e.length)]:xi.FORMAT_CONFIGS[xi.FORMATS.FORMAT_7V7].defaultFormation}else o=xi.FORMATIONS.FORMATION_2_2;xa(a),x(o),w(t,a);const l=((e,t)=>{const a={},n=nd(e);for(let r=1;r<=t;r++){const e=(r-1)%n.length;a[r]=n[e].id}return a})(n,d);f(l);const u=["Lions FC","Eagles United","Sharks","Thunder","Storm","Wildcats"],m=u[Math.floor(Math.random()*u.length)];ga(m)},variant:"warning",Icon:Nc,className:"bg-amber-600 hover:bg-amber-700 text-white",children:Z("configuration:buttons.randomize")}),(0,Ts.jsx)(_h,{isOpen:ee,onClose:()=>{te(!1),ne(null),zt()},onConfirm:async()=>{if(!ae)return;if(zt(),!Vt)return void console.error("User must be authenticated to vote");(await Lt(ae,Ie)).success&&setTimeout(()=>{te(!1),ne(null)},2e3)},featureName:ae,loading:qt,error:Ut,successMessage:Bt,infoMessage:Gt,isAuthenticated:Vt,authModal:L,children:(0,Ts.jsx)("p",{children:Z("configuration:formationVoting.description")})}),(0,Ts.jsx)(Bc,{isOpen:de,onPrimary:ha,onSecondary:pa,onTertiary:ma,title:Z("configuration:addPlayerModal.title"),message:Z("configuration:addPlayerModal.message"),primaryText:Z("configuration:addPlayerModal.addToTeam"),secondaryText:Z("configuration:addPlayerModal.addTemporary"),tertiaryText:Z("configuration:addPlayerModal.cancel"),primaryVariant:"primary",secondaryVariant:"secondary",tertiaryVariant:"secondary"}),(0,Ts.jsx)(Ph,{isOpen:pe,onResume:wa,onDiscard:Sa,onClose:_t,pendingMatches:me,isLoading:ge}),(0,Ts.jsx)(Uc,{isOpen:le.isOpen,onClose:()=>ce({isOpen:!1,title:"",message:""}),title:le.title,message:le.message})]}):(0,Ts.jsx)("div",{className:"space-y-4",children:(0,Ts.jsx)(Mm,{})})}const Uh=fc("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Bh={leftDefender:{title:"Left Defender",position:"leftDefender"},rightDefender:{title:"Right Defender",position:"rightDefender"},leftAttacker:{title:"Left Attacker",position:"leftAttacker"},rightAttacker:{title:"Right Attacker",position:"rightAttacker"},defender:{title:"Defender",position:"defender"},left:{title:"Left Mid",position:"left"},right:{title:"Right Mid",position:"right"},attacker:{title:"Attacker",position:"attacker"},leftMidfielder:{title:"Left Midfielder",position:"leftMidfielder"},rightMidfielder:{title:"Right Midfielder",position:"rightMidfielder"},centerMidfielder:{title:"Center Midfielder",position:"centerMidfielder"},substitute_1:{title:"Substitute",position:"substitute_1"},substitute_2:{title:"Substitute",position:"substitute_2"},substitute_3:{title:"Substitute",position:"substitute_3"},substitute_4:{title:"Substitute",position:"substitute_4"},substitute_5:{title:"Substitute",position:"substitute_5"}},Gh=e=>{for(let t=e.length-1;t>0;t--){const a=Math.floor(Math.random()*(t+1));[e[t],e[a]]=[e[a],e[t]]}return e},zh=e=>({[Je.q.DEFENDER]:"defender",[Je.q.MIDFIELDER]:"midfielder",[Je.q.ATTACKER]:"attacker"}[e]||e.toLowerCase()),Vh=function(e,t,a,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(!e||!Array.isArray(e)||0===e.length)return null;if(!a)return null;const s=(0,wi.getModeDefinition)(a);if(!s)return null;const i=(e=>{const t=(0,wi.getModeDefinition)(e);if(!t||!t.positions||!t.fieldPositions)return{defender:0,midfielder:0,attacker:0};const a={[Je.q.DEFENDER]:0,[Je.q.MIDFIELDER]:0,[Je.q.ATTACKER]:0};t.fieldPositions.forEach(e=>{const n=t.positions[e],r=(null===n||void 0===n?void 0:n.role)||n;a.hasOwnProperty(r)&&a[r]++});const n=Object.values(a).reduce((e,t)=>e+t,0);return 0===n?{defender:0,midfielder:0,attacker:0}:{defender:(a[Je.q.DEFENDER]||0)/n*100,midfielder:(a[Je.q.MIDFIELDER]||0)/n*100,attacker:(a[Je.q.ATTACKER]||0)/n*100}})(a),o=function(e,t){const a=new Set(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[]);return e.filter(e=>!a.has(e.id)).map(e=>{const a=e.percentTimeAsDefender||0,n=e.percentTimeAsMidfielder||0,r=e.percentTimeAsAttacker||0,s=a>0||n>0||r>0;return{id:e.id,displayName:e.displayName,deficits:{defender:t.defender-a,midfielder:t.midfielder-n,attacker:t.attacker-r},percentages:{defender:a,midfielder:n,attacker:r},hasHistory:s}})}(e,i,[n,...r].filter(Boolean));if(0===o.length)return null;const l=((e,t)=>{if(!t||!t.positions||!t.fieldPositions)return{};const a={},n=new Set,r={[Je.q.DEFENDER]:[],[Je.q.MIDFIELDER]:[],[Je.q.ATTACKER]:[]};return t.fieldPositions.forEach(e=>{const a=t.positions[e],n=(null===a||void 0===a?void 0:a.role)||a;n&&r[n]&&r[n].push(e)}),[Je.q.DEFENDER,Je.q.MIDFIELDER,Je.q.ATTACKER].forEach(t=>{const s=r[t];if(!s||0===s.length)return;const i=e.filter(e=>!n.has(e.id));if(0===i.length)return;const o=zh(t),l=[...i].sort((e,t)=>{const a=e.deficits[o]||0;return(t.deficits[o]||0)-a}),c=[];let d=[],u=null;l.forEach(e=>{const a=e.deficits[t.toLowerCase()]||0,n=Math.round(100*a)/100;null===u||Math.abs(n-u)<.01?(d.push(e),u=n):(d.length>0&&c.push(d),d=[e],u=n)}),d.length>0&&c.push(d);let m=0;for(const e of c){if(m>=s.length)break;const t=Gh([...e]);for(const e of t){if(m>=s.length)break;a[s[m]]=e.id,n.add(e.id),m++}}}),a})(o,s),c={};return Object.entries(l).forEach(e=>{let[t,a]=e;const n=o.find(e=>e.id===a);if(!n)return;const r=s.positions[t],i=(null===r||void 0===r?void 0:r.role)||r,l=zh(i),d=n.percentages[l]||0;let u,m;n.hasHistory?(u="roleTimePercentage",m={percentage:d.toFixed(1),role:l}):u="noMatchHistory",c[t]={playerId:a,reasonKey:u,reasonParams:m}}),{recommendations:c,metadata:{playersConsidered:o.length,targetPercentages:i}}},Hh=e=>e.replace(/_/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/^./,e=>e.toUpperCase());function Kh(e){let{recommendations:t,onAccept:a,onDismiss:n,allPlayers:r,loading:s,error:i}=e;const{t:o}=xe("configuration"),l=(null===t||void 0===t?void 0:t.recommendations)&&Object.keys(t.recommendations).length>0;return(0,Ts.jsxs)("div",{"data-testid":"position-recommendations",className:"p-2 bg-slate-700 rounded-lg space-y-2",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("h3",{className:"text-sm font-medium text-sky-200",children:o("positionRecommendations.title")}),(0,Ts.jsx)("span",{className:"text-xs text-slate-300",children:o("positionRecommendations.timeframe")})]}),s?(0,Ts.jsx)("p",{className:"text-xs text-slate-300",children:o("positionRecommendations.loading")}):i?(0,Ts.jsx)("p",{className:"text-xs text-rose-300",children:o("positionRecommendations.error")}):l?(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)("p",{className:"text-xs text-slate-300",children:o("positionRecommendations.description")}),(0,Ts.jsx)("ul",{className:"space-y-1","data-testid":"position-recommendations-list",children:Object.entries(t.recommendations).map(e=>{let[t,a]=e;const n=r.find(e=>e.id===a.playerId),s=Bh[i=t]||{title:Hh(i),position:i};var i;return(0,Ts.jsxs)("li",{className:"flex items-center justify-between rounded-md bg-slate-800/60 px-2 py-1 text-sm text-slate-100",children:[(0,Ts.jsxs)("span",{children:[s.title,": ",(null===n||void 0===n?void 0:n.displayName)||o("positionRecommendations.unknown")]}),(0,Ts.jsx)("span",{className:"text-xs text-slate-300",children:o("positionRecommendations.reasons.".concat(a.reasonKey),a.reasonParams||{})})]},t)})})]}):(0,Ts.jsx)("p",{className:"text-xs text-slate-300",children:o("positionRecommendations.noRecommendations")}),(0,Ts.jsxs)("div",{className:"flex items-center justify-end space-x-2 pt-1",children:[(0,Ts.jsx)(Lc,{variant:"secondary",onClick:n,children:o("positionRecommendations.dismiss")}),(0,Ts.jsx)(Lc,{variant:"accent",onClick:a,disabled:s||!l,children:o("positionRecommendations.acceptAll")})]})]})}Kh.defaultProps={recommendations:null,loading:!1,error:null};var Wh=a(829);const Yh=e=>e.replace(/_/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/^./,e=>e.toUpperCase());const Jh={[Je.q.ATTACKER]:"offence",[Je.q.MIDFIELDER]:"midfield",[Je.q.DEFENDER]:"defence"};function Qh(e){let{position:t,formation:a,onPlayerAssign:n,getAvailableOptions:r,currentPeriodNumber:s,t:i,showLabel:o=!1}=e;const l=Bh[c=t]||(c.startsWith("substitute_")?{title:"Substitute",position:c}:{title:Yh(c),position:c});var c;const d=function(e,t,a){const n=e.startsWith("substitute_")?"substitute":e;return a("periodSetup.positions.".concat(n),{defaultValue:""})||t.title}(t,l,i),u=r(l.position),m=(0,Ts.jsx)(Dc,{value:a[t]||"",onChange:e=>n(l.position,e),options:u.map(e=>({value:e.id,label:Hl(e,s)})),placeholder:i("periodSetup.fallbacks.selectPosition",{title:d})});return o?(0,Ts.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ts.jsx)("span",{className:"text-xs text-sky-300 w-16 shrink-0",children:d}),(0,Ts.jsx)("div",{className:"flex-1",children:m})]}):(0,Ts.jsx)("div",{children:m})}function $h(e){let{fieldGroups:t,substitutePositions:a,formation:r,onPlayerAssign:s,getAvailableOptions:i,currentPeriodNumber:o,t:l}=e;const c={formation:r,onPlayerAssign:s,getAvailableOptions:i,currentPeriodNumber:o,t:l};return(0,Ts.jsxs)(Ts.Fragment,{children:[t.map(e=>{let{role:t,positions:a}=e;const r=l("periodSetup.roleGroups.".concat(Jh[t]));return(0,Ts.jsxs)("div",{className:"p-2 bg-sky-700 rounded-md space-y-1.5",children:[(0,Ts.jsx)("h3",{className:"text-sm font-medium text-sky-200",children:r}),a.map(e=>(0,Ts.jsx)(Qh,(0,n.A)({position:e,showLabel:!0},c),e))]},t)}),a.length>0&&(0,Ts.jsxs)("div",{className:"p-2 bg-slate-700 rounded-md space-y-1.5",children:[(0,Ts.jsx)("h3",{className:"text-sm font-medium text-slate-200",children:l("periodSetup.roleGroups.substitutes")}),a.map(e=>(0,Ts.jsx)(Qh,(0,n.A)({position:e},c),e))]})]})}function Xh(t){let{currentPeriodNumber:a,formation:r,setFormation:s,availableForAssignment:i,allPlayers:o,setAllPlayers:l,handleStartGame:c,gameLog:d,selectedSquadPlayers:u,periodGoalieIds:m,setPeriodGoalieIds:h,numPeriods:p,teamConfig:f,selectedFormation:g,onNavigateBack:v,pushNavigationState:y,removeFromNavigationStack:b,ownScore:x,opponentScore:w,opponentTeam:S,ownTeamName:k=Ul.OWN_TEAM_NAME,rotationQueue:N,setRotationQueue:j,preparePeriodWithGameLog:T,handleSavePeriodConfiguration:A,matchState:_,debugMode:C=!1,resumeFormationData:M=null}=t;const{currentTeam:P,loadTeamPreferences:E}=vi(),{t:I}=xe("configuration"),[R,O]=(0,e.useState)({subHandled:!1,subPercentages:{},subError:null,positionHandled:!1,positionData:null,positionError:null}),{playerStats:D,loading:F,error:L}=function(t,a,n){const{t:r}=xe("common"),[s,i]=(0,e.useState)(null),[o,l]=(0,e.useState)(!1),[c,d]=(0,e.useState)(null);return(0,e.useEffect)(()=>{if(1!==a||!t||null===n||void 0===n||!n.length)return i(null),l(!1),void d(null);let e=!0;return(async()=>{l(!0),d(null);try{const a=new Date,n=new Date(a);n.setMonth(n.getMonth()-6);const s=await Zo(t,n,a);if(!e)return;null!==s&&void 0!==s&&s.success?(i(s.players||[]),d(null)):(i(null),d((null===s||void 0===s?void 0:s.error)||r("errors.failedToLoadPlayerStats")))}catch(a){if(!e)return;i(null),d(a.message||r("errors.failedToLoadPlayerStats"))}finally{e&&l(!1)}})(),()=>{e=!1}},[t,a,n,r]),{playerStats:s,loading:o,error:c}}(null===P||void 0===P?void 0:P.id,a,u),q=(0,e.useMemo)(()=>(0,wi.getModeDefinition)(f),[f]),U=(0,e.useMemo)(()=>{if(!f)return 0;if(!q)return 0;return(q.substitutePositions||[]).reduce((e,t)=>null!==r&&void 0!==r&&r[t]?e:e+1,0)},[f,r,q]),B=(0,e.useMemo)(()=>{if(1!==a)return[];if(!Array.isArray(u))return[];const e=null===r||void 0===r?void 0:r.goalie,t=(null===q||void 0===q?void 0:q.substitutePositions)||[];return[...u].filter(a=>!(null===a||void 0===a||!a.id||a.id===e)&&!t.some(e=>(null===r||void 0===r?void 0:r[e])===a.id)).map(e=>({id:e.id,displayName:e.displayName,percentStartedAsSub:"number"===typeof R.subPercentages[e.id]?R.subPercentages[e.id]:0})).sort((e,t)=>{if(e.percentStartedAsSub===t.percentStartedAsSub){const a=e.displayName||"",n=t.displayName||"";return a.localeCompare(n)}return e.percentStartedAsSub-t.percentStartedAsSub})},[a,u,r,R.subPercentages,q]),G=(0,e.useMemo)(()=>U<=0?[]:B.slice(0,U),[B,U]),z=e=>{const t=Number.isFinite(e)?e:0;return"".concat(t.toFixed(1),"%")},V=1===a&&U>0&&!R.subHandled,H=(0,e.useMemo)(()=>{const e=(0,wi.getOutfieldPositions)(f),t=e.map(e=>r[e]).filter(Boolean),n=e.length,s=r.goalie&&t.length===n&&new Set(t).size===n,i={isPeriod1:1===a,subHandled:R.subHandled,notYetHandled:!R.positionHandled,hasRecommendations:!!R.positionData,formationIncomplete:!s};return i.isPeriod1&&i.subHandled&&i.notYetHandled&&i.hasRecommendations&&i.formationIncomplete},[a,R.subHandled,R.positionHandled,R.positionData,r,f]),K=(0,e.useMemo)(()=>(0,Wh.P)((null===q||void 0===q?void 0:q.fieldPositions)||[]),[q]),W=(null===q||void 0===q?void 0:q.substitutePositions)||[],[Y,J]=(0,e.useState)(!1),[Q,$]=(0,e.useState)({loading:!1,message:"",error:null}),[X,Z]=(0,e.useState)({isOpen:!1,type:"direct",playerName:"",playerId:"",position:"",role:"",originalValue:"",swapDetails:null,newGoalieId:null,formerGoalieId:null});(0,e.useEffect)(()=>{rd()},[]),(0,e.useEffect)(()=>(y&&y(()=>{Z({isOpen:!1,type:"direct",playerName:"",playerId:"",position:"",role:"",originalValue:"",swapDetails:null}),v()}),()=>{b&&b()}),[y,b,v]);const ee=(0,e.useRef)({teamId:null,period:null,signature:null,openSlotCount:null}),te=(0,e.useRef)({statsSignature:null,formationSignature:null});(0,e.useEffect)(()=>{if(1!==a||null===P||void 0===P||!P.id)return;const e=P.id,t=Array.isArray(u)?u.map(e=>null===e||void 0===e?void 0:e.id).filter(Boolean).sort().join("|"):"";if((ee.current.teamId!==e||ee.current.period!==a||ee.current.signature!==t)&&(ee.current={teamId:e,period:a,signature:t},te.current={statsSignature:null,formationSignature:null},O({subHandled:!1,subPercentages:{},subError:null,positionHandled:!1,positionData:null,positionError:null})),L)return void O(e=>(0,n.A)((0,n.A)({},e),{},{subPercentages:{},subError:L,positionData:null,positionError:L}));if(!D)return;const s=Array.isArray(D)?[...D].filter(e=>null===e||void 0===e?void 0:e.id).map(e=>"".concat(e.id,":").concat(Number.isFinite(e.percentStartedAsSubstitute)?e.percentStartedAsSubstitute:0)).sort().join("|"):"",i=r?Object.keys(r).sort().map(e=>"".concat(e,":").concat(r[e]||"")).join("|"):"";if(!(te.current.statsSignature!==s||te.current.formationSignature!==i))return;te.current={statsSignature:s,formationSignature:i};let o=!0;return(async()=>{try{const a={};if(D.forEach(e=>{null!==e&&void 0!==e&&e.id&&(a[e.id]="number"===typeof e.percentStartedAsSubstitute?e.percentStartedAsSubstitute:0)}),!o)return;O(e=>(0,n.A)((0,n.A)({},e),{},{subPercentages:a,subError:null}));const s=await E(P.id);if(!o)return;let i=null;if(!1!==(null===s||void 0===s?void 0:s.alternateRoles)){var e,t;const a=new Set(u.map(e=>e.id).filter(Boolean)),n=D.filter(e=>a.has(e.id)),s=(null===q||void 0===q||null===(e=q.substitutePositions)||void 0===e||null===(t=e.map(e=>null===r||void 0===r?void 0:r[e]))||void 0===t?void 0:t.filter(Boolean))||[];i=Vh(n,r,f,null===r||void 0===r?void 0:r.goalie,s)}if(!o)return;O(e=>(0,n.A)((0,n.A)({},e),{},{subPercentages:a,subError:null,positionData:i,positionError:null}))}catch(a){if(!o)return;O(e=>(0,n.A)((0,n.A)({},e),{},{subPercentages:{},subError:a.message||I("periodSetup.substituteRecommendations.error"),positionData:null,positionError:a.message||I("positionRecommendations.error")}))}})(),()=>{o=!1}},[a,D,L,null===P||void 0===P?void 0:P.id,u,r,f,q,E,I]);const ae=(0,e.useCallback)(()=>{O(e=>(0,n.A)((0,n.A)({},e),{},{subHandled:!0}))},[]),ne=(0,e.useCallback)(()=>{0!==G.length?(q&&s(e=>{const t=(q.substitutePositions||[]).filter(t=>!e[t]);if(0===t.length)return e;const a=G.slice(0,t.length),r=new Set(a.map(e=>e.id)),s=(0,n.A)({},e);return(q.fieldPositions||[]).forEach(e=>{r.has(s[e])&&(s[e]=null)}),t.forEach((e,t)=>{const n=a[t];n&&(s[e]=n.id)}),s}),O(e=>(0,n.A)((0,n.A)({},e),{},{subHandled:!0}))):O(e=>(0,n.A)((0,n.A)({},e),{},{subHandled:!0}))},[G,q,s]),re=(0,e.useCallback)(()=>{var e;null!==(e=R.positionData)&&void 0!==e&&e.recommendations?(s(e=>{const t=(0,n.A)({},e);return Object.entries(R.positionData.recommendations).forEach(e=>{let[a,n]=e;null!==n&&void 0!==n&&n.playerId&&(t[a]=n.playerId)}),t}),O(e=>(0,n.A)((0,n.A)({},e),{},{positionHandled:!0}))):O(e=>(0,n.A)((0,n.A)({},e),{},{positionHandled:!0}))},[R.positionData,s]),se=(0,e.useCallback)(()=>{O(e=>(0,n.A)((0,n.A)({},e),{},{positionHandled:!0}))},[]);(0,e.useEffect)(()=>{M&&s(M)},[M,s]),(0,e.useEffect)(()=>{if(r.goalie&&a>1){var e;const t=o.find(e=>e.id===r.goalie);null!==t&&void 0!==t&&null!==(e=t.stats)&&void 0!==e&&e.isInactive&&!Y&&Z({isOpen:!0,type:"inactive-goalie",playerName:Bi(t),playerId:t.id,position:"goalie",role:"",originalValue:r.goalie,swapDetails:null})}},[r.goalie,o,a,Y]);const ie=e=>{var t;const a=o.find(t=>t.id===e);return(null===a||void 0===a||null===(t=a.stats)||void 0===t?void 0:t.isInactive)||!1},oe=function(e){return"leftDefender"===e||"rightDefender"===e||"leftAttacker"===e||"rightAttacker"===e||"defender"===e||"left"===e||"right"===e||"attacker"===e||"leftMidfielder"===e||"rightMidfielder"===e||"centerMidfielder"===e},le=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(oe(t,a))return null;const n=(e=>{const t=(0,wi.getOutfieldPositions)(f);for(const a of t)if(r[a]===e)return{position:a};return null})(e);if(!n||!oe(n.position,n.role))return null;const s=r[t];if(s&&ie(s)){const r=o.find(e=>e.id===s);return{displacedPlayerId:s,displacedPlayerName:Bi(r),selectedPlayerId:e,targetPosition:t,targetRole:a,fieldPosition:n.position,fieldRole:n.role}}return null},ce=(e,t)=>{if(he()&&t){let a=null;if((0,wi.getOutfieldPositions)(f).forEach(e=>{r[e]===t&&(a=e)}),a){const i=r[e];return void s(r=>(0,n.A)((0,n.A)({},r),{},{[e]:t,[a]:i}))}}const a=[];if((0,wi.getOutfieldPositions)(f).forEach(t=>{t!==e&&r[t]&&a.push(r[t])}),t&&a.includes(t)){const e=zi(o,t);return void alert(I("periodSetup.alerts.alreadyAssigned",{playerName:e}))}s(a=>(0,n.A)((0,n.A)({},a),{},{[e]:t}))},de=(e,t)=>{if(!t)return ce(e,t);if(ie(t)&&oe(e)){const a=o.find(e=>e.id===t),n=r[e]||"";return void function(e,t,a){Z({isOpen:!0,type:"direct",playerName:e,playerId:t,position:a,role:arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",originalValue:arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",swapDetails:null})}(Bi(a),t,e,"",n)}if(he()&&t){const a=le(t,e);if(a){return void function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Z({isOpen:!0,type:"indirect",playerName:e.displacedPlayerName,playerId:e.displacedPlayerId,position:e.targetPosition,role:e.targetRole,originalValue:t,swapDetails:e})}(a,r[e]||"")}}ce(e,t)},ue=(e,t)=>{let i=null;if((0,wi.getOutfieldPositions)(f).forEach(t=>{r[t]===e&&(i={position:t})}),s(i&&t?a=>(0,n.A)((0,n.A)({},a),{},{goalie:e,[i.position]:t}):t=>(0,n.A)((0,n.A)({},t),{},{goalie:e})),h(t=>(0,n.A)((0,n.A)({},t),{},{[a]:e})),N&&N.length>0){const a=N.findIndex(t=>t===e);if(-1!==a){const e=[...N];t?e[a]=t:e.splice(a,1),j(e)}else if(t){const e=[...N,t];j(e)}}},me=e=>{if(he())return i;const t=new Set;return(0,wi.getOutfieldPositions)(f).forEach(a=>{a!==e&&r[a]&&t.add(r[a])}),i.filter(e=>!t.has(e.id))},he=()=>{const e=(0,wi.getOutfieldPositions)(f),t=e.map(e=>r[e]).filter(Boolean),a=e.length;return r.goalie&&t.length===a&&new Set(t).size===a};return(0,Ts.jsxs)("div",{className:"space-y-3",children:[(0,Ts.jsxs)("h2",{className:"text-xl font-semibold text-sky-300 flex items-center",children:[(0,Ts.jsx)(od,{className:"mr-2 h-6 w-6"}),I("periodSetup.header.title",{period:a})]}),(0,Ts.jsxs)("div",{className:"p-2 bg-slate-700 rounded-lg text-center",children:[(0,Ts.jsx)("h3",{className:"text-sm font-medium text-sky-200 mb-2",children:I("periodSetup.score.title")}),(0,Ts.jsxs)("div",{className:"flex items-center justify-center space-x-4",children:[(0,Ts.jsxs)("div",{className:"text-center",children:[(0,Ts.jsx)("div",{className:"text-2xl font-bold text-sky-400",children:x}),(0,Ts.jsx)("div",{className:"text-xs text-slate-300 font-semibold",children:k})]}),(0,Ts.jsx)("div",{className:"text-xl font-mono font-bold text-slate-400",children:"-"}),(0,Ts.jsxs)("div",{className:"text-center",children:[(0,Ts.jsx)("div",{className:"text-2xl font-bold text-slate-400",children:w}),(0,Ts.jsx)("div",{className:"text-xs text-slate-300 font-semibold",children:S||I("periodSetup.score.opponent")})]})]})]}),V&&(0,Ts.jsxs)("div",{"data-testid":"substitute-recommendations",className:"p-2 bg-slate-700 rounded-lg space-y-2",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("h3",{className:"text-sm font-medium text-sky-200",children:I("periodSetup.substituteRecommendations.title")}),(0,Ts.jsx)("span",{className:"text-xs text-slate-300",children:I("periodSetup.substituteRecommendations.timeframe")})]}),F?(0,Ts.jsx)("p",{className:"text-xs text-slate-300",children:I("periodSetup.substituteRecommendations.loading")}):R.subError?(0,Ts.jsx)("p",{className:"text-xs text-rose-300",children:I("periodSetup.substituteRecommendations.error")}):G.length>0?(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)("p",{className:"text-xs text-slate-300",children:I("periodSetup.substituteRecommendations.description")}),(0,Ts.jsx)("ul",{className:"space-y-1","data-testid":"substitute-recommendations-list",children:G.map(e=>(0,Ts.jsxs)("li",{className:"flex items-center justify-between rounded-md bg-slate-800/60 px-2 py-1 text-sm text-slate-100",children:[(0,Ts.jsx)("span",{children:e.displayName}),(0,Ts.jsx)("span",{className:"text-xs text-slate-300",children:z(e.percentStartedAsSub)})]},e.id))})]}):(0,Ts.jsx)("p",{className:"text-xs text-slate-300",children:I("periodSetup.substituteRecommendations.noEligible")}),(0,Ts.jsxs)("div",{className:"flex items-center justify-end space-x-2 pt-1",children:[(0,Ts.jsx)(Lc,{variant:"secondary",onClick:ae,children:I("periodSetup.substituteRecommendations.dismiss")}),(0,Ts.jsx)(Lc,{variant:"accent",onClick:ne,disabled:F||0===G.length,children:I("periodSetup.substituteRecommendations.accept")})]})]}),H&&(0,Ts.jsx)(Kh,{recommendations:R.positionData,onAccept:re,onDismiss:se,allPlayers:o,loading:F,error:R.positionError}),Q.message&&(0,Ts.jsx)(Jc,{variant:"success",children:Q.message}),Q.error&&(0,Ts.jsx)(Jc,{variant:"error",children:I("periodSetup.saveStatus.error",{message:Q.error})}),r.goalie&&(0,Ts.jsx)($h,{fieldGroups:K,substitutePositions:[],formation:r,onPlayerAssign:de,getAvailableOptions:me,currentPeriodNumber:a,t:I}),(()=>{const e=r.goalie&&ie(r.goalie),t=e?"bg-amber-700 border border-amber-500":"bg-emerald-700",s=e?"text-amber-200":"text-emerald-100";return(0,Ts.jsxs)("div",{className:"p-2 ".concat(t," rounded-md"),children:[(0,Ts.jsx)("h3",{className:"text-sm font-medium ".concat(s," mb-1"),children:I(e?"periodSetup.goalie.headerInactive":"periodSetup.goalie.header",{period:a})}),(0,Ts.jsx)(Dc,{value:r.goalie||"",onChange:e=>(e=>{const t=r.goalie;if(e!==t)return Y&&a>1&&e&&T?(J(!1),h(t=>(0,n.A)((0,n.A)({},t),{},{[a]:e})),ue(e,t),void setTimeout(()=>{T(a,d,e)},10)):void(a>1&&e&&t&&T?Z({isOpen:!0,type:"recommendation-rerun",playerName:zi(o,e),playerId:e,position:"goalie",role:"",originalValue:t,swapDetails:null,newGoalieId:e,formerGoalieId:t}):ue(e,t))})(e),options:[...u].sort((e,t)=>{var a,n;const r=(null===(a=e.stats)||void 0===a?void 0:a.isInactive)||!1,s=(null===(n=t.stats)||void 0===n?void 0:n.isInactive)||!1;return r&&!s?1:!r&&s?-1:0}).map(e=>({value:e.id,label:Hl(e,a)})),placeholder:I("periodSetup.goalie.placeholder")})]})})(),r.goalie&&(0,Ts.jsx)($h,{fieldGroups:[],substitutePositions:W,formation:r,onPlayerAssign:de,getAvailableOptions:me,currentPeriodNumber:a,t:I}),A&&"running"!==_&&1===a&&(0,Ts.jsx)(Lc,{onClick:async()=>{if(A){$({loading:!0,message:I("periodSetup.saveStatus.saving"),error:null});try{const e=await A();e.success?($({loading:!1,message:I("periodSetup.saveStatus.success",{message:e.message||I("periodSetup.saveStatus.defaultSuccess")}),error:null}),rd(),setTimeout(()=>{$(e=>(0,n.A)((0,n.A)({},e),{},{message:""}))},3e3)):$({loading:!1,message:"",error:e.error||I("periodSetup.saveStatus.defaultError")})}catch(e){console.error("Save period configuration error:",e),$({loading:!1,message:"",error:I("periodSetup.saveStatus.defaultError")+": "+e.message})}}else console.warn("handleSavePeriodConfiguration is not provided")},disabled:Q.loading||!he(),variant:"secondary",Icon:wc,children:Q.loading?I("periodSetup.buttons.saving"):I("periodSetup.buttons.saveConfig")}),(0,Ts.jsx)(Lc,{onClick:c,disabled:!he(),Icon:kc,children:I("periodSetup.buttons.enterGame")}),C&&1===a&&(0,Ts.jsx)(Lc,{onClick:()=>{if(!r.goalie)return void alert(I("periodSetup.alerts.selectGoalieFirst"));const e=i;if(0===e.length)return void alert(I("periodSetup.alerts.noPlayersAvailable"));const t=((e,t)=>{const a=nd(e),n={},r=(null===t||void 0===t?void 0:t.formation)||"2-2",s=(null===t||void 0===t?void 0:t.squadSize)||7;let i;i="7v7"===((null===t||void 0===t?void 0:t.format)||"5v5")?6:4;const o=s-i-1;if("1-2-1"===r){var l,c,d,u;n.defender=(null===(l=a[0])||void 0===l?void 0:l.id)||null,n.left=(null===(c=a[1])||void 0===c?void 0:c.id)||null,n.right=(null===(d=a[2])||void 0===d?void 0:d.id)||null,n.attacker=(null===(u=a[3])||void 0===u?void 0:u.id)||null;for(let e=0;e<o;e++){var m;n["substitute_".concat(e+1)]=(null===(m=a[4+e])||void 0===m?void 0:m.id)||null}}else if("2-2"===r){var h,p,f,g;n.leftDefender=(null===(h=a[0])||void 0===h?void 0:h.id)||null,n.rightDefender=(null===(p=a[1])||void 0===p?void 0:p.id)||null,n.leftAttacker=(null===(f=a[2])||void 0===f?void 0:f.id)||null,n.rightAttacker=(null===(g=a[3])||void 0===g?void 0:g.id)||null;for(let e=0;e<o;e++){var v;n["substitute_".concat(e+1)]=(null===(v=a[4+e])||void 0===v?void 0:v.id)||null}}else if("2-2-2"===r){var y,b,x,w,S,k;n.leftDefender=(null===(y=a[0])||void 0===y?void 0:y.id)||null,n.rightDefender=(null===(b=a[1])||void 0===b?void 0:b.id)||null,n.leftMidfielder=(null===(x=a[2])||void 0===x?void 0:x.id)||null,n.rightMidfielder=(null===(w=a[3])||void 0===w?void 0:w.id)||null,n.leftAttacker=(null===(S=a[4])||void 0===S?void 0:S.id)||null,n.rightAttacker=(null===(k=a[5])||void 0===k?void 0:k.id)||null;for(let e=0;e<o;e++){var N;n["substitute_".concat(e+1)]=(null===(N=a[6+e])||void 0===N?void 0:N.id)||null}}else if("2-3-1"===r){var j,T,A,_,C,M;n.leftDefender=(null===(j=a[0])||void 0===j?void 0:j.id)||null,n.rightDefender=(null===(T=a[1])||void 0===T?void 0:T.id)||null,n.leftMidfielder=(null===(A=a[2])||void 0===A?void 0:A.id)||null,n.centerMidfielder=(null===(_=a[3])||void 0===_?void 0:_.id)||null,n.rightMidfielder=(null===(C=a[4])||void 0===C?void 0:C.id)||null,n.attacker=(null===(M=a[5])||void 0===M?void 0:M.id)||null;for(let e=0;e<o;e++){var P;n["substitute_".concat(e+1)]=(null===(P=a[6+e])||void 0===P?void 0:P.id)||null}}else{var E,I,R,O;n.leftDefender=(null===(E=a[0])||void 0===E?void 0:E.id)||null,n.rightDefender=(null===(I=a[1])||void 0===I?void 0:I.id)||null,n.leftAttacker=(null===(R=a[2])||void 0===R?void 0:R.id)||null,n.rightAttacker=(null===(O=a[3])||void 0===O?void 0:O.id)||null;for(let e=0;e<o;e++){var D;n["substitute_".concat(e+1)]=(null===(D=a[4+e])||void 0===D?void 0:D.id)||null}}return n})(e,f);if(0===Object.keys(t).length)return void alert(I("periodSetup.alerts.randomizeFailed"));const a=(0,n.A)((0,n.A)((0,n.A)({},r),t),{},{goalie:r.goalie});s(a)},variant:"accent",Icon:Nc,className:"bg-amber-600 hover:bg-amber-700 text-white",children:I("periodSetup.buttons.randomize")}),1===a&&(0,Ts.jsx)(Lc,{onClick:v,Icon:Uh,children:I("periodSetup.buttons.backToConfig")}),(0,Ts.jsx)(qc,{isOpen:X.isOpen,onConfirm:()=>{const{type:e,playerId:t,position:r,swapDetails:s}=X;if(l(e=>e.map(e=>e.id===t?(0,n.A)((0,n.A)({},e),{},{stats:(0,n.A)((0,n.A)({},e.stats),{},{isInactive:!1})}):e)),"direct"===e)ce(r,t);else if("indirect"===e&&s)ce(r,s.selectedPlayerId);else if("inactive-goalie"===e);else if("recommendation-rerun"===e){const{newGoalieId:e,formerGoalieId:t}=X;ue(e,t),T&&d.length>0&&h(t=>{const r=(0,n.A)((0,n.A)({},t),{},{[a]:e});return setTimeout(()=>{T(a,d,e)},10),r})}Z({isOpen:!1,type:"direct",playerName:"",playerId:"",position:"",role:"",originalValue:"",swapDetails:null})},onCancel:()=>{const{type:e,position:t,originalValue:a}=X;if("inactive-goalie"===e)J(!0),s(e=>(0,n.A)((0,n.A)({},e),{},{goalie:null}));else if("recommendation-rerun"===e){const{newGoalieId:e,formerGoalieId:t}=X;ue(e,t)}else s(e=>(0,n.A)((0,n.A)({},e),{},{[t]:a}));Z({isOpen:!1,type:"direct",playerName:"",playerId:"",position:"",role:"",originalValue:"",swapDetails:null})},title:"inactive-goalie"===X.type?I("periodSetup.modals.inactiveGoalie.title"):"recommendation-rerun"===X.type?I("periodSetup.modals.recommendationRerun.title"):I("periodSetup.modals.activatePlayer.title"),message:"inactive-goalie"===X.type?I("periodSetup.modals.inactiveGoalie.message",{playerName:X.playerName}):"recommendation-rerun"===X.type?I("periodSetup.modals.recommendationRerun.message",{formerGoalie:zi(o,X.formerGoalieId)||I("periodSetup.fallbacks.unknownPlayer"),newGoalie:X.playerName}):I("periodSetup.modals.activatePlayer.message",{playerName:X.playerName}),confirmText:"inactive-goalie"===X.type?I("periodSetup.modals.inactiveGoalie.confirm"):"recommendation-rerun"===X.type?I("periodSetup.modals.recommendationRerun.confirm"):I("periodSetup.modals.activatePlayer.confirm"),cancelText:"inactive-goalie"===X.type?I("periodSetup.modals.inactiveGoalie.cancel"):"recommendation-rerun"===X.type?I("periodSetup.modals.recommendationRerun.cancel"):I("periodSetup.modals.activatePlayer.cancel"),variant:"accent"})]})}const Zh=fc("square-play",[["rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",key:"h1oib"}],["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}]]),ep=fc("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]]),tp=fc("refresh-ccw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]),ap=fc("undo-2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]]),np=fc("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),rp=fc("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);const sp=e=>{if(null===e||void 0===e||!e.stats)return Je.q.SUBSTITUTE;const{currentRole:t,currentStatus:a}=e.stats;return t&&"On Field"!==t?(0,ki.GY)(t):a?(0,ki.GY)(a):Je.q.SUBSTITUTE},ip=t=>{var a;let{isOpen:n,onClose:r,onSelectScorer:s,onCorrectGoal:i,eligiblePlayers:o=[],mode:l="new",eventId:c=null,currentScorerId:d=null,existingGoalData:u=null,matchTime:m="00:00",goalType:h="scored"}=t;const{t:p}=xe(["modals","common","shared"]),[f,g]=(0,e.useState)("new"===l?null:null!==(a=null!==d&&void 0!==d?d:null===u||void 0===u?void 0:u.scorerId)&&void 0!==a?a:null);(0,e.useEffect)(()=>{if(n){var e;const t="new"===l?null:null!==(e=null!==d&&void 0!==d?d:null===u||void 0===u?void 0:u.scorerId)&&void 0!==e?e:null;g(t)}},[n,d,u,l]);const v=(0,e.useMemo)(()=>{switch(l){case"correct":return{title:p("modals:goalScorer.correctGoalScorer"),subtitle:p("modals:goalScorer.goalAt",{time:m}),primaryAction:p("modals:goalScorer.updateScorer"),primaryColor:"bg-amber-600 hover:bg-amber-500 focus:ring-amber-500"};case"view":return{title:p("modals:goalScorer.goalInformation"),subtitle:p("modals:goalScorer.goalAt",{time:m}),primaryAction:p("shared:close"),primaryColor:"bg-slate-600 hover:bg-slate-500 focus:ring-slate-500"};default:return{title:p("modals:goalScorer.title"),subtitle:p("scored"===h?"modals:goalScorer.scoredGoalAt":"modals:goalScorer.concededGoalAt",{time:m}),primaryAction:p("modals:goalScorer.confirmScorer"),primaryColor:"bg-sky-600 hover:bg-sky-500 focus:ring-sky-500"}}},[l,m,h,p]),y=e=>{g(e)};return n?(0,Ts.jsxs)(Mc,{title:v.title,icon:jd,iconColor:"amber",onClose:r,className:"max-h-[90vh] overflow-hidden",children:[(0,Ts.jsx)("p",{className:"text-sm text-slate-400 -mt-2 mb-4",children:v.subtitle}),("correct"===l||"view"===l)&&(void 0!==d||u)&&(0,Ts.jsxs)(Xc,{className:"mb-6",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,Ts.jsx)(od,{className:"w-4 h-4 text-sky-400"}),(0,Ts.jsx)("span",{className:"text-sm font-medium text-sky-300",children:p("modals:goalScorer.currentScorer")})]}),(0,Ts.jsx)("p",{className:"text-slate-100",children:(null!==d&&void 0!==d?d:null===u||void 0===u?void 0:u.scorerId)?Hi(o,null!==d&&void 0!==d?d:null===u||void 0===u?void 0:u.scorerId):p("modals:goalScorer.noScorerRecorded")})]}),"view"!==l&&(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)("h3",{className:"text-sm font-medium text-slate-100 mb-3",children:p("correct"===l?"modals:goalScorer.selectNewScorer":"modals:goalScorer.selectScorer")}),(0,Ts.jsx)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:o.map(e=>{const t=(e=>{if(!e)return rp;switch(sp(e)){case Je.q.ATTACKER:return yh;case Je.q.DEFENDER:return dd;case Je.q.MIDFIELDER:return xh;case Je.q.GOALIE:return bh;case Je.q.SUBSTITUTE:default:return rp}})(e),a=(e=>{if(!e)return"text-gray-400";switch(sp(e)){case Je.q.ATTACKER:return"text-red-500";case Je.q.DEFENDER:return"text-blue-500";case Je.q.MIDFIELDER:return"text-yellow-500";case Je.q.GOALIE:return"text-green-500";case Je.q.SUBSTITUTE:default:return"text-gray-400"}})(e);return(0,Ts.jsx)("button",{onClick:()=>y(e.id),className:"w-full text-left p-3 rounded-lg border transition-colors focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-offset-2 focus:ring-offset-slate-800 ".concat(f===e.id?"bg-sky-500 bg-opacity-20 border-sky-400 text-slate-100":"bg-slate-700 border-slate-600 text-slate-100 hover:bg-slate-600 hover:border-slate-500"),children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ts.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(f===e.id?"bg-sky-400":"bg-slate-500")}),(0,Ts.jsx)(t,{className:"w-4 h-4 ".concat(a)}),(0,Ts.jsx)("span",{className:"font-medium",children:Hi([e],e.id)})]})},e.id)})}),"new"===l&&(0,Ts.jsx)("button",{onClick:()=>y(null),className:"w-full text-left p-3 rounded-lg border transition-colors mt-2 focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-offset-2 focus:ring-offset-slate-800 ".concat(null===f?"bg-slate-500 bg-opacity-30 border-slate-500 text-slate-100":"bg-slate-700 border-slate-600 text-slate-300 hover:bg-slate-600 hover:border-slate-500"),children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ts.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(null===f?"bg-slate-400":"bg-slate-500")}),(0,Ts.jsx)("span",{className:"italic",children:p("modals:goalScorer.noSpecificScorer")})]})})]}),"view"===l&&(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("h3",{className:"text-sm font-medium text-slate-100 mb-2",children:p("modals:goalScorer.goalDetails")}),(0,Ts.jsxs)("div",{className:"space-y-2 text-sm text-slate-300",children:[(0,Ts.jsxs)("div",{children:[p("modals:goalScorer.team"),": ",(0,Ts.jsx)("span",{className:"font-medium text-slate-100",children:p("scored"===h?"modals:goalScorer.scored":"modals:goalScorer.conceded")})]}),(0,Ts.jsxs)("div",{children:[p("modals:goalScorer.time"),": ",(0,Ts.jsx)("span",{className:"font-medium text-slate-100",children:m})]}),(0,Ts.jsxs)("div",{children:[p("modals:goalScorer.period"),": ",(0,Ts.jsx)("span",{className:"font-medium text-slate-100",children:(null===u||void 0===u?void 0:u.period)||p("modals:goalScorer.unknown")})]}),(0,Ts.jsxs)("div",{children:[p("modals:goalScorer.scorer"),": ",(0,Ts.jsx)("span",{className:"font-medium text-slate-100",children:(null!==d&&void 0!==d?d:null===u||void 0===u?void 0:u.scorerId)?Hi(o,null!==d&&void 0!==d?d:null===u||void 0===u?void 0:u.scorerId):p("modals:goalScorer.noScorerRecorded")})]})]})]}),(0,Ts.jsx)("div",{className:"bg-slate-700 rounded-lg p-3 border border-slate-600",children:(0,Ts.jsx)("p",{className:"text-sm text-sky-300",children:p("modals:goalScorer.readOnlyNotice")})})]}),(0,Ts.jsx)("div",{className:"pt-4 border-t border-slate-600",children:(0,Ts.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,Ts.jsx)("button",{onClick:r,className:"px-4 py-2 text-slate-300 bg-slate-600 rounded-lg hover:bg-slate-500 transition-colors focus:outline-none focus:ring-2 focus:ring-slate-500 focus:ring-offset-2 focus:ring-offset-slate-800",children:p("common:buttons.cancel")}),"view"!==l&&(0,Ts.jsx)("button",{onClick:()=>{if("view"!==l){if("new"===l)s(f);else if("correct"===l){const e=c||(null===u||void 0===u?void 0:u.eventId);if(!e)return void console.error("No eventId provided for goal correction");i(e,f)}r()}else r()},className:"px-4 py-2 text-white rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-800 ".concat(v.primaryColor),children:v.primaryAction})]})})]}):null};const op=fc("circle-arrow-down",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]),lp=fc("circle-arrow-up",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);const cp="p-2 rounded-lg shadow-md transition-all duration-300 border-2 relative",dp={field:"bg-sky-700",defenderField:"bg-sky-900",midfielderField:"bg-sky-800",substitute:"bg-slate-700",inactive:"bg-slate-800",goalie:"bg-emerald-700"},up={field:"text-sky-100",substitute:"text-slate-300",inactive:"text-slate-500"},mp={transparent:"border-transparent",nextOff:"border-rose-500",nextOn:"border-emerald-500",recentlySubstituted:"border-amber-400"},hp={recentlySubstituted:"animate-pulse shadow-lg shadow-amber-400/50 border-amber-400"},pp="cursor-pointer select-none",fp="inline h-3 w-3 mr-1",gp="h-5 w-5",vp={nextOff:"text-rose-400",nextOn:"text-emerald-400"};new Proxy({},{get(e,t){if("string"!==typeof t)return;const a=t.startsWith("substitute_")?"substitute":t;return W.t("game:formation.positions.".concat(a),{defaultValue:t})}});const yp={goalie:"Goalie",leftDefender:"Left Defender",rightDefender:"Right Defender",leftAttacker:"Left Attacker",rightAttacker:"Right Attacker",defender:"Defender",left:"Left Mid",right:"Right Mid",attacker:"Attacker",leftMidfielder:"Left Midfielder",rightMidfielder:"Right Midfielder",centerMidfielder:"Center Midfielder",substitute_1:"Substitute",substitute_2:"Substitute",substitute_3:"Substitute",substitute_4:"Substitute",substitute_5:"Substitute"},bp={goalie:"formation.positions.goalie",leftDefender:"formation.positions.leftDefender",rightDefender:"formation.positions.rightDefender",leftAttacker:"formation.positions.leftAttacker",rightAttacker:"formation.positions.rightAttacker",defender:"formation.positions.defender",left:"formation.positions.left",right:"formation.positions.right",attacker:"formation.positions.attacker",leftMidfielder:"formation.positions.leftMidfielder",rightMidfielder:"formation.positions.rightMidfielder",centerMidfielder:"formation.positions.centerMidfielder",substitute_1:"formation.positions.substitute",substitute_2:"formation.positions.substitute",substitute_3:"formation.positions.substitute",substitute_4:"formation.positions.substitute",substitute_5:"formation.positions.substitute"};function xp(e,t,a,n,r){if((0,wi.supportsInactiveUsers)(a)&&n.includes(e)&&null!==t&&void 0!==t&&t.stats.isInactive)return r?r("formation.inactiveStatus"):"Inactive";const s=bp[e];return s&&r?r(s):yp[e]||e}function wp(e,t,a,n,r){const s={},i=e.slice(0,r);return n.slice(0,r).forEach((e,n)=>{if(n<i.length){const r=i[n],o=a.find(e=>t[e]===r);o&&(s[e]=o)}}),s}const Sp=16,kp=4,Np=8,jp=56,Tp=72,Ap=(e,t)=>{if("goalie"===e)return!0;return(0,$i.pr)(t).includes(e)},_p=(e,t)=>(0,$i.fd)(t).includes(e),Cp=function(e,t){try{const a=(0,wi.getModeDefinition)(t);if(!a)return-1;const n=[...(0,Wh.a)(a.fieldPositions||[]),kl,...a.substitutePositions];return n.indexOf(e)}catch(a){return console.warn("Error getting position index for ".concat(e," in ").concat(t,":"),a),-1}},Mp=function(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(-1===e||-1===t||e===t)return 0;const s=Sp+kp+jp+Np;let i=Math.abs(t-e)*s*.9025;return n&&r&&((e,t,a)=>{const n=Ap(e,a),r=Ap(t,a),s=_p(e,a),i=_p(t,a);return n&&i||s&&r})(n,r,a)&&(i+=Tp),t>e?i:-i},Pp=function(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r={};e.goalie&&(r[e.goalie]={playerId:e.goalie,position:kl,positionIndex:Cp(kl,a,n)});const s=(0,wi.getModeDefinition)(a);if(s){[...s.fieldPositions,...s.substitutePositions].forEach(t=>{const s=e[t];if(s){const e=Cp(t,a,n);r[s]={playerId:s,position:t,positionIndex:e}}})}return r},Ep=(e,t,a,r,s,i)=>{const o=Pp(e.formation,e.allPlayers,e.teamConfig,e.selectedFormation),l=t(e),c=((e,t,a)=>{const n={};return e&&t?(new Set([...Object.keys(e),...Object.keys(t)]).forEach(r=>{const s=e[r],i=t[r];if(!s||!i||s.positionIndex===i.positionIndex)return;const o=Mp(s.positionIndex,i.positionIndex,a,s.position,i.position);0!==o&&(n[r]={playerId:r,distance:o,direction:o>0?"down":"up",fromPosition:s.position,toPosition:i.position})}),n):n})(o,Pp(l.formation,l.allPlayers,l.teamConfig,l.selectedFormation||e.selectedFormation),e.teamConfig);var d;Object.keys(c).length>0?(r({type:"generic",phase:"switching",data:{animations:c}}),s&&s(!0),setTimeout(()=>{var e;a(l),i&&(null===(e=l.playersToHighlight)||void 0===e?void 0:e.length)>0&&i(new Set(l.playersToHighlight)),r(e=>(0,n.A)((0,n.A)({},e),{},{phase:"completing"})),setTimeout(()=>{r({type:"none",phase:"idle",data:{}}),s&&s(!1),i&&i(new Set)},900)},1e3)):(a(l),i&&(null===(d=l.playersToHighlight)||void 0===d?void 0:d.length)>0&&(i(new Set(l.playersToHighlight)),setTimeout(()=>{i(new Set)},900)))};function Ip(e){let{playerId:t,getPlayerTimeStats:a,className:n=""}=e;if(!t)return null;const r=a(t);return(0,Ts.jsxs)("div",{className:"text-right text-xs ".concat(n),children:[(0,Ts.jsxs)("span",{children:[(0,Ts.jsx)(Sd,{className:fp}),(0,Ts.jsx)("span",{className:"font-mono",children:Bl(r.totalOutfieldTime)})]}),(0,Ts.jsxs)("span",{className:"ml-3",children:[(0,Ts.jsx)(yh,{className:fp}),(0,Ts.jsx)("span",{className:"font-mono",children:Vl(r.attackDefenderDiff)})]})]})}const Rp=["teamConfig","selectedFormation","formation","allPlayers","animationState","recentlySubstitutedPlayers","hideNextOffIndicator","quickTapHandlers","goalieHandlers","getPlayerNameById","getPlayerTimeStats","nextPlayerIdToSubOut","substitutionCount","rotationQueue","renderSection"],Op={};function Dp(t){let{teamConfig:a,selectedFormation:r,formation:s,allPlayers:i,animationState:o,recentlySubstitutedPlayers:l,hideNextOffIndicator:c,quickTapHandlers:d,goalieHandlers:u,getPlayerNameById:m,getPlayerTimeStats:h,nextPlayerIdToSubOut:p,substitutionCount:f=1,rotationQueue:g=[],renderSection:v="all"}=t,y=he(t,Rp);const{t:b}=xe("game"),x=b("formation.inactive"),w=e.useMemo(()=>r&&r!==a.formation?(0,n.A)((0,n.A)({},a),{},{formation:r}):a,[r,a]),S=(0,$i.pr)(w),k=(0,$i.fd)(w),N=e.useMemo(()=>(0,Wh.a)(S),[S]),j=(0,wi.supportsInactiveUsers)(w),T=e.useMemo(()=>wp(g,s||Op,S,k,f),[g,s,S,k,f]),A=e.useMemo(()=>{const e={};return Object.entries(T).forEach(t=>{let[a,n]=t;const r=xp(n,null,w,k,b),i=null===s||void 0===s?void 0:s[n],o=i&&m?m(i):null;e[a]=o?"".concat(o," - ").concat(r):r}),e},[T,w,k,s,m,b]);if(!s)return(0,Ts.jsx)("div",(0,n.A)({className:"space-y-2"},y));let _;_="field"===v?[...N,"goalie"]:"substitutes"===v?k:[...N,"goalie",...k];const C=(e,t)=>{const a=s[e];if(!a)return null;const r=S.includes(e),v=k.includes(e),y="goalie"===e,N=r,T=l.has(a),_=Ui(i,a),C=j&&(null===_||void 0===_?void 0:_.stats.isInactive)||!1,{isNextOff:M,isNextOn:P}=function(e,t,a,n,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[];const o=null===e||void 0===e?void 0:e.id,l=r.includes(t),c=i.slice(0,s),d=r.slice(0,s);return{isNextOff:c.includes(o),isNextOn:l&&d.includes(t)}}(_,e,w,p,k,f,g),E=(0,$i.Mf)(e),{animationClass:I,zIndexClass:R,styleProps:O}=function(e,t){if(!e||!t)return{animationClass:"",zIndexClass:"",styleProps:{}};const a=((e,t)=>{var a;if("generic"!==t.type||"switching"!==t.phase)return null;const n=null===(a=t.data.animations)||void 0===a?void 0:a[e];return n?{animationClass:"down"===n.direction?"animate-dynamic-down":"animate-dynamic-up",zIndexClass:"down"===n.direction?"z-10":"z-20",styleProps:{"--move-distance":"".concat(n.distance,"px")}}:null})(e,t);return a?{animationClass:a.animationClass||"",zIndexClass:a.zIndexClass||"",styleProps:a.styleProps||{}}:{animationClass:"",zIndexClass:"",styleProps:{}}}(a,o),{bgColor:D,textColor:F,borderColor:L,glowClass:q}=function(e){let{isFieldPosition:t=!1,isInactive:a=!1,isNextOff:n=!1,isNextOn:r=!1,isRecentlySubstituted:s=!1,hideNextOffIndicator:i=!1,supportsInactiveUsers:o=!1,role:l=null,isGoalie:c=!1}=e,d=dp.substitute;c?d=dp.goalie:t&&(d=l===Je.q.DEFENDER?dp.defenderField:l===Je.q.MIDFIELDER?dp.midfielderField:(Je.q.ATTACKER,dp.field)),o&&a&&(d=dp.inactive);let u=up.substitute;t&&(u=up.field),o&&a&&(u=up.inactive);let m=mp.transparent,h="";return s?(h=hp.recentlySubstituted,m=mp.recentlySubstituted):i||(n?m=mp.nextOff:r&&(m=mp.nextOn)),{bgColor:d,textColor:u,borderColor:m,glowClass:h}}({isFieldPosition:r,isInactive:C,isNextOff:M,isNextOn:P,isRecentlySubstituted:T,hideNextOffIndicator:c,supportsInactiveUsers:j,role:E,isGoalie:y}),U=y&&u?u.goalieEvents:function(e,t){return e["".concat(t,"Events")]||{}}(d,e),B=xp(e,_,w,k,b),G=function(e,t){if("goalie"===e)return(0,Ts.jsx)(bh,{className:fp});if(t&&t.includes(e))return(0,Ts.jsx)(rp,{className:fp});switch((0,$i.Mf)(e)){case Je.q.DEFENDER:return(0,Ts.jsx)(dd,{className:fp});case Je.q.MIDFIELDER:return(0,Ts.jsx)(xh,{className:fp});case Je.q.GOALIE:return(0,Ts.jsx)(bh,{className:fp});case Je.q.SUBSTITUTE:return(0,Ts.jsx)(rp,{className:fp});case Je.q.ATTACKER:default:return(0,Ts.jsx)(yh,{className:fp})}}(e,k),z=A[e]||null,V=v&&z&&(!j||!C),H=m?m(a):a;return(0,Ts.jsxs)("div",(0,n.A)((0,n.A)({"data-testid":"player-".concat(a),className:"".concat(cp," ").concat(L," ").concat(D," ").concat(F," ").concat(q," ").concat(I," ").concat(R," ").concat(N||v?pp:""),style:O},U),{},{children:[(0,Ts.jsxs)("h3",{className:"text-sm font-semibold mb-1 flex items-center justify-between",children:[(0,Ts.jsxs)("span",{className:"flex items-center gap-2",children:[(0,Ts.jsx)("span",{children:B}),V&&(0,Ts.jsxs)("span",{className:"text-[11px] font-normal text-slate-200",children:["(",z,")"]}),j&&C&&(0,Ts.jsx)("span",{className:"text-xs text-slate-600",children:x})]}),(0,Ts.jsxs)("div",{className:"flex space-x-1",children:[(!j||!C)&&M&&!c&&(0,Ts.jsx)(op,{className:"".concat(gp," ").concat(vp.nextOff," inline-block")}),(!j||!C)&&P&&!c&&(0,Ts.jsx)(lp,{className:"".concat(gp," ").concat(vp.nextOn," inline-block")})]})]}),(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsxs)("div",{children:[G," ",H]}),(0,Ts.jsx)(Ip,{playerId:a,getPlayerTimeStats:h})]})]}),e)};return(0,Ts.jsx)("div",(0,n.A)((0,n.A)({className:"space-y-2"},y),{},{children:_.map((e,t)=>C(e))}))}const Fp=["teamConfig","selectedFormation","renderSection"];function Lp(e){let{teamConfig:t,selectedFormation:a,renderSection:r="all"}=e,s=he(e,Fp);const{t:i}=xe("game"),o="all"===r?"formation-renderer":"formation-renderer-".concat(r);if(!t)return(0,Ts.jsx)("div",{"data-testid":o,children:i("formation.noConfig")});return"string"===typeof t.format&&"string"===typeof t.formation&&"number"===typeof t.squadSize?(0,Ts.jsx)(Dp,(0,n.A)({"data-testid":o,teamConfig:t,selectedFormation:a,renderSection:r},s)):(0,Ts.jsx)("div",{"data-testid":o,children:i("formation.invalidConfig")})}const qp=function(e,t,a,r,s){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:()=>1;const o=function(e){return e&&"object"===typeof e?(0,wi.getModeDefinition)(e):null},l=e=>e?Kl(e):"Unknown Player",{setFormation:c,setAllPlayers:d,setNextPlayerToSubOut:u,setNextPlayerIdToSubOut:m,setRotationQueue:h,setShouldSubstituteNow:p,setSubstitutionOverride:f=()=>{},clearSubstitutionOverride:g=()=>{},setLastSubstitution:v,setLastSubstitutionTimestamp:y,resetSubTimer:b,handleUndoSubstitutionTimer:x,setSubstitutionCountOverride:w,clearSubstitutionCountOverride:S,setShouldResetSubTimerOnNextSub:k}=t,{setAnimationState:N,setHideNextOffIndicator:j,setRecentlySubstitutedPlayers:T}=a,{closeFieldPlayerModal:A,closeSubstituteModal:_,removeFromNavigationStack:C,openFieldPlayerModal:M}=r,P=(0,wi.supportsInactiveUsers)(s),E=()=>{"function"===typeof w&&w(1),"function"===typeof k&&k(!1)},I=()=>{"function"===typeof S&&S(),"function"===typeof k&&k(!0)},R=(e,t)=>{const a=o(t);if(!a)return e;const n={goalie:e.goalie};return a.fieldPositions.forEach(t=>{n[t]=e[t]}),a.substitutePositions.forEach(a=>{6===(null===t||void 0===t?void 0:t.squadSize)&&"substitute_1"===a?n.substitute=e[a]:n[a]=e[a]}),n},O=(e,t)=>e.map(e=>{const a=t.find(t=>t.id===e);return a?Kl(a):"Unknown"}),D=function(e,t,a,n,r,s,i){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;try{const c={eventId:(()=>{const e=Ns(),t=Math.random().toString(36).substr(2,9);return"sub_".concat(e,"_").concat(t)})(),playersOff:e,playersOn:t,playersOffNames:O(e,s),playersOnNames:O(t,s),teamConfig:r,beforeFormation:R(a,r),afterFormation:R(n,r),periodNumber:o,matchTime:_o(i),timestamp:i,matchId:l};return Io(wo.SUBSTITUTION,c)}catch(c){return null}};return{handleSetNextSubstitution:t=>{if("player"===t.type){const a=i();if(a>1){const r=e(),s=t.sourcePlayerId;s&&Ep(r,e=>function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const{rotationQueue:r}=e;if(!r||0===r.length)return e;if(r.slice(0,a).includes(t))return e;const s=Li(r,Vi(e.allPlayers));return s.initialize(),s.removePlayer(t),s.addPlayer(t,0),(0,n.A)((0,n.A)({},e),{},{rotationQueue:s.toArray(),playersToHighlight:[t]})}(e,s,a),e=>{h(e.rotationQueue),d(e.allPlayers)},N,j,T)}else u(t.target,!1)}A()},handleRemoveFromNextSubstitution:t=>{if("player"===t.type){const a=i();if(a>1){const n=e(),r=t.sourcePlayerId;r&&Ep(n,e=>Al(e,r,a),e=>{h(e.rotationQueue),d(e.allPlayers)},N,j,T)}else{const a=e(),n=t.sourcePlayerId;n&&Ep(a,e=>Al(e,n,1),e=>{h(e.rotationQueue),d(e.allPlayers);const t=e.rotationQueue[0];if(t){m(t);const a=o(s),n=((null===a||void 0===a?void 0:a.fieldPositions)||[]).find(a=>e.formation[a]===t);n&&u(n,!0)}},N,j,T)}}A()},handleSubstituteNow:t=>{const a=e();if(g(),"player"===t.type){const e=o(s);if(!e)return void A();const d=a.formation[t.target];if(!Ui(a.allPlayers,d))return void A();const m=a.allPlayers.filter(t=>{var a,n;return e.substitutePositions.includes(null===(a=t.stats)||void 0===a?void 0:a.currentPositionKey)&&!(null!==(n=t.stats)&&void 0!==n&&n.isInactive)});if(1===m.length){const r=m[0].id,i=Object.keys(a.formation).find(e=>a.formation[e]===r),o=e.substitutePositions[0];if(i!==o){const e=Ns();Ep(a,e=>{const t=(0,n.A)({},e.formation),a=t[o];return t[o]=r,t[i]=a,(0,n.A)((0,n.A)({},e),{},{formation:t,playersToHighlight:[r,a]})},n=>{c(n.formation);try{const t=a.allPlayers.find(e=>e.id===r),c=a.allPlayers.find(e=>e.id===a.formation[o]);t&&c&&Io(wo.POSITION_CHANGE,{type:"immediate_substitute_reorder",playerId:r,playerName:l(t),swapPlayerId:c.id,swapPlayerName:l(c),fromPosition:i,toPosition:o,description:"".concat(l(t)," moved to next-in for immediate substitution"),beforeFormation:R(a.formation,s),afterFormation:R(n.formation,s),teamConfig:s,matchTime:_o(e),timestamp:e,periodNumber:a.currentPeriodNumber||1})}catch(d){}u(t.target,!1),f({substitutionCount:1,reason:"immediate_field_player"}),E(),p(!0)},N,j,T)}else u(t.target,!1),f({substitutionCount:1,reason:"immediate_field_player"}),E(),p(!0);return void A()}const h=(0,$i.pr)(s),g=a.rotationQueue||[],v=i(),y=wp(g,a.formation,h,e.substitutePositions,v),b=Object.keys(y).find(e=>y[e]===t.target),x=b?a.formation[b]:null,w=[...m].sort((e,t)=>{if(e.id===x)return-1;if(t.id===x)return 1;const a=g.indexOf(e.id),n=g.indexOf(t.id);return-1!==a&&-1!==n?a-n:-1!==a?-1:-1!==n?1:0});A(),r.openSubstituteSelectionModal&&r.openSubstituteSelectionModal({fieldPlayerName:t.playerName,fieldPlayerId:d,fieldPlayerPosition:t.target,availableSubstitutes:w})}},handleCancelFieldPlayerModal:()=>{g(),A(),C&&C()},handleSetAsNextToGoIn:(t,a)=>{if(t.playerId){var r,l;const u=t.playerId,m=e(),h=o(s);if(!h||!h.hasMultipleSubstitutes)return void _();const p=Object.keys(a).find(e=>a[e]===u);if(h.substitutePositions.includes(p)&&"substitute_1"!==p&&!(null!==(r=m.allPlayers.find(e=>e.id===u))&&void 0!==r&&null!==(l=r.stats)&&void 0!==l&&l.isInactive)){const e=i();Ep(m,t=>function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const{allPlayers:r,formation:s,teamConfig:i,selectedFormation:o}=e;if(!(0,wi.hasMultipleSubstitutes)(i))return e;const l=Nl(i,o);if(!l||!l.substitutePositions.includes(t))return e;const c=l.substitutePositions,d=c[Math.min(a-1,c.length-1)],u=c.indexOf(t);if(u<a)return e;const m=s[t];if(!m)return e;if(-1===u)return e;const h=(0,n.A)({},s),p=[],f=c.indexOf(d);for(let n=f;n<u;n++){const e=c[n],t=s[e];t&&p.push({playerId:t,currentPosition:e})}h[d]=m;for(let n=0;n<p.length;n++)h[c[f+n+1]]=p[n].playerId;const g=r.map(e=>{if(e.id===m)return(0,n.A)((0,n.A)({},e),{},{stats:(0,n.A)((0,n.A)({},e.stats),{},{currentPositionKey:d})});const t=p.find(t=>t.playerId===e.id);if(t){const a=c.indexOf(t.currentPosition),r=c[a+1];return(0,n.A)((0,n.A)({},e),{},{stats:(0,n.A)((0,n.A)({},e.stats),{},{currentPositionKey:r})})}return e}),v=[m,...p.map(e=>e.playerId)];return(0,n.A)((0,n.A)({},e),{},{formation:h,allPlayers:g,playersToHighlight:v})}(t,p,e),e=>{c(e.formation),d(e.allPlayers)},N,j,T)}}_(),C&&C()},handleInactivatePlayer:(t,a,n)=>{if(t.playerId&&P){const n=e(),i=Ui(a,t.playerId),o=(0,wi.getBottomSubstitutePosition)(s);if((null===i||void 0===i?void 0:i.stats.currentPositionKey)===o){const e=Tl(n,t.playerId);c(e.formation),d(e.allPlayers),m(e.nextPlayerIdToSubOut),e.rotationQueue&&h(e.rotationQueue);try{i&&Io(wo.PLAYER_INACTIVATED,{playerId:t.playerId,periodNumber:n.currentPeriodNumber||1,playerName:l(i),display_name:l(i)})}catch(r){}}else Ep(n,e=>Tl(e,t.playerId),e=>{c(e.formation),d(e.allPlayers),m(e.nextPlayerIdToSubOut),e.rotationQueue&&h(e.rotationQueue);try{i&&Io(wo.PLAYER_INACTIVATED,{playerId:t.playerId,periodNumber:n.currentPeriodNumber||1,playerName:l(i),display_name:l(i)})}catch(r){}},N,j,T)}else t.playerId;_(),C&&C()},handleActivatePlayer:t=>{if(t.playerId&&P){const a=e(),n=Ui(a.allPlayers,t.playerId);Ep(a,e=>Tl(e,t.playerId),e=>{c(e.formation),d(e.allPlayers),m(e.nextPlayerIdToSubOut),e.rotationQueue&&h(e.rotationQueue);try{n&&Io(wo.PLAYER_ACTIVATED,{playerId:t.playerId,periodNumber:a.currentPeriodNumber||1,playerName:l(n),display_name:l(n)})}catch(r){}},N,j,T)}else t.playerId;_(),C&&C()},handleCancelSubstituteModal:()=>{_(),C&&C()},handleSubstitutionWithHighlight:()=>{const t=e();if(!Ji(t.allPlayers,t.teamConfig))return void I();const a=Ns(),r=(0,n.A)({},t.formation),i=t.nextPlayerToSubOut,o=t.nextPlayerIdToSubOut,l=t.subTimerSeconds;Ep(t,jl,e=>{c(e.formation),d(e.allPlayers),u(e.nextPlayerToSubOut),m(e.nextPlayerIdToSubOut),e.rotationQueue&&h(e.rotationQueue);const p=e.substitutionResult||{},f=p.playersGoingOffIds||[],g=p.playersComingOnIds||e.playersToHighlight||[],x=g.map(e=>{const a=t.allPlayers.find(t=>t.id===e);return a?{id:a.id,stats:(0,n.A)({},a.stats)}:null}).filter(Boolean),w=D(f,g,r,e.formation,s,t.allPlayers,a,t.currentPeriodNumber||1,t.currentMatchId),S={timestamp:a,beforeFormation:r,beforeNextPlayer:i,beforeNextPlayerId:o,playersComingOnOriginalStats:x,playersComingOnIds:g,playersGoingOffIds:f,teamConfig:s,subTimerSecondsAtSubstitution:l,eventId:(null===w||void 0===w?void 0:w.id)||null};v(S),y(a),!1!==t.shouldResetSubTimerOnNextSub&&b(),I()},N,j,T)},handleChangePosition:t=>{const a=e(),{fieldPlayerModal:r}=a;if("show-options"===t){if(r.target&&"player"===r.type){const e=a.formation[r.target],t=a.formation.goalie;if(e){var i;const s=a.selectedSquadPlayers.map(e=>e.id),l=o(a.teamConfig);if(!l)return!0;const c=null===(i=l.positions[r.target])||void 0===i?void 0:i.role,d=Wi(a.allPlayers,s,t).filter(t=>{if(t.id===e)return!1;const n=a.allPlayers.find(e=>e.id===t.id);if(!n)return!1;const r=n.stats.currentPositionKey,s=o(a.teamConfig);return!s||!s.substitutePositions.includes(r)}).map(e=>{var t;const r=a.allPlayers.find(t=>t.id===e.id),s=null===(t=l.positions[r.stats.currentPositionKey])||void 0===t?void 0:t.role;return(0,n.A)((0,n.A)({},e),{},{role:s})}).sort((e,t)=>{const a=e.role===c,n=t.role===c;return a&&!n?1:!a&&n?-1:0});M({type:"player",target:r.target,playerName:r.playerName,sourcePlayerId:e,availablePlayers:d,showPositionOptions:!0})}}}else if(null===t){const t=e(),{fieldPlayerModal:a}=t;M({type:a.type,target:a.target,playerName:a.playerName,sourcePlayerId:a.sourcePlayerId,availablePlayers:[],showPositionOptions:!1})}else if("string"===typeof t&&r.sourcePlayerId){const e=t,i=Ns();Ep(a,t=>((e,t,a)=>{const{allPlayers:r,formation:s,teamConfig:i,isSubTimerPaused:o=!1}=e;if(!t||!a||t===a)return e;const l=Ui(r,t),c=Ui(r,a);if(!l||!c)return e;if(l.id===s.goalie||c.id===s.goalie)return e;const d=l.stats.currentPositionKey,u=c.stats.currentPositionKey,m=(0,wi.getValidPositions)(i);if(!m.includes(d)||!m.includes(u))return e;const h=(0,n.A)({},s);h[d]=a,h[u]=t;const p=Ns(),f=r.map(e=>{if(e.id===t){const t=fo(e,(0,$i.Mf)(u)||e.stats.currentRole,p,o);return(0,n.A)((0,n.A)({},t),{},{stats:(0,n.A)((0,n.A)({},t.stats),{},{currentPositionKey:u})})}if(e.id===a){const t=fo(e,(0,$i.Mf)(d)||e.stats.currentRole,p,o);return(0,n.A)((0,n.A)({},t),{},{stats:(0,n.A)((0,n.A)({},t.stats),{},{currentPositionKey:d})})}return e});return(0,n.A)((0,n.A)({},e),{},{formation:h,allPlayers:f,playersToHighlight:[t,a]})})(t,r.sourcePlayerId,e),t=>{c(t.formation),d(t.allPlayers);try{const n=a.allPlayers.find(e=>e.id===r.sourcePlayerId),o=a.allPlayers.find(t=>t.id===e);n&&o&&Io(wo.POSITION_CHANGE,{sourcePlayerId:r.sourcePlayerId,targetPlayerId:e,sourcePlayerName:l(n),targetPlayerName:l(o),sourcePosition:n.stats.currentPositionKey,targetPosition:o.stats.currentPositionKey,beforeFormation:R(a.formation,s),afterFormation:R(t.formation,s),teamConfig:s,matchTime:_o(i),timestamp:i,periodNumber:a.currentPeriodNumber||1})}catch(n){}},N,j,T),A()}else A()},handleChangeNextPosition:(t,a)=>{if(!t.playerId)return;const i=e(),d=o(s);if("show-options"===a){const e=(null===d||void 0===d?void 0:d.substitutePositions)||[],a=Object.keys(i.formation).find(e=>i.formation[e]===t.playerId),o=wp(i.rotationQueue,i.formation,d.fieldPositions,e,i.substitutionCount||1),l=[];return Object.entries(o).forEach(t=>{let[n,r]=t;if(n!==a){const t=xp(r,null,s,e),a=(0,$i.Mf)(r);l.push({value:n,label:t,role:a})}}),l.sort((e,t)=>{const a={[Je.q.DEFENDER]:1,[Je.q.MIDFIELDER]:2,[Je.q.ATTACKER]:3};return(a[e.role]||999)-(a[t.role]||999)}),void r.openSubstituteModal((0,n.A)((0,n.A)({},r.modals.substitute),{},{showPositionSelection:!0,availableNextPositions:l}))}if(null===a)return void r.openSubstituteModal((0,n.A)((0,n.A)({},r.modals.substitute),{},{showPositionSelection:!1,availableNextPositions:[]}));const u=Ns(),m=Object.keys(i.formation).find(e=>i.formation[e]===t.playerId);if(!m||!a)return _(),void(C&&C());Ep(i,e=>{const t=(0,n.A)({},e.formation),r=t[m],s=t[a];return t[m]=s,t[a]=r,(0,n.A)((0,n.A)({},e),{},{formation:t,playersToHighlight:[r,s]})},e=>{c(e.formation);try{const n=i.allPlayers.find(e=>e.id===t.playerId),r=i.allPlayers.find(e=>e.id===i.formation[a]);n&&r&&Io(wo.POSITION_CHANGE,{type:"substitute_position_swap",playerId:t.playerId,playerName:l(n),swapPlayerId:r.id,swapPlayerName:l(r),fromPosition:m,toPosition:a,description:"".concat(l(n)," and ").concat(l(r)," swapped next-in positions"),beforeFormation:R(i.formation,s),afterFormation:R(e.formation,s),teamConfig:s,matchTime:_o(u),timestamp:u,periodNumber:i.currentPeriodNumber||1})}catch(n){}},N,j,T),_(),C&&C()},handleUndo:t=>{if(!t)return;const a=Ns();Ep(e(),e=>((e,t)=>{if(!t)return e;const a=Ns(),r=Math.round((a-t.timestamp)/1e3),s=t.beforeFormation,i=t.beforeNextPlayer,o=t.beforeNextPlayerId,l=e.allPlayers.map(e=>{const s=t.playersComingOnIds.includes(e.id),i=t.playersGoingOffIds.includes(e.id);if(s){const a=t.playersComingOnOriginalStats.find(t=>t.id===e.id);return a?(0,n.A)((0,n.A)({},e),{},{stats:a.stats}):e}if(i){const s=(0,n.A)({},e.stats);s.timeOnFieldSeconds+=r;const i=(0,ki.GY)(s.currentRole);i===Je.q.ATTACKER?s.timeAsAttackerSeconds+=r:i===Je.q.DEFENDER&&(s.timeAsDefenderSeconds+=r),s.currentStatus=Je.P.ON_FIELD,s.lastStintStartTimeEpoch=a;const o=t.beforeFormation,l=(0,wi.getValidPositions)(t.teamConfig).find(t=>o[t]===e.id);return l&&(s.currentPositionKey=l),(0,n.A)((0,n.A)({},e),{},{stats:s})}return e});return(0,n.A)((0,n.A)({},e),{},{formation:s,nextPlayerToSubOut:i,nextPlayerIdToSubOut:o,allPlayers:l,playersToHighlight:t.playersGoingOffIds,lastSubstitutionTimestamp:null})})(e,t),e=>{c(e.formation),u(e.nextPlayerToSubOut),m(e.nextPlayerIdToSubOut),d(e.allPlayers),e.rotationQueue&&h(e.rotationQueue);try{t.eventId&&(e=>{try{const t=jo.findIndex(t=>t.id===e);if(-1===t)return console.warn("Event not found for removal: ".concat(e)),!1;const a=jo[t],n=jo.filter(t=>t.id!==e);return!!Po(n)&&(Oo("event_removed",{removedEvent:a}),!0)}catch(t){return console.error("Failed to remove event:",t),!1}})(t.eventId),Io(wo.SUBSTITUTION_UNDONE,{originalEventId:t.eventId,originalTimestamp:t.timestamp,undoTimestamp:a,timeSinceOriginal:a-t.timestamp,playersGoingBackOn:t.playersGoingOffIds,playersComingBackOff:t.playersComingOnIds,playersGoingBackOnNames:O(t.playersGoingOffIds,e.allPlayers),playersComingBackOffNames:O(t.playersComingOnIds,e.allPlayers),teamConfig:t.teamConfig,beforeFormation:R(e.formation,t.teamConfig),afterFormation:R(t.beforeFormation,t.teamConfig),reason:"user_initiated_undo",matchTime:_o(a),periodNumber:e.currentPeriodNumber||1})}catch(n){}x&&void 0!==t.subTimerSecondsAtSubstitution&&x(t.subTimerSecondsAtSubstitution,t.timestamp)},N,j,T)},handleSelectSubstituteForImmediate:(t,a)=>{if(g(),!t.fieldPlayerId||!a)return void(r.closeSubstituteSelectionModal&&r.closeSubstituteSelectionModal());const i=e(),d=o(s);if(!d)return void(r.closeSubstituteSelectionModal&&r.closeSubstituteSelectionModal());const m=Object.keys(i.formation).find(e=>i.formation[e]===a);if(!m)return void(r.closeSubstituteSelectionModal&&r.closeSubstituteSelectionModal());const h=d.substitutePositions[0];if(m!==h){const e=Ns();Ep(i,e=>{const t=(0,n.A)({},e.formation),r=t[h];return t[h]=a,t[m]=r,(0,n.A)((0,n.A)({},e),{},{formation:t,playersToHighlight:[a,r]})},n=>{c(n.formation);try{const t=i.allPlayers.find(e=>e.id===a),r=i.allPlayers.find(e=>e.id===i.formation[h]);t&&r&&Io(wo.POSITION_CHANGE,{type:"immediate_substitute_reorder",playerId:a,playerName:l(t),swapPlayerId:r.id,swapPlayerName:l(r),fromPosition:m,toPosition:h,description:"".concat(l(t)," moved to next-in for immediate substitution"),beforeFormation:R(i.formation,s),afterFormation:R(n.formation,s),teamConfig:s,matchTime:_o(e),timestamp:e,periodNumber:i.currentPeriodNumber||1})}catch(r){}f({substitutionCount:1,reason:"immediate_field_player"}),u(t.fieldPlayerPosition,!1),E(),p(!0)},N,j,T)}else f({substitutionCount:1,reason:"immediate_field_player"}),u(t.fieldPlayerPosition,!1),E(),p(!0);r.closeSubstituteSelectionModal&&r.closeSubstituteSelectionModal(),C&&C()},handleCancelSubstituteSelection:()=>{g(),r.closeSubstituteSelectionModal&&r.closeSubstituteSelectionModal(),C&&C(),I()}}},Up=function(e,t,a,n,r){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[];const{openFieldPlayerModal:o,openSubstituteModal:l}=r,c=e=>e&&"object"===typeof e?(0,wi.getModeDefinition)(e):null,d=(0,wi.supportsInactiveUsers)(e),u=(0,wi.hasMultipleSubstitutes)(e),m=e=>Hi(a,e),h=r=>h=>{h&&(h.preventDefault(),h.stopPropagation());const p=c(e);d&&null!==p&&void 0!==p&&p.substitutePositions.includes(r)?(r=>{if(!d)return;const i=c(e);if(null===i||void 0===i||!i.substitutePositions.includes(r))return;const o=t[r],h=m(o),p=Ui(a,o),f=(null===p||void 0===p?void 0:p.stats.isInactive)||!1,g=i.substitutePositions.indexOf(r)<s;l({playerId:o,playerName:h,isCurrentlyInactive:f,canSetAsNextToGoIn:u&&!g&&!(o===n)&&!f,canChangeNextPosition:g&&s>1&&!f,availableNextPositions:[],showPositionSelection:!1})})(r):(e=>{const a=t[e],n=m(a),r=i.slice(0,s).includes(a);o({type:"player",target:e,playerName:n,sourcePlayerId:a,availablePlayers:[],showPositionOptions:!1,isPlayerAboutToSubOff:r})})(r)},p={},f=c(e);if(f){[...f.fieldPositions,...f.substitutePositions].forEach(e=>{p["".concat(e,"Callback")]=h(e)})}return p},Bp=function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:150;const[n,r]=(0,e.useState)(!1),s=(0,e.useRef)(t),i=(0,e.useRef)({x:0,y:0}),o=(0,e.useRef)(!1),l=(0,e.useRef)(null),c=(0,e.useRef)(null),d=(0,e.useRef)(null);(0,e.useEffect)(()=>{s.current=t},[t]);const u=(e,t)=>{i.current={x:e,y:t},o.current=!1,l.current=Date.now(),r(!0),c.current=setTimeout(()=>{o.current=!0},a)},m=(0,e.useCallback)(()=>{if(l.current&&!o.current){Date.now()-l.current<a&&s.current(d.current)}r(!1),l.current=null,d.current=null,c.current&&(clearTimeout(c.current),c.current=null)},[a]),h=(0,e.useCallback)((e,t)=>{if(n){const a=10,n=Math.abs(e-i.current.x),r=Math.abs(t-i.current.y);(n>a||r>a)&&(o.current=!0,m())}},[n,m]),p=(0,e.useCallback)(e=>{if(e.touches.length>0){const t=e.touches[0];h(t.clientX,t.clientY)}},[h]),f=(0,e.useCallback)(e=>{h(e.clientX,e.clientY)},[h]);return(0,e.useEffect)(()=>{if(n)return document.addEventListener("touchmove",p,{passive:!0}),document.addEventListener("mousemove",f),()=>{document.removeEventListener("touchmove",p),document.removeEventListener("mousemove",f)}},[n,p,f]),(0,e.useEffect)(()=>()=>{c.current&&clearTimeout(c.current)},[]),{onTouchStart:e=>{d.current=e;const t=e.touches[0];u(t.clientX,t.clientY)},onTouchEnd:e=>{d.current=e,m()},onMouseDown:e=>{e.preventDefault(),d.current=e,u(e.clientX,e.clientY)},onMouseUp:e=>{e.preventDefault(),d.current=e,m()},onMouseLeave:m}},Gp=(e,t,a,r)=>{const{setAllPlayers:s}=t,{pauseSubTimer:i,resumeSubTimer:o}=a,l=(t,a)=>{s(r=>r.map(r=>e.find(e=>e.id===r.id)?((e,t,a)=>{const r=(0,n.A)({},e.stats);if(a){if(Zi(!1,r.lastStintStartTimeEpoch))return(0,n.A)((0,n.A)({},e),{},{stats:r});const a=eo(r.lastStintStartTimeEpoch,t),s=ao(r,a);return(0,n.A)((0,n.A)({},e),{},{stats:s})}return"on_field"===r.currentStatus||"substitute"===r.currentStatus||"goalie"===r.currentStatus?no(e,t):(0,n.A)((0,n.A)({},e),{},{stats:r})})(r,t,a):r))};return{handlePauseTimer:()=>{i(l)},handleResumeTimer:()=>{o(l)},updatePlayerStatsForPause:l}},zp=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{setScore:r,addGoalScored:s,addGoalConceded:i}=e,{openScoreEditModal:o,closeScoreEditModal:l,openGoalScorerModal:c,closeGoalScorerModal:d,setPendingGoalData:u,getPendingGoalData:m,clearPendingGoal:h}=t,{shouldTrackGoalScorer:p=!0,getPlayerNameById:f=null}=a,g=e=>{if(!e||"function"!==typeof f)return null;try{return f(e)||null}catch(t){return null}},v=e=>{const t=Lo().find(t=>t.id===e&&!t.undone);return t||(console.warn("Goal event not found: ".concat(e)),null)},y=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return void("scored"===e?s():i());const a=(()=>{const e=Date.now(),t=Math.random().toString(36).substr(2,9);return"evt_".concat(e,"_").concat(t)})(),n=((e,t,a)=>{const{ownScore:n,opponentScore:r,currentPeriodNumber:s,currentMatchId:i}=a,o=Date.now();return{eventId:t,type:"scored"===e?wo.GOAL_SCORED:wo.GOAL_CONCEDED,periodNumber:s,ownScore:"scored"===e?n+1:n,opponentScore:"conceded"===e?r+1:r,goalType:e,matchId:i,timestamp:o}})(e,a,t);if("scored"===e){if(!p)return h&&h(),s(),void Io(n.type,{eventId:n.eventId,periodNumber:n.periodNumber,ownScore:n.ownScore,opponentScore:n.opponentScore,scorerId:null,goalType:n.goalType,matchId:t.currentMatchId},n.timestamp);if(u(n),!c)return console.error("Goal scorer modal not available - cannot process goal with gameState"),console.error("This indicates a configuration problem. Modal handlers may not be properly initialized."),void(h&&h());c({eventId:a,team:e,mode:"new",matchTime:_o(n.timestamp),periodNumber:n.periodNumber})}else i(),Io(n.type,{eventId:n.eventId,periodNumber:n.periodNumber,ownScore:n.ownScore,opponentScore:n.opponentScore,scorerId:null,goalType:n.goalType,matchId:t.currentMatchId},n.timestamp)},b=()=>{o()};return{handleAddGoalScored:function(){return y("scored",arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)},handleAddGoalConceded:function(){return y("conceded",arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)},handleSelectGoalScorer:(e,t)=>{if(!p)return void d();const a=m();if(a&&a.eventId===e){a.type===wo.GOAL_SCORED?s():a.type===wo.GOAL_CONCEDED&&i();const e=g(t);Io(a.type,(0,n.A)((0,n.A)({eventId:a.eventId,periodNumber:a.periodNumber,ownScore:a.ownScore,opponentScore:a.opponentScore,scorerId:t||null},e?{scorerName:e,display_name:e}:{}),{},{goalType:a.goalType,matchId:a.matchId}),a.timestamp),h()}d()},handleCorrectGoalScorer:(e,t)=>{if(!p)return void d();const a=g(t),n={scorerId:t};a&&(n.scorerName=a,n.display_name=a);qo(e,n)?Io(wo.GOAL_CORRECTED,{originalEventId:e,scorerId:t,correctionType:"scorer_correction"}):console.warn("Failed to update goal scorer for event:",e),d()},handleScoreEdit:(e,t)=>{r(e,t),l()},handleOpenScoreEdit:b,handleCancelGoalScorer:()=>{m()&&h(),d()},handleDeleteGoal:e=>{const t=v(e);if(!t)return;if(![wo.GOAL_SCORED,wo.GOAL_CONCEDED].includes(t.type))return void console.warn("Attempted to delete non-goal event: ".concat(e,", type: ").concat(t.type));const a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user_action";try{const a=jo.findIndex(t=>t.id===e);if(-1===a)return console.warn("Event not found for undo marking: ".concat(e)),!1;const r=[...jo];return r[a]=(0,n.A)((0,n.A)({},r[a]),{},{undone:!0,undoTimestamp:Date.now(),undoReason:t}),!!Po(r)}catch(a){return console.error("Failed to mark event as undone:",a),!1}}(t.id,"manual_deletion");if(!a)return void console.error("Failed to mark goal event as undone: ".concat(e));const s=Lo(),i=s.filter(e=>[wo.GOAL_SCORED,wo.GOAL_CONCEDED].includes(e.type)).sort((e,t)=>e.timestamp-t.timestamp),o=i.findIndex(t=>t.id===e);if(o>=0){const e=t.type===wo.GOAL_SCORED;i.slice(o+1).forEach(t=>{if(t.data&&void 0!==t.data.ownScore&&void 0!==t.data.opponentScore){const a={ownScore:e?t.data.ownScore-1:t.data.ownScore,opponentScore:e?t.data.opponentScore:t.data.opponentScore-1};qo(t.id,a)||console.warn("Failed to update score history for event: ".concat(t.id))}});const a=s.filter(e=>[wo.GOAL_SCORED,wo.GOAL_CONCEDED].includes(e.type)&&!e.undone);let n=0,l=0;a.forEach(e=>{e.type===wo.GOAL_SCORED?n++:e.type===wo.GOAL_CONCEDED&&l++}),r(n,l)}else console.warn("Could not find deleted goal in chronological sequence: ".concat(e))},handleEditGoalScorer:e=>{var t,a;if(!p)return;if(!c)return void console.warn("Goal scorer modal not available for editing");const n=v(e);var r;n&&c({eventId:n.id,team:(r=n.type,r===wo.GOAL_SCORED?"scored":"conceded"),mode:"correct",matchTime:_o(n.timestamp),periodNumber:(null===(t=n.data)||void 0===t?void 0:t.periodNumber)||1,currentScorerId:(null===(a=n.data)||void 0===a?void 0:a.scorerId)||null})},scoreCallback:()=>{b()}}},Vp=(e,t,a,r,s,i)=>{const{setFormation:o,setAllPlayers:l,setRotationQueue:c,setNextPlayerIdToSubOut:d}=t,{setAnimationState:u,setHideNextOffIndicator:m,setRecentlySubstitutedPlayers:h}=a,{openGoalieModal:p,closeGoalieModal:f,removeFromNavigationStack:g}=r,v=e=>Hi(s,e),y=e=>{const t=v(e.goalie),a=i.map(e=>e.id),r=Wi(s,a,e.goalie).map(e=>{var t;const a=Kl(e);return(0,n.A)((0,n.A)({},e),{},{id:e.id,displayName:e.displayName||a,firstName:e.firstName||e.displayName||a,lastName:e.lastName||null,isInactive:(null===(t=e.stats)||void 0===t?void 0:t.isInactive)||!1})}).sort((e,t)=>{if(e.isInactive!==t.isInactive)return e.isInactive?1:-1;const a=Kl(e),n=Kl(t);return a.localeCompare(n)});p({currentGoalieName:t,availablePlayers:r})};return{handleGoalieQuickTap:y,handleSelectNewGoalie:t=>{const a=e(),r=Date.now(),i=s.find(e=>e.id===t);Ep(a,e=>((e,t)=>{const{allPlayers:a,formation:r,isSubTimerPaused:s=!1}=e;if(!t||t===r.goalie)return e;const i=Ui(a,r.goalie),o=Ui(a,t);if(!i||!o)return e;if(o.stats.isInactive)return e;const l=o.stats.currentPositionKey,c=(0,n.A)({},r);c.goalie=t,c[l]=r.goalie;const d=Ns(),u=a.map(e=>{if(e.id===r.goalie){const t=to(e,d,s),a=(0,$i.Mf)(l)||Je.q.DEFENDER,r=l&&l.includes("substitute_1")?Je.P.SUBSTITUTE:Je.P.ON_FIELD,i=fo((0,n.A)((0,n.A)({},e),{},{stats:t}),a,d,s),o=(0,n.A)((0,n.A)({},i.stats),{},{currentStatus:r,currentPositionKey:l});return(0,n.A)((0,n.A)({},e),{},{stats:o})}if(e.id===t){const t=to(e,d,s),a=fo((0,n.A)((0,n.A)({},e),{},{stats:t}),Je.q.GOALIE,d,s),r=(0,n.A)((0,n.A)({},a.stats),{},{currentStatus:Je.P.GOALIE,currentPositionKey:kl});return(0,n.A)((0,n.A)({},e),{},{stats:r})}return e}),m=Li(e.rotationQueue,Vi(a));m.initialize();const h=m.getPosition(t);m.removePlayer(t),h>=0?m.addPlayer(r.goalie,h):m.addPlayer(r.goalie,"end");let p=e.nextPlayerIdToSubOut;t===e.nextPlayerIdToSubOut&&(p=m.toArray()[0]||null);return(0,n.A)((0,n.A)({},e),{},{formation:c,allPlayers:u,rotationQueue:m.toArray(),nextPlayerIdToSubOut:p,playersToHighlight:[r.goalie,t]})})(e,t),e=>{o(e.formation),l(e.allPlayers),c(e.rotationQueue),void 0!==e.nextPlayerIdToSubOut&&d(e.nextPlayerIdToSubOut);try{var n;if(i)Io(wo.GOALIE_ASSIGNMENT,{goalieId:t,goalieName:Kl(i),previousGoalieId:a.formation.goalie,previousGoalieName:a.formation.goalie?v(a.formation.goalie):null,newGoaliePosition:(null===i||void 0===i||null===(n=i.stats)||void 0===n?void 0:n.currentPositionKey)||null,eventType:"replacement",matchTime:_o(r),timestamp:r,periodNumber:a.currentPeriodNumber||1,teamConfig:a.teamConfig,description:"".concat(Kl(i)," is goalie"),matchId:a.currentMatchId})}catch(s){}},u,m,h),f()},handleCancelGoalieModal:()=>{f(),g&&g()},goalieCallback:t=>{t&&(t.preventDefault(),t.stopPropagation());const a=e();y(a.formation)}}},Hp=fc("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);function Kp(e){let{onClick:t,disabled:a,children:n,ariaLabel:r,className:s=""}=e;return(0,Ts.jsx)("button",{type:"button",onClick:t,disabled:a,"aria-label":r,className:"flex items-center justify-center rounded-md border border-slate-600 bg-slate-700 text-slate-100 transition-colors hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-offset-2 focus:ring-offset-slate-900 disabled:cursor-not-allowed disabled:opacity-40 ".concat(s),children:n})}function Wp(t){let{value:a,onChange:n,min:r=1,max:s=4,disabled:i=!1,variant:o="default",className:l=""}=t;const{t:c}=xe("game"),d=e.useMemo(()=>"compact"===o?{container:"px-0.5 py-1.5 gap-0.5",label:"text-[10px]",valueText:"text-base",button:"h-8 w-5"}:{container:"px-3 py-2 gap-2",label:"text-xs",valueText:"text-2xl",button:"h-9 w-9"},[o]),u=e.useCallback(e=>{if(i)return;const t=((e,t,a)=>"number"!==typeof e||Number.isNaN(e)?t:Math.max(t,Math.min(a,e)))(a+e,r,s);t!==a&&n(t)},[i,a,r,s,n]);return(0,Ts.jsxs)("div",{className:"flex items-center rounded-lg border border-slate-700 bg-slate-800/70 text-slate-100 ".concat(d.container," ").concat(i?"opacity-60":""," ").concat(l),children:[(0,Ts.jsx)(Kp,{onClick:()=>u(-1),disabled:i||a<=r,ariaLabel:c("substitution.decreaseCount"),className:d.button,children:(0,Ts.jsx)(Hp,{className:"h-4 w-4"})}),(0,Ts.jsx)("span",{className:"px-1.5 font-semibold leading-none ".concat(d.valueText),children:a}),(0,Ts.jsx)(Kp,{onClick:()=>u(1),disabled:i||a>=s,ariaLabel:c("substitution.increaseCount"),className:d.button,children:(0,Ts.jsx)(Xd,{className:"h-4 w-4"})})]})}function Yp(e){let{value:t,min:a=1,max:n=4,onChange:r,disabled:s=!1,className:i=""}=e;return(0,Ts.jsx)(Wp,{value:t,min:a,max:n,onChange:r,disabled:s,variant:"compact",className:"min-w-[64px] flex-shrink-0 self-stretch ".concat(i)})}const Jp=Bs(Br.SUBSTITUTION_COUNT,{count:1}),Qp=(e,t)=>1===e?t("period.ordinal.1st"):2===e?t("period.ordinal.2nd"):3===e?t("period.ordinal.3rd"):4===e?t("period.ordinal.4th"):t("period.ordinal.nth",{number:e});function $p(t){let{currentPeriodNumber:a,formation:r,setFormation:s,allPlayers:i,setAllPlayers:o,matchTimerSeconds:l,subTimerSeconds:c,isSubTimerPaused:d,pauseSubTimer:u,resumeSubTimer:m,formatTime:h,resetSubTimer:p,handleUndoSubstitution:f,handleEndPeriod:g,nextPlayerToSubOut:v,nextPlayerIdToSubOut:y,selectedSquadPlayers:b,setNextPlayerToSubOut:x,setNextPlayerIdToSubOut:w,teamConfig:S,selectedFormation:k,alertMinutes:N,pushNavigationState:j,removeFromNavigationStack:T,onNavigateBack:A,ownScore:_,opponentScore:C,opponentTeam:M,addGoalScored:P,addGoalConceded:E,setScore:I,rotationQueue:R,setRotationQueue:O,matchEvents:D,goalScorers:F,matchStartTime:L,matchState:q,currentMatchId:U,handleActualMatchStart:B,periodDurationMinutes:G,trackGoalScorer:z=!0,getPlayerName:V,setShowNewGameModal:H,ownTeamName:K}=t;const{t:W}=xe("game"),Y=function(t,a){const[r,s]=(0,e.useState)(null),[i,o]=(0,e.useState)({fieldPlayer:{isOpen:!1,type:null,target:null,playerName:"",sourcePlayerId:null,availablePlayers:[],showPositionOptions:!1},substitute:{isOpen:!1,playerId:null,playerName:"",isCurrentlyInactive:!1,canSetAsNextToGoIn:!1,canChangeNextPosition:!1,availableNextPositions:[],showPositionSelection:!1},substituteSelection:{isOpen:!1,fieldPlayerName:"",fieldPlayerId:null,fieldPlayerPosition:null,availableSubstitutes:[]},goalie:{isOpen:!1,currentGoalieName:"",availablePlayers:[]},scoreEdit:{isOpen:!1},undoConfirm:{isOpen:!1},goalScorer:{isOpen:!1,eventId:null,team:Fs.VENUE_TYPES.HOME,mode:"new",matchTime:"00:00",periodNumber:1,existingGoalData:null}}),l=(0,e.useCallback)(e=>{o(t=>(0,n.A)((0,n.A)({},t),{},{[e]:(0,n.A)((0,n.A)({},t[e]),{},{isOpen:!1})}))},[]),c=(0,e.useCallback)(function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(t=>(0,n.A)((0,n.A)({},t),{},{[e]:(0,n.A)((0,n.A)({},t[e]),{},{isOpen:!0},a)})),t&&t(()=>{l(e)})},[t,l]),d=(0,e.useCallback)(e=>{l(e),a&&a()},[l,a]),u=(0,e.useCallback)(()=>{o(e=>{const t=(0,n.A)({},e);return Object.keys(t).forEach(e=>{t[e]=(0,n.A)((0,n.A)({},t[e]),{},{isOpen:!1})}),t})},[]),m=(0,e.useCallback)(e=>{c("fieldPlayer",e)},[c]),h=(0,e.useCallback)(()=>{l("fieldPlayer")},[l]),p=(0,e.useCallback)(e=>{c("substitute",e)},[c]),f=(0,e.useCallback)(()=>{l("substitute")},[l]),g=(0,e.useCallback)(e=>{c("goalie",e)},[c]),v=(0,e.useCallback)(()=>{l("goalie")},[l]),y=(0,e.useCallback)(()=>{c("scoreEdit")},[c]),b=(0,e.useCallback)(()=>{l("scoreEdit")},[l]),x=(0,e.useCallback)(()=>{c("undoConfirm")},[c]),w=(0,e.useCallback)(()=>{l("undoConfirm")},[l]),S=(0,e.useCallback)(e=>{c("goalScorer",e)},[c]),k=(0,e.useCallback)(()=>{l("goalScorer")},[l]),N=(0,e.useCallback)(e=>{c("substituteSelection",e)},[c]),j=(0,e.useCallback)(()=>{l("substituteSelection")},[l]),T=(0,e.useCallback)(e=>{s(e)},[]),A=(0,e.useCallback)(()=>r,[r]),_=(0,e.useCallback)(()=>{s(null)},[]);return{modals:i,openModal:c,closeModal:l,closeModalWithNavigation:d,closeAllModals:u,openFieldPlayerModal:m,closeFieldPlayerModal:h,openSubstituteModal:p,closeSubstituteModal:f,openSubstituteSelectionModal:N,closeSubstituteSelectionModal:j,openGoalieModal:g,closeGoalieModal:v,openScoreEditModal:y,closeScoreEditModal:b,openUndoConfirmModal:x,closeUndoConfirmModal:w,openGoalScorerModal:S,closeGoalScorerModal:k,setPendingGoalData:T,getPendingGoalData:A,clearPendingGoal:_}}(j,T),J=function(){const[t,a]=(0,e.useState)({type:"none",phase:"idle",data:{}}),[n,r]=(0,e.useState)(new Set),[s,i]=(0,e.useState)(!1),[o,l]=(0,e.useState)(null),[c,d]=(0,e.useState)(!1),[u,m]=(0,e.useState)(null),[h,p]=(0,e.useState)(null),[f,g]=(0,e.useState)(!0),v=(0,e.useCallback)(()=>{a({type:"none",phase:"idle",data:{}}),i(!1),r(new Set)},[]),y=(0,e.useCallback)(e=>{l(e)},[]),b=(0,e.useCallback)(()=>{l(null)},[]),x=(0,e.useCallback)(e=>{r(t=>new Set([...t,e]))},[]),w=(0,e.useCallback)(e=>{r(t=>{const a=new Set(t);return a.delete(e),a})},[]),S=(0,e.useCallback)(()=>{r(new Set)},[]),k=(0,e.useCallback)(e=>{m(e)},[]),N=(0,e.useCallback)(()=>{m(null)},[]),j=(0,e.useCallback)(e=>{p(e)},[]),T=(0,e.useCallback)(()=>{p(null)},[]);return{animationState:t,setAnimationState:a,recentlySubstitutedPlayers:n,setRecentlySubstitutedPlayers:r,addRecentlySubstitutedPlayer:x,removeRecentlySubstitutedPlayer:w,clearRecentlySubstitutedPlayers:S,hideNextOffIndicator:s,setHideNextOffIndicator:i,lastSubstitution:o,setLastSubstitution:l,updateLastSubstitution:y,clearLastSubstitution:b,shouldSubstituteNow:c,setShouldSubstituteNow:d,substitutionOverride:u,setSubstitutionOverride:k,clearSubstitutionOverride:N,substitutionCountOverride:h,setSubstitutionCountOverride:j,clearSubstitutionCountOverride:T,shouldResetSubTimerOnNextSub:f,setShouldResetSubTimerOnNextSub:g,resetAnimationState:v}}(),{setShouldResetSubTimerOnNextSub:Q}=J,$=K||Ul.OWN_TEAM_NAME,X=M||Ul.DEFAULT_OPPONENT_TEAM_NAME,{scoreRowRef:Z,displayOwnTeam:ee,displayOpponentTeam:te}=function(t,a,n,r){const[s,i]=(0,e.useState)(!1),o=(0,e.useRef)(null),l=e=>e?e.substring(0,3)+".":e,c=s?l(t):t,d=s?l(a):a;return(0,e.useEffect)(()=>{const e=()=>{if(!o.current)return;const e=o.current,s=e.offsetWidth,l=document.createElement("div");l.style.position="absolute",l.style.visibility="hidden",l.style.whiteSpace="nowrap",l.className=e.className;const c=document.createElement("button");c.className="flex-1 px-3 py-2 bg-sky-600 hover:bg-sky-500 rounded-md text-white font-semibold transition-colors",c.textContent=t||"";const d=document.createElement("div");d.className="text-2xl font-mono font-bold text-sky-200 cursor-pointer select-none px-1.5 py-2 rounded-md hover:bg-slate-600 transition-colors whitespace-nowrap flex-shrink-0",d.textContent="".concat(n||0," - ").concat(r||0);const u=document.createElement("button");u.className="flex-1 px-3 py-2 bg-slate-600 hover:bg-slate-500 rounded-md text-white font-semibold transition-colors",u.textContent=a||"",l.appendChild(c),l.appendChild(d),l.appendChild(u),e.parentElement.appendChild(l);const m=l.scrollWidth;e.parentElement.removeChild(l),i(m>s)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[t,a,n,r]),{scoreRowRef:o,displayOwnTeam:c,displayOpponentTeam:d}}($,X,_,C),[ae,ne]=e.useState(!1),re=e.useCallback(e=>V(e),[V]),se=(0,e.useMemo)(()=>(e=>{if(!Array.isArray(e)||0===e.length)return e;const t=[...e];return t.sort((e,t)=>{const a=sp(e),n=sp(t),r=(0,ki.XO)(a),s=(0,ki.XO)(n);if(r!==s)return r-s;const i=e.displayName||e.firstName||"",o=t.displayName||t.firstName||"";return i.localeCompare(o)}),t})(b.filter(e=>e.stats&&!e.stats.isInactive)),[b]),[ie,oe]=e.useState(()=>{const e=Jp.loadState(),t=parseInt(e.count,10);return!isNaN(t)&&t>=1?t:1}),le=e.useMemo(()=>{const e=Math.max(1,(0,$i.Kf)(S)||0),t=i.filter(e=>{var t,a;return(null===(t=e.stats)||void 0===t?void 0:t.currentStatus)===Je.P.SUBSTITUTE&&!(null!==(a=e.stats)&&void 0!==a&&a.isInactive)}).length;return Math.max(1,Math.min(e,t))},[S,i]);e.useEffect(()=>{ie>le&&oe(le)},[ie,le]),e.useEffect(()=>{Jp.saveState({count:ie})},[ie]);const ce=e.useCallback(e=>{oe(e)},[]),de=e.useCallback(()=>{var e;const t=null!==(e=J.substitutionCountOverride)&&void 0!==e?e:ie;return{formation:r,allPlayers:i,teamConfig:S,selectedFormation:k,nextPlayerToSubOut:v,nextPlayerIdToSubOut:y,rotationQueue:R,selectedSquadPlayers:b,fieldPlayerModal:Y.modals.fieldPlayer,lastSubstitution:J.lastSubstitution,subTimerSeconds:c,isSubTimerPaused:d,currentPeriodNumber:a,matchTimerSeconds:l,ownScore:_,opponentScore:C,currentMatchId:U,substitutionCount:t,substitutionOverride:J.substitutionOverride,shouldResetSubTimerOnNextSub:J.shouldResetSubTimerOnNextSub}},[r,i,S,k,v,y,R,b,Y.modals.fieldPlayer,J.lastSubstitution,c,d,a,l,_,C,U,ie,J.substitutionCountOverride,J.substitutionOverride,J.shouldResetSubTimerOnNextSub]),ue=e.useMemo(()=>({setFormation:s,setAllPlayers:o,setNextPlayerToSubOut:x,setNextPlayerIdToSubOut:w,setRotationQueue:O,setShouldSubstituteNow:J.setShouldSubstituteNow,setSubstitutionOverride:J.setSubstitutionOverride,clearSubstitutionOverride:J.clearSubstitutionOverride,setLastSubstitution:J.setLastSubstitution,setLastSubstitutionTimestamp:()=>{},setScore:I,setOwnScore:e=>I(e,C),setOpponentScore:e=>I(_,e),addGoalScored:P,addGoalConceded:E,resetSubTimer:p,handleUndoSubstitutionTimer:f,setSubstitutionCountOverride:J.setSubstitutionCountOverride,clearSubstitutionCountOverride:J.clearSubstitutionCountOverride,setShouldResetSubTimerOnNextSub:Q}),[s,o,x,w,O,J.setShouldSubstituteNow,J.setSubstitutionOverride,J.clearSubstitutionOverride,J.setLastSubstitution,I,_,C,P,E,p,f,J.setSubstitutionCountOverride,J.clearSubstitutionCountOverride,Q]),me=(0,e.useCallback)(e=>{const t=Ui(i,e);return t?Kl(t):null},[i]),he=e.useMemo(()=>({setAnimationState:J.setAnimationState,setHideNextOffIndicator:J.setHideNextOffIndicator,setRecentlySubstitutedPlayers:J.setRecentlySubstitutedPlayers}),[J.setAnimationState,J.setHideNextOffIndicator,J.setRecentlySubstitutedPlayers]),pe=e.useMemo(()=>({pauseSubTimer:u,resumeSubTimer:m}),[u,m]),fe=e.useCallback(()=>{var e;return null!==(e=J.substitutionCountOverride)&&void 0!==e?e:ie},[J.substitutionCountOverride,ie]),ge=e.useMemo(()=>qp(de,ue,he,Y,S,fe),[de,ue,he,Y,S,fe]),ve=(e=>({leftDefenderEvents:Bp(e.leftDefenderCallback||(()=>{})),rightDefenderEvents:Bp(e.rightDefenderCallback||(()=>{})),leftAttackerEvents:Bp(e.leftAttackerCallback||(()=>{})),rightAttackerEvents:Bp(e.rightAttackerCallback||(()=>{})),leftMidfielderEvents:Bp(e.leftMidfielderCallback||(()=>{})),centerMidfielderEvents:Bp(e.centerMidfielderCallback||(()=>{})),rightMidfielderEvents:Bp(e.rightMidfielderCallback||(()=>{})),defenderEvents:Bp(e.defenderCallback||(()=>{})),leftEvents:Bp(e.leftCallback||(()=>{})),rightEvents:Bp(e.rightCallback||(()=>{})),attackerEvents:Bp(e.attackerCallback||(()=>{})),substitute_1Events:Bp(e.substitute_1Callback||(()=>{})),substitute_2Events:Bp(e.substitute_2Callback||(()=>{})),substitute_3Events:Bp(e.substitute_3Callback||(()=>{})),substitute_4Events:Bp(e.substitute_4Callback||(()=>{})),substitute_5Events:Bp(e.substitute_5Callback||(()=>{}))}))(e.useMemo(()=>Up(S,r,i,y,Y,k,ie,R),[S,r,i,y,Y,k,ie,R])),ye=e.useMemo(()=>Gp(b,ue,pe),[b,ue,pe,de]),be=e.useMemo(()=>zp(ue,Y,{shouldTrackGoalScorer:z,getPlayerNameById:me}),[ue,Y,z,me]),we=e.useMemo(()=>Vp(de,ue,he,Y,i,b),[de,ue,he,Y,i,b]),Se=Bp(we.goalieCallback),ke=Bp(be.scoreCallback),Ne=e.useMemo(()=>(0,n.A)((0,n.A)({},we),{},{goalieEvents:Se}),[we,Se]),je=e.useMemo(()=>Ji(i,S),[i,S]),Te=e.useMemo(()=>1===ie?W("substitution.buttonSingle"):W("substitution.buttonMultiple",{count:ie}),[ie,W]),Ae=e.useCallback(e=>{const t=Ui(i,e);if(!t)return{totalOutfieldTime:0,attackDefenderDiff:0};const a=t.stats;if(d){return{totalOutfieldTime:a.timeOnFieldSeconds||0,attackDefenderDiff:(a.timeAsAttackerSeconds||0)-(a.timeAsDefenderSeconds||0)}}let n=0;a.currentStatus===Je.P.ON_FIELD&&(n=eo(a.lastStintStartTimeEpoch,Ns()));const r=(a.timeOnFieldSeconds||0)+n;let s=a.timeAsAttackerSeconds||0,o=a.timeAsDefenderSeconds||0;a.currentStatus===Je.P.ON_FIELD&&a.currentRole&&(a.currentRole===Je.q.ATTACKER?s+=n:a.currentRole===Je.q.DEFENDER&&(o+=n));return{totalOutfieldTime:r,attackDefenderDiff:s-o}},[i,d]);e.useEffect(()=>{J.shouldSubstituteNow&&(J.setShouldSubstituteNow(!1),ge.handleSubstitutionWithHighlight())},[J.shouldSubstituteNow,J.setShouldSubstituteNow,ge,J]);const _e=e.useCallback(()=>{Q(!0),ge.handleSubstitutionWithHighlight()},[Q,ge]),Ce=()=>{J.lastSubstitution&&(ge.handleUndo(J.lastSubstitution),J.clearLastSubstitution())},Me=e.useCallback(()=>{A()},[A]),Pe=e.useCallback(()=>{H(!0),j&&j(()=>{H(!1)},"GameScreen-CloseAbandonmentModal")},[H,j]);e.useEffect(()=>"pending"===q&&j?(j(Me,"GameScreen-BackToSetup"),()=>{T&&T()}):"running"===q&&j?(j(Pe,"GameScreen-MatchAbandonment"),()=>{T&&T()}):void 0,[q,j,T,Me,Pe]);const Ee="pending"===q||ae?60*G:l,Ie="pending"===q||ae?0:c;return(0,Ts.jsxs)("div",{className:"relative space-y-4",children:[("pending"===q||ae)&&(0,Ts.jsxs)("div",{className:"absolute inset-0 z-50 flex items-center justify-center p-8 transition-opacity duration-[2000ms] ".concat(ae?"opacity-0":"opacity-100"),children:[(0,Ts.jsx)("div",{className:"absolute inset-0 bg-black transition-all duration-[2000ms] ".concat(ae?"bg-opacity-0 backdrop-blur-none":"bg-opacity-30 backdrop-blur-sm")}),(0,Ts.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-sky-900/10 to-slate-900/15 transition-opacity duration-[2000ms] ".concat(ae?"opacity-0":"opacity-100")}),(0,Ts.jsxs)("div",{className:"relative z-10 text-center transition-opacity duration-[2000ms] ".concat(ae?"opacity-0":"opacity-100"),children:[(0,Ts.jsxs)("div",{onClick:()=>{ae||(B(),ne(!0),setTimeout(()=>{ne(!1)},2e3))},className:"group relative inline-block select-none transition-opacity duration-[2000ms] ".concat(ae?"cursor-default opacity-0":"cursor-pointer opacity-100"),children:[(0,Ts.jsxs)("div",{className:"absolute inset-0 animate-pulse",children:[(0,Ts.jsx)("div",{className:"absolute inset-0 bg-sky-400 rounded-full blur-3xl opacity-20 group-hover:opacity-40 transition-opacity duration-500"}),(0,Ts.jsx)("div",{className:"absolute inset-0 bg-sky-300 rounded-full blur-2xl opacity-30 group-hover:opacity-60 transition-opacity duration-300"}),(0,Ts.jsx)("div",{className:"absolute inset-0 bg-white rounded-full blur-xl opacity-10 group-hover:opacity-30 transition-opacity duration-200"})]}),(0,Ts.jsx)(Zh,{size:160,className:"relative text-sky-400 hover:text-sky-300 active:text-sky-500  drop-shadow-2xl  transform group-hover:scale-110 group-active:scale-95  transition-all duration-300 ease-out filter group-hover:brightness-110 group-active:brightness-90 group-hover:drop-shadow-[0_0_30px_rgba(56,189,248,0.8)] group-active:drop-shadow-[0_0_50px_rgba(56,189,248,1)]"}),(0,Ts.jsx)("div",{className:"absolute inset-0 rounded-full transition-opacity ".concat(ae?"opacity-100 animate-ping duration-[2000ms]":"opacity-0 group-active:opacity-100 group-active:animate-ping duration-75"," bg-sky-400/20")}),ae&&(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)("div",{className:"absolute inset-0 rounded-full opacity-60 animate-ping bg-sky-300/15 animation-delay-300",style:{animationDuration:"2000ms"}}),(0,Ts.jsx)("div",{className:"absolute inset-0 rounded-full opacity-40 animate-ping bg-sky-200/10 animation-delay-600",style:{animationDuration:"2000ms"}})]})]}),(0,Ts.jsxs)("div",{className:"mt-8 space-y-2 transition-opacity duration-[2000ms] ".concat(ae?"opacity-0":"opacity-100"),children:[(0,Ts.jsx)("p",{className:"text-3xl font-bold text-white drop-shadow-lg tracking-wide",children:1===a?W("startScreen.startMatch"):W("startScreen.startPeriod",{ordinal:Qp(a,W)})}),(0,Ts.jsx)("p",{className:"text-center text-sky-100/70 text-lg font-medium tracking-wide drop-shadow-sm",children:W("startScreen.instructions")})]}),(0,Ts.jsx)("div",{className:"mt-6 transition-opacity duration-[2000ms] ".concat(ae?"opacity-0":"opacity-100"),children:(0,Ts.jsxs)("div",{onClick:Me,className:"group relative inline-flex items-center justify-center space-x-2 px-4 py-2 cursor-pointer select-none text-sky-100/60 hover:text-sky-100/90 bg-white/5 hover:bg-white/10 rounded-md transform hover:scale-105 active:scale-95 transition-all duration-200 ease-out drop-shadow-sm hover:drop-shadow-md",children:[(0,Ts.jsx)(Uh,{className:"h-5 w-5"}),(0,Ts.jsx)("span",{className:"text-sm font-medium tracking-wide",children:W("startScreen.backToSetup")})]})})]})]}),(0,Ts.jsx)("h2",{className:"text-xl font-semibold text-sky-300 text-center",children:W("period.label",{number:a})}),(0,Ts.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-center",children:[(0,Ts.jsxs)("div",{className:"p-2 bg-slate-700 rounded-lg",children:[(0,Ts.jsx)("p",{className:"text-xs text-sky-200 mb-0.5",children:W("timers.matchClock")}),(0,Ts.jsxs)("p",{className:"text-2xl font-mono ".concat(Ee<0?"text-red-400":"text-sky-400"),children:[Ee<0?"+":"",h(Math.abs(Ee))]})]}),(0,Ts.jsxs)("div",{className:"p-2 bg-slate-700 rounded-lg relative",children:[(0,Ts.jsx)("p",{className:"text-xs text-sky-200 mb-0.5",children:W("timers.substitutionTimer")}),(0,Ts.jsxs)("div",{className:"relative flex items-center justify-center",children:[(0,Ts.jsx)("p",{className:"text-2xl font-mono ".concat(N>0&&Ie>=60*N?"text-red-400":"text-emerald-400"),children:h(Ie)}),(0,Ts.jsx)("button",{onClick:d?ye.handleResumeTimer:ye.handlePauseTimer,className:"absolute right-0 p-1 hover:bg-slate-600 rounded-full transition-colors duration-150 flex-shrink-0",title:W(d?"timers.resumeTooltip":"timers.pauseTooltip"),children:d?(0,Ts.jsx)(kc,{className:"h-4 w-4"}):(0,Ts.jsx)(ep,{className:"h-4 w-4"})})]})]})]}),(0,Ts.jsxs)("div",{className:"p-2 bg-slate-700 rounded-lg text-center",children:[(0,Ts.jsxs)("div",{ref:Z,className:"flex items-center justify-center space-x-2.5",children:[(0,Ts.jsx)("button",{onClick:()=>be.handleAddGoalScored(de()),className:"flex-1 px-3 py-2 bg-sky-600 hover:bg-sky-500 rounded-md text-white font-semibold transition-colors",children:ee}),(0,Ts.jsxs)("div",(0,n.A)((0,n.A)({},ke),{},{className:"text-2xl font-mono font-bold text-sky-200 cursor-pointer select-none px-1.5 py-2 rounded-md hover:bg-slate-600 transition-colors whitespace-nowrap flex-shrink-0",children:[_," - ",C]})),(0,Ts.jsx)("button",{onClick:()=>be.handleAddGoalConceded(de()),className:"flex-1 px-3 py-2 bg-slate-600 hover:bg-slate-500 rounded-md text-white font-semibold transition-colors",children:te})]}),(0,Ts.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:W("score.instructions")})]}),(0,Ts.jsx)(Lp,{teamConfig:S,selectedFormation:k,formation:r,allPlayers:i,animationState:J.animationState,recentlySubstitutedPlayers:J.recentlySubstitutedPlayers,hideNextOffIndicator:J.hideNextOffIndicator||!je,nextPlayerIdToSubOut:y,substitutionCount:ie,rotationQueue:R,quickTapHandlers:ve,goalieHandlers:Ne,getPlayerNameById:re,getPlayerTimeStats:Ae,renderSection:"field"}),(0,Ts.jsxs)("div",{className:"flex gap-2 mt-4 z-30 relative","data-testid":"substitution-action-row",children:[(0,Ts.jsx)(Yp,{value:ie,min:1,max:le,onChange:ce,disabled:!je,className:"flex-shrink-0"}),(0,Ts.jsx)(Lc,{onClick:_e,Icon:tp,className:"flex-1",disabled:!je,title:W(je?"substitution.makeSubstitution":"substitution.cannotSubstitute"),children:Te}),(0,Ts.jsx)("button",{onClick:Ce,disabled:!J.lastSubstitution,className:"w-12 h-12 rounded-md flex items-center justify-center transition-all duration-200 ".concat(J.lastSubstitution?"bg-slate-600 hover:bg-slate-500 text-slate-100 shadow-md cursor-pointer":"bg-slate-800 text-slate-600 cursor-not-allowed opacity-50"),title:J.lastSubstitution?W("substitution.undoTooltip"):W("substitution.undoDisabled"),children:(0,Ts.jsx)(ap,{className:"h-5 w-5"})})]}),(0,Ts.jsx)(Lp,{teamConfig:S,selectedFormation:k,formation:r,allPlayers:i,animationState:J.animationState,recentlySubstitutedPlayers:J.recentlySubstitutedPlayers,hideNextOffIndicator:J.hideNextOffIndicator||!je,nextPlayerIdToSubOut:y,substitutionCount:ie,rotationQueue:R,quickTapHandlers:ve,goalieHandlers:Ne,getPlayerNameById:re,getPlayerTimeStats:Ae,renderSection:"substitutes"}),(0,Ts.jsx)("div",{className:"flex flex-col gap-3 mt-4",children:(0,Ts.jsx)(Lc,{onClick:g,Icon:np,variant:"danger",className:"w-full",children:W("actions.endPeriod")})}),(0,Ts.jsx)(Gc,{isOpen:Y.modals.fieldPlayer.isOpen,onSetNext:()=>ge.handleSetNextSubstitution(Y.modals.fieldPlayer),onRemoveFromNext:()=>ge.handleRemoveFromNextSubstitution(Y.modals.fieldPlayer),onSubNow:()=>ge.handleSubstituteNow(Y.modals.fieldPlayer),onCancel:ge.handleCancelFieldPlayerModal,onChangePosition:ge.handleChangePosition,playerName:Y.modals.fieldPlayer.playerName,availablePlayers:Y.modals.fieldPlayer.availablePlayers,showPositionChange:"player"===Y.modals.fieldPlayer.type,showPositionOptions:Y.modals.fieldPlayer.showPositionOptions,showSubstitutionOptions:"player"===Y.modals.fieldPlayer.type,canSubstitute:je,isPlayerAboutToSubOff:Y.modals.fieldPlayer.isPlayerAboutToSubOff||!1}),(0,Ts.jsx)(zc,{isOpen:Y.modals.substitute.isOpen,onInactivate:()=>ge.handleInactivatePlayer(Y.modals.substitute,i,r),onActivate:()=>ge.handleActivatePlayer(Y.modals.substitute),onCancel:ge.handleCancelSubstituteModal,onSetAsNextToGoIn:()=>ge.handleSetAsNextToGoIn(Y.modals.substitute,r),onChangeNextPosition:e=>ge.handleChangeNextPosition(Y.modals.substitute,e),playerName:Y.modals.substitute.playerName,isCurrentlyInactive:Y.modals.substitute.isCurrentlyInactive,canSetAsNextToGoIn:Y.modals.substitute.canSetAsNextToGoIn,canChangeNextPosition:Y.modals.substitute.canChangeNextPosition,availableNextPositions:Y.modals.substitute.availableNextPositions,showPositionSelection:Y.modals.substitute.showPositionSelection}),(0,Ts.jsx)(Vc,{isOpen:Y.modals.goalie.isOpen,onCancel:Ne.handleCancelGoalieModal,onSelectGoalie:Ne.handleSelectNewGoalie,currentGoalieName:Y.modals.goalie.currentGoalieName,availablePlayers:Y.modals.goalie.availablePlayers}),(0,Ts.jsx)(Hc,{isOpen:Y.modals.scoreEdit.isOpen,onCancel:Y.closeScoreEditModal,ownScore:_,opponentScore:C,ownTeamName:$,opponentTeam:X,matchEvents:D,goalScorers:F,allPlayers:i,onAddGoalScored:()=>be.handleAddGoalScored(de()),onAddGoalConceded:()=>be.handleAddGoalConceded(de()),onEditGoalScorer:be.handleEditGoalScorer,onDeleteGoal:be.handleDeleteGoal,calculateMatchTime:e=>_o(e,L),formatTime:h,getPlayerName:V,allowScorerSelection:z}),(0,Ts.jsx)(qc,{isOpen:Y.modals.undoConfirm.isOpen,onConfirm:Ce,onCancel:Y.closeUndoConfirmModal,title:W("substitution.undoModal.title"),message:W("substitution.undoModal.message"),confirmText:W("substitution.undoModal.confirm"),cancelText:W("substitution.undoModal.cancel"),variant:"warning"}),(0,Ts.jsx)(ip,{isOpen:z&&Y.modals.goalScorer.isOpen,onClose:be.handleCancelGoalScorer,onSelectScorer:e=>be.handleSelectGoalScorer(Y.modals.goalScorer.eventId,e),onCorrectGoal:(e,t)=>be.handleCorrectGoalScorer(e,t),eligiblePlayers:se,mode:Y.modals.goalScorer.mode,eventId:Y.modals.goalScorer.eventId,currentScorerId:Y.modals.goalScorer.currentScorerId,existingGoalData:Y.modals.goalScorer.existingGoalData,matchTime:Y.modals.goalScorer.matchTime,goalType:Y.modals.goalScorer.team}),(0,Ts.jsx)(Kc,{isOpen:Y.modals.substituteSelection.isOpen,onCancel:ge.handleCancelSubstituteSelection,onSelectSubstitute:e=>ge.handleSelectSubstituteForImmediate(Y.modals.substituteSelection,e),fieldPlayerName:Y.modals.substituteSelection.fieldPlayerName,availableSubstitutes:Y.modals.substituteSelection.availableSubstitutes})]})}const Xp=fc("list-checks",[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}]]),Zp=fc("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),ef=fc("timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);function tf(e){let{ownTeamName:t=Ul.OWN_TEAM_NAME,opponentTeam:a="Opponent",ownScore:n=0,opponentScore:r=0,matchStartTime:s=null,scheduledStartTime:i=null,matchDuration:o=null,matchDurationDisplay:l=null,totalPeriods:c=0,periodDurationMinutes:d=12,matchHasStarted:u=!0,matchHasFinished:m=u}=e;const{t:h}=xe("statistics"),p=e=>n===r?"text-sky-300":(e?n>r:r>n)?"text-emerald-400":"text-slate-300";return(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-slate-400",children:[(0,Ts.jsx)(Id,{className:"h-4 w-4"}),(0,Ts.jsx)("span",{className:"text-sm",children:(()=>{if(u&&s){const e=new Date(s),t=e.toLocaleDateString("sv-SE",{year:"numeric",month:"2-digit",day:"2-digit"}),a=e.toLocaleTimeString("sv-SE",{hour:"2-digit",minute:"2-digit"});return"".concat(t," ").concat(a)}if(!u&&i){const{date:e,time:t,venue:a}=i;return a?"".concat(h("matchSummary.scheduled")," ").concat(e," ").concat(t," (").concat(a,")"):"".concat(h("matchSummary.scheduled")," ").concat(e," ").concat(t)}return h("matchSummary.noStartTime")})()})]}),(0,Ts.jsxs)("div",{className:"text-center space-y-2",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-center space-x-6",children:[(0,Ts.jsxs)("div",{className:"flex-1 text-right",children:[(0,Ts.jsx)("div",{className:"text-lg font-semibold text-slate-200 truncate",children:t}),(0,Ts.jsx)("div",{className:"text-4xl font-bold font-mono ".concat(p(!0)),children:n})]}),(0,Ts.jsx)("div",{className:"flex-shrink-0 px-4",children:(0,Ts.jsx)("div",{className:"text-2xl font-bold text-slate-500",children:"-"})}),(0,Ts.jsxs)("div",{className:"flex-1 text-left",children:[(0,Ts.jsx)("div",{className:"text-lg font-semibold text-slate-200 truncate",children:a}),(0,Ts.jsx)("div",{className:"text-4xl font-bold font-mono ".concat(p(!1)),children:r})]})]}),m&&(0,Ts.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-sm",children:[(0,Ts.jsx)(jd,{className:"h-4 w-4 text-yellow-400"}),(0,Ts.jsx)("span",{className:"text-slate-300",children:n>r?h("matchSummary.wins",{teamName:t}):r>n?h("matchSummary.wins",{teamName:a}):h("matchSummary.tied")})]})]}),(0,Ts.jsxs)("div",{className:"flex items-center justify-center space-x-6 text-sm text-slate-400",children:[u&&(0,Ts.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Ts.jsx)(Sd,{className:"h-4 w-4"}),(0,Ts.jsx)("span",{children:(()=>{if(l)return l;if(!o||o<=0)return h("matchSummary.durationUnknown");return Bl(o)})()})]}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Ts.jsx)(ef,{className:"h-4 w-4"}),(0,Ts.jsx)("span",{children:h("matchSummary.periodsFormat",{periods:c,duration:d})})]})]})]})}function af(t){let{players:a=[],formation:n={},matchEvents:r=[],goalScorers:s={}}=t;const{t:i}=xe("reports"),[o,l]=(0,e.useState)("name"),[c,d]=(0,e.useState)("asc"),u=(0,e.useMemo)(()=>{const e={};return r.forEach(t=>{if((t.type===wo.GOAL_SCORED||t.type===wo.GOAL_CONCEDED)&&!t.undone){var a;const n=s[t.id]||(null===(a=t.data)||void 0===a?void 0:a.scorerId);n&&(e[n]=(e[n]||0)+1)}}),e},[r,s]),m=(0,e.useMemo)(()=>{const e=a.some(e=>{var t;return(null===(t=e.stats)||void 0===t?void 0:t.timeAsDefenderSeconds)>0}),t=a.some(e=>{var t;return(null===(t=e.stats)||void 0===t?void 0:t.timeAsMidfielderSeconds)>0}),n=a.some(e=>{var t;return(null===(t=e.stats)||void 0===t?void 0:t.timeAsAttackerSeconds)>0}),r=[{key:"name",label:i("table.columns.player"),sortable:!0,className:"text-left font-medium text-slate-100",render:e=>Kl(e)},{key:"startingRole",label:i("table.columns.startingRole"),sortable:!0,className:"text-center text-slate-300",render:e=>{var t,a;const n=null===(t=e.stats)||void 0===t?void 0:t.startedAtRole,r=null===(a=e.stats)||void 0===a?void 0:a.startedMatchAs;return n===Je.q.GOALIE?i("table.roles.goalie"):n===Je.q.DEFENDER?i("table.roles.defender"):n===Je.q.MIDFIELDER?i("table.roles.midfielder"):n===Je.q.ATTACKER?i("table.roles.attacker"):n===Je.q.SUBSTITUTE?i("table.roles.substitute"):r===Je.q.GOALIE?i("table.roles.goalie"):r===Je.q.SUBSTITUTE?i("table.roles.substitute"):r===Je.q.FIELD_PLAYER?i("table.roles.field"):i("table.roles.none")}},{key:"timeOnField",label:i("table.columns.outfield"),sortable:!0,className:"text-center text-slate-300 font-mono",render:e=>{var t;const a=(null===(t=e.stats)||void 0===t?void 0:t.timeOnFieldSeconds)||0;return a>0?Bl(a):"--"}},{key:"timeAsDefender",label:i("table.columns.defender"),sortable:!0,className:"text-center text-slate-300 font-mono",render:e=>{var t;const a=(null===(t=e.stats)||void 0===t?void 0:t.timeAsDefenderSeconds)||0;return a>0?Bl(a):"--"}},{key:"timeAsMidfielder",label:i("table.columns.midfielder"),sortable:!0,className:"text-center text-slate-300 font-mono",render:e=>{var t;const a=(null===(t=e.stats)||void 0===t?void 0:t.timeAsMidfielderSeconds)||0;return a>0?Bl(a):"--"}},{key:"timeAsAttacker",label:i("table.columns.attacker"),sortable:!0,className:"text-center text-slate-300 font-mono",render:e=>{var t;const a=(null===(t=e.stats)||void 0===t?void 0:t.timeAsAttackerSeconds)||0;return a>0?Bl(a):"--"}},{key:"timeAsGoalie",label:i("table.columns.goalie"),sortable:!0,className:"text-center text-slate-300 font-mono",render:e=>{var t;const a=(null===(t=e.stats)||void 0===t?void 0:t.timeAsGoalieSeconds)||0;return a>0?Bl(a):"--"}},{key:"timeAsSubstitute",label:i("table.columns.substitute"),sortable:!0,className:"text-center text-slate-300 font-mono",render:e=>{var t;const a=(null===(t=e.stats)||void 0===t?void 0:t.timeAsSubSeconds)||0;return a>0?Bl(a):"--"}},{key:"goalsScored",label:i("table.columns.goals"),sortable:!0,className:"text-center text-slate-300",render:e=>{const t=u[e.id]||0;return t>0?t:"--"}}];return r.filter(a=>!("timeAsDefender"===a.key&&!e)&&(!("timeAsMidfielder"===a.key&&!t)&&!("timeAsAttacker"===a.key&&!n)))},[u,a,i]),h=(0,e.useMemo)(()=>{if(!a.length)return[];const e=[...a].sort((e,t)=>{var a,n,r,s,l,d,m,h,p,f,g,v;let y,b;switch(o){case"name":default:y=e.name||"",b=t.name||"";break;case"startingRole":const o=e=>{var t,a;const n=null===(t=e.stats)||void 0===t?void 0:t.startedAtRole,r=null===(a=e.stats)||void 0===a?void 0:a.startedMatchAs;return n===Je.q.GOALIE?i("table.roles.goalie"):n===Je.q.DEFENDER?i("table.roles.defender"):n===Je.q.MIDFIELDER?i("table.roles.midfielder"):n===Je.q.ATTACKER?i("table.roles.attacker"):n===Je.q.SUBSTITUTE?i("table.roles.substitute"):r===Je.q.GOALIE?i("table.roles.goalie"):r===Je.q.SUBSTITUTE?i("table.roles.substitute"):r===Je.q.FIELD_PLAYER?i("table.roles.field"):i("table.roles.none")};y=o(e),b=o(t);break;case"timeOnField":y=(null===(a=e.stats)||void 0===a?void 0:a.timeOnFieldSeconds)||0,b=(null===(n=t.stats)||void 0===n?void 0:n.timeOnFieldSeconds)||0;break;case"timeAsAttacker":y=(null===(r=e.stats)||void 0===r?void 0:r.timeAsAttackerSeconds)||0,b=(null===(s=t.stats)||void 0===s?void 0:s.timeAsAttackerSeconds)||0;break;case"timeAsDefender":y=(null===(l=e.stats)||void 0===l?void 0:l.timeAsDefenderSeconds)||0,b=(null===(d=t.stats)||void 0===d?void 0:d.timeAsDefenderSeconds)||0;break;case"timeAsMidfielder":y=(null===(m=e.stats)||void 0===m?void 0:m.timeAsMidfielderSeconds)||0,b=(null===(h=t.stats)||void 0===h?void 0:h.timeAsMidfielderSeconds)||0;break;case"timeAsGoalie":y=(null===(p=e.stats)||void 0===p?void 0:p.timeAsGoalieSeconds)||0,b=(null===(f=t.stats)||void 0===f?void 0:f.timeAsGoalieSeconds)||0;break;case"timeAsSubstitute":y=(null===(g=e.stats)||void 0===g?void 0:g.timeAsSubSeconds)||0,b=(null===(v=t.stats)||void 0===v?void 0:v.timeAsSubSeconds)||0;break;case"goalsScored":y=u[e.id]||0,b=u[t.id]||0}if("string"===typeof y){const e=y.localeCompare(b);return"asc"===c?e:-e}const x=y-b;return"asc"===c?x:-x});return e},[a,o,c,u,i]);(0,e.useEffect)(()=>{const e=m.map(e=>e.key);e.includes(o)||(l("name"),d("asc"))},[m,o]);return h.length?(0,Ts.jsx)("div",{className:"bg-slate-700 rounded-lg border border-slate-600 overflow-hidden",children:(0,Ts.jsx)("div",{className:"overflow-x-auto",children:(0,Ts.jsxs)("table",{className:"min-w-full divide-y divide-slate-600",children:[(0,Ts.jsx)("thead",{className:"bg-slate-800",children:(0,Ts.jsx)("tr",{children:m.map((e,t)=>{return(0,Ts.jsx)("th",{scope:"col",className:"px-3 py-3 text-xs font-medium text-sky-200 tracking-wider ".concat(e.sortable?"cursor-pointer hover:bg-slate-700 transition-colors":""," ").concat(o===e.key?"bg-slate-700":""," ").concat(0===t?"sticky left-0 z-10 bg-slate-800":""),onClick:e.sortable?()=>(e=>{const t=o===e&&"desc"===c?"asc":"desc";l(e),d(t)})(e.key):void 0,children:(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("span",{children:e.label}),e.sortable&&(a=e.key,o!==a?null:"asc"===c?(0,Ts.jsx)($u,{className:"h-5 w-5 inline-block ml-1"}):(0,Ts.jsx)(jc,{className:"h-5 w-5 inline-block ml-1"}))]})},e.key);var a})})}),(0,Ts.jsx)("tbody",{className:"bg-slate-700 divide-y divide-slate-600",children:h.map((e,t)=>(0,Ts.jsx)("tr",{className:"".concat(t%2===0?"bg-slate-700":"bg-slate-800"," hover:bg-slate-600 transition-colors"),children:m.map((a,n)=>(0,Ts.jsx)("td",{className:"px-3 py-3 whitespace-nowrap text-sm ".concat(a.className," ").concat(0===n?"sticky left-0 z-10 ".concat(t%2===0?"bg-slate-700":"bg-slate-800"):""),children:a.render(e)},a.key))},e.id))})]})})}):(0,Ts.jsx)(Yd,{title:i("table.noStats")})}function nf(t){let{allPlayers:a,onNavigateTo:r,setAllPlayers:s,setSelectedSquadIds:i,setPeriodGoalieIds:o,setGameLog:l,initializePlayers:c,initialRoster:d,clearStoredState:u,clearTimerState:m,ownScore:h,opponentScore:p,opponentTeam:f,resetScore:g,setOpponentTeam:v,onNavigateBack:y,pushNavigationState:b,removeFromNavigationStack:x,matchEvents:w=[],gameLog:S=[],currentMatchId:k,goalScorers:N={},showSuccessMessage:j=()=>{},checkForActiveMatch:T,handleRestartMatch:A,selectedSquadIds:_=[],onStartNewConfigurationSession:C=()=>{},matchStartTime:M,periodDurationMinutes:P=12,formation:E={},ownTeamName:I=Ul.OWN_TEAM_NAME,matchType:R=null}=t;const{t:O}=xe("game"),[D,F]=(0,e.useState)(null),[L,q]=(0,e.useState)(!1),[U,B]=(0,e.useState)(null),[G,z]=(0,e.useState)(ci.NONE),[V,H]=(0,e.useState)({}),{isAuthenticated:K}=Cs(),{currentTeam:W,loadTeamPreferences:Y}=vi(),J=(0,e.useRef)(0);(0,e.useEffect)(()=>(b&&b(()=>{y()}),()=>{x&&x()}),[b,x,y]),(0,e.useEffect)(()=>{rd()},[]);const Q=(0,e.useMemo)(()=>{if(!M)return 0;const e=w&&w.length>0?Math.max(...w.map(e=>e.timestamp)):Date.now();return Math.floor((e-M)/1e3)},[w,M]),$=(0,e.useMemo)(()=>S.length,[S]),X=(0,e.useMemo)(()=>Array.isArray(_)&&_.length>0?new Set(_):null,[_]),Z=(0,e.useMemo)(()=>a.filter(e=>!(X&&!X.has(e.id))&&(e=>{if(null===e||void 0===e||!e.stats)return!1;const{timeOnFieldSeconds:t=0,timeAsGoalieSeconds:a=0,timeAsDefenderSeconds:n=0,timeAsAttackerSeconds:r=0,timeAsMidfielderSeconds:s=0,periodsAsGoalie:i=0,periodsAsDefender:o=0,periodsAsAttacker:l=0,periodsAsMidfielder:c=0,goals:d=0,saves:u=0,blocks:m=0,cards:h=[]}=e.stats;return t>0||a>0||n>0||r>0||s>0||i>0||o>0||l>0||c>0||d>0||u>0||m>0||!!(Array.isArray(h)&&h.length>0)||e.stats.startedMatchAs===Je.q.GOALIE||e.stats.startedMatchAs===Je.q.FIELD_PLAYER})(e)),[a,X]),ee="bg-gradient-to-r from-emerald-900/20 to-emerald-800/20 border border-emerald-500/40 shadow-emerald-500/20 shadow-lg rounded-lg p-4",te="text-lg font-semibold text-emerald-200 flex items-center",ae="w-full appearance-none bg-emerald-900/20 border border-emerald-500/60 text-emerald-100 py-2 px-3 pr-8 rounded-md leading-tight focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:border-emerald-400 focus:shadow-emerald-300/50 focus:shadow-lg transition-colors",ne="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-emerald-400",re="mt-3 p-3 bg-gradient-to-r from-emerald-900/40 to-emerald-800/40 border border-emerald-400/50 shadow-emerald-400/30 shadow-lg rounded-lg",se="text-emerald-200 font-medium flex items-center",ie="text-xs text-emerald-300/90 font-semibold",oe=(0,e.useCallback)((e,t)=>{const a=t.find(t=>t.id===e);return a?Kl(a):""},[]);(0,e.useEffect)(()=>{let e=!0;return(async()=>{var t;if(null!==W&&void 0!==W&&W.id&&Y)try{const a=await Y(W.id);if(!e)return;const n=(t=null===a||void 0===a?void 0:a.fairPlayAward,Object.values(ci).includes(t)?t:ci.NONE);z(n)}catch(a){console.warn("Failed to load fair play award preference:",a),e&&z(ci.NONE)}else z(ci.NONE)})(),()=>{e=!1}},[null===W||void 0===W?void 0:W.id,Y]);const le=(0,e.useMemo)(()=>{switch(G){case ci.ALL_GAMES:return!0;case ci.LEAGUE_ONLY:return R===Ol.MATCH_TYPES.LEAGUE;case ci.COMPETITIVE:return[Ol.MATCH_TYPES.LEAGUE,Ol.MATCH_TYPES.CUP,Ol.MATCH_TYPES.TOURNAMENT].includes(R);default:return!1}},[G,R]);(0,e.useEffect)(()=>{!le&&U&&B(null)},[le,U]),(0,e.useEffect)(()=>{var e;if(!le)return;const t=(null===(e=Z.find(e=>e.hasFairPlayAward))||void 0===e?void 0:e.id)||null;B(e=>e===t?e:t)},[le,Z]),(0,e.useEffect)(()=>{let e=!0;return(async()=>{if(le&&K&&null!==W&&void 0!==W&&W.id)try{const t=new Date,a=new Date(t);a.setMonth(t.getMonth()-6);const n=await Zo(W.id,a,t);if(!e)return;if(null!==n&&void 0!==n&&n.success&&Array.isArray(n.players)){const e={};n.players.forEach(t=>{e[t.id]=t.fairPlayAwards||0}),H(e)}else null!==n&&void 0!==n&&n.error&&console.error("Failed to load fair play award history:",n.error),H({})}catch(t){e&&H({}),console.error("Fair play award history load error:",t)}else e&&H({})})(),()=>{e=!1}},[null===W||void 0===W?void 0:W.id,K,le]);const ce=(0,e.useCallback)(async e=>{const t=e?oe(e,Z):null;if(!le)return;if(!k)return void F(O("stats.errors.noMatchId"));if(!K)return void F(O("stats.errors.signInRequired"));const a=J.current+1;J.current=a,F(null),q(!0),s(t=>((e,t)=>{const a=t||null;return e.map(e=>(0,n.A)((0,n.A)({},e),{},{hasFairPlayAward:Boolean(a&&e.id===a)}))})(t,e));try{const n=await Jo(k,{fairPlayAwardId:null!==e&&void 0!==e?e:null,fairPlayAwardName:t});if(J.current!==a)return;n.success?j(O("stats.matchSaved")):F(n.error||O("stats.errors.saveFailed"))}catch(r){J.current===a&&F(r.message||O("stats.errors.saveFailed"))}finally{J.current===a&&q(!1)}},[k,oe,K,s,le,j,Z,O]),de=(0,e.useCallback)(e=>{const t=e.target.value||null;B(t),ce(t)},[ce]),ue=(0,e.useMemo)(()=>[...Z].map(e=>{var t;const a=null!==(t=V[e.id])&&void 0!==t?t:0,n=Kl(e);return{id:e.id,awardsCount:a,label:"".concat(n," (").concat(a,")")}}).sort((e,t)=>e.awardsCount!==t.awardsCount?e.awardsCount-t.awardsCount:e.label.localeCompare(t.label)),[V,Z]);return(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsx)("div",{className:"flex items-center justify-between",children:(0,Ts.jsxs)("h2",{className:"text-2xl font-semibold text-sky-300 flex items-center",children:[(0,Ts.jsx)(Xp,{className:"mr-2 h-6 w-6"}),O("stats.title")]})}),(0,Ts.jsx)(Xc,{children:(0,Ts.jsx)(tf,{ownTeamName:I,opponentTeam:f||O("stats.opponent"),ownScore:h,opponentScore:p,matchStartTime:M,matchDuration:Q,totalPeriods:$,periodDurationMinutes:P})}),le&&(0,Ts.jsxs)("div",{className:ee,"data-testid":"fair-play-award-section",children:[(0,Ts.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,Ts.jsx)("h3",{className:te,children:O("stats.fairPlayAward")})}),(0,Ts.jsxs)("div",{className:"relative",children:[(0,Ts.jsxs)("select",{value:U||"",onChange:de,className:ae,"data-testid":"fair-play-award-dropdown",children:[(0,Ts.jsx)("option",{value:"",className:"bg-slate-800",children:O("stats.notAwarded")}),ue.map(e=>(0,Ts.jsx)("option",{value:e.id,className:"bg-slate-800",children:e.label},e.id))]}),(0,Ts.jsx)("div",{className:ne,children:(0,Ts.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),U&&(0,Ts.jsx)("div",{className:re,"data-testid":"fair-play-confirmation",children:(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsxs)("span",{className:se,children:["\u2728 ",oe(U,Z)]}),(0,Ts.jsx)("span",{className:ie,children:O("stats.fairPlayWinner")})]})}),(0,Ts.jsx)("div",{className:"mt-3 text-xs text-slate-300",children:O(L?"stats.savingSelection":"stats.selectionSavesAutomatically")}),D&&(0,Ts.jsx)(Jc,{variant:"error",className:"mt-3",children:D})]}),(0,Ts.jsx)(af,{players:Z,formation:E,matchEvents:w,goalScorers:N}),(0,Ts.jsx)(Lc,{onClick:()=>{k?r(bi.LIVE_MATCH,{matchId:k,entryPoint:bi.STATS}):console.warn("No match ID available for live match navigation")},Icon:Zp,variant:"primary",children:O("stats.viewMatchReport")}),(0,Ts.jsx)(Lc,{onClick:async()=>{console.log("\ud83d\udcca New Game from Stats Screen - calling checkForActiveMatch()"),await T(()=>{console.log("\ud83d\udcca New Game from Stats - delegating to handleRestartMatch"),A({preserveConfiguration:!1})})},Icon:Ju,children:O("stats.startNewGame")})]})}const rf=fc("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),sf=fc("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]),of=fc("chart-pie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]),lf={W:"bg-emerald-900/50 text-emerald-300 border border-emerald-600",D:"bg-slate-700 text-slate-300 border border-slate-600",L:"bg-rose-900/50 text-rose-300 border border-rose-600",default:"bg-slate-700 text-slate-300"},cf={league:"bg-sky-900/50 text-sky-300 border border-sky-600",cup:"bg-purple-900/50 text-purple-300 border border-purple-600",friendly:"bg-slate-700 text-slate-300 border border-slate-600",tournament:"bg-amber-900/50 text-amber-200 border border-amber-600",internal:"bg-teal-900/50 text-teal-200 border border-teal-600",default:"bg-slate-700 text-slate-300"},df="inline-flex items-center justify-center px-2 py-1 rounded text-xs font-medium w-12 text-center",uf="inline-flex items-center justify-center px-2 py-1 rounded text-xs font-medium w-20 text-center",mf="inline-flex items-center justify-center px-2 py-1 rounded text-xs font-medium w-14 text-center",hf={"5v5":"bg-emerald-900/50 text-emerald-200 border border-emerald-600","7v7":"bg-blue-900/50 text-blue-200 border border-blue-600",default:"bg-slate-700 text-slate-200 border border-slate-600"};function pf(e){let{baseClasses:t=df}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=lf[e]||lf.default;return"".concat(t," ").concat(a).trim()}function ff(e){let{baseClasses:t=uf}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a="string"===typeof e?e.toLowerCase():e,n=cf[a]||cf.default;return"".concat(t," ").concat(n).trim()}function gf(e){let{baseClasses:t=mf}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a="string"===typeof e?e.toLowerCase():e,n=hf[a]||hf.default;return"".concat(t," ").concat(n).trim()}function vf(t){let{matches:a=[],typeFilter:n,outcomeFilter:r,venueFilter:s,opponentFilter:i,playerFilter:o,formatFilter:l,showPlayerFilter:c=!0,onTypeFilterChange:d,onOutcomeFilterChange:u,onVenueFilterChange:m,onOpponentFilterChange:h,onPlayerFilterChange:p,onFormatFilterChange:f,onClearAllFilters:g}=t;const{t:v}=xe("statistics"),y=(0,e.useMemo)(()=>(0,Ol.getMatchTypeOptions)(v).map(e=>{let{value:t,label:a}=e;return{value:t,label:a}}),[v]),b=(0,e.useMemo)(()=>[{value:"W",label:v("filters.outcomes.win")},{value:"D",label:v("filters.outcomes.draw")},{value:"L",label:v("filters.outcomes.loss")}],[v]),x=(0,e.useMemo)(()=>[{value:"home",label:v("filters.venues.home")},{value:"away",label:v("filters.venues.away")},{value:"neutral",label:v("filters.venues.neutral")}],[v]),w=(0,e.useCallback)(()=>"undefined"!==typeof window&&window.innerWidth<dm,[]),[S,k]=(0,e.useState)(()=>w()),[N,j]=(0,e.useState)(()=>w());(0,e.useEffect)(()=>{const e=()=>{const e=w();k(t=>(t!==e&&j(a=>!(!e||t)||!!e&&a),e))};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[w]);const T=(0,e.useMemo)(()=>{const e=[...new Set(a.map(e=>e.opponent).filter(Boolean))].sort((e,t)=>e.localeCompare(t));return e.map(e=>({value:e,label:e}))},[a]),A=(0,e.useMemo)(()=>[...new Set(a.flatMap(e=>e.players||[]).filter(Boolean))].sort().map(e=>({value:e,label:e})),[a]),_=(0,e.useMemo)(()=>[...new Set(a.map(e=>e.format).filter(Boolean))].sort().map(e=>({value:e,label:e})),[a]),C=_.length>1,M=(0,e.useMemo)(()=>c?C?"lg:grid-cols-6":"lg:grid-cols-5":C?"lg:grid-cols-5":"lg:grid-cols-4",[c,C]);return(0,Ts.jsxs)(Xc,{children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>j(!N),children:[(0,Ts.jsx)(Jd,{title:v("filters.title"),icon:Qu}),S&&(0,Ts.jsx)("button",{className:"text-sky-400 hover:text-sky-300 transition-colors",children:N?(0,Ts.jsx)(jc,{className:"h-5 w-5"}):(0,Ts.jsx)($u,{className:"h-5 w-5"})})]}),(0,Ts.jsx)(Lc,{onClick:g,Icon:rp,variant:"ghost",size:"sm",className:"text-sky-400 hover:text-sky-300",children:v("filters.clearAll")})]}),(0,Ts.jsx)("div",{className:"".concat(S?N?"hidden":"block mt-4":"mt-4"),children:(0,Ts.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 ".concat(M),children:[(0,Ts.jsxs)("div",{className:"flex flex-col",children:[(0,Ts.jsx)("label",{className:"text-slate-300 text-sm mb-2",children:v("filters.type")}),(0,Ts.jsx)(Fc,{value:n,onChange:d,options:y,placeholder:v("filters.all")})]}),(0,Ts.jsxs)("div",{className:"flex flex-col",children:[(0,Ts.jsx)("label",{className:"text-slate-300 text-sm mb-2",children:v("filters.outcome")}),(0,Ts.jsx)(Fc,{value:r,onChange:u,options:b,placeholder:v("filters.all")})]}),(0,Ts.jsxs)("div",{className:"flex flex-col",children:[(0,Ts.jsx)("label",{className:"text-slate-300 text-sm mb-2",children:v("filters.venue")}),(0,Ts.jsx)(Fc,{value:s,onChange:m,options:x,placeholder:v("filters.all")})]}),(0,Ts.jsxs)("div",{className:"flex flex-col",children:[(0,Ts.jsx)("label",{className:"text-slate-300 text-sm mb-2",children:v("filters.opponent")}),(0,Ts.jsx)(Fc,{value:i,onChange:h,options:T,placeholder:v("filters.all")})]}),c&&(0,Ts.jsxs)("div",{className:"flex flex-col",children:[(0,Ts.jsx)("label",{className:"text-slate-300 text-sm mb-2",children:v("filters.withPlayer")}),(0,Ts.jsx)(Fc,{value:o,onChange:p,options:A,placeholder:v("filters.all")})]}),C&&(0,Ts.jsxs)("div",{className:"flex flex-col",children:[(0,Ts.jsx)("label",{className:"text-slate-300 text-sm mb-2",children:v("filters.format")}),(0,Ts.jsx)(Fc,{value:l,onChange:f,options:_,placeholder:v("filters.all")})]})]})})]})}function yf(){const t=(0,e.useMemo)(()=>Bs(Br.STATS_FILTERS,{typeFilter:[],outcomeFilter:[],venueFilter:[],opponentFilter:[],playerFilter:[],formatFilter:[]}),[]),[a,r]=(0,e.useState)(()=>(e=>{const t=e&&"object"===typeof e?e:{};return{typeFilter:Array.isArray(t.typeFilter)?t.typeFilter:[],outcomeFilter:Array.isArray(t.outcomeFilter)?t.outcomeFilter:[],venueFilter:Array.isArray(t.venueFilter)?t.venueFilter:[],opponentFilter:Array.isArray(t.opponentFilter)?t.opponentFilter:[],playerFilter:Array.isArray(t.playerFilter)?t.playerFilter:[],formatFilter:Array.isArray(t.formatFilter)?t.formatFilter:[]}})(t.loadState()));(0,e.useEffect)(()=>{t.saveState(a)},[a,t]);const s=(0,e.useCallback)((e,t)=>{r(a=>{const r=Array.isArray(t)?t:[];if(a[e]===r)return a;return(0,n.A)((0,n.A)({},a),{},{[e]:r})})},[]),i=(0,e.useCallback)(()=>{r(()=>({typeFilter:[],outcomeFilter:[],venueFilter:[],opponentFilter:[],playerFilter:[],formatFilter:[]}))},[]);return{typeFilter:a.typeFilter,outcomeFilter:a.outcomeFilter,venueFilter:a.venueFilter,opponentFilter:a.opponentFilter,playerFilter:a.playerFilter,formatFilter:a.formatFilter,setTypeFilter:(0,e.useCallback)(e=>s("typeFilter",e),[s]),setOutcomeFilter:(0,e.useCallback)(e=>s("outcomeFilter",e),[s]),setVenueFilter:(0,e.useCallback)(e=>s("venueFilter",e),[s]),setOpponentFilter:(0,e.useCallback)(e=>s("opponentFilter",e),[s]),setPlayerFilter:(0,e.useCallback)(e=>s("playerFilter",e),[s]),setFormatFilter:(0,e.useCallback)(e=>s("formatFilter",e),[s]),clearFilters:i}}function bf(e){let{message:t}=e;const{t:a}=xe("statistics"),n=t||a("loading");return(0,Ts.jsx)("div",{className:"space-y-6",children:(0,Ts.jsx)(Xc,{padding:"lg",className:"text-center",children:(0,Ts.jsx)(Wd,{size:"md",message:n})})})}function xf(e){let{title:t,message:a}=e;return(0,Ts.jsx)("div",{className:"space-y-6",children:(0,Ts.jsx)(Jc,{variant:"error",children:(0,Ts.jsxs)("div",{className:"text-center",children:[(0,Ts.jsx)("div",{className:"mb-2 font-medium",children:t}),(0,Ts.jsx)("div",{className:"text-sm opacity-80",children:a})]})})})}function wf(e){return(0,Ts.jsx)("div",{className:"space-y-6",children:(0,Ts.jsx)(Yd,(0,n.A)({},e))})}function Sf(t){let{startDate:a,endDate:n,onMatchSelect:r}=t;const{t:s}=xe("statistics"),{currentTeam:i}=vi(),[o,l]=(0,e.useState)([]),[c,d]=(0,e.useState)(!1),[u,m]=(0,e.useState)(null),{typeFilter:h,outcomeFilter:p,venueFilter:f,opponentFilter:g,playerFilter:v,formatFilter:y,setTypeFilter:b,setOutcomeFilter:x,setVenueFilter:w,setOpponentFilter:S,setPlayerFilter:k,setFormatFilter:N,clearFilters:j}=yf();(0,e.useEffect)(()=>{!async function(){if(null===i||void 0===i||!i.id)return void l([]);d(!0),m(null);const e=await $o(i.id,a,n);e.success?l(e.matches||[]):(m(e.error||s("teamStats.failedToLoadMatchData")),l([])),d(!1)}()},[null===i||void 0===i?void 0:i.id,a,n,s]);const T=j,A=(0,e.useMemo)(()=>xo(o,{typeFilter:h,outcomeFilter:p,venueFilter:f,opponentFilter:g,playerFilter:v,formatFilter:y,startDate:a,endDate:n}),[o,h,p,f,g,v,y,a,n]),_=(0,e.useMemo)(()=>{if(0===A.length)return null;const e=A.length,t=A.filter(e=>"W"===e.outcome).length,a=A.filter(e=>"D"===e.outcome).length,n=A.filter(e=>"L"===e.outcome).length,r=A.reduce((e,t)=>e+t.goalsScored,0),s=A.reduce((e,t)=>e+t.goalsConceded,0),i=(r/e).toFixed(1),o=(s/e).toFixed(1),l=A.filter(e=>0===e.goalsConceded).length,c=e>0?(l/e*100).toFixed(1):"0.0",d=A.filter(e=>"home"===e.venueType),u=A.filter(e=>"away"===e.venueType);return{totalMatches:e,wins:t,draws:a,losses:n,goalsScored:r,goalsConceded:s,averageGoalsScored:i,averageGoalsConceded:o,cleanSheets:l,cleanSheetPercentage:c,homeRecord:{total:d.length,wins:d.filter(e=>"W"===e.outcome).length,draws:d.filter(e=>"D"===e.outcome).length,losses:d.filter(e=>"L"===e.outcome).length},awayRecord:{total:u.length,wins:u.filter(e=>"W"===e.outcome).length,draws:u.filter(e=>"D"===e.outcome).length,losses:u.filter(e=>"L"===e.outcome).length},recentMatches:A.slice(0,5).map(e=>({id:e.id,date:new Date(e.date).toISOString().split("T")[0],opponent:e.opponent,score:"".concat(e.goalsScored,"-").concat(e.goalsConceded),result:e.outcome}))}},[A]);if(c)return(0,Ts.jsx)(bf,{message:s("teamStats.loading")});if(u)return(0,Ts.jsx)(xf,{title:s("teamStats.error"),message:u});if(!c&&0===o.length)return(0,Ts.jsx)(wf,{title:s("teamStats.noStats")});if(!c&&!_&&o.length>0)return(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsx)(vf,{matches:o,typeFilter:h,outcomeFilter:p,venueFilter:f,opponentFilter:g,playerFilter:v,formatFilter:y,onTypeFilterChange:b,onOutcomeFilterChange:x,onVenueFilterChange:w,onOpponentFilterChange:S,onPlayerFilterChange:k,onFormatFilterChange:N,onClearAllFilters:T}),(0,Ts.jsx)(wf,{title:s("teamStats.noMatchesFiltered"),message:s("teamStats.adjustFilters")})]});const{totalMatches:C,wins:M,draws:P,losses:E,goalsScored:I,goalsConceded:R,averageGoalsScored:O,averageGoalsConceded:D,cleanSheets:F,cleanSheetPercentage:L,homeRecord:q,awayRecord:U,recentMatches:B}=_,G=e=>C>0?(e/C*100).toFixed(1):"0.0",z=G(M),V=I-R,H=[{label:s("teamStats.labels.matchesWon"),count:M},{label:s("teamStats.labels.matchesDrawn"),count:P},{label:s("teamStats.labels.matchesLost"),count:E}],K=e=>{let{icon:t,title:a,value:n,subtitle:r,trend:s}=e;return(0,Ts.jsx)(Xc,{children:(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ts.jsx)("div",{className:"p-2 rounded-lg",children:(0,Ts.jsx)(t,{className:"h-5 w-5 text-sky-400"})}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("p",{className:"text-slate-400 text-sm",children:a}),(0,Ts.jsx)("p",{className:"text-slate-100 text-xl font-semibold","aria-label":"".concat(a," value"),children:n}),r&&(0,Ts.jsx)("p",{className:"text-slate-400 text-xs",children:r})]})]}),s&&(0,Ts.jsxs)("div",{className:"flex items-center text-sm ".concat(s>0?"text-emerald-400":s<0?"text-rose-400":"text-slate-400"),children:[s>0?(0,Ts.jsx)(rf,{className:"h-4 w-4 mr-1"}):s<0?(0,Ts.jsx)(sf,{className:"h-4 w-4 mr-1"}):null,0!==s&&"".concat(Math.abs(s),"%")]})]})})};return(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsx)(vf,{matches:o,typeFilter:h,outcomeFilter:p,venueFilter:f,opponentFilter:g,playerFilter:v,formatFilter:y,onTypeFilterChange:b,onOutcomeFilterChange:x,onVenueFilterChange:w,onOpponentFilterChange:S,onPlayerFilterChange:k,onFormatFilterChange:N,onClearAllFilters:T}),(0,Ts.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,Ts.jsx)(K,{icon:Id,title:s("teamStats.totalMatches"),value:C,subtitle:s("teamStats.summaryRecord",{wins:M,draws:P,losses:E})}),(0,Ts.jsx)(K,{icon:jd,title:s("teamStats.winRate"),value:"".concat(z,"%"),subtitle:"".concat(M," ").concat(s("teamStats.victories"))}),(0,Ts.jsx)(K,{icon:rf,title:s("teamStats.avgGoalsScored"),value:O,subtitle:"".concat(I," ").concat(s("teamStats.totalGoals"))}),(0,Ts.jsx)(K,{icon:sf,title:s("teamStats.avgGoalsConceded"),value:D,subtitle:"".concat(R," ").concat(s("teamStats.totalGoals"))})]}),(0,Ts.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,Ts.jsxs)(Xc,{children:[(0,Ts.jsx)(Jd,{title:s("teamStats.sections.goals"),icon:wd,className:"mb-4"}),(0,Ts.jsxs)("div",{className:"space-y-3",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("span",{className:"text-slate-300",children:s("teamStats.labels.goalsScored")}),(0,Ts.jsx)("span",{className:"text-slate-100 font-semibold",children:I})]}),(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("span",{className:"text-slate-300",children:s("teamStats.labels.goalsConceded")}),(0,Ts.jsx)("span",{className:"text-slate-100 font-semibold",children:R})]}),(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("span",{className:"text-slate-300 font-medium",children:s("teamStats.labels.goalDifference")}),(0,Ts.jsxs)("span",{className:"font-bold ".concat(V>0?"text-emerald-400":V<0?"text-rose-400":"text-slate-400"),children:[V>0?"+":"",V]})]})]})]}),(0,Ts.jsxs)(Xc,{children:[(0,Ts.jsx)(Jd,{title:s("teamStats.sections.matchOutcomes"),icon:of,className:"mb-4"}),(0,Ts.jsx)("div",{className:"space-y-3",children:H.map(e=>{let{label:t,count:a}=e;return(0,Ts.jsxs)("div",{className:"grid grid-cols-[1fr_auto_auto] items-center gap-3",children:[(0,Ts.jsx)("span",{className:"text-slate-300",children:t}),(0,Ts.jsx)("span",{className:"text-slate-100 font-semibold text-right tabular-nums min-w-[2.5rem]",children:a}),(0,Ts.jsxs)("span",{className:"text-slate-400 text-sm text-right tabular-nums min-w-[3.5rem]",children:["(",G(a),"%)"]})]},t)})})]})]}),(0,Ts.jsxs)(Xc,{children:[(0,Ts.jsx)(Jd,{title:s("teamStats.sections.recentMatches"),icon:Sd,className:"mb-4"}),(0,Ts.jsx)("div",{className:"space-y-3",children:B.map(e=>{return(0,Ts.jsx)("div",{className:"bg-slate-800 p-3 rounded-lg border border-slate-600 ".concat(r?"hover:bg-slate-750 transition-colors cursor-pointer":""),onClick:r?()=>r(e.id):void 0,children:(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Ts.jsx)("div",{className:"text-slate-400 text-sm font-mono",children:e.date}),(0,Ts.jsx)("div",{className:"text-slate-200 font-medium",children:e.opponent})]}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ts.jsx)("div",{className:"text-slate-100 font-mono font-semibold",children:e.score}),(0,Ts.jsx)("span",{className:(t=e.result,pf(t,{baseClasses:"px-2 py-1 rounded text-xs font-medium w-12 text-center"})),children:"W"===e.result?s("teamStats.outcomes.win"):"D"===e.result?s("teamStats.outcomes.draw"):s("teamStats.outcomes.loss")})]})]})},e.id);var t})})]}),(0,Ts.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Ts.jsxs)(Xc,{children:[(0,Ts.jsx)("h4",{className:"text-slate-300 font-medium mb-2",children:s("teamStats.sections.homeRecord")}),(0,Ts.jsxs)("div",{className:"text-slate-100",children:[(0,Ts.jsx)("span",{className:"text-xl font-semibold",children:q.wins}),(0,Ts.jsx)("span",{className:"text-slate-400 text-sm ml-1",children:s("teamStats.record.wins")})]}),(0,Ts.jsxs)("div",{className:"text-slate-400 text-sm",children:[q.draws," ",s("teamStats.record.draws"),", ",q.losses," ",1===q.losses?s("teamStats.record.loss"):s("teamStats.record.losses"),q.total>0&&" (".concat(q.total," ").concat(s("teamStats.labels.total"),")")]})]}),(0,Ts.jsxs)(Xc,{children:[(0,Ts.jsx)("h4",{className:"text-slate-300 font-medium mb-2",children:s("teamStats.sections.awayRecord")}),(0,Ts.jsxs)("div",{className:"text-slate-100",children:[(0,Ts.jsx)("span",{className:"text-xl font-semibold",children:U.wins}),(0,Ts.jsx)("span",{className:"text-slate-400 text-sm ml-1",children:s("teamStats.record.wins")})]}),(0,Ts.jsxs)("div",{className:"text-slate-400 text-sm",children:[U.draws," ",s("teamStats.record.draws"),", ",U.losses," ",1===U.losses?s("teamStats.record.loss"):s("teamStats.record.losses"),U.total>0&&" (".concat(U.total," ").concat(s("teamStats.labels.total"),")")]})]}),(0,Ts.jsxs)(Xc,{children:[(0,Ts.jsx)("h4",{className:"text-slate-300 font-medium mb-2",children:s("teamStats.sections.cleanSheets")}),(0,Ts.jsxs)("div",{className:"text-slate-100",children:[(0,Ts.jsx)("span",{className:"text-xl font-semibold",children:F}),(0,Ts.jsx)("span",{className:"text-slate-400 text-sm ml-1",children:s("teamStats.labels.matches")})]}),(0,Ts.jsxs)("div",{className:"text-slate-400 text-sm",children:[L,"% ",s("teamStats.labels.ofTotal")]})]})]})]})}const kf=fc("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);function Nf(t,a){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"asc",r=arguments.length>3?arguments[3]:void 0;const[s,i]=(0,e.useState)(a),[o,l]=(0,e.useState)(n),c=(0,e.useMemo)(()=>{if(!t||0===t.length)return[];const e=[...t].sort((e,t)=>{let a=e[s],n=t[s];if(null==a&&null==n)return 0;if(null==a)return"asc"===o?-1:1;if(null==n)return"asc"===o?1:-1;if("string"===typeof a&&"string"===typeof n){const e=a.localeCompare(n);return"asc"===o?e:-e}const r=a-n;return"asc"===o?r:-r});return e},[t,s,o]),d=(0,e.useCallback)(e=>{r&&r()||(s===e?l("asc"===o?"desc":"asc"):(i(e),l("desc")))},[s,o,r]),u=(0,e.useCallback)(e=>s!==e?null:"asc"===o?(0,Ts.jsx)($u,{className:"h-4 w-4 inline-block ml-1"}):(0,Ts.jsx)(jc,{className:"h-4 w-4 inline-block ml-1"}),[s,o]);return{sortedData:c,sortBy:s,sortOrder:o,handleSort:d,renderSortIndicator:u,setSortBy:i,setSortOrder:l}}const jf=12;function Tf(t,a){const n=(0,e.useMemo)(()=>t.map(e=>e.key),[t]),r=(0,e.useMemo)(()=>"undefined"===typeof window?null:new qs(a,{order:n}),[a,n]),s=(0,e.useMemo)(()=>{if(!r)return null;const e=r.loadState();return Array.isArray(null===e||void 0===e?void 0:e.order)?e.order:null},[r]),i=function(t,a){const n="function"===typeof a?{onReorder:a}:a||{},{onReorder:r,initialOrder:s}=n,i=(0,e.useMemo)(()=>t.map(e=>e.key),[t]),o=(0,e.useCallback)(e=>{if(!Array.isArray(e)||0===e.length)return[...i];const t=e.filter(e=>i.includes(e)),a=i.filter(e=>!t.includes(e));return[...t,...a]},[i]),[l,c]=(0,e.useState)(()=>o(s)),[d,u]=(0,e.useState)(null),[m,h]=(0,e.useState)(null),[p,f]=(0,e.useState)(null),[g,v]=(0,e.useState)(!1),y=(0,e.useRef)(null),b=(0,e.useRef)(null),x=(0,e.useRef)(null),w=(0,e.useRef)(null),S=(0,e.useRef)(null),k=(0,e.useRef)(null),N=(0,e.useRef)(null),j=(0,e.useRef)(null),T=(0,e.useRef)(null),A=(0,e.useRef)({x:0,y:0}),_=(0,e.useRef)(null);(0,e.useEffect)(()=>{c(e=>o(e))},[o]),(0,e.useEffect)(()=>{if(!s)return;const e=o(s);c(t=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.length===t.length&&e.every((e,a)=>e===t[a])}(t,e)?t:e)},[s,o]),(0,e.useEffect)(()=>{b.current=d},[d]),(0,e.useEffect)(()=>{x.current=m},[m]),(0,e.useEffect)(()=>{w.current=p},[p]);const C=(0,e.useMemo)(()=>{const e=new Map(t.map(e=>[e.key,e]));return l.map(t=>e.get(t)).filter(Boolean)},[t,l]),M=(0,e.useCallback)(()=>{T.current&&(T.current.remove(),T.current=null)},[]),P=(0,e.useCallback)((e,t)=>{const a=T.current;if(!a)return;const n=e-A.current.x,r=t-A.current.y;a.style.transform="translate(".concat(n,"px, ").concat(r,"px)")},[]),E=(0,e.useCallback)((e,t,a,n)=>{if(M(),!e)return;const r=e.getBoundingClientRect();A.current={x:Math.min(Math.max(a-r.left,0),r.width),y:Math.min(Math.max(n-r.top,0),r.height)};const s=document.createElement("div");s.textContent=t,s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.pointerEvents="none",s.style.zIndex="9999",s.style.padding="0.5rem 0.75rem",s.style.borderRadius="0.5rem",s.style.border="1px solid rgba(56, 189, 248, 0.6)",s.style.background="rgba(15, 23, 42, 0.95)",s.style.color="rgb(224, 242, 254)",s.style.fontSize="0.75rem",s.style.fontWeight="600",s.style.letterSpacing="0.08em",s.style.textTransform="uppercase",s.style.boxShadow="0 10px 25px rgba(14, 165, 233, 0.35)",s.style.opacity="0.95",s.style.minWidth="".concat(Math.max(r.width,60),"px"),s.style.textAlign="center",s.style.transition="transform 0.08s ease-out",document.body.appendChild(s),T.current=s,P(a,n)},[M,P]),I=(0,e.useCallback)(()=>{u(null),h(null),f(null),v(!1),b.current=null,x.current=null,w.current=null,_.current=null},[]),R=(0,e.useCallback)(()=>{S.current&&(window.removeEventListener("pointermove",S.current),S.current=null),k.current&&(window.removeEventListener("pointerup",k.current),k.current=null),N.current&&(window.removeEventListener("pointercancel",N.current),N.current=null),y.current=null,b.current=null,x.current=null,w.current=null,M(),_.current=null},[M]),O=(0,e.useCallback)(e=>{const t=_.current;return!(!t||t.started)&&(t.started=!0,u(t.columnKey),v(!0),h(null),x.current=null,f(null),w.current=null,b.current=t.columnKey,e.cancelable&&e.preventDefault(),E(t.headerElement,t.columnLabel,e.clientX,e.clientY),!0)},[E]),D=(0,e.useCallback)((e,t,a)=>{const n=w.current;let r=0;(null===n||void 0===n?void 0:n.columnKey)===t&&(r="before"===n.position?jf:"after"===n.position?-12:0);const s=(a.left-r+(a.right-r))/2,i=Math.min(.2*a.width,18);return e<=s-i?"before":e>=s+i?"after":(null===n||void 0===n?void 0:n.columnKey)===t?n.position:e<s?"before":"after"},[]),F=(0,e.useCallback)(e=>{const t=j.current;if(!t)return null;const a=Array.from(t.querySelectorAll("th[data-column-key]"));if(0===a.length)return null;const n=a.map(t=>{const a=t.getBoundingClientRect();return e>=a.left&&e<=a.right?{columnKey:t.dataset.columnKey,rect:a}:null}).filter(Boolean),r=n.length?n[n.length-1]:null;if(!r)return null;const s=D(e,r.columnKey,r.rect);return{columnKey:r.columnKey,position:s}},[D]),L=(0,e.useCallback)(function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"before";e&&t&&e!==t?(c(n=>{const s=n.filter(t=>t!==e),i=s.indexOf(t);if(-1===i)return n;const l="after"===a?i+1:i;if(0===l)return n;const c=[...s];c.splice(l,0,e);const d=o(c);return r&&r(d),d}),I()):I()},[o,r,I]);(0,e.useEffect)(()=>()=>{R()},[R]);const q=(0,e.useCallback)((e,t)=>{if("mouse"===e.pointerType&&0!==e.button)return;if(0===C.findIndex(e=>e.key===t))return;R(),y.current=e.pointerId;const a=C.find(e=>e.key===t);_.current={started:!1,columnKey:t,columnLabel:(null===a||void 0===a?void 0:a.label)||t,headerElement:e.currentTarget,pointerType:e.pointerType,startClientX:e.clientX,startClientY:e.clientY};const n=e=>{var t,a;if(e.pointerId!==y.current)return;const n=_.current;if(!n)return;if(!n.started){if("mouse"===n.pointerType){const t=Math.abs(e.clientX-n.startClientX),a=Math.abs(e.clientY-n.startClientY);if(Math.max(t,a)<6)return}if(!O(e))return}e.cancelable&&e.preventDefault(),P(e.clientX,e.clientY);const r=F(e.clientX);if(!r||r.columnKey===b.current)return null!==x.current&&(x.current=null,h(null)),w.current=null,void f(null);const{columnKey:s,position:i}=r;x.current!==s&&(x.current=s,h(s)),(null===(t=w.current)||void 0===t?void 0:t.columnKey)===s&&(null===(a=w.current)||void 0===a?void 0:a.position)===i||(w.current={columnKey:s,position:i},f({columnKey:s,position:i}))},r=e=>{if(e.pointerId!==y.current)return;const t=_.current;if(null===t||void 0===t||!t.started)return void R();e.cancelable&&e.preventDefault(),P(e.clientX,e.clientY);const a=F(e.clientX),n=w.current,r=a||n,s=(null===r||void 0===r?void 0:r.columnKey)||x.current||b.current,i=(null===r||void 0===r?void 0:r.position)||(null===n||void 0===n?void 0:n.position)||"before";L(b.current,s,i),R()},s=e=>{if(e.pointerId!==y.current)return;const t=_.current;null!==t&&void 0!==t&&t.started&&I(),R()};S.current=n,k.current=r,N.current=s,window.addEventListener("pointermove",n,{passive:!1}),window.addEventListener("pointerup",r,{passive:!1}),window.addEventListener("pointercancel",s,{passive:!1}),"mouse"!==e.pointerType&&O(e)},[R,C,F,L,O,P,I]);return{headerRowRef:j,orderedColumns:C,columnOrder:l,draggingColumn:d,dragOverColumn:m,dropIndicator:p,isReordering:g,handlePointerDown:q}}(t,{initialOrder:s});return(0,e.useEffect)(()=>{r&&i.columnOrder&&r.saveState({order:i.columnOrder})},[r,i.columnOrder]),i}function Af(e){let{icon:t,title:a,value:n,subtitle:r}=e;return(0,Ts.jsx)(Xc,{children:(0,Ts.jsx)("div",{className:"flex items-center justify-between",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ts.jsx)("div",{className:"p-2 rounded-lg",children:(0,Ts.jsx)(t,{className:"h-5 w-5 text-sky-400"})}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("p",{className:"text-slate-400 text-sm",children:a}),(0,Ts.jsx)("p",{className:"text-slate-100 text-xl font-semibold",children:n}),r&&(0,Ts.jsx)("p",{className:"text-slate-400 text-xs",children:r})]})]})})})}function _f(e){let{data:t,orderedColumns:a,sortBy:n,dragDropHandlers:r,onSort:s,renderSortIndicator:i,headerIcon:o,headerTitle:l,headerSubtitle:c,idKey:d="id"}=e;const{headerRowRef:u,draggingColumn:m,dragOverColumn:h,dropIndicator:p,handlePointerDown:f}=r;return(0,Ts.jsxs)(Xc,{padding:"sm",className:"overflow-hidden",children:[(0,Ts.jsxs)("div",{className:"p-4 border-b border-slate-600",children:[(0,Ts.jsxs)("h3",{className:"text-lg font-semibold text-sky-400 flex items-center space-x-2",children:[(0,Ts.jsx)(o,{className:"h-5 w-5"}),(0,Ts.jsx)("span",{children:l})]}),c&&(0,Ts.jsx)("p",{className:"text-slate-400 text-sm mt-1",children:c})]}),(0,Ts.jsx)("div",{className:"overflow-x-auto",children:(0,Ts.jsxs)("table",{className:"min-w-full",children:[(0,Ts.jsx)("thead",{className:"bg-slate-800",children:(0,Ts.jsx)("tr",{ref:u,children:a.map((e,t)=>{const a=(null===p||void 0===p?void 0:p.columnKey)===e.key?p.position:null,r={transform:"before"===a?"translateX(".concat(jf,"px)"):"after"===a?"translateX(-".concat(jf,"px)"):void 0,transition:"transform 0.15s ease, box-shadow 0.15s ease",boxShadow:a&&m!==e.key?"0 0 0 2px rgba(56, 189, 248, 0.3)":void 0},o=0===t;return(0,Ts.jsx)("th",{scope:"col","data-column-key":e.key,className:"relative px-3 py-2 text-xs font-medium text-sky-200 tracking-wider select-none touch-none ".concat(e.className||""," ").concat(o?"sticky left-0 z-10 bg-slate-800":""," ").concat(e.sortable&&!o?"cursor-grab active:cursor-grabbing hover:bg-slate-700 transition-colors":""," ").concat(e.sortable&&o?"cursor-pointer hover:bg-slate-700 transition-colors":""," ").concat(n===e.key?"bg-slate-700":""," ").concat(m===e.key?"opacity-60":""," ").concat(h===e.key&&m!==e.key?"ring-1 ring-sky-400 ring-inset":""),style:r,onClick:e.sortable?()=>s(e.key):void 0,onPointerDown:t=>f(t,e.key),children:(0,Ts.jsxs)("div",{className:"relative flex w-full items-center justify-center gap-1",children:[a&&m!==e.key&&(0,Ts.jsx)("span",{className:"pointer-events-none absolute top-1/2 h-8 w-1 rounded-full bg-sky-400/80 -translate-y-1/2",style:{left:"before"===a?"-0.4rem":void 0,right:"after"===a?"-0.4rem":void 0,boxShadow:"0 0 12px rgba(56, 189, 248, 0.6)"},"aria-hidden":"true"}),(0,Ts.jsx)("span",{children:e.label}),e.sortable&&i(e.key)]})},e.key)})})}),(0,Ts.jsx)("tbody",{className:"divide-y divide-slate-600",children:t.map((e,t)=>(0,Ts.jsx)("tr",{className:"".concat(t%2===0?"bg-slate-700":"bg-slate-800"," hover:bg-slate-600 transition-colors"),children:a.map((a,n)=>{const r=(null===p||void 0===p?void 0:p.columnKey)===a.key?p.position:null,s={transform:"before"===r?"translateX(".concat(jf,"px)"):"after"===r?"translateX(-".concat(jf,"px)"):void 0,transition:"transform 0.15s ease"},i=0===n,o=i?t%2===0?"bg-slate-700":"bg-slate-800":"";return(0,Ts.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm ".concat(a.className," ").concat(i?"sticky left-0 z-10":""," ").concat(o),style:s,children:a.render(e)},a.key)})},e[d]))})]})})]})}const Cf="displayName",Mf="matchesPlayed",Pf="goalsScored",Ef="averageTimePerMatch",If="totalFieldTimeSeconds",Rf="percentStartedAsSubstitute",Of="percentTimeAsDefender",Df="percentTimeAsMidfielder",Ff="percentTimeAsAttacker",Lf="percentTimeAsGoalkeeper",qf="matchesAsCaptain",Uf="fairPlayAwards",Bf="loanMatches";function Gf(t){let{startDate:a,endDate:r}=t;const{t:s}=xe("statistics"),{currentTeam:i,loadTeamPreferences:o}=vi(),[l,c]=(0,e.useState)([]),[d,u]=(0,e.useState)([]),[m,h]=(0,e.useState)(!1),[p,f]=(0,e.useState)(!1),[g,v]=(0,e.useState)(null),[y,b]=(0,e.useState)(null),[x,w]=(0,e.useState)(am()),[S,k]=(0,e.useState)(new Map),[N,j]=(0,e.useState)(null),{typeFilter:T,outcomeFilter:A,venueFilter:_,opponentFilter:C,playerFilter:M,formatFilter:P,setTypeFilter:E,setOutcomeFilter:I,setVenueFilter:R,setOpponentFilter:O,setPlayerFilter:D,setFormatFilter:F,clearFilters:L}=yf(),q=(0,e.useCallback)(e=>Number.isFinite(e)?e%1===0?e.toString():e.toFixed(1):"0",[]);(0,e.useEffect)(()=>{!async function(){if(null===i||void 0===i||!i.id)return u([]),b(null),void f(!1);f(!0),b(null);const e=await $o(i.id,a,r);e.success?u(e.matches||[]):(b(e.error||s("playerStats.failedToLoadMatches")),u([])),f(!1)}()},[null===i||void 0===i?void 0:i.id,a,r,s]),(0,e.useEffect)(()=>{!async function(){if(null===i||void 0===i||!i.id)return k(new Map),w(am()),void j(null);j(null);try{const[e,t]=await Promise.all([sm(i.id,{startDate:a,endDate:r}),o?o(i.id):Promise.resolve({})]);if(e.success){const t=new Map;(e.loans||[]).forEach(e=>{if(null===e||void 0===e||!e.player_id)return;const a=t.get(e.player_id)||[];a.push(e),t.set(e.player_id,a)}),k(t)}else k(new Map),j(e.error||s("playerStats.failedToLoadLoanMatches"));const n=null===t||void 0===t?void 0:t.loanMatchWeight,l="number"===typeof n?n:parseFloat(n);w(Number.isNaN(l)?am():l)}catch(e){console.error("Failed to load loan data:",e),k(new Map),j(s("playerStats.failedToLoadLoanMatches")),w(am())}}()},[null===i||void 0===i?void 0:i.id,a,r,o,s]),(0,e.useEffect)(()=>{!async function(){if(null===i||void 0===i||!i.id)return void c([]);h(!0),v(null);const e=await Zo(i.id,a,r,{typeFilter:T,outcomeFilter:A,venueFilter:_,opponentFilter:C,playerFilter:M,formatFilter:P});e.success?c(e.players||[]):(v(e.error||s("playerStats.errorDetails")),c([])),h(!1)}()},[null===i||void 0===i?void 0:i.id,a,r,T,A,_,C,M,P,s]);const U=(0,e.useMemo)(()=>{const e=Number.isFinite(x)?x:am(),t=new Map(l.map(e=>[e.id,e])),a=[];return S.forEach((e,n)=>{var r;if(t.has(n))return;const i=null===(r=e.find(e=>null===e||void 0===e?void 0:e.player))||void 0===r?void 0:r.player,o=(null===i||void 0===i?void 0:i.display_name)||(null===i||void 0===i?void 0:i.first_name)||s("playerStats.unnamedPlayer");a.push({id:n,displayName:o,matchesPlayed:0,goalsScored:0,totalFieldTimeSeconds:0,averageTimePerMatch:0,percentStartedAsSubstitute:0,percentTimeAsDefender:0,percentTimeAsMidfielder:0,percentTimeAsAttacker:0,percentTimeAsGoalkeeper:0,matchesAsCaptain:0,fairPlayAwards:0})}),[...l,...a].map(t=>{const a=(S.get(t.id)||[]).length,r=a*e,s=t.matchesPlayed+r;return(0,n.A)((0,n.A)({},t),{},{regularMatches:t.matchesPlayed,loanMatches:a,weightedLoanMatches:r,matchesPlayed:s,loanWeight:e})})},[l,S,x,s]),B=(0,e.useMemo)(()=>xo(d,{typeFilter:T,outcomeFilter:A,venueFilter:_,opponentFilter:C,playerFilter:M,formatFilter:P,startDate:a,endDate:r}),[d,T,A,_,C,M,P,a,r]),G=L,z=Tf((0,e.useMemo)(()=>[{key:Cf,label:s("playerStats.columns.player"),sortable:!0,className:"text-left font-medium",render:e=>(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(Xu,{className:"h-4 w-4 text-slate-400"}),(0,Ts.jsx)("span",{className:"text-slate-100",children:e.displayName})]})},{key:Mf,label:s("playerStats.columns.matches"),sortable:!0,className:"text-center",render:e=>(0,Ts.jsxs)("div",{className:"flex flex-col items-center",children:[(0,Ts.jsx)("span",{className:"text-slate-300 font-mono",children:q(e.matchesPlayed)}),e.loanMatches>0&&(0,Ts.jsxs)("span",{className:"text-xs text-slate-400",children:[e.regularMatches," + ",q(e.weightedLoanMatches)]})]})},{key:Bf,label:s("playerStats.columns.loanMatches"),sortable:!0,className:"text-center",render:e=>(0,Ts.jsx)("span",{className:"text-slate-300 font-mono",children:e.loanMatches>0?e.loanMatches:"-"})},{key:Pf,label:s("playerStats.columns.goals"),sortable:!0,className:"text-center",render:e=>(0,Ts.jsx)("span",{className:"text-slate-300 font-mono",children:e.goalsScored})},{key:Ef,label:s("playerStats.columns.avgTime"),sortable:!0,className:"text-center",render:e=>(0,Ts.jsx)("div",{className:"flex items-center justify-center space-x-1",children:(0,Ts.jsx)("span",{className:"text-slate-300 font-mono",children:Gl(e.averageTimePerMatch)})})},{key:If,label:s("playerStats.columns.outfieldTime"),sortable:!0,className:"text-center",render:e=>(0,Ts.jsx)("span",{className:"text-slate-300 font-mono",children:zl(e.totalFieldTimeSeconds)})},{key:Rf,label:s("playerStats.columns.startedAsSub"),sortable:!0,className:"text-center",render:e=>(0,Ts.jsxs)("span",{className:"text-slate-300 font-mono",children:[e.percentStartedAsSubstitute,"%"]})},{key:Of,label:s("playerStats.columns.defender"),sortable:!0,className:"text-center",render:e=>(0,Ts.jsxs)("span",{className:"text-slate-300 font-mono",children:[e.percentTimeAsDefender,"%"]})},{key:Df,label:s("playerStats.columns.midfielder"),sortable:!0,className:"text-center",render:e=>(0,Ts.jsxs)("span",{className:"text-slate-300 font-mono",children:[e.percentTimeAsMidfielder,"%"]})},{key:Ff,label:s("playerStats.columns.attacker"),sortable:!0,className:"text-center",render:e=>(0,Ts.jsxs)("span",{className:"text-slate-300 font-mono",children:[e.percentTimeAsAttacker,"%"]})},{key:Lf,label:s("playerStats.columns.goalkeeper"),sortable:!0,className:"text-center",render:e=>(0,Ts.jsxs)("span",{className:"text-slate-300 font-mono",children:[e.percentTimeAsGoalkeeper,"%"]})},{key:qf,label:s("playerStats.columns.captain"),sortable:!0,className:"text-center",render:e=>(0,Ts.jsx)("span",{className:"text-slate-300 font-mono",children:e.matchesAsCaptain})},{key:Uf,label:s("playerStats.columns.fairPlay"),sortable:!0,className:"text-center",render:e=>(0,Ts.jsx)("span",{className:"text-slate-300 font-mono",children:e.fairPlayAwards})}],[q,s]),Br.STATISTICS_PLAYER_COLUMN_ORDER),{sortedData:V,sortBy:H,handleSort:K,renderSortIndicator:W}=Nf(U,Cf,"asc",z.isReordering),Y=(0,e.useMemo)(()=>{if(0===U.length)return{totalPlayers:0,averageFieldTime:0,averageGoalsPerPlayer:0,totalGoals:0,topScorer:null};const e=U.length,t=U.reduce((e,t)=>e+t.averageTimePerMatch,0)/e,a=U.reduce((e,t)=>e+t.goalsScored,0);return{totalPlayers:e,averageFieldTime:t,averageGoalsPerPlayer:a/e,totalGoals:a,topScorer:U.reduce((e,t)=>t.goalsScored>e.goalsScored?t:e)}},[U]);if(m)return(0,Ts.jsx)(bf,{message:s("playerStats.loading")});if(g)return(0,Ts.jsx)(xf,{title:s("playerStats.error"),message:g});const J=V.length>0,Q=!p&&0===d.length&&0===S.size,$=!p&&d.length>0&&0===B.length&&0===S.size;return(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsx)(vf,{matches:d,typeFilter:T,outcomeFilter:A,venueFilter:_,opponentFilter:C,playerFilter:M,formatFilter:P,showPlayerFilter:!1,onTypeFilterChange:E,onOutcomeFilterChange:I,onVenueFilterChange:R,onOpponentFilterChange:O,onPlayerFilterChange:D,onFormatFilterChange:F,onClearAllFilters:G}),y&&(0,Ts.jsx)(Jc,{variant:"warning",children:y}),N&&(0,Ts.jsx)(Jc,{variant:"warning",children:N}),Q&&(0,Ts.jsx)(wf,{title:s("playerStats.noMatchesAvailable"),message:s("playerStats.addMatchesOrAdjust")}),!Q&&$&&(0,Ts.jsx)(wf,{title:s("playerStats.noMatchesFiltered"),message:s("playerStats.adjustFilters")}),!Q&&!$&&!J&&!p&&(0,Ts.jsx)(wf,{title:s("playerStats.noStatsRecorded")}),J&&(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,Ts.jsx)(Af,{icon:od,title:s("playerStats.totalPlayers"),value:Y.totalPlayers,subtitle:s("playerStats.activePlayers")}),(0,Ts.jsx)(Af,{icon:Sd,title:s("playerStats.avgPlayingTime"),value:Gl(Y.averageFieldTime),subtitle:s("playerStats.perMatch")}),(0,Ts.jsx)(Af,{icon:wd,title:s("playerStats.avgGoals"),value:Y.averageGoalsPerPlayer.toFixed(1),subtitle:"".concat(s("playerStats.totalGoalsLabel")," ").concat(Y.totalGoals)}),(0,Ts.jsx)(Af,{icon:kf,title:s("playerStats.topScorer"),value:Y.topScorer?Y.topScorer.displayName:"-",subtitle:Y.topScorer?"".concat(Y.topScorer.goalsScored," ").concat(s("playerStats.goals")):s("playerStats.noData")})]}),(0,Ts.jsx)(_f,{data:V,orderedColumns:z.orderedColumns,sortBy:H,dragDropHandlers:z,onSort:K,renderSortIndicator:W,headerIcon:od,headerTitle:s("playerStats.title"),headerSubtitle:s("playerStats.tableSubtitle",{weight:q(x)}),idKey:"id"})]})]})}const zf=fc("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);function Vf(t){let{onMatchSelect:a,onCreateMatch:n,startDate:r,endDate:s,refreshKey:i=0}=t;const{t:o}=xe("statistics"),{currentTeam:l}=vi(),[c,d]=(0,e.useState)([]),[u,m]=(0,e.useState)(!1),[h,p]=(0,e.useState)(null),{typeFilter:f,outcomeFilter:g,venueFilter:v,opponentFilter:y,playerFilter:b,formatFilter:x,setTypeFilter:w,setOutcomeFilter:S,setVenueFilter:k,setOpponentFilter:N,setPlayerFilter:j,setFormatFilter:T,clearFilters:A}=yf(),_=(0,e.useCallback)(()=>"undefined"!==typeof window&&window.innerWidth>=cm,[]),[C,M]=(0,e.useState)(()=>_());(0,e.useEffect)(()=>{!async function(){if(null===l||void 0===l||!l.id)return void d([]);m(!0),p(null);const e=await $o(l.id,r,s);e.success?d(e.matches||[]):(p(e.error||o("matchHistory.errorDetails")),d([])),m(!1)}()},[null===l||void 0===l?void 0:l.id,r,s,i,o]),(0,e.useEffect)(()=>{const e=()=>{M(_())};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[_]);const P=A,E=xo(c,{typeFilter:f,outcomeFilter:g,venueFilter:v,opponentFilter:y,playerFilter:b,formatFilter:x,startDate:r,endDate:s}),I=e=>"".concat(e.goalsScored,"-").concat(e.goalsConceded),R=e=>new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1});return u?(0,Ts.jsx)(bf,{message:o("matchHistory.loading")}):h?(0,Ts.jsx)(xf,{title:o("matchHistory.error"),message:h}):(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsx)(vf,{matches:c,typeFilter:f,outcomeFilter:g,venueFilter:v,opponentFilter:y,playerFilter:b,formatFilter:x,onTypeFilterChange:w,onOutcomeFilterChange:S,onVenueFilterChange:k,onOpponentFilterChange:N,onPlayerFilterChange:j,onFormatFilterChange:T,onClearAllFilters:P}),(0,Ts.jsxs)(Xc,{children:[(0,Ts.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between mb-4",children:[(0,Ts.jsx)(Jd,{title:o("matchHistory.title"),icon:kh}),n&&(0,Ts.jsx)(Lc,{onClick:n,Icon:Ju,size:"sm",children:o("matchHistory.addMatch")})]}),(0,Ts.jsx)("p",{className:"text-slate-400 text-sm mb-4",children:o("matchHistory.matchesFound",{count:E.length})}),(0,Ts.jsxs)("div",{className:"space-y-3",children:[E.map(e=>{return(0,Ts.jsx)("div",{className:"bg-slate-800 p-4 rounded-lg border border-slate-600 hover:bg-slate-750 transition-colors cursor-pointer",onClick:()=>a(e.id),children:(0,Ts.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,Ts.jsxs)("div",{className:"flex items-start gap-4 flex-1 min-w-0",children:[(0,Ts.jsxs)("div",{className:"flex items-center gap-2 text-slate-400 shrink-0",children:[(0,Ts.jsx)(Id,{className:"h-4 w-4"}),(0,Ts.jsxs)("div",{className:"text-sm",children:[(0,Ts.jsx)("div",{className:"font-mono",children:(t=e.date,new Date(t).toISOString().split("T")[0])}),(0,Ts.jsx)("div",{className:"font-mono text-xs opacity-75",children:R(e.date)})]})]}),(0,Ts.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,Ts.jsx)("div",{className:"text-slate-200 font-semibold text-lg truncate",children:e.opponent}),(0,Ts.jsxs)("div",{className:"flex items-center gap-3 mt-1",children:[C&&(0,Ts.jsxs)("div",{className:"flex items-center gap-1 text-slate-400",children:[(0,Ts.jsx)(zf,{className:"h-3 w-3"}),(0,Ts.jsx)("span",{className:"text-sm",children:"home"===e.venueType?o("matchHistory.venues.home"):"neutral"===e.venueType?o("matchHistory.venues.neutral"):o("matchHistory.venues.away")})]}),C&&(0,Ts.jsx)("span",{className:ff(e.type),children:e.type}),C&&e.format&&(0,Ts.jsx)("span",{className:gf(e.format),children:e.format})]})]})]}),(0,Ts.jsxs)("div",{className:"text-right shrink-0",children:[(0,Ts.jsx)("div",{className:"text-2xl font-mono font-bold text-slate-100 mb-1",children:I(e)}),C&&(0,Ts.jsx)("span",{className:pf(e.outcome),children:"W"===e.outcome?o("matchHistory.outcomes.win"):"D"===e.outcome?o("matchHistory.outcomes.draw"):o("matchHistory.outcomes.loss")})]})]})},e.id);var t}),0===E.length&&(0,Ts.jsxs)("div",{className:"p-8 text-center text-slate-400",children:[(0,Ts.jsx)(jd,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,Ts.jsx)("p",{children:o("matchHistory.noMatchesFiltered")}),(0,Ts.jsx)("p",{className:"text-sm mt-1",children:o("matchHistory.adjustFilters")})]})]})]})]})}const Hf=fc("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),Kf=fc("layers-2",[["path",{d:"M13 13.74a2 2 0 0 1-2 0L2.5 8.87a1 1 0 0 1 0-1.74L11 2.26a2 2 0 0 1 2 0l8.5 4.87a1 1 0 0 1 0 1.74z",key:"15q6uc"}],["path",{d:"m20 14.285 1.5.845a1 1 0 0 1 0 1.74L13 21.74a2 2 0 0 1-2 0l-8.5-4.87a1 1 0 0 1 0-1.74l1.5-.845",key:"byia6g"}]]),Wf=t=>{let{value:a,onChange:n,className:r=""}=t;const[s,i]=(0,e.useState)("");e.useEffect(()=>{const e=Math.round(60*(a||0));if(e>=3600){const t=Math.floor(e/3600),a=Math.floor(e%3600/60),n=e%60;i("".concat(t,":").concat(a.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0")))}else{const t=Math.floor(e/60),a=e%60;i("".concat(t.toString().padStart(2,"0"),":").concat(a.toString().padStart(2,"0")))}},[a]);return(0,Ts.jsx)(Rc,{type:"text",value:s,onChange:e=>i(e.target.value),onBlur:e=>{const t=(e=>{if(!e)return 0;if(!e.includes(":"))return parseInt(e,10)||0;const t=e.split(":");if(3===t.length){const[e,a,n]=t.map(e=>parseInt(e,10)||0);return 60*e+a+n/60}const[a,n]=t.map(e=>parseInt(e,10)||0);return a+n/60})(e.target.value.trim()),a=Math.round(60*t);let r;if(a>=3600){const e=Math.floor(a/3600),t=Math.floor(a%3600/60),n=a%60;r="".concat(e,":").concat(t.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"))}else{const e=Math.floor(a/60),t=a%60;r="".concat(e.toString().padStart(2,"0"),":").concat(t.toString().padStart(2,"0"))}i(r),n(t)},className:"w-20 text-center font-mono ".concat(r),placeholder:"0:00:00"})},Yf=e=>{if("number"===typeof e)return Number.isFinite(e)?Math.max(0,e):0;if("string"===typeof e){const t=e.trim();if(""===t)return 0;const a=parseInt(t,10);return Number.isNaN(a)?0:Math.max(0,a)}return 0},Jf=["Goalkeeper","Defender","Midfielder","Attacker","Substitute"],Qf=xi.FORMATS.FORMAT_5V5,$f=Jf[4],Xf=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(""===e||null===e||void 0===e)return t;const a=parseInt(e,10);return Number.isNaN(a)?t:Math.max(0,a)},Zf=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(""===e||null===e||void 0===e)return t;const a=parseFloat(e);return Number.isNaN(a)?t:Math.max(0,a)},eg=e=>(0,xi.getValidFormations)(e,15).map(e=>{var t;return{value:e,label:(null===(t=xi.FORMATION_DEFINITIONS[e])||void 0===t?void 0:t.label)||e}}),tg=e=>{const t=Math.round(60*e),a=Math.floor(t/3600),n=Math.floor(t%3600/60),r=t%60;return"".concat(a.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0"))},ag=e=>{const t=Math.round(60*e);if(t>=3600){const e=Math.floor(t/3600),a=Math.floor(t%3600/60),n=t%60;return"".concat(e,":").concat(a.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"))}{const e=Math.floor(t/60),a=t%60;return"".concat(e.toString().padStart(2,"0"),":").concat(a.toString().padStart(2,"0"))}},ng=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unnamed Player";return e&&(e.displayName||e.display_name||e.firstName||e.first_name)||t};function rg(t){let{matchId:a,onNavigateBack:r,mode:s="view",teamId:i,teamPlayers:o=[],onManualMatchCreated:l,onMatchUpdated:c,onMatchDeleted:d}=t;const{t:u}=xe("navigation"),{t:m}=xe("statistics"),h="create"===s,p=m("matchDetails.unnamedPlayer"),f=(0,e.useMemo)(()=>[{value:"home",label:m("matchDetails.venues.home")},{value:"away",label:m("matchDetails.venues.away")},{value:"neutral",label:m("matchDetails.venues.neutral")}],[m]),g=(0,e.useMemo)(()=>({Goalkeeper:m("matchDetails.playerStats.goalkeeper"),Defender:m("matchDetails.playerStats.defender"),Midfielder:m("matchDetails.playerStats.midfielder"),Attacker:m("matchDetails.playerStats.attacker"),Substitute:m("matchDetails.playerStats.substitute")}),[m]),v=(0,e.useMemo)(()=>Jf.map(e=>({value:e,label:g[e]||e})),[g]),[y,b]=(0,e.useState)(""),x=(0,e.useMemo)(()=>(Array.isArray(o)?o:[]).map((e,t)=>({id:e.id||"player-".concat(t),playerId:e.id,displayName:ng(e,p),goalsScored:0,totalTimePlayed:0,timeAsDefender:0,timeAsMidfielder:0,timeAsAttacker:0,timeAsGoalkeeper:0,startingRole:$f,wasCaptain:!1,receivedFairPlayAward:!1})),[o,p]),w=(0,e.useMemo)(()=>{var e;if(!h)return null;const t=(new Date).toISOString(),a=(null===(e=xi.FORMAT_CONFIGS[Qf])||void 0===e?void 0:e.defaultFormation)||"2-2";return{id:null,opponent:"",goalsScored:0,goalsConceded:0,venueType:"home",type:Ol.DEFAULT_MATCH_TYPE,format:Qf,formation:a,periods:3,periodDuration:15,matchDurationSeconds:2700,date:t.split("T")[0],time:t.slice(11,16),outcome:"D",playerStats:x}},[x,h]),[S,k]=(0,e.useState)(h),[N,j]=(0,e.useState)(()=>h?w:null),[T,A]=(0,e.useState)(()=>h?w:null),[_,C]=(0,e.useState)(!h),[M,P]=(0,e.useState)(null),[E,I]=(0,e.useState)("displayName"),[R,O]=(0,e.useState)("asc"),[D,F]=(0,e.useState)(null),[L,q]=(0,e.useState)(!1),[U,B]=(0,e.useState)(null),[G,z]=(0,e.useState)(!1),[V,H]=(0,e.useState)(!1),[K,W]=(0,e.useState)(null),[Y,J]=(0,e.useState)(null),Q=(0,e.useMemo)(()=>new Set(((null===T||void 0===T?void 0:T.playerStats)||[]).map(e=>e.playerId)),[null===T||void 0===T?void 0:T.playerStats]),$=(0,e.useMemo)(()=>(o||[]).filter(e=>!Q.has(e.id)).map(e=>(0,n.A)((0,n.A)({},e),{},{displayName:ng(e,p)})),[o,Q,p]);(0,e.useEffect)(()=>{h&&(w&&(j(e=>e&&Array.isArray(e.playerStats)&&e.playerStats.length>0?e:w),A(e=>e&&Array.isArray(e.playerStats)&&e.playerStats.length>0?e:w)),C(!1),P(null))},[w,h]),(0,e.useEffect)(()=>{if(h)return;if(!a)return P(m("matchDetails.noMatchId")),void C(!1);let e=!0;return async function(){C(!0),P(null),F(null),j(null),A(null);const t=await Xo(a);if(e){if(t.success){const e=(t.playerStats||[]).map((e,t)=>(0,n.A)((0,n.A)({},e),{},{id:e.playerId||e.id||"player-".concat(t)})),a=(0,n.A)((0,n.A)({},t.match),{},{playerStats:e});j(a),A(a)}else P(t.error||m("matchDetails.failedToLoadDetails"));C(!1)}}(),()=>{e=!1}},[h,a,m]),(0,e.useEffect)(()=>{y&&!$.some(e=>e.id===y)&&b("")},[$,y]);const X=(0,e.useCallback)(e=>{if(!S||!e)return void W(null);const t=Yf(e.goalsScored),a=(e.playerStats||[]).reduce((e,t)=>e+Yf(null===t||void 0===t?void 0:t.goalsScored),0);W(a>t?{teamGoals:t,playerGoals:a}:null)},[S]),Z=(0,e.useCallback)(e=>{if(!S||!e)return void J(null);const t=e.playerStats||[],a=t.filter(e=>"Goalkeeper"===e.startingRole).length,n=t.filter(e=>["Defender","Midfielder","Attacker"].includes(e.startingRole)).length,r=e.format||Qf,s=r===xi.FORMATS.FORMAT_5V5?4:6,i=[];1!==a&&i.push(m("matchDetails.playerStats.goalkeeperCountIssue",{count:a})),n!==s&&i.push(m("matchDetails.playerStats.outfieldCountIssue",{count:n,expected:s,format:r})),i.length>0?J({issues:i}):J(null)},[S,m]);if((0,e.useEffect)(()=>{S?(X(T),Z(T)):(W(null),J(null))},[S,T,X,Z]),_)return(0,Ts.jsx)("div",{className:"text-center py-8 text-slate-400",children:(0,Ts.jsx)("p",{children:m("matchDetails.loading")})});if(M||!N||!T)return(0,Ts.jsxs)("div",{className:"text-center py-8",children:[(0,Ts.jsx)("p",{className:"text-red-400 mb-2",children:M||m("matchDetails.notFound")}),(0,Ts.jsx)(Lc,{onClick:r,variant:"secondary",className:"mt-4",children:u("backTo.matchHistory")})]});const ee=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{validateGoals:r=!1}=a;A(a=>{if(!a)return a;const s=(0,n.A)((0,n.A)({},a),{},{[e]:t});if("format"===e){const e=eg(t);e.length>0&&!e.some(e=>e.value===s.formation)&&(s.formation=e[0].value)}if("goalsScored"===e||"goalsConceded"===e){const a=el(("goalsScored"===e?t:s.goalsScored)||0,("goalsConceded"===e?t:s.goalsConceded)||0);s.outcome="win"===a?"W":"draw"===a?"D":"L"}return r&&"goalsScored"===e&&X(s),s})},te=e=>t=>{const{value:a}=t.target;if(""===a)return void ee(e,"");const n=parseInt(a,10);Number.isNaN(n)?ee(e,""):ee(e,Math.max(0,n))},ae=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return()=>{if(!T)return;const a=Xf(T[e],t);ee(e,a,{validateGoals:"goalsScored"===e})}},ne=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return()=>{var n;const r=null===T||void 0===T||null===(n=T.playerStats)||void 0===n?void 0:n.find(t=>t.id===e);if(!r)return;const s=Xf(r[t],a);se(e,t,s,{validateGoals:"goalsScored"===t})}},re=e=>{const t=function(){return((arguments.length>0&&void 0!==arguments[0]?arguments[0]:[])||[]).map(e=>{const t=Zf(e.timeAsDefender,0),a=Zf(e.timeAsMidfielder,0),r=Zf(e.timeAsAttacker,0),s=Zf(e.timeAsGoalkeeper,0),i=t+a+r;return(0,n.A)((0,n.A)({},e),{},{goalsScored:Xf(e.goalsScored,0),timeAsDefender:t,timeAsMidfielder:a,timeAsAttacker:r,timeAsGoalkeeper:s,totalTimePlayed:i,wasCaptain:Boolean(e.wasCaptain),receivedFairPlayAward:Boolean(e.receivedFairPlayAward)})})}(e.playerStats),a=Xf(e.periods,3),r=Xf(e.periodDuration,15),s=Xf(e.goalsScored,0),i=Xf(e.goalsConceded,0),o=Zf(e.matchDurationSeconds,a*r*60);return(0,n.A)((0,n.A)({},e),{},{goalsScored:s,goalsConceded:i,periods:a,periodDuration:r,matchDurationSeconds:o,playerStats:t})},se=function(e,t,a){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const{validateGoals:s=!1,validateRoles:i=!1}=r;A(r=>{if(!r)return r;const o=Array.isArray(r.playerStats)?r.playerStats.map(r=>{if(r.id!==e)return r;const s=(0,n.A)((0,n.A)({},r),{},{[t]:a});return["timeAsDefender","timeAsMidfielder","timeAsAttacker","timeAsGoalkeeper"].includes(t)&&(s.totalTimePlayed=(s.timeAsDefender||0)+(s.timeAsMidfielder||0)+(s.timeAsAttacker||0)),s}):[],l=(0,n.A)((0,n.A)({},r),{},{playerStats:o});return s&&"goalsScored"===t&&X(l),i&&"startingRole"===t&&Z(l),l})},ie=e=>{const t=(T.matchDurationSeconds||0)/60;return e.totalTimePlayed>t},oe=e=>{let{children:t,field:a,align:n="center"}=e;const r=E===a,s=a&&!["wasCaptain","receivedFairPlayAward"].includes(a),i="left"===n?"text-left":"text-center",o="left"===n?"justify-start":"justify-center";return(0,Ts.jsx)("th",{className:"px-3 py-2 ".concat(i," text-xs font-medium text-sky-200 tracking-wider"),children:s?(0,Ts.jsxs)("button",{onClick:()=>(e=>{E===e?O("asc"===R?"desc":"asc"):(I(e),O("asc"))})(a),className:"flex items-center ".concat(o," space-x-1 hover:text-sky-100 transition-colors w-full"),children:[(0,Ts.jsx)("span",{children:t}),r&&("asc"===R?(0,Ts.jsx)($u,{className:"h-3 w-3"}):(0,Ts.jsx)(jc,{className:"h-3 w-3"}))]}):(0,Ts.jsx)("span",{children:t})})};return(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Ts.jsx)(Lc,{onClick:r,Icon:Uh,variant:"secondary",size:"md",children:u("back")}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(Td,{className:"h-6 w-6 text-sky-400"}),(0,Ts.jsx)("h2",{className:"text-2xl font-bold text-sky-400",children:m("matchDetails.title")})]}),(0,Ts.jsx)("p",{className:"text-slate-400 text-sm",children:T.opponent||m("matchDetails.newMatch")})]})]}),(0,Ts.jsx)("div",{className:"flex items-center space-x-2",children:S?(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)(Lc,{onClick:async()=>{if(T){q(!0),F(null);try{const r=re(T),s=r.playerStats;if(h||!a){var e,t;if(!i)throw new Error(m("matchDetails.teamRequired"));const a=(null===(e=s.find(e=>e.receivedFairPlayAward))||void 0===e?void 0:e.playerId)||null,o=(null===(t=s.find(e=>e.wasCaptain))||void 0===t?void 0:t.playerId)||null,c=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];try{var a,n;const r=["teamId","date","time","type","venueType","format","formation","periods","periodDuration"].filter(t=>{const a=e[t];return void 0===a||null===a||""===a});if(r.length>0)return{success:!1,error:"Missing required fields: ".concat(r.join(", "))};const s="number"===typeof e.goalsScored?e.goalsScored:0,i="number"===typeof e.goalsConceded?e.goalsConceded:0,o=el(s,i),l=(Number(e.periods)||0)*(Number(e.periodDuration)||0)*60,c="number"===typeof e.matchDurationSeconds?e.matchDurationSeconds:l;let d;try{const t="".concat(e.date,"T").concat(e.time,":00");d=new Date(t).toISOString()}catch(M){d=(new Date).toISOString()}const u=(new Date).toISOString(),m=e.fairPlayAwardPlayerId||(null===(a=t.find(e=>null===e||void 0===e?void 0:e.receivedFairPlayAward))||void 0===a?void 0:a.playerId)||null,h=e.captainId||(null===(n=t.find(e=>null===e||void 0===e?void 0:e.wasCaptain))||void 0===n?void 0:n.playerId)||null,p={team_id:e.teamId,opponent:e.opponent||null,goals_scored:s,goals_conceded:i,outcome:o,venue_type:e.venueType,type:"string"===typeof e.type?e.type.toLowerCase():e.type,format:e.format,formation:e.formation,periods:Number(e.periods)||0,period_duration_minutes:Number(e.periodDuration)||0,match_duration_seconds:c,started_at:d,finished_at:d,updated_at:u,state:"finished",fair_play_award:m,captain:h},{data:f,error:g}=await Ur.from("match").insert(p).select("id").single();if(g)return console.error("\u274c Failed to create manual match:",g),{success:!1,error:"Database error: ".concat(g.message)};const v=null===f||void 0===f?void 0:f.id;if(!v)return{success:!1,error:"errors.matchCreationFailed"};if(Array.isArray(t)&&t.length>0){const e=t.filter(e=>null===e||void 0===e?void 0:e.playerId).map(e=>dl(v,e.playerId,e));if(e.length>0){const{error:t}=await Ur.from("player_match_stats").upsert(e,{onConflict:"match_id,player_id"});if(t)return console.error("\u274c Failed to insert manual player stats:",t),{success:!1,error:"Database error: ".concat(t.message)}}}return{success:!0,matchId:v}}catch(M){return console.error("\u274c Exception while creating manual match:",M),{success:!1,error:"Unexpected error: ".concat(M.message)}}}((0,n.A)((0,n.A)({},r),{},{teamId:i,fairPlayAwardPlayerId:a,captainId:o}),s);if(!c.success)throw new Error(c.error||m("matchDetails.failedToCreate"));return j(r),A(r),k(!1),void(l&&l(c.matchId))}const o=await async function(e,t){try{if(!e)return{success:!1,error:"Match ID is required"};const a=el(t.goalsScored,t.goalsConceded),n=new Date("".concat(t.date,"T").concat(t.time,":00")).toISOString(),r={opponent:t.opponent||null,goals_scored:t.goalsScored,goals_conceded:t.goalsConceded,outcome:a,venue_type:t.venueType,type:t.type.toLowerCase(),format:t.format,formation:t.formation,periods:t.periods,period_duration_minutes:t.periodDuration,match_duration_seconds:t.matchDurationSeconds,started_at:n,updated_at:(new Date).toISOString()},{error:s}=await Ur.from("match").update(r).eq("id",e).is("deleted_at",null);return s?(console.error("\u274c Failed to update match details:",s),{success:!1,error:"Database error: ".concat(s.message)}):{success:!0}}catch(M){return console.error("\u274c Exception while updating match details:",M),{success:!1,error:"Unexpected error: ".concat(M.message)}}}(a,{opponent:r.opponent,goalsScored:r.goalsScored,goalsConceded:r.goalsConceded,venueType:r.venueType,type:r.type,format:r.format,formation:r.formation,periods:r.periods,periodDuration:r.periodDuration,matchDurationSeconds:r.matchDurationSeconds,date:r.date,time:r.time});if(!o.success)throw new Error(o.error||m("matchDetails.failedToUpdateDetails"));const d=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];try{if(!e)return{success:!1,error:"Match ID is required"};if(!Array.isArray(t))return{success:!1,error:"errors.invalidPlayerStats"};if(0===t.length)return{success:!0,updated:0};const a=t.filter(e=>null===e||void 0===e?void 0:e.playerId).map(t=>dl(e,t.playerId,t));if(0===a.length)return{success:!1,error:"errors.noValidPlayerStats"};const{error:n}=await Ur.from("player_match_stats").upsert(a,{onConflict:"match_id,player_id"});return n?(console.error("\u274c Failed to batch update player match stats:",n),{success:!1,error:"Database error: ".concat(n.message)}):{success:!0,updated:a.length}}catch(M){return console.error("\u274c Exception while batch updating player match stats:",M),{success:!1,error:"Unexpected error: ".concat(M.message)}}}(a,s);if(!d.success)throw new Error(d.error||m("matchDetails.failedToUpdatePlayerStats"));const u=await Xo(a);if(u.success){const e=(0,n.A)((0,n.A)({},u.match),{},{playerStats:u.playerStats});j(e),A(e)}k(!1),c&&c()}catch(r){console.error("Error saving match data:",r),F(r.message)}finally{q(!1)}}},Icon:wc,variant:"primary",disabled:L,children:m(L?"matchDetails.saving":"matchDetails.saveChanges")}),(0,Ts.jsx)(Lc,{onClick:()=>{if(h)return void(r&&r());if(!N)return void(r&&r());const e=Array.isArray(N.playerStats)?N.playerStats:[];A((0,n.A)((0,n.A)({},N),{},{playerStats:e.map(e=>(0,n.A)({},e))})),F(null),k(!1)},Icon:Tc,variant:"secondary",disabled:L,children:m("matchDetails.cancel")})]}):(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)(Lc,{onClick:()=>k(!0),Icon:Hf,variant:"secondary",children:m("matchDetails.editMatch")}),!h&&(0,Ts.jsx)(Lc,{onClick:()=>{G||(B(null),H(!0))},Icon:xd,variant:"secondary",disabled:G,children:m(G?"matchDetails.deleting":"matchDetails.delete")})]})})]}),D&&(0,Ts.jsxs)(Jc,{variant:"error",children:[(0,Ts.jsx)("p",{className:"font-medium",children:m("matchDetails.errorSaving")}),(0,Ts.jsx)("p",{className:"text-sm mt-1 opacity-80",children:D})]}),U&&(0,Ts.jsxs)(Jc,{variant:"error",children:[(0,Ts.jsx)("p",{className:"font-medium",children:m("matchDetails.errorDeleting")}),(0,Ts.jsx)("p",{className:"text-sm mt-1 opacity-80",children:U})]}),(0,Ts.jsx)(qc,{isOpen:V,onCancel:()=>{G||H(!1)},onConfirm:async()=>{if(G)return;z(!0),B(null);const e=await async function(e){try{if(!e)return{success:!1,error:"Match ID is required"};const t=(new Date).toISOString(),a=await Ur.from("player_match_stats").delete().eq("match_id",e);if(a.error)return console.error("\u274c Failed to delete player match stats:",a.error),{success:!1,error:"Database error: ".concat(a.error.message)};const n=await Ur.from("match").update({deleted_at:t},{returning:"minimal"}).eq("id",e).is("deleted_at",null).eq("state","finished");return n.error?(console.error("\u274c Failed to delete finished match:",n.error),{success:!1,error:"Database error: ".concat(n.error.message)}):n.data&&0!==n.data.length?{success:!0}:{success:!1,error:"errors.matchNotFoundOrDeleted"}}catch(M){return console.error("\u274c Exception while deleting finished match:",M),{success:!1,error:"Unexpected error: ".concat(M.message)}}}(a);if(!e.success)return B(e.error||m("matchDetails.failedToDelete")),z(!1),void H(!1);z(!1),H(!1),d&&d(a),r()},title:m("matchDetails.deleteTitle"),message:m("matchDetails.deleteConfirm"),confirmText:m(G?"matchDetails.deletingEllipsis":"matchDetails.delete"),cancelText:m("matchDetails.cancel"),variant:"danger"}),(0,Ts.jsxs)(Xc,{padding:"sm",className:"overflow-hidden",children:[(0,Ts.jsx)("div",{className:"p-4 bg-slate-800",children:(0,Ts.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ts.jsx)("div",{className:"flex items-center space-x-2",children:S?(0,Ts.jsx)(Rc,{type:"text",value:T.opponent,onChange:e=>ee("opponent",e.target.value),className:"w-48 text-lg font-semibold",placeholder:m("matchDetails.opponentName")}):(0,Ts.jsx)("span",{className:"text-xl font-semibold text-slate-100",children:T.opponent})}),(0,Ts.jsx)("span",{className:(le=T.outcome,pf(le,{baseClasses:"px-2 py-1 rounded text-xs font-medium"})),children:"W"===T.outcome?m("matchDetails.outcomes.win"):"D"===T.outcome?m("matchDetails.outcomes.draw"):m("matchDetails.outcomes.loss")})]}),(0,Ts.jsx)("div",{className:"text-center",children:S?(0,Ts.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,Ts.jsx)(Rc,{type:"number",value:""===T.goalsScored?"":T.goalsScored,onChange:te("goalsScored"),onBlur:ae("goalsScored",0),className:"w-16 text-center",min:"0"}),(0,Ts.jsx)("span",{className:"text-slate-400 text-xl",children:"-"}),(0,Ts.jsx)(Rc,{type:"number",value:""===T.goalsConceded?"":T.goalsConceded,onChange:te("goalsConceded"),onBlur:ae("goalsConceded",0),className:"w-16 text-center",min:"0"})]}):(0,Ts.jsx)("div",{className:"text-3xl font-bold text-sky-300",children:"".concat(T.goalsScored,"-").concat(T.goalsConceded)})}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(Id,{className:"h-4 w-4 text-slate-400"}),(0,Ts.jsx)("div",{className:"text-right",children:S?(0,Ts.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,Ts.jsx)(Rc,{type:"date",value:T.date,onChange:e=>ee("date",e.target.value),className:"w-32 text-sm"}),(0,Ts.jsx)(Rc,{type:"time",value:T.time,onChange:e=>ee("time",e.target.value),className:"w-32 text-sm"})]}):(0,Ts.jsx)("div",{className:"text-sm",children:(0,Ts.jsxs)("div",{className:"text-slate-100 font-mono flex flex-col sm:flex-row sm:space-x-2",children:[(0,Ts.jsx)("span",{children:T.date}),(0,Ts.jsx)("span",{className:"text-slate-300",children:T.time})]})})})]})]})}),S&&K&&(0,Ts.jsx)("div",{className:"px-4 py-2 bg-slate-800 border-t border-slate-600 text-xs text-red-300",role:"status",children:(0,Ts.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,Ts.jsx)("span",{"aria-hidden":"true",children:"\u26a0\ufe0f"}),(0,Ts.jsx)("span",{children:m("matchDetails.playerStats.goalWarning",{playerGoals:K.playerGoals,teamGoals:K.teamGoals})})]})}),S&&Y&&(0,Ts.jsx)("div",{className:"px-4 py-2 bg-slate-800 border-t border-slate-600 text-xs text-red-300",role:"status",children:(0,Ts.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,Ts.jsx)("span",{"aria-hidden":"true",children:"\u26a0\ufe0f"}),(0,Ts.jsx)("span",{children:m("matchDetails.playerStats.roleWarning",{issues:Y.issues.join(", ")})})]})}),(0,Ts.jsx)("div",{className:"px-4 py-3 border-t border-slate-600",children:(0,Ts.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-7 gap-4",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(jd,{className:"h-4 w-4 text-slate-400"}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("div",{className:"text-xs text-slate-400 tracking-wide",children:m("matchDetails.type")}),S?(0,Ts.jsx)(Dc,{value:T.type,onChange:e=>ee("type",e),options:(0,Ol.getMatchTypeOptions)(u).map(e=>({value:e.value,label:e.label})),className:"text-sm"}):(0,Ts.jsx)("div",{className:"text-sm text-slate-100 font-medium",children:(e=>{const t=(0,Ol.getMatchTypeOptions)(u).find(t=>t.value===e);return t?t.label:e?e.charAt(0).toUpperCase()+e.slice(1):m("matchDetails.unknownType")})(T.type)})]})]}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(zf,{className:"h-4 w-4 text-slate-400"}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("div",{className:"text-xs text-slate-400 tracking-wide",children:m("matchDetails.venue")}),S?(0,Ts.jsx)(Dc,{value:T.venueType,onChange:e=>ee("venueType",e),options:f,className:"text-sm"}):(0,Ts.jsx)("div",{className:"text-sm text-slate-100 font-medium",children:"home"===T.venueType?m("matchDetails.venues.home"):"neutral"===T.venueType?m("matchDetails.venues.neutral"):m("matchDetails.venues.away")})]})]}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(Kf,{className:"h-4 w-4 text-slate-400"}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("div",{className:"text-xs text-slate-400 tracking-wide",children:m("matchDetails.format")}),S?(0,Ts.jsx)(Dc,{value:T.format,onChange:e=>ee("format",e),options:Object.values(xi.FORMATS).map(e=>{var t;return{value:e,label:(null===(t=xi.FORMAT_CONFIGS[e])||void 0===t?void 0:t.label)||e}}),className:"text-sm"}):(0,Ts.jsx)("div",{className:"text-sm text-slate-100 font-medium",children:T.format})]})]}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(xc,{className:"h-4 w-4 text-slate-400"}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("div",{className:"text-xs text-slate-400 tracking-wide",children:m("matchDetails.formation")}),S?(0,Ts.jsx)(Dc,{value:T.formation,onChange:e=>ee("formation",e),options:eg(T.format),className:"text-sm"}):(0,Ts.jsx)("div",{className:"text-sm text-slate-100 font-medium",children:T.formation})]})]}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(Sd,{className:"h-4 w-4 text-slate-400"}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("div",{className:"text-xs text-slate-400 tracking-wide",children:m("matchDetails.periods")}),S?(0,Ts.jsx)(Rc,{type:"number",value:""===T.periods?"":T.periods,onChange:te("periods"),onBlur:ae("periods",1),className:"text-sm",min:"1"}):(0,Ts.jsx)("div",{className:"text-sm text-slate-100 font-medium",children:T.periods})]})]}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(Sd,{className:"h-4 w-4 text-slate-400"}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("div",{className:"text-xs text-slate-400 tracking-wide",children:m("matchDetails.periodDuration")}),S?(0,Ts.jsx)(Rc,{type:"number",value:""===T.periodDuration?"":T.periodDuration,onChange:te("periodDuration"),onBlur:ae("periodDuration",15),className:"text-sm w-16",min:"1"}):(0,Ts.jsxs)("div",{className:"text-sm text-slate-100 font-medium",children:[T.periodDuration," min"]})]})]}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(Sd,{className:"h-4 w-4 text-slate-400"}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("div",{className:"text-xs text-slate-400 tracking-wide",children:m("matchDetails.totalTime")}),S?(0,Ts.jsx)(Wf,{value:(T.matchDurationSeconds||0)/60,onChange:e=>ee("matchDurationSeconds",60*e),className:"text-sm"}):(0,Ts.jsx)("div",{className:"text-sm text-slate-100 font-medium",children:tg((T.matchDurationSeconds||0)/60)})]})]})]})})]}),(0,Ts.jsxs)(Xc,{padding:"sm",className:"overflow-hidden",children:[(0,Ts.jsxs)("div",{className:"p-4 border-b border-slate-600",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(od,{className:"h-5 w-5 text-sky-400"}),(0,Ts.jsx)("h3",{className:"text-lg font-semibold text-sky-400",children:m("matchDetails.playerStats.title")})]}),(0,Ts.jsx)("p",{className:"text-slate-400 text-sm mt-1",children:m("matchDetails.playerStats.subtitle")})]}),h&&S&&(0,Ts.jsx)("div",{className:"p-4 border-b border-slate-600 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:(0,Ts.jsxs)("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[(0,Ts.jsx)(Dc,{value:y,onChange:b,options:$.map(e=>({value:e.id,label:ng(e,p)})),placeholder:0===$.length?m("matchDetails.playerStats.allPlayersIncluded"):m("matchDetails.playerStats.selectPlayer"),disabled:0===$.length}),(0,Ts.jsx)(Lc,{onClick:()=>{if(!y)return;const e=(o||[]).find(e=>e.id===y);if(!e)return;const t={id:e.id,playerId:e.id,displayName:ng(e,p),goalsScored:0,totalTimePlayed:0,timeAsDefender:0,timeAsMidfielder:0,timeAsAttacker:0,timeAsGoalkeeper:0,startingRole:$f,wasCaptain:!1,receivedFairPlayAward:!1};A(e=>(0,n.A)((0,n.A)({},e),{},{playerStats:Array.isArray(e.playerStats)?[...e.playerStats,t]:[t]})),b("")},variant:"secondary",size:"sm",disabled:!y,children:m("matchDetails.playerStats.addPlayer")})]})}),(0,Ts.jsx)("div",{className:"overflow-x-auto",children:(0,Ts.jsxs)("table",{className:"min-w-full",children:[(0,Ts.jsx)("thead",{className:"bg-slate-800",children:(0,Ts.jsxs)("tr",{children:[(0,Ts.jsx)(oe,{field:"displayName",align:"left",children:m("matchDetails.playerStats.player")}),(0,Ts.jsx)(oe,{field:"goalsScored",children:m("matchDetails.playerStats.goals")}),(0,Ts.jsx)(oe,{field:"totalTimePlayed",children:m("matchDetails.playerStats.outfieldTime")}),(0,Ts.jsx)(oe,{field:"timeAsDefender",children:m("matchDetails.playerStats.defender")}),(0,Ts.jsx)(oe,{field:"timeAsMidfielder",children:m("matchDetails.playerStats.midfielder")}),(0,Ts.jsx)(oe,{field:"timeAsAttacker",children:m("matchDetails.playerStats.attacker")}),(0,Ts.jsx)(oe,{field:"timeAsGoalkeeper",children:m("matchDetails.playerStats.goalkeeper")}),(0,Ts.jsx)(oe,{field:"startingRole",children:m("matchDetails.playerStats.startingRole")}),(0,Ts.jsx)(oe,{field:"wasCaptain",children:m("matchDetails.playerStats.captain")}),(0,Ts.jsx)(oe,{field:"receivedFairPlayAward",children:m("matchDetails.playerStats.fairPlay")}),h&&S&&(0,Ts.jsx)("th",{className:"px-3 py-2 text-center text-xs font-medium text-sky-200 tracking-wider",children:m("matchDetails.playerStats.actions")})]})}),(0,Ts.jsx)("tbody",{className:"divide-y divide-slate-600",children:(null!==T&&void 0!==T&&T.playerStats?E?[...T.playerStats].sort((e,t)=>{let a=e[E],n=t[E];"string"===typeof a&&(a=a.toLowerCase(),n=n.toLowerCase());let r=0;return a<n&&(r=-1),a>n&&(r=1),"desc"===R?-r:r}):T.playerStats:[]).map((e,t)=>{return(0,Ts.jsxs)("tr",{className:"".concat(t%2===0?"bg-slate-700":"bg-slate-800"," hover:bg-slate-600 transition-colors"),children:[(0,Ts.jsx)("td",{className:"px-3 py-2 whitespace-nowrap",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(Xu,{className:"h-4 w-4 text-slate-400"}),(0,Ts.jsx)("span",{className:"text-slate-100 font-medium",children:ng(e,p)})]})}),(0,Ts.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:S?(0,Ts.jsx)(Rc,{type:"number",value:""===e.goalsScored?"":e.goalsScored,onChange:(a=e.id,r="goalsScored",e=>{const{value:t}=e.target;if(""===t)return void se(a,r,"");const n=parseInt(t,10);Number.isNaN(n)?se(a,r,""):se(a,r,Math.max(0,n))}),onBlur:ne(e.id,"goalsScored",0),className:"w-16 text-center",min:"0"}):(0,Ts.jsx)("span",{className:"text-slate-300 font-mono",children:e.goalsScored})}),(0,Ts.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:S?(0,Ts.jsxs)("div",{className:"flex flex-col items-center space-y-1",children:[(0,Ts.jsx)("span",{className:"text-slate-300 font-mono",children:ag(e.totalTimePlayed)}),ie(e)&&(0,Ts.jsx)("div",{className:"text-xs text-red-400 text-center",children:m("matchDetails.playerStats.exceedsMatchDuration")})]}):(0,Ts.jsx)("span",{className:"text-slate-300 font-mono",children:ag(e.totalTimePlayed)})}),(0,Ts.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:S?(0,Ts.jsx)(Wf,{value:e.timeAsDefender,onChange:t=>se(e.id,"timeAsDefender",t)}):(0,Ts.jsx)("span",{className:"text-slate-300 font-mono",children:ag(e.timeAsDefender)})}),(0,Ts.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:S?(0,Ts.jsx)(Wf,{value:e.timeAsMidfielder,onChange:t=>se(e.id,"timeAsMidfielder",t)}):(0,Ts.jsx)("span",{className:"text-slate-300 font-mono",children:ag(e.timeAsMidfielder)})}),(0,Ts.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:S?(0,Ts.jsx)(Wf,{value:e.timeAsAttacker,onChange:t=>se(e.id,"timeAsAttacker",t)}):(0,Ts.jsx)("span",{className:"text-slate-300 font-mono",children:ag(e.timeAsAttacker)})}),(0,Ts.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:S?(0,Ts.jsx)(Wf,{value:e.timeAsGoalkeeper,onChange:t=>se(e.id,"timeAsGoalkeeper",t)}):(0,Ts.jsx)("span",{className:"text-slate-300 font-mono",children:ag(e.timeAsGoalkeeper)})}),(0,Ts.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:S?(0,Ts.jsx)(Dc,{value:e.startingRole,onChange:t=>se(e.id,"startingRole",t,{validateRoles:!0}),options:v}):(0,Ts.jsx)("span",{className:"text-slate-300 text-sm",children:g[e.startingRole]||e.startingRole})}),(0,Ts.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:S?(0,Ts.jsx)("input",{type:"checkbox",checked:e.wasCaptain,onChange:t=>se(e.id,"wasCaptain",t.target.checked),className:"rounded border-slate-500 bg-slate-600 text-sky-600 focus:ring-sky-500"}):e.wasCaptain&&(0,Ts.jsx)("span",{className:"text-yellow-400 font-bold text-lg mx-auto block text-center",children:"C"})}),(0,Ts.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:S?(0,Ts.jsx)("input",{type:"checkbox",checked:e.receivedFairPlayAward,onChange:t=>se(e.id,"receivedFairPlayAward",t.target.checked),className:"rounded border-slate-500 bg-slate-600 text-emerald-600 focus:ring-emerald-500"}):e.receivedFairPlayAward&&(0,Ts.jsx)(kf,{className:"h-4 w-4 text-emerald-400 mx-auto"})}),h&&S&&(0,Ts.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:(0,Ts.jsx)(Lc,{onClick:()=>{return t=e.id,void A(e=>{if(!e)return e;const a=Array.isArray(e.playerStats)?e.playerStats.filter(e=>e.id!==t):[],r=(0,n.A)((0,n.A)({},e),{},{playerStats:a});return X(r),r});var t},Icon:xd,variant:"secondary",size:"sm",children:m("matchDetails.playerStats.remove")})})]},e.id);var a,r})})]})})]})]});var le}const sg="playerName",ig="practicesPerMatch",og="totalAttendance",lg="attendanceRate",cg="matchesPlayed",dg="loanMatches",ug=Bs(Br.TEAM_MANAGEMENT_ACTIVE_TAB,{tab:"overview"});function mg(t){let{startDate:a,endDate:r,onNavigateTo:s}=t;const{t:i}=xe("statistics"),{currentTeam:o}=vi(),[l,c]=(0,e.useState)([]),[d,u]=(0,e.useState)([]),[m,h]=(0,e.useState)(!1),[p,f]=(0,e.useState)(!1),[g,v]=(0,e.useState)(null),[y,b]=(0,e.useState)(new Map),[x,w]=(0,e.useState)(null);(0,e.useEffect)(()=>{!async function(){if(null===o||void 0===o||!o.id)return u([]),void f(!1);f(!0);try{const e=await Bu(o.id);u(e||[])}catch(e){console.error("Error fetching connectors:",e),u([])}f(!1)}()},[null===o||void 0===o?void 0:o.id]),(0,e.useEffect)(()=>{!async function(){if(null!==o&&void 0!==o&&o.id){h(!0),v(null);try{const e=await Ku(o.id,a,r);c(e||[])}catch(e){console.error("Error fetching attendance stats:",e),v(e.message||i("attendanceStats.failedToLoadAttendance")),c([])}h(!1)}else c([])}()},[null===o||void 0===o?void 0:o.id,a,r,i]),(0,e.useEffect)(()=>{!async function(){if(null===o||void 0===o||!o.id)return b(new Map),void w(null);w(null);try{const e=await sm(o.id,{startDate:a,endDate:r});if(e.success){const t=new Map;(e.loans||[]).forEach(e=>{if(null===e||void 0===e||!e.player_id)return;const a=t.get(e.player_id)||[];a.push(e),t.set(e.player_id,a)}),b(t)}else b(new Map),w(e.error||i("attendanceStats.failedToLoadLoanMatches"))}catch(e){console.error("Failed to load loan data:",e),b(new Map),w(i("attendanceStats.failedToLoadLoanMatches"))}}()},[null===o||void 0===o?void 0:o.id,a,r,i]);const S=(0,e.useMemo)(()=>l.map(e=>{const t=(y.get(e.playerId)||[]).length;return(0,n.A)((0,n.A)({},e),{},{loanMatches:t})}),[l,y]),k=Tf((0,e.useMemo)(()=>[{key:sg,label:i("attendanceStats.table.player"),sortable:!0,className:"text-left font-medium",render:e=>(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(Xu,{className:"h-4 w-4 text-slate-400"}),(0,Ts.jsx)("span",{className:"text-slate-100",children:e.playerName})]})},{key:ig,label:i("attendanceStats.table.practicesPerMatch"),sortable:!0,className:"text-center",render:e=>(0,Ts.jsx)("span",{className:"text-slate-300 font-mono",children:e.practicesPerMatch.toFixed(2)})},{key:og,label:i("attendanceStats.table.practicesAttended"),sortable:!0,className:"text-center",render:e=>(0,Ts.jsx)("span",{className:"text-slate-300 font-mono",children:e.totalAttendance})},{key:lg,label:i("attendanceStats.table.attendanceRate"),sortable:!0,className:"text-center",render:e=>(0,Ts.jsxs)("span",{className:"text-slate-300 font-mono",children:[e.attendanceRate,"%"]})},{key:cg,label:i("attendanceStats.table.matchesPlayed"),sortable:!0,className:"text-center",render:e=>(0,Ts.jsx)("span",{className:"text-slate-300 font-mono",children:e.matchesPlayed})},{key:dg,label:i("attendanceStats.table.matchesLoaned"),sortable:!0,className:"text-center",render:e=>(0,Ts.jsx)("span",{className:"text-slate-300 font-mono",children:e.loanMatches>0?e.loanMatches:"-"})}],[i]),Br.STATISTICS_ATTENDANCE_COLUMN_ORDER),{sortedData:N,sortBy:j,handleSort:T,renderSortIndicator:A}=Nf(S,sg,"asc",k.isReordering),_=(0,e.useMemo)(()=>{if(0===l.length)return{totalPlayers:0,totalPractices:0,averageAttendanceRate:0,topAttendee:null};const e=l.length,t=Math.max(...l.map(e=>e.totalPractices),0),a=l.reduce((e,t)=>e+t.attendanceRate,0)/e,n=l.reduce((e,t)=>e?t.totalAttendance>e.totalAttendance?t:t.totalAttendance<e.totalAttendance?e:t.attendanceRate>e.attendanceRate?t:e:t,null);return{totalPlayers:e,totalPractices:t,averageAttendanceRate:Math.round(10*a)/10,topAttendee:n?{playerName:n.playerName,attendanceRate:n.attendanceRate,totalAttendance:n.totalAttendance}:null}},[l]),C=()=>{ug.saveState({tab:"connectors"}),"function"===typeof s&&s(bi.TEAM_MANAGEMENT)};if(m||p)return(0,Ts.jsx)(bf,{message:i("attendanceStats.loading")});if(g)return(0,Ts.jsx)(xf,{title:i("attendanceStats.error"),message:g});const M=d.some(e=>"connected"===e.status);if(!M)return(0,Ts.jsx)(wf,{icon:Id,title:i("attendanceStats.noConnector.title"),message:(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)("p",{className:"text-slate-400 text-sm mb-4",children:i("attendanceStats.noConnector.description")}),(0,Ts.jsxs)("ul",{className:"text-slate-400 text-sm mb-6 space-y-1",children:[(0,Ts.jsx)("li",{children:i("attendanceStats.noConnector.platforms.sportadmin")}),(0,Ts.jsx)("li",{children:i("attendanceStats.noConnector.platforms.svenskalag")}),(0,Ts.jsx)("li",{children:i("attendanceStats.noConnector.platforms.myclub")})]})]}),actions:(0,Ts.jsx)(Lc,{onClick:C,children:i("attendanceStats.noConnector.connectButton")})});const P=N.length>0;return(0,Ts.jsxs)("div",{className:"space-y-6",children:[x&&(0,Ts.jsx)(Jc,{variant:"warning",className:"mb-4",children:x}),!P&&(0,Ts.jsx)(wf,{title:i("attendanceStats.noDataTimeRange"),message:i("attendanceStats.adjustTimeFilter")}),P&&(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,Ts.jsx)(Af,{icon:od,title:i("attendanceStats.totalPlayers"),value:_.totalPlayers,subtitle:i("attendanceStats.trackedPlayers")}),(0,Ts.jsx)(Af,{icon:Id,title:i("attendanceStats.totalPractices"),value:_.totalPractices,subtitle:i("attendanceStats.inSelectedPeriod")}),(0,Ts.jsx)(Af,{icon:rf,title:i("attendanceStats.avgAttendanceRate"),value:"".concat(_.averageAttendanceRate,"%"),subtitle:i("attendanceStats.acrossAllPlayers")}),(0,Ts.jsx)(Af,{icon:kf,title:i("attendanceStats.topAttendee"),value:_.topAttendee?_.topAttendee.playerName:i("attendanceStats.noData"),subtitle:_.topAttendee?"".concat(_.topAttendee.attendanceRate,"%"):i("attendanceStats.noData")})]}),(0,Ts.jsx)(_f,{data:N,orderedColumns:k.orderedColumns,sortBy:j,dragDropHandlers:k,onSort:T,renderSortIndicator:A,headerIcon:Id,headerTitle:i("attendanceStats.title"),headerSubtitle:i("attendanceStats.table.sortInstruction"),idKey:"playerId"})]})]})}const hg={TEAM:"team",PLAYER:"player",ATTENDANCE:"attendance",HISTORY:"history"};function pg(t){let{onNavigateBack:a,authModal:n,onNavigateTo:r,pushNavigationState:s,removeFromNavigationStack:i}=t;const{t:o}=xe("navigation"),{t:l}=xe("statistics"),c=(0,e.useMemo)(()=>Bs(Br.STATISTICS_ACTIVE_TAB,{tab:hg.TEAM}),[]),d=(0,e.useMemo)(()=>Bs(Br.STATISTICS_TIME_RANGE,{presetId:"all-time",customStartDate:null,customEndDate:null}),[]),u=(0,e.useRef)(null);u.current||(u.current=(e=>{const t=e.loadState(),a=(null===t||void 0===t?void 0:t.presetId)||"all-time";if("custom"===a){const e=e=>{if(!e)return null;const t=new Date(e);return Number.isNaN(t.getTime())?null:t};return{start:e(null===t||void 0===t?void 0:t.customStartDate),end:e(null===t||void 0===t?void 0:t.customEndDate),presetId:"custom"}}const n=im.find(e=>e.id===a),r=n?n.getValue():{start:null,end:null};return{start:r.start,end:r.end,presetId:n?a:"all-time"}})(d));const m=u.current,[h,p]=(0,e.useState)(()=>{const e=c.loadState(),t=e&&"object"===typeof e?e.tab:null;return t&&Object.values(hg).includes(t)?t:hg.TEAM}),[f,g]=(0,e.useState)(null),[v,y]=(0,e.useState)(!1),[b,x]=(0,e.useState)(0),[w,S]=(0,e.useState)(m.start),[k,N]=(0,e.useState)(m.end),[j,T]=(0,e.useState)(m.presetId),{loading:A,isAuthenticated:_}=Cs(),{loading:C,currentTeam:M,userTeams:P,canViewStatistics:E,teamPlayers:I}=vi(),R=hh(n);(0,e.useEffect)(()=>(s&&s(()=>{a()}),()=>{i&&i()}),[s,i,a]),(0,e.useEffect)(()=>{c.saveState({tab:h})},[h,c]),(0,e.useEffect)(()=>{"custom"===j?d.saveState({presetId:"custom",customStartDate:w?w.toISOString():null,customEndDate:k?k.toISOString():null}):d.saveState({presetId:j,customStartDate:null,customEndDate:null})},[w,k,j,d]);const O=e=>{g(e),y(!1)},D=()=>{g(null),y(!1)},F=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all-time";const n=e=>{if(!e)return null;const t=e instanceof Date?e:new Date(e);return Number.isNaN(t.getTime())?null:t};S(n(e)),N(n(t)),T(a)},L=()=>{g(null),y(!0)},q=()=>{x(e=>e+1)},U=e=>{q(),e?(g(e),y(!1)):(g(null),y(!1))},B=()=>{q(),g(null),y(!1)},G=[{id:hg.TEAM,label:l("screen.tabs.teamStats"),icon:Td,description:l("screen.tabs.teamStatsDescription")},{id:hg.PLAYER,label:l("screen.tabs.playerMatchStats"),icon:od,description:l("screen.tabs.playerMatchStatsDescription")},{id:hg.ATTENDANCE,label:l("screen.tabs.attendanceStats"),icon:Id,description:l("screen.tabs.attendanceStatsDescription")},{id:hg.HISTORY,label:l("screen.tabs.matchHistory"),icon:kh,description:l("screen.tabs.matchHistoryDescription")}],z=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Ts.jsx)(Lc,{onClick:a,Icon:Uh,variant:"secondary",size:"md",children:o("back")}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("h2",{className:"text-2xl font-bold text-sky-400",children:l("screen.title")}),e&&(0,Ts.jsx)("p",{className:"text-slate-400 text-sm",children:e})]})]}),(0,Ts.jsxs)(Xc,{variant:"dark",padding:"lg",className:"text-center space-y-4",children:[(0,Ts.jsx)("p",{className:"text-slate-300 text-sm",children:t}),n]})]})};if(A||C)return(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Ts.jsx)(Lc,{onClick:a,Icon:Uh,variant:"secondary",size:"md",children:o("back")}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("h2",{className:"text-2xl font-bold text-sky-400",children:l("screen.title")}),(0,Ts.jsx)("p",{className:"text-slate-400 text-sm",children:l("screen.loadingSubtitle")})]})]}),(0,Ts.jsx)("div",{className:"flex justify-center py-10",children:(0,Ts.jsx)(Wd,{size:"sm",message:l("screen.fetchingData")})})]});if(!_)return z(l("screen.signInSubtitle"),l("screen.signInBody"),(0,Ts.jsxs)("div",{className:"flex flex-col sm:flex-row justify-center gap-3",children:[(0,Ts.jsx)(Lc,{onClick:()=>{var e;return null===(e=R.openLogin)||void 0===e?void 0:e.call(R)},children:l("screen.signIn")}),(0,Ts.jsx)(Lc,{variant:"secondary",onClick:()=>{var e;return null===(e=R.openSignup)||void 0===e?void 0:e.call(R)},children:l("screen.createAccount")})]}));if(!M){const e=Array.isArray(P)&&P.length>0;return z(l(e?"screen.selectTeamSubtitle":"screen.noTeamSubtitle"),l(e?"screen.selectTeamBody":"screen.noTeamBody"),(0,Ts.jsx)("div",{className:"flex justify-center",children:(0,Ts.jsx)(Lc,{variant:"secondary",onClick:a,children:o("return.toApp")})}))}if(!E)return z(l("screen.roleUpdateSubtitle"),l("screen.roleUpdateBody"),(0,Ts.jsx)("div",{className:"flex justify-center",children:(0,Ts.jsx)(Lc,{variant:"secondary",onClick:a,children:o("back")})}));const V=G.find(e=>e.id===h);return(0,Ts.jsxs)("div",{className:"space-y-6",children:[!f&&(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Ts.jsx)(Lc,{onClick:a,Icon:Uh,variant:"secondary",size:"md",children:o("back")}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("h2",{className:"text-2xl font-bold text-sky-400",children:l("screen.title")}),V&&(0,Ts.jsx)("p",{className:"text-slate-400 text-sm",children:V.description})]})]}),(0,Ts.jsx)(lm,{startDate:w,endDate:k,selectedPresetId:j,onTimeRangeChange:F,className:"flex-shrink-0 hidden sm:block"})]}),!f&&(0,Ts.jsx)("div",{className:"sm:hidden",children:(0,Ts.jsx)(lm,{startDate:w,endDate:k,selectedPresetId:j,onTimeRangeChange:F,className:"w-full"})}),!f&&(0,Ts.jsx)("div",{className:"border-b border-slate-600",children:(0,Ts.jsx)($d,{tabs:G,activeTab:h,onTabChange:p,variant:"wrap"})}),(0,Ts.jsx)("div",{className:"min-h-96",children:(()=>{if(f||v)return(0,Ts.jsx)(rg,{matchId:v?null:f,mode:v?"create":"view",teamId:null===M||void 0===M?void 0:M.id,teamPlayers:I,onNavigateBack:D,onManualMatchCreated:U,onMatchUpdated:q,onMatchDeleted:B});switch(h){case hg.TEAM:return(0,Ts.jsx)(Sf,{startDate:w,endDate:k,onMatchSelect:O});case hg.PLAYER:return(0,Ts.jsx)(Gf,{startDate:w,endDate:k});case hg.ATTENDANCE:return(0,Ts.jsx)(mg,{startDate:w,endDate:k,onNavigateTo:r});case hg.HISTORY:return(0,Ts.jsx)(Vf,{onMatchSelect:O,onCreateMatch:L,startDate:w,endDate:k,refreshKey:b});default:return(0,Ts.jsx)(Sf,{startDate:w,endDate:k,onMatchSelect:O})}})()})]})}const fg=["id","x","y","onPointerStart","onDoubleClick","isInPalette","style","className","children"];function gg(t){let{id:a,x:r=0,y:s=0,onPointerStart:i,onDoubleClick:o,isInPalette:l=!1,style:c={},className:d="",children:u}=t,m=he(t,fg);const h=(0,e.useCallback)(e=>{null===i||void 0===i||i(e)},[i]),p=function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;const n=(0,e.useRef)(0),r=(0,e.useRef)(null);return{onDoubleClick:(0,e.useCallback)(()=>{null===t||void 0===t||t()},[t]),onTouchStart:(0,e.useCallback)(e=>{const s=Date.now(),i=s-n.current;i<a&&i>0?(e.preventDefault(),e.stopPropagation(),null===t||void 0===t||t(),n.current=0):(n.current=s,r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{n.current=0},a))},[t,a])}}(o),f="\n    ".concat(l?"relative":"absolute"," \n    cursor-move \n    select-none \n    shadow-lg\n    hover:shadow-xl\n    transition-all\n    duration-200\n    transform\n    hover:scale-105\n  ").trim(),g="".concat(f," ").concat(d).trim(),v=(0,n.A)((0,n.A)({},l?{}:{left:"".concat(r,"%"),top:"".concat(s,"%"),transform:"translate(-50%, -50%)",zIndex:10}),{},{touchAction:"none"},c);return(0,Ts.jsx)("div",(0,n.A)((0,n.A)({id:a,className:g,style:v,onPointerDown:h,onDoubleClick:p.onDoubleClick,onTouchStart:p.onTouchStart},m),{},{children:u}))}const vg={WIDTH:"w-7 h-7 sm:w-8 sm:h-8",BORDER:"border-2",TEXT_SIZE:"text-xs sm:text-sm"},yg={WIDTH:"w-4 h-4 sm:w-5 sm:h-5"},bg="#1e293b",xg=.5,wg={white:"bg-white text-slate-900 border-slate-300",red:"bg-red-500 text-white border-red-600",blue:"bg-blue-500 text-white border-blue-600",yellow:"bg-yellow-500 text-slate-900 border-yellow-600",green:"bg-green-500 text-white border-green-600",orange:"bg-orange-500 text-white border-orange-600",purple:"bg-purple-500 text-white border-purple-600",black:"bg-slate-800 text-white border-slate-700",djurgarden:"bg-sky-400 text-white border-sky-500"},Sg=["djurgarden","white","red","blue","yellow","green","orange","purple","black"],kg=["ball-v1"];function Ng(e){let{id:t,color:a,number:n,x:r,y:s,onPointerStart:i,onDoubleClick:o,isInPalette:l=!1,style:c={}}=e;const d=wg[a]||wg.white,u="djurgarden"===a,m="\n    ".concat(vg.WIDTH,"\n    rounded-full \n    ").concat(vg.BORDER,"\n    ").concat(d,"\n    flex \n    items-center \n    justify-center \n    font-bold \n    ").concat(vg.TEXT_SIZE,"\n    ").concat(u?"overflow-hidden":"","\n  ").trim();return(0,Ts.jsxs)(gg,{id:t,x:r,y:s,onPointerStart:i,onDoubleClick:o,isInPalette:l,style:c,className:m,children:[u&&(0,Ts.jsxs)("div",{className:"absolute inset-0 rounded-full overflow-hidden bg-sky-400",children:[(0,Ts.jsx)("div",{className:"absolute top-0 bottom-0 bg-blue-800",style:{left:"13.5%",width:"16%"}}),(0,Ts.jsx)("div",{className:"absolute top-0 bottom-0 bg-blue-800",style:{left:"42%",width:"16%"}}),(0,Ts.jsx)("div",{className:"absolute top-0 bottom-0 bg-blue-800",style:{left:"70.5%",width:"16%"}})]}),(0,Ts.jsx)("span",{className:"relative z-10 font-bold",children:n})]})}function jg(e){let{id:t,x:a,y:n,variation:r="ball-v1",number:s,onPointerStart:i,onDoubleClick:o,isInPalette:l=!1,style:c={}}=e;const d="\n    ".concat(yg.WIDTH,"\n    rounded-full \n    overflow-hidden\n  ").trim();return(0,Ts.jsxs)(gg,{id:t,x:a,y:n,onPointerStart:i,onDoubleClick:o,isInPalette:l,style:c,className:d,children:[(0,Ts.jsx)("div",{className:"absolute inset-0 bg-white rounded-full",children:"ball-v1"===r&&(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-2 h-2 bg-black",style:{clipPath:"polygon(50% 0%, 95% 35%, 78% 90%, 22% 90%, 5% 35%)"}}),(0,Ts.jsx)("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 w-0.5 h-0.5 bg-black rounded-full"}),(0,Ts.jsx)("div",{className:"absolute bottom-0 left-1/4 w-0.5 h-0.5 bg-black rounded-full"}),(0,Ts.jsx)("div",{className:"absolute bottom-0 right-1/4 w-0.5 h-0.5 bg-black rounded-full"})]})}),l&&s&&(0,Ts.jsx)("span",{className:"absolute -bottom-5 left-1/2 transform -translate-x-1/2 text-sm font-bold text-white bg-slate-900 rounded px-1",children:s})]})}function Tg(t){let{onDragStart:a,isDragging:n,isInteractionDisabled:r=!1}=t;const{t:s}=xe("tactical"),i=(0,e.useCallback)((e,t)=>{if(!a||r)return;a({type:"player",color:e,isNewChip:!0},t)},[a,r]),o=(0,e.useCallback)((e,t)=>{if(!a||r)return;a({type:"ball",variation:e,isNewChip:!0},t)},[a,r]);return(0,Ts.jsxs)("div",{className:"bg-slate-800 rounded-lg p-4 shadow-lg transition-opacity duration-200 ".concat(n?"opacity-90":""," ").concat(r?"opacity-80":""),"aria-disabled":r,children:[(0,Ts.jsxs)("div",{className:"flex flex-wrap gap-3 justify-center items-end",children:[Sg.map(e=>(0,Ts.jsx)(Ng,{id:"palette-".concat(e),color:e,number:1,isInPalette:!0,onPointerStart:r?void 0:t=>i(e,t),style:r?{cursor:"not-allowed"}:void 0},e)),kg.map(e=>(0,Ts.jsx)(jg,{id:"palette-".concat(e),variation:e,isInPalette:!0,onPointerStart:r?void 0:t=>o(e,t),style:r?{cursor:"not-allowed"}:void 0},e))]}),(0,Ts.jsx)("div",{className:"border-t border-slate-700 pt-4 mt-4",children:(0,Ts.jsx)("p",{className:"text-xs text-slate-400 text-center",children:s(r?"palette.drawModeHint":"palette.dragInstruction")})})]})}const Ag=a.p+"static/media/full-field.c9950099811218943f1a.png",_g=a.p+"static/media/half-field.564011ece33866e0126b.png";function Cg(t){let{pitchMode:a,placedChips:r,onChipPlace:s,onChipMove:i,onChipDelete:o,interactionMode:l="drag",drawings:c=[],onAddDrawing:d}=t;const u=(0,e.useRef)(null),m=(0,e.useRef)(null),h=(0,e.useRef)(null),[p,f]=(0,e.useState)(null),[g,v]=(0,e.useState)(!1),y="draw"===l,b=(0,e.useRef)({}),x=(0,e.useCallback)(e=>(b.current[e]||(b.current[e]=1),b.current[e]++),[]),{isDragging:w,ghostChip:S,handlePointerStart:k,isChipBeingDragged:N}=function(t,a,r,s){const[i,o]=(0,e.useState)(null),[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)({x:0,y:0}),[m,h]=(0,e.useState)(null),p=(0,e.useCallback)((e,a)=>{if(a.preventDefault(),o(e),c(!0),t.current){const n=t.current.getBoundingClientRect();if(e.isNewChip){const t=(a.clientX-n.left)/n.width*100,r=(a.clientY-n.top)/n.height*100;h({type:e.type,color:e.color,variation:e.variation,number:"player"===e.type?s(e.color):null,x:Math.max(3,Math.min(97,t)),y:Math.max(3,Math.min(97,r))}),u({x:0,y:0})}else{const t=e.x/100*n.width,r=e.y/100*n.height;u({x:a.clientX-n.left-t,y:a.clientY-n.top-r}),h({type:e.type,color:e.color,variation:e.variation,number:e.number,x:e.x,y:e.y})}}a.target.setPointerCapture&&a.target.setPointerCapture(a.pointerId)},[t,s]),f=(0,e.useCallback)(e=>{if(!l||!i||!t.current||!m)return;e.preventDefault();const a=t.current.getBoundingClientRect();let r,s;i.isNewChip?(r=(e.clientX-a.left)/a.width*100,s=(e.clientY-a.top)/a.height*100):(r=(e.clientX-a.left-d.x)/a.width*100,s=(e.clientY-a.top-d.y)/a.height*100),h(e=>(0,n.A)((0,n.A)({},e),{},{x:Math.max(3,Math.min(97,r)),y:Math.max(3,Math.min(97,s))}))},[l,i,d,m,t]),g=(0,e.useCallback)(e=>{if(l&&i&&t.current&&m){if(e.preventDefault(),i.isNewChip){const e={id:"chip-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),type:m.type,color:m.color,variation:m.variation,number:m.number,x:m.x,y:m.y};a(e)}else r(i.id,{x:m.x,y:m.y});o(null),c(!1),u({x:0,y:0}),h(null)}},[l,i,m,a,r,t]);return(0,e.useEffect)(()=>{if(l)return document.addEventListener("pointermove",f),document.addEventListener("pointerup",g),document.addEventListener("pointercancel",g),()=>{document.removeEventListener("pointermove",f),document.removeEventListener("pointerup",g),document.removeEventListener("pointercancel",g)}},[l,f,g]),{draggedChip:i,isDragging:l,ghostChip:m,handlePointerStart:p,isChipBeingDragged:e=>l&&i&&!i.isNewChip&&i.id===e}}(u,s,i,x),j=(0,e.useCallback)((e,t)=>{y||k(e,t)},[y,k]),T=(0,e.useCallback)(e=>{y||o(e)},[o,y]),A=(0,e.useCallback)(e=>!!y||!N(e),[y,N]),_=(0,e.useCallback)(e=>{var t;const a=m.current?m.current.getBoundingClientRect():null===(t=u.current)||void 0===t?void 0:t.getBoundingClientRect();if(!a||!a.width||!a.height)return null;const n=(e.clientX-a.left)/a.width*100,r=(e.clientY-a.top)/a.height*100;return{x:Math.max(0,Math.min(100,n)),y:Math.max(0,Math.min(100,r))}},[]),C=(0,e.useCallback)(e=>{if(!y)return;e.preventDefault();const t=_(e);if(!t)return;const a={id:"drawing-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,7)),color:bg,width:xg,points:[t]};h.current=a,f(a),v(!0)},[_,y]),M=(0,e.useCallback)(e=>{h.current&&(h.current=(0,n.A)((0,n.A)({},h.current),{},{points:[...h.current.points,e]}),f(h.current))},[]),P=(0,e.useCallback)(()=>{if(!h.current)return v(!1),void f(null);const e=h.current;e.points.length>1&&d&&d(e),h.current=null,f(null),v(!1)},[d]);(0,e.useEffect)(()=>{if(!g)return;const e=e=>{if(!y)return;e.preventDefault();const t=_(e);t&&M(t)},t=()=>{P()};return document.addEventListener("pointermove",e),document.addEventListener("pointerup",t),document.addEventListener("pointercancel",t),()=>{document.removeEventListener("pointermove",e),document.removeEventListener("pointerup",t),document.removeEventListener("pointercancel",t)}},[M,P,_,y,g]),(0,e.useEffect)(()=>{!y&&g&&P()},[y,g,P]);const E=(0,e.useCallback)(e=>{if(!e||!e.points||e.points.length<2)return null;const t=e.points.map(e=>"".concat(e.x,",").concat(e.y)).join(" ");return(0,Ts.jsx)("polyline",{points:t,fill:"none",stroke:e.color||bg,strokeWidth:e.width||xg,strokeLinecap:"round",strokeLinejoin:"round"},e.id)},[]);return(0,Ts.jsxs)("div",{className:"flex flex-col space-y-4 max-w-4xl lg:max-w-6xl xl:max-w-7xl mx-auto",children:[(0,Ts.jsx)("div",{className:"relative w-full bg-slate-800 rounded-lg overflow-hidden shadow-2xl",children:(0,Ts.jsxs)("div",{ref:u,className:"relative w-full",style:{backgroundImage:"url(".concat("full"===a?Ag:_g,")"),backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",touchAction:"none",aspectRatio:"full"===a?"16 / 23":"5 / 4",width:"100%",cursor:y?'url("data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A//www.w3.org/2000/svg%27%20width%3D%2724%27%20height%3D%2724%27%20viewBox%3D%270%200%2024%2024%27%20fill%3D%27none%27%3E%3Cpath%20d%3D%27M4.5%2019.5l1-5.5%209.5-9.5%205%205-9.5%209.5z%27%20fill%3D%27%23facc15%27/%3E%3Cpath%20d%3D%27M14.5%205.5l4%204%27%20stroke%3D%27%230f172a%27%20stroke-width%3D%271.2%27%20stroke-linecap%3D%27round%27/%3E%3C/svg%3E") 2 22, crosshair':"default"},children:[r.map(e=>{const t=!y&&!A(e.id);return"player"===e.type?(0,Ts.jsx)(Ng,{id:e.id,color:e.color,number:e.number,x:e.x,y:e.y,onPointerStart:t=>j(e,t),onDoubleClick:()=>T(e.id),style:{opacity:t?0:1,transition:t?"none":"opacity 0.1s ease",cursor:y?"not-allowed":void 0}},e.id):(0,Ts.jsx)(jg,{id:e.id,x:e.x,y:e.y,variation:e.variation,onPointerStart:t=>j(e,t),onDoubleClick:()=>T(e.id),style:{opacity:t?0:1,transition:t?"none":"opacity 0.1s ease",cursor:y?"not-allowed":void 0}},e.id)}),!y&&S&&(0,Ts.jsx)("div",{className:"absolute pointer-events-none",style:{left:"".concat(S.x,"%"),top:"".concat(S.y,"%"),transform:"translate(-50%, -50%)",zIndex:100,opacity:.7,transition:"opacity 0.1s ease"},children:"player"===S.type?(0,Ts.jsx)(Ng,{id:"ghost-chip",color:S.color,number:S.number,x:0,y:0,isInPalette:!1}):(0,Ts.jsx)(jg,{id:"ghost-chip",x:0,y:0,variation:S.variation,isInPalette:!1})}),(0,Ts.jsx)("div",{ref:m,className:"absolute inset-0 z-30",style:{pointerEvents:y?"auto":"none",touchAction:"none"},onPointerDown:C,children:(0,Ts.jsxs)("svg",{className:"w-full h-full",viewBox:"0 0 100 100",preserveAspectRatio:"none",style:{pointerEvents:"none"},children:[c.map(e=>E(e)),p&&E(p)]})}),(0,Ts.jsx)("div",{className:"absolute bottom-0 right-1 z-20",children:(0,Ts.jsx)("a",{href:"https://www.vecteezy.com/free-vector/football-pitch",target:"_blank",rel:"noopener noreferrer",className:"text-2xs text-green-200 hover:text-green-200 transition-colors duration-200",style:{fontSize:"10px"},children:"Design by Vecteezy"})})]})}),(0,Ts.jsx)(Tg,{onDragStart:j,isDragging:!y&&w,isInteractionDisabled:y})]})}function Mg(t){let{onNavigateBack:a,pushNavigationState:r,removeFromNavigationStack:s,fromView:i}=t;const{t:o}=xe("tactical"),l=(0,e.useMemo)(()=>Bs(Br.TACTICAL_PREFERENCES,{pitchMode:"full",interactionMode:"drag",fullModeChips:[],halfModeChips:[],fullModeDrawings:[],halfModeDrawings:[],fromView:null}),[]),[c,d]=(0,e.useState)("full"),[u,m]=(0,e.useState)([]),[h,p]=(0,e.useState)([]),[f,g]=(0,e.useState)("drag"),v=(0,e.useCallback)(()=>{const e=l.loadState();a(e.fromView)},[a,l]);(0,e.useEffect)(()=>{const e=l.loadState();d(e.pitchMode),g(e.interactionMode||"drag");const t="full"===e.pitchMode?"fullModeChips":"halfModeChips",a="full"===e.pitchMode?"fullModeDrawings":"halfModeDrawings";m(e[t]||[]),p(e[a]||[]),i&&l.saveState((0,n.A)((0,n.A)({},e),{},{fromView:i}))},[l,i]),(0,e.useEffect)(()=>(r&&r(()=>{v()}),()=>{s&&s()}),[r,s,v]);const y=(0,e.useCallback)(e=>{if(e===c)return;const t=l.loadState(),a="full"===c?"fullModeChips":"halfModeChips",r="full"===e?"fullModeChips":"halfModeChips",s="full"===c?"fullModeDrawings":"halfModeDrawings",i="full"===e?"fullModeDrawings":"halfModeDrawings",o=(0,n.A)((0,n.A)({},t),{},{pitchMode:e,[a]:u,[s]:h});l.saveState(o),d(e),m(o[r]||[]),p(o[i]||[])},[c,u,h,l]),b=(0,e.useCallback)(e=>{m(t=>{const a=e(t),r="full"===c?"fullModeChips":"halfModeChips";return l.saveState((0,n.A)((0,n.A)({},l.loadState()),{},{pitchMode:c,[r]:a})),a})},[c,l]),x=(0,e.useCallback)(e=>{p(t=>{const a=e(t),r="full"===c?"fullModeDrawings":"halfModeDrawings";return l.saveState((0,n.A)((0,n.A)({},l.loadState()),{},{pitchMode:c,[r]:a})),a})},[c,l]),w=(0,e.useCallback)(e=>{b(t=>[...t,e])},[b]),S=(0,e.useCallback)((e,t)=>{b(a=>a.map(a=>a.id===e?(0,n.A)((0,n.A)({},a),{},{x:t.x,y:t.y}):a))},[b]),k=(0,e.useCallback)(e=>{b(t=>t.filter(t=>t.id!==e))},[b]),N=(0,e.useCallback)(e=>{x(t=>[...t,e])},[x]),j=(0,e.useCallback)(()=>{x(e=>0===e.length?e:e.slice(0,-1))},[x]),T=(0,e.useCallback)(()=>{m([]);const e="full"===c?"fullModeChips":"halfModeChips";l.saveState((0,n.A)((0,n.A)({},l.loadState()),{},{[e]:[]}))},[c,l]),A=(0,e.useCallback)(()=>{p([]);const e="full"===c?"fullModeDrawings":"halfModeDrawings";l.saveState((0,n.A)((0,n.A)({},l.loadState()),{},{[e]:[]}))},[c,l]),_=(0,e.useCallback)(()=>{A(),"drag"===f&&T()},[f,T,A]),C=(0,e.useCallback)(e=>{e!==f&&(g(e),l.saveState((0,n.A)((0,n.A)({},l.loadState()),{},{interactionMode:e})))},[f,l]),M="draw"===f&&h.length>0,P=o("draw"===f?"controls.clear":"controls.clearAll");return(0,Ts.jsxs)("div",{className:"min-h-screen bg-slate-900 text-slate-100 p-2 sm:p-4",children:[(0,Ts.jsxs)("div",{className:"flex flex-col gap-3 mb-4",children:[(0,Ts.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,Ts.jsx)("div",{className:"flex-1 min-w-[110px] flex justify-start",children:(0,Ts.jsx)("button",{onClick:v,className:"bg-sky-600 hover:bg-sky-500 text-white rounded-lg px-3 py-1 text-sm font-medium transition-colors duration-200 shadow-md",children:o("controls.back")})}),(0,Ts.jsx)("div",{className:"flex-1 min-w-[110px] flex justify-center",children:"draw"===f&&(0,Ts.jsx)("button",{onClick:j,disabled:!M,className:"rounded-lg px-3 py-1 text-sm font-medium transition-colors duration-200 shadow-md ".concat(M?"bg-slate-700 hover:bg-slate-600 text-white":"bg-slate-700/60 text-slate-400 cursor-not-allowed"),children:o("controls.undo")})}),(0,Ts.jsx)("div",{className:"flex-1 min-w-[110px] flex justify-end",children:(0,Ts.jsx)("button",{onClick:_,className:"bg-slate-600 hover:bg-slate-500 text-white rounded-lg px-3 py-1 text-sm font-medium transition-colors duration-200 shadow-md",children:P})})]}),(0,Ts.jsxs)("div",{className:"flex flex-wrap justify-center items-center gap-3",children:[(0,Ts.jsxs)("div",{className:"bg-slate-800 border border-slate-600 rounded-full p-0.5 inline-flex",children:[(0,Ts.jsx)("button",{onClick:()=>C("drag"),className:"px-3 py-1 rounded-full text-xs font-medium transition-colors ".concat("drag"===f?"bg-emerald-500 text-white":"text-slate-400 hover:text-white"),children:o("controls.drag")}),(0,Ts.jsx)("button",{onClick:()=>C("draw"),className:"px-3 py-1 rounded-full text-xs font-medium transition-colors ".concat("draw"===f?"bg-emerald-500 text-white":"text-slate-400 hover:text-white"),children:o("controls.draw")})]}),(0,Ts.jsxs)("div",{className:"bg-slate-800 border border-slate-600 rounded-full p-0.5 inline-flex",children:[(0,Ts.jsx)("button",{onClick:()=>y("full"),className:"px-3 py-1 rounded-full text-xs font-medium transition-colors ".concat("full"===c?"bg-sky-500 text-white":"text-slate-400 hover:text-white"),children:o("controls.full")}),(0,Ts.jsx)("button",{onClick:()=>y("half"),className:"px-3 py-1 rounded-full text-xs font-medium transition-colors ".concat("half"===c?"bg-sky-500 text-white":"text-slate-400 hover:text-white"),children:o("controls.half")})]})]})]}),(0,Ts.jsx)(Cg,{pitchMode:c,placedChips:u,onChipPlace:w,onChipMove:S,onChipDelete:k,interactionMode:f,drawings:h,onAddDrawing:N})]})}const Pg=fc("radio",[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Eg=fc("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),Ig=e=>"number"===typeof(null===e||void 0===e?void 0:e.ordinal)?e.ordinal:null,Rg=e=>"number"===typeof(null===e||void 0===e?void 0:e.timestamp)?e.timestamp:null,Og=e=>"number"===typeof(null===e||void 0===e?void 0:e.occurredAtSeconds)?e.occurredAtSeconds:null,Dg=e=>"number"===typeof(null===e||void 0===e?void 0:e.__sourceIndex)?e.__sourceIndex:1/0,Fg=[wo.MATCH_START,wo.MATCH_END,wo.PERIOD_START,wo.PERIOD_END,wo.INTERMISSION],Lg=[wo.GOAL_SCORED,wo.GOAL_CONCEDED],qg=[wo.SUBSTITUTION,wo.GOALIE_ASSIGNMENT,wo.GOALIE_SWITCH,wo.POSITION_CHANGE,wo.PLAYER_INACTIVATED,wo.PLAYER_ACTIVATED],Ug=Bs(Br.TIMELINE_PREFERENCES,{sortOrder:"asc"});function Bg(t){let{events:a=[],showSubstitutions:n=!1,onEventFilter:r,goalScorers:s={},getPlayerName:i,onGoalClick:o,ownTeamName:l=Ul.OWN_TEAM_NAME,opponentTeam:c="Opponent",matchStartTime:d,filterType:u="all",selectedPlayerId:m=null,availablePlayers:h=[],onPlayerFilterChange:p,debugMode:f=!1,initialSortOrder:g,onSortOrderChange:v}=t;const{t:y}=xe("reports"),[b,x]=(0,e.useState)(()=>{if(g)return g;return Ug.loadState().sortOrder}),[w,S]=(0,e.useState)(new Set);(0,e.useEffect)(()=>{v?v(b):Ug.saveState({sortOrder:b})},[b,v]);const k=(0,e.useMemo)(()=>{let e=[...a];return e=e.filter(e=>!e.undone||e.type===wo.GOAL_CORRECTED),f||(e=e.filter(e=>e.type!==wo.SUBSTITUTION_UNDONE)),m&&(e=e.filter(e=>{const{type:t,data:a}=e,n=a||{};if(Fg.includes(t))return!0;if(Lg.includes(t)){return(s[e.id]||n.scorerId)===m}if(qg.includes(t)){if(t===wo.SUBSTITUTION){const e=n.playersOff||(n.outPlayerId?[n.outPlayerId]:[]),t=n.playersOn||(n.inPlayerId?[n.inPlayerId]:[]);return e.includes(m)||t.includes(m)}if(t===wo.GOALIE_ASSIGNMENT)return n.goalieId===m;if(t===wo.GOALIE_SWITCH){const e=Array.isArray(n.positionChanges)?n.positionChanges:[];return n.oldGoalieId===m||n.newGoalieId===m||e.some(e=>e.playerId===m)}if(t===wo.POSITION_CHANGE){const e=Array.isArray(n.positionChanges)?n.positionChanges:[];return n.player1Id===m||n.player2Id===m||e.some(e=>e.playerId===m)}if(t===wo.PLAYER_INACTIVATED||t===wo.PLAYER_ACTIVATED)return e.playerId===m}return t===wo.FAIR_PLAY_AWARD&&e.playerId===m})),e.sort((e,t)=>function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"asc";const n=Ig(e),r=Ig(t);if(null!==n||null!==r){if(null===n)return"desc"===a?1:-1;if(null===r)return"desc"===a?-1:1;if(n!==r)return"desc"===a?r-n:n-r}const s=Rg(e),i=Rg(t);if(null!==s||null!==i){if(null===s)return"desc"===a?1:-1;if(null===i)return"desc"===a?-1:1;if(s!==i)return"desc"===a?i-s:s-i}const o=Og(e),l=Og(t);if(null!==o||null!==l){if(null===o)return"desc"===a?1:-1;if(null===l)return"desc"===a?-1:1;if(o!==l)return"desc"===a?l-o:o-l}return Dg(e)-Dg(t)}(e,t,b)),e},[a,b,m,s,f]),N=(0,e.useMemo)(()=>{const e={};let t=[],a=null,n=null,r=null;k.forEach(s=>{var i;if(s.type===wo.MATCH_START)return void(a=s);if(s.type===wo.MATCH_END)return void(n=s);if(s.type===wo.FAIR_PLAY_AWARD)return void(r=s);if(s.type===wo.INTERMISSION)return void t.push(s);const o=s.periodNumber||(null===(i=s.data)||void 0===i?void 0:i.periodNumber)||1;e[o]||(e[o]=[]),e[o].push(s)});const s={},i=t.filter(e=>{var t;return"start"===(null===(t=e.data)||void 0===t?void 0:t.intermissionType)}),o=t.filter(e=>{var t;return"end"===(null===(t=e.data)||void 0===t?void 0:t.intermissionType)});return i.forEach(e=>{var t;const a=null===(t=e.data)||void 0===t?void 0:t.followingPeriodNumber;if(a){const t=o.find(e=>{var t;return(null===(t=e.data)||void 0===t?void 0:t.precedingPeriodNumber)===a-1});if(t){const n=t.timestamp-e.timestamp;s[a]={startEvent:e,endEvent:t,duration:n,durationMinutes:Math.floor(n/6e4),durationSeconds:Math.floor(n%6e4/1e3)}}}}),{groups:e,intermissions:s,matchStartEvent:a,matchEndEvent:n,fairPlayAwardEvent:r}},[k]),j=e=>e&&"string"===typeof e?e.replace(/_/g," ").replace(/([A-Z])/g," $1").replace(/\s+/g," ").trim().replace(/\b\w/g,e=>e.toUpperCase()):y("events.unknownPosition"),T=e=>{const{type:t,data:a}=e,n=a||{};switch(t){case wo.MATCH_START:return y("events.matchStarted");case wo.MATCH_END:return y("events.matchEnded");case wo.PERIOD_START:const a=n.periodNumber||e.periodNumber||n.period||e.period||y("events.unknown");return y("events.periodStarted",{period:a});case wo.PERIOD_END:const r=n.periodNumber||e.periodNumber||n.period||e.period||y("events.unknown");return y("events.periodEnded",{period:r});case wo.GOAL_SCORED:const o=n.ownScore,d=n.opponentScore,u=s[e.id]?i&&i(s[e.id])||null:n.scorerId&&i&&i(n.scorerId)||null;if(void 0!==o&&void 0!==d){const e=y("events.goalScoredWithScore",{ownScore:o,opponentScore:d,team:l});return u?"".concat(e," - ").concat(u):e}{const e=u||y("events.unknownScorer");return y("events.goalFor",{team:l,scorer:e})}case wo.GOAL_CONCEDED:const m=n.ownScore,h=n.opponentScore;return void 0!==m&&void 0!==h?y("events.goalScoredWithScore",{ownScore:m,opponentScore:h,team:c}):y("events.goalForTeam",{team:c});case wo.SUBSTITUTION:const p=n.playersOff||(n.outPlayerId?[n.outPlayerId]:[]),f=n.playersOn||(n.inPlayerId?[n.inPlayerId]:[]),g=y("events.unknown"),v=p.map(e=>e&&i&&i(e)||g).filter(e=>e!==g),b=f.map(e=>e&&i&&i(e)||g).filter(e=>e!==g),x=y("events.out"),w=y("events.in"),S=v.length>0?v.join(" & ")+" (".concat(x,")"):"".concat(g," (").concat(x,")"),k=b.length>0?b.join(" & ")+" (".concat(w,")"):"".concat(g," (").concat(w,")");return"".concat(y("events.substitution"),": ").concat(S," \u2192 ").concat(k);case wo.GOALIE_SWITCH:const N=Array.isArray(n.positionChanges)?n.positionChanges:[],T=N.find(e=>"goalie"===(e.oldPosition||"").toLowerCase()),A=N.find(e=>"goalie"===(e.newPosition||"").toLowerCase()),_=N.filter(e=>e!==T&&e!==A),C=e=>(null===e||void 0===e?void 0:e.playerName)||null!==e&&void 0!==e&&e.playerId&&i&&i(e.playerId)||null||null,M=n.oldGoalieName||n.oldGoalieId&&i&&i(n.oldGoalieId)||null||C(T),P=n.newGoalieName||n.newGoalieId&&i&&i(n.newGoalieId)||null||C(A),E=n.newGoaliePreviousPosition||(null===A||void 0===A?void 0:A.oldPosition),I=n.oldGoalieNewPosition||(null===T||void 0===T?void 0:T.newPosition),R=[];if(P||E||A){const e=E?" (".concat(y("events.from")," ").concat(j(E),")"):"";R.push("".concat(y("events.newGoalie"),": ").concat(P||y("events.unknown")).concat(e))}if(M||I||T){const e=I?" \u2192 ".concat(j(I)):" ".concat(y("events.leavesGoal"));R.push("".concat(y("events.oldGoalie"),": ").concat(M||y("events.unknown")).concat(e))}if(_.length>0){const e=_.map(e=>{const t=C(e)||y("events.unknown"),a=j(e.oldPosition),n=j(e.newPosition);return"".concat(t," (").concat(a," \u2192 ").concat(n,")")}).join(" | ");R.push("".concat(y("events.otherSwitches"),": ").concat(e))}if(R.length>0)return R.join(" | ");if(N.length>0){return N.map(e=>{const t=C(e)||y("events.unknown"),a=j(e.oldPosition),n=j(e.newPosition);return"".concat(t," (").concat(a," \u2192 ").concat(n,")")}).join(" | ")}const O=M||y("events.unknown"),D=P||y("events.unknown");return"".concat(y("events.newGoalie"),": ").concat(D," | ").concat(y("events.oldGoalie"),": ").concat(O);case wo.GOALIE_ASSIGNMENT:const F=n.goalieId||e.playerId,L=F&&i&&i(F)||null,q=n.goalieName||n.display_name||L||null;return n.description?n.description:q?y("events.playerIsGoalie",{name:q}):y("events.goalieAssigned");case wo.POSITION_CHANGE:const U=Array.isArray(n.positionChanges)?n.positionChanges:[];if(U.length>0){const e=U.map(e=>{const t=e.playerName||e.playerId&&i&&i(e.playerId)||null||y("events.unknown"),a=j(e.newPosition);return"".concat(t," \u2192 ").concat(a)}).join(" | ");return"".concat(y("events.positionSwitch"),": ").concat(e)}if(n.player1Id&&n.player2Id){const e=n.player1Id&&i&&i(n.player1Id)||y("events.unknown"),t=n.player2Id&&i&&i(n.player2Id)||y("events.unknown");return"".concat(y("events.positionSwitch"),": ").concat(e," \u2194 ").concat(t)}const B=n.display_name||n.player1Id&&i&&i(n.player1Id)||null||e.playerId&&i&&i(e.playerId)||null||n.playerName||y("events.unknown"),G=n.old_position||n.oldPosition,z=n.new_position||n.newPosition;if(z||G){const e=G?"".concat(j(G)," \u2192 ").concat(j(z||y("events.unknown"))):"\u2192 ".concat(j(z||y("events.unknown")));return"".concat(y("events.positionChange"),": ").concat(B," ").concat(e)}return"".concat(y("events.positionChange"),": ").concat(B);case wo.PLAYER_INACTIVATED:const V=n.display_name||n.playerName||e.playerId&&i&&i(e.playerId)||null||y("events.unknown");return y("events.playerInactivated",{name:V});case wo.PLAYER_ACTIVATED:const H=n.display_name||n.playerName||e.playerId&&i&&i(e.playerId)||null||y("events.unknown");return y("events.playerActivated",{name:H});case wo.FAIR_PLAY_AWARD:const K=n.display_name||n.playerName||e.playerId&&i&&i(e.playerId)||null||y("events.unknownPlayer");return"".concat(y("events.fairPlayAward"),": ").concat(K);case wo.TIMER_PAUSED:return y("events.timerPaused");case wo.TIMER_RESUMED:return y("events.timerResumed");case wo.PERIOD_PAUSED:return y("events.periodPaused");case wo.PERIOD_RESUMED:return y("events.periodResumed");case wo.INTERMISSION:return y("events.intermission");case wo.GOAL_CORRECTED:return y("events.goalCorrected");case wo.GOAL_UNDONE:return y("events.goalUndone");case wo.SUBSTITUTION_UNDONE:return y("events.substitutionUndone");case wo.TECHNICAL_TIMEOUT:return y("events.technicalTimeout");default:return"".concat(t.replace(/_/g," "))}},A=e=>e.matchTime||_o(e.timestamp,d),_=e=>{const t=(e=>{switch(e){case wo.MATCH_START:case wo.PERIOD_START:return kc;case wo.MATCH_END:case wo.PERIOD_END:return np;case wo.INTERMISSION:return Sd;case wo.GOAL_SCORED:case wo.GOAL_CONCEDED:return jd;case wo.SUBSTITUTION:case wo.GOALIE_SWITCH:case wo.GOALIE_ASSIGNMENT:return Eg;case wo.TIMER_PAUSED:case wo.PERIOD_PAUSED:return ep;case wo.TIMER_RESUMED:case wo.PERIOD_RESUMED:return kc;case wo.POSITION_CHANGE:return Eg;case wo.GOAL_CORRECTED:return kd;case wo.GOAL_UNDONE:case wo.SUBSTITUTION_UNDONE:return uu;case wo.FAIR_PLAY_AWARD:return kf;case wo.TECHNICAL_TIMEOUT:return bm;default:return Sd}})(e.type),a=function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return"text-slate-500";switch(e){case wo.MATCH_START:case wo.MATCH_END:return"text-sky-400";case wo.PERIOD_START:case wo.PERIOD_END:return"text-blue-400";case wo.INTERMISSION:return"text-slate-400";case wo.GOAL_SCORED:case wo.GOAL_CONCEDED:return"text-yellow-400";case wo.SUBSTITUTION:case wo.POSITION_CHANGE:return"text-cyan-400";case wo.GOALIE_SWITCH:case wo.GOALIE_ASSIGNMENT:return"text-purple-400";case wo.FAIR_PLAY_AWARD:return"text-emerald-300";case wo.TIMER_PAUSED:case wo.PERIOD_PAUSED:return"text-orange-400";case wo.TIMER_RESUMED:case wo.PERIOD_RESUMED:case wo.GOAL_CORRECTED:return"text-green-400";case wo.GOAL_UNDONE:case wo.SUBSTITUTION_UNDONE:return"text-red-400";case wo.TECHNICAL_TIMEOUT:return"text-yellow-400";default:return"text-slate-400"}}(e.type,e.undone),n=function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])return"bg-slate-700/50";switch(e){case wo.GOAL_SCORED:case wo.GOAL_CONCEDED:return"bg-yellow-400/40 border-yellow-400/60";case wo.SUBSTITUTION:case wo.POSITION_CHANGE:return"bg-cyan-900/20 border-cyan-700/30";case wo.GOALIE_SWITCH:case wo.GOALIE_ASSIGNMENT:return"bg-purple-900/20 border-purple-700/30";case wo.FAIR_PLAY_AWARD:return"bg-emerald-800/30 border-emerald-500/60";default:return"bg-slate-700/30 border-slate-600/30"}}(e.type,e.undone),r=(e=>o&&(e.type===wo.GOAL_SCORED||e.type===wo.GOAL_CONCEDED))(e),s=w.has(e.id),i=M(e),l=e.type===wo.GOAL_SCORED||e.type===wo.GOAL_CONCEDED,c=e.type===wo.GOAL_SCORED;return(0,Ts.jsxs)("div",{className:"relative flex items-start",children:[(0,Ts.jsx)("div",{className:"relative z-10 flex items-center justify-center w-12 h-12 rounded-full bg-slate-800 border-2 ".concat(l?"border-yellow-400":a.replace("text-","border-")),children:(0,Ts.jsx)(t,{className:"h-5 w-5 ".concat(a)})}),(0,Ts.jsx)("div",{className:"ml-4 flex-1",children:(0,Ts.jsxs)("div",{className:"rounded-lg border p-4 ".concat(n," ").concat(r?"cursor-pointer hover:bg-opacity-80 transition-colors":""," ").concat(e.undone?"opacity-60":""," ").concat(c?"shadow-lg shadow-yellow-400/30":""),onClick:()=>(e=>{!o||e.type!==wo.GOAL_SCORED&&e.type!==wo.GOAL_CONCEDED||o(e)})(e),children:[(0,Ts.jsxs)("div",{className:"flex items-start justify-between",children:[(0,Ts.jsxs)("div",{className:"flex-1",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)("span",{className:"text-sm font-mono text-slate-400",children:A(e)}),e.undone&&(0,Ts.jsx)("span",{className:"text-xs bg-red-900/50 text-red-200 px-2 py-1 rounded",children:y("events.undone")})]}),(0,Ts.jsx)("p",{className:"".concat(l?"text-base font-bold":"text-sm font-medium"," mt-1 ").concat(e.undone?"line-through text-slate-500":"text-slate-200"),children:T(e)}),r&&(0,Ts.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:y("events.clickToEditScorer")})]}),i.length>0&&(0,Ts.jsx)("button",{onClick:t=>{t.stopPropagation(),(e=>{const t=new Set(w);t.has(e)?t.delete(e):t.add(e),S(t)})(e.id)},className:"ml-2 text-slate-400 hover:text-slate-300 transition-colors",children:s?(0,Ts.jsx)($u,{className:"h-4 w-4"}):(0,Ts.jsx)(jc,{className:"h-4 w-4"})})]}),s&&i.length>0&&(0,Ts.jsx)("div",{className:"mt-3 pt-3 border-t border-slate-600/50",children:(0,Ts.jsx)("dl",{className:"space-y-1",children:i.map((e,t)=>(0,Ts.jsx)("dd",{className:"text-xs text-slate-400",children:e},t))})})]})})]},e.id)},C=e=>{const t=e.durationMinutes,a=e.durationSeconds;return(0,Ts.jsx)("div",{className:"py-8 flex justify-center",children:(0,Ts.jsx)("div",{className:"bg-slate-700/50 rounded-lg px-6 py-4 border border-slate-600/50",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ts.jsx)(Sd,{className:"h-5 w-5 text-slate-400"}),(0,Ts.jsxs)("div",{className:"text-center",children:[(0,Ts.jsx)("p",{className:"text-sm font-medium text-slate-300",children:y("events.intermission")}),(0,Ts.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:t>0?"".concat(t,":").concat(a.toString().padStart(2,"0")):"".concat(a,"s")})]})]})})},"intermission-".concat(e.startEvent.id))},M=e=>{const{data:t}=e,a=t||{},n=[];if(e.periodNumber&&e.type!==wo.MATCH_END&&e.type!==wo.FAIR_PLAY_AWARD&&n.push("".concat(y("details.period"),": ").concat(e.periodNumber)),void 0!==a.ownScore&&void 0!==a.opponentScore&&n.push("".concat(y("details.score"),": ").concat(a.ownScore," - ").concat(a.opponentScore)),e.type===wo.FAIR_PLAY_AWARD){const t=a.display_name||a.playerName||e.playerId&&i&&i(e.playerId)||null||null;t&&n.push("".concat(y("details.awardedTo"),": ").concat(t))}e.undone&&(n.push("".concat(y("details.undone"),": ").concat(e.undoReason||y("details.userAction"))),e.undoTimestamp&&n.push("".concat(y("details.undoneAt"),": ").concat(_o(e.undoTimestamp,d)))),e.relatedEventId&&n.push("".concat(y("details.relatedTo"),": ").concat(e.relatedEventId));const r=Array.isArray(a.positionChanges)?a.positionChanges:[];r.length>0&&(n.push("".concat(y("details.positionChanges"),":")),r.forEach(e=>{const t=e.playerName||e.playerId&&i&&i(e.playerId)||null||y("events.unknown"),a=j(e.oldPosition),r=j(e.newPosition);n.push("- ".concat(t,": ").concat(a," \u2192 ").concat(r))}));const s=Array.isArray(a.startingLineup)?a.startingLineup:[];return s.length>0&&(n.push("".concat(y("details.startingPositions"),":")),s.forEach(e=>{const t=j(e.position),a=e.name||y("events.unknown");n.push("- ".concat(t,": ").concat(a))})),n},P=e=>(0,Ts.jsx)("div",{className:"space-y-4",children:(0,Ts.jsxs)("div",{className:"relative",children:[(0,Ts.jsx)("div",{className:"absolute left-6 top-0 bottom-0 w-0.5 bg-slate-600"}),(0,Ts.jsx)("div",{className:"space-y-4",children:_(e)})]})});return a&&0!==a.length?(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Ts.jsx)("span",{className:"text-sm text-slate-400",children:y("controls.eventCount",{count:k.length})}),h.length>0&&p&&(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsxs)("label",{className:"text-xs text-slate-400",children:[y("controls.player"),":"]}),(0,Ts.jsxs)("select",{value:m||"",onChange:e=>p(e.target.value||null),className:"text-xs bg-slate-700 border border-slate-600 rounded px-2 py-1 text-slate-300 hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-sky-500",children:[(0,Ts.jsx)("option",{value:"",children:y("controls.allPlayers")}),h.map(e=>(0,Ts.jsx)("option",{value:e.id,children:Kl(e)},e.id))]})]})]}),(0,Ts.jsxs)("button",{onClick:()=>x(e=>"desc"===e?"asc":"desc"),className:"flex items-center space-x-1 text-sm text-slate-400 hover:text-slate-300 transition-colors",children:[(0,Ts.jsx)("span",{children:y("desc"===b?"controls.newestFirst":"controls.oldestFirst")}),"desc"===b?(0,Ts.jsx)(jc,{className:"h-4 w-4"}):(0,Ts.jsx)($u,{className:"h-4 w-4"})]})]}),(0,Ts.jsxs)("div",{className:"space-y-6",children:["desc"===b&&(0,Ts.jsxs)(Ts.Fragment,{children:[N.fairPlayAwardEvent&&P(N.fairPlayAwardEvent),N.matchEndEvent&&P(N.matchEndEvent)]}),"asc"===b&&N.matchStartEvent&&P(N.matchStartEvent),Object.keys(N.groups).sort((e,t)=>"desc"===b?t-e:e-t).map(e=>{const t=N.groups[e],a=parseInt(e)+1,n=N.intermissions[a],r=e>1||1===e&&!N.matchStartEvent?(0,Ts.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,Ts.jsx)("div",{className:"h-px bg-slate-600 flex-1"}),(0,Ts.jsx)("h3",{className:"text-sm font-medium text-slate-300 px-3",children:y("controls.periodLabel",{period:e})}),(0,Ts.jsx)("div",{className:"h-px bg-slate-600 flex-1"})]}):null;return(0,Ts.jsxs)("div",{className:"space-y-4",children:["asc"===b&&r,(0,Ts.jsxs)("div",{className:"relative",children:[(0,Ts.jsx)("div",{className:"absolute left-6 top-0 bottom-0 w-0.5 bg-slate-600"}),(0,Ts.jsx)("div",{className:"space-y-4",children:t.map(e=>_(e))})]}),"desc"===b&&r,n&&C(n)]},"period-".concat(e))}),"asc"===b&&(0,Ts.jsxs)(Ts.Fragment,{children:[N.matchEndEvent&&P(N.matchEndEvent),N.fairPlayAwardEvent&&P(N.fairPlayAwardEvent)]}),"desc"===b&&N.matchStartEvent&&P(N.matchStartEvent)]})]}):(0,Ts.jsx)(Yd,{icon:Sd,title:y("timeline.noEvents")})}function Gg(e){let{icon:t,title:a,children:n,headerExtra:r=null,className:s=""}=e;return(0,Ts.jsxs)("section",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700 ".concat(s).trim(),children:[(0,Ts.jsxs)("div",{className:"flex items-center mb-4 ".concat(r?"justify-between":""),children:[(0,Ts.jsxs)("div",{className:"flex items-center",children:[t&&(0,Ts.jsx)(t,{className:"h-5 w-5 text-sky-400 mr-2"}),(0,Ts.jsx)("h2",{className:"text-xl font-semibold text-sky-300",children:a})]}),r&&(0,Ts.jsx)("div",{className:"flex items-center",children:r})]}),n]})}function zg(e){let{isVisible:t=!1,onToggle:a,label:n,className:r=""}=e;const{t:s}=xe("reports"),i=n||s("timeline.toggleSubstitutions");return(0,Ts.jsxs)("button",{onClick:a,className:"flex items-center space-x-1 text-xs px-2 py-1 rounded transition-colors ".concat(t?"bg-sky-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"," ").concat(r).trim(),children:[t?(0,Ts.jsx)(hd,{className:"h-3 w-3"}):(0,Ts.jsx)(pd,{className:"h-3 w-3"}),(0,Ts.jsx)("span",{children:i})]})}function Vg(e){let{onNavigateBack:t,className:a=""}=e;const{t:n}=xe("navigation");return t?(0,Ts.jsx)("div",{className:"flex flex-wrap gap-2 mb-4 ".concat(a).trim(),children:(0,Ts.jsx)(Lc,{onClick:()=>t(),variant:"secondary",Icon:Uh,size:"sm","data-testid":"button-back",children:n("back")})}):null}const Hg={match_started:"match_start",match_ended:"match_end",period_started:"period_start",period_ended:"period_end",goal_scored:"goal_scored",goal_conceded:"goal_conceded",substitution_in:"substitution",substitution_out:"substitution",substitution:"substitution",goalie_enters:"goalie_assignment",goalie_exits:"goalie_switch",goalie_switch:"goalie_switch",position_switch:"position_change",position_switch_group:"position_change",player_inactivated:"player_inactivated",player_activated:"player_activated",player_reactivated:"player_activated",fair_play_award:"fair_play_award"},Kg=e=>{if(null===e||void 0===e||!e.created_at)return null;const t=Date.parse(e.created_at);return Number.isFinite(t)?t:null},Wg=e=>"number"===typeof(null===e||void 0===e?void 0:e.ordinal)?e.ordinal:null,Yg=(e,t)=>{const a=Wg(e),n=Wg(t);if(null!==a&&null!==n&&a!==n)return a-n;if(null!==a&&null===n)return-1;if(null===a&&null!==n)return 1;const r=Kg(e),s=Kg(t);if(null!==r&&null!==s&&r!==s)return r-s;if(null!==r&&null===s)return-1;if(null===r&&null!==s)return 1;const i="number"===typeof(null===e||void 0===e?void 0:e.occurred_at_seconds)?e.occurred_at_seconds:null,o="number"===typeof(null===t||void 0===t?void 0:t.occurred_at_seconds)?t.occurred_at_seconds:null;if(null!==i&&null!==o&&i!==o)return i-o;if(null!==i&&null===o)return-1;if(null===i&&null!==o)return 1;return("number"===typeof(null===e||void 0===e?void 0:e.__sourceIndex)?e.__sourceIndex:1/0)-("number"===typeof(null===t||void 0===t?void 0:t.__sourceIndex)?t.__sourceIndex:1/0)},Jg=e=>{const t=(null===e||void 0===e?void 0:e.data)||{};return t.display_name||t.playerName||t.scorerName||t.goalieName||t.previousGoalieName||null};function Qg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],{playerNameMap:t=new Map}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||0===e.length)return[];const a=new Map,r=new Map,s=[];return e.forEach((e,t)=>{const i="substitution_in"===e.event_type,o="substitution_out"===e.event_type,l=e.correlation_id,c="position_switch"===e.event_type,d="goalie_enters"===e.event_type,u="goalie_exits"===e.event_type;if((i||o)&&l){let r=a.get(l);r||(r={correlationId:l,created_at:e.created_at,occurred_at_seconds:e.occurred_at_seconds,ordinal:e.ordinal,period:e.period,data:e.data?(0,n.A)({},e.data):{},playersOn:[],playersOff:[],playersOnNames:[],playersOffNames:[],sourceIndices:[]},a.set(l,r)),r.sourceIndices.push(t);const s=e.player_id,c=Jg(e);return i&&s&&!r.playersOn.includes(s)&&(r.playersOn.push(s),c&&r.playersOnNames.push(c)),o&&s&&!r.playersOff.includes(s)&&(r.playersOff.push(s),c&&r.playersOffNames.push(c)),e.created_at&&(!r.created_at||Date.parse(e.created_at)<Date.parse(r.created_at))&&(r.created_at=e.created_at),"number"===typeof e.occurred_at_seconds&&(void 0===r.occurred_at_seconds||e.occurred_at_seconds<r.occurred_at_seconds)&&(r.occurred_at_seconds=e.occurred_at_seconds),"number"===typeof e.ordinal&&(r.ordinal="number"===typeof r.ordinal?Math.min(r.ordinal,e.ordinal):e.ordinal),void(!r.period&&e.period&&(r.period=e.period))}if(l&&(c||d||u)){let a=r.get(l);return a||(a={correlationId:l,created_at:e.created_at,occurred_at_seconds:e.occurred_at_seconds,ordinal:e.ordinal,period:e.period,events:[],sourceIndices:[]},r.set(l,a)),a.sourceIndices.push(t),a.events.push(e),e.created_at&&(!a.created_at||Date.parse(e.created_at)<Date.parse(a.created_at))&&(a.created_at=e.created_at),"number"===typeof e.occurred_at_seconds&&(void 0===a.occurred_at_seconds||e.occurred_at_seconds<a.occurred_at_seconds)&&(a.occurred_at_seconds=e.occurred_at_seconds),"number"===typeof e.ordinal&&(a.ordinal="number"===typeof a.ordinal?Math.min(a.ordinal,e.ordinal):e.ordinal),void(!a.period&&e.period&&(a.period=e.period))}s.push((0,n.A)((0,n.A)({},e),{},{__sourceIndex:t}))}),a.forEach(e=>{const t=e.sourceIndices.length?Math.min(...e.sourceIndices):void 0;s.push({id:e.correlationId?"sub-".concat(e.correlationId):void 0,event_type:"substitution",correlation_id:e.correlationId,created_at:e.created_at,occurred_at_seconds:e.occurred_at_seconds,ordinal:e.ordinal,period:e.period,data:(0,n.A)((0,n.A)((0,n.A)({},e.data),{},{playersOff:e.playersOff,playersOn:e.playersOn},e.playersOffNames.length?{playersOffNames:e.playersOffNames}:{}),e.playersOnNames.length?{playersOnNames:e.playersOnNames}:{}),__sourceIndex:t})}),r.forEach(e=>{const a=e.sourceIndices.length?Math.min(...e.sourceIndices):void 0;s.push((0,n.A)((0,n.A)({},((e,t)=>{var a,r,s;const i=[];let o=null,l=null;e.events.forEach(e=>{var t,a,n,r;"position_switch"===e.event_type?i.push({playerId:e.player_id,playerName:Jg(e),oldPosition:(null===(t=e.data)||void 0===t?void 0:t.old_position)||(null===(a=e.data)||void 0===a?void 0:a.oldPosition)||null,newPosition:(null===(n=e.data)||void 0===n?void 0:n.new_position)||(null===(r=e.data)||void 0===r?void 0:r.newPosition)||null}):"goalie_enters"===e.event_type?o=e:"goalie_exits"===e.event_type&&(l=e)});const c=Boolean(l)||i.some(e=>"goalie"===(e.oldPosition||"").toLowerCase()||"goalie"===(e.newPosition||"").toLowerCase()),d=Boolean(o||l)||i.some(e=>"goalie"===(e.oldPosition||"").toLowerCase()||"goalie"===(e.newPosition||"").toLowerCase()),u=(null===(a=o)||void 0===a?void 0:a.player_id)||(null===(r=i.find(e=>"goalie"===(e.newPosition||"").toLowerCase()))||void 0===r?void 0:r.playerId)||null,m=i.find(e=>"goalie"===(e.oldPosition||"").toLowerCase()),h=i.find(e=>"goalie"===(e.newPosition||"").toLowerCase()),p=(null===m||void 0===m?void 0:m.playerId)||(null===(s=l)||void 0===s?void 0:s.player_id)||null,f=o?Jg(o):h?h.playerName:null,g=l?Jg(l):m?m.playerName:null,v=(null===m||void 0===m?void 0:m.newPosition)||null,y=(null===h||void 0===h?void 0:h.oldPosition)||null;var b;return c||l||m||!d||i.length?{id:e.correlationId?"pos-".concat(e.correlationId):void 0,event_type:c?"goalie_switch":"position_switch_group",correlation_id:e.correlationId,created_at:e.created_at||(new Date).toISOString(),occurred_at_seconds:"number"===typeof e.occurred_at_seconds?e.occurred_at_seconds:0,ordinal:e.ordinal,period:e.period,data:(0,n.A)((0,n.A)((0,n.A)((0,n.A)((0,n.A)((0,n.A)({positionChanges:i},p?{oldGoalieId:p}:{}),u?{newGoalieId:u}:{}),g?{oldGoalieName:g}:{}),f?{newGoalieName:f}:{}),v?{oldGoalieNewPosition:v}:{}),y?{newGoaliePreviousPosition:y}:{})}:{id:e.correlationId?"pos-".concat(e.correlationId):void 0,event_type:"goalie_enters",correlation_id:e.correlationId,created_at:e.created_at||(new Date).toISOString(),occurred_at_seconds:"number"===typeof e.occurred_at_seconds?e.occurred_at_seconds:0,ordinal:e.ordinal,period:e.period,data:(0,n.A)((0,n.A)({},(null===(b=o)||void 0===b?void 0:b.data)||{}),{},{goalieId:u,goalieName:f||(u?t.get(u):null)})}})(e,t)),{},{__sourceIndex:a}))}),function(){return[...arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]].sort(Yg)}(s)}const $g=e=>{const t=Math.floor(e/60),a=e%60;return"".concat(t,":").concat(a.toString().padStart(2,"0"))},Xg=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();if(!Array.isArray(e)||0===e.length)return[];const n=[...e].sort((e,t)=>{const a=Kg(e),n=Kg(t);if(null!==a&&null!==n&&a!==n)return a-n;return("number"===typeof(null===e||void 0===e?void 0:e.ordinal)?e.ordinal:0)-("number"===typeof(null===t||void 0===t?void 0:t.ordinal)?t.ordinal:0)}),r=[];let s=null,i=null;if(n.forEach(e=>{const t=Kg(e);var a;Number.isFinite(t)&&(i=t,"match_started"!==e.event_type&&"period_started"!==e.event_type||null!==s?"period_ended"!==e.event_type&&"match_ended"!==e.event_type||(a=t,null!==s&&Number.isFinite(a)&&(a>s&&r.push({start:s,end:a}),s=null)):s=t)}),null!==s){const e=t?a:i;Number.isFinite(e)&&e>s&&r.push({start:s,end:e})}return r};const Zg=Bs(Br.TIMELINE_PREFERENCES,{sortOrder:"asc",showSubstitutions:!0}),ev=Bs(Br.TIMELINE_PREFERENCES_LIVE,{sortOrder:"desc",showSubstitutions:!0});function tv(t){let{matchId:a,showBackButton:r=!1,onNavigateBack:s=null}=t;const{t:i}=xe("live"),{currentTeam:o}=vi(),[l,c]=(0,e.useState)(null),[d,u]=(0,e.useState)({enabled:!1,intervalMs:6e4}),m=(0,e.useRef)(null),h=(0,e.useCallback)(()=>m.current?Zg:ev,[]),[p,f]=(0,e.useState)(()=>{var e;return null===(e=ev.loadState().showSubstitutions)||void 0===e||e}),[g,v]=(0,e.useState)(null),{events:y,isLoading:b,error:x,lastUpdateTime:w}=pl(a,{pollingEnabled:d.enabled,refreshIntervalMs:d.intervalMs}),S=(0,e.useCallback)(()=>r&&s?(0,Ts.jsx)("div",{className:"mb-4",children:(0,Ts.jsx)(Vg,{onNavigateBack:s})}):null,[s,r]),k=(0,e.useMemo)(()=>function(){var e,t,a,n,r,s,i,o,l,c,d,u,m;let h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!h||0===h.length)return null;const p=h.find(e=>"match_started"===e.event_type),f=h.find(e=>"match_created"===e.event_type),g=h.find(e=>"match_ended"===e.event_type),v=h.filter(e=>"period_started"===e.event_type),y=h.filter(e=>"goal_scored"===e.event_type),b=h.filter(e=>"goal_conceded"===e.event_type),x=!!p,w=p||f,S=(null===w||void 0===w||null===(e=w.data)||void 0===e?void 0:e.ownTeamName)||"Own Team",k=(null===w||void 0===w||null===(t=w.data)||void 0===t?void 0:t.opponentTeamName)||(null===p||void 0===p||null===(a=p.data)||void 0===a?void 0:a.opponentTeam)||(null===p||void 0===p||null===(n=p.data)||void 0===n?void 0:n.opponentName)||"Opponent",N=y.length,j=b.length,T=v.length,A=p?new Date(p.created_at).getTime():null,_=g?new Date(g.created_at).getTime():null;return{ownTeamName:S,opponentName:k,ownScore:N,opponentScore:j,currentPeriod:T,matchStartTime:A,matchEndTime:_,isLive:!g,matchHasStarted:x,totalPeriods:(null===w||void 0===w||null===(r=w.data)||void 0===r?void 0:r.totalPeriods)||(null===p||void 0===p||null===(s=p.data)||void 0===s?void 0:s.numPeriods)||(null===p||void 0===p||null===(i=p.data)||void 0===i||null===(o=i.matchMetadata)||void 0===o?void 0:o.plannedPeriods)||(null===g||void 0===g||null===(l=g.data)||void 0===l?void 0:l.totalPeriods)||T,periodDurationMinutes:(null===w||void 0===w||null===(c=w.data)||void 0===c?void 0:c.periodDurationMinutes)||(null===g||void 0===g||null===(d=g.data)||void 0===d||null===(u=d.matchMetadata)||void 0===u?void 0:u.plannedDurationMinutes)||15,matchDurationSeconds:(null===g||void 0===g||null===(m=g.data)||void 0===m?void 0:m.matchDurationSeconds)||(A&&_?Math.max(0,Math.round((_-A)/1e3)):0)}}(y),[y]),N=Boolean((null===k||void 0===k?void 0:k.matchHasStarted)&&!(null!==k&&void 0!==k&&k.isLive));(0,e.useEffect)(()=>{var e;if(null!==m.current)return;if(!k)return;m.current=Boolean(k.matchHasStarted&&!k.isLive);const t=m.current?Zg.loadState():ev.loadState();v(t.sortOrder),f(null===(e=t.showSubstitutions)||void 0===e||e)},[k]);const j=(0,e.useCallback)(e=>{v(e);const t=h();t.saveState((0,n.A)((0,n.A)({},t.loadState()),{},{sortOrder:e}))},[h]);(0,e.useEffect)(()=>{const e=Boolean(null===k||void 0===k?void 0:k.isLive),t={enabled:e||N,intervalMs:e?3e4:N?3e5:6e4};u(e=>e.enabled===t.enabled&&e.intervalMs===t.intervalMs?e:t)},[null===k||void 0===k?void 0:k.isLive,N]),(0,e.useEffect)(()=>{const e=h();e.saveState((0,n.A)((0,n.A)({},e.loadState()),{},{showSubstitutions:p}))},[p,h]);const T=(0,e.useMemo)(()=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();const n=Xg(e,t,a);if(!n.length)return 0;const r=n.reduce((e,t)=>Number.isFinite(null===t||void 0===t?void 0:t.start)&&Number.isFinite(null===t||void 0===t?void 0:t.end)?e+Math.max(0,t.end-t.start):e,0);return Math.max(0,Math.floor(r/1e3))}(y,null===k||void 0===k?void 0:k.isLive),[y,null===k||void 0===k?void 0:k.isLive]),A=(0,e.useMemo)(()=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();const n=Xg(e,t,a);return e=>{if(!Number.isFinite(e)||0===n.length)return null;let r=0;return n.forEach(n=>{let{start:s,end:i}=n;if(!Number.isFinite(s))return;const o=Number.isFinite(i)?i:t?a:e;if(e<=s)return;const l=Math.min(e,o);l>s&&(r+=l-s)}),Math.max(0,Math.floor(r/1e3))}}(y,null===k||void 0===k?void 0:k.isLive),[y,null===k||void 0===k?void 0:k.isLive]),_=(0,e.useMemo)(()=>null!==k&&void 0!==k&&k.isLive?(e=>{if(!Number.isFinite(e)||e<0)return"1'";const t=Math.floor(e/60)+1;return"".concat(Math.max(1,t),"'")})(T):null,[T,null===k||void 0===k?void 0:k.isLive]),C=(0,e.useMemo)(()=>!l||null!==k&&void 0!==k&&k.matchHasStarted?null:l.match_date&&l.match_time?{date:l.match_date,time:l.match_time,venue:l.venue}:null,[l,null===k||void 0===k?void 0:k.matchHasStarted]),M=(0,e.useMemo)(()=>{if(!y||0===y.length||null===k||void 0===k||!k.currentPeriod)return 0;const e=y.filter(e=>"period_started"===e.event_type).sort((e,t)=>(t.ordinal||0)-(e.ordinal||0));if(0===e.length)return 0;const t=e[0],a=new Date(t.created_at).getTime(),n=Date.now(),r=Math.floor((n-a)/1e3);return Math.floor(r/60)+1},[y,null===k||void 0===k?void 0:k.currentPeriod]);(0,e.useEffect)(()=>{null!==k&&void 0!==k&&k.matchHasStarted||null===k||void 0===k||!k.opponentName||null===o||void 0===o||!o.id||async function(e,t){if(!e||!t)return null;try{const a=t.trim().toLowerCase(),n=(new Date).toISOString().split("T")[0],{data:r,error:s}=await Ur.from("upcoming_match").select("\n        *,\n        connector!inner (\n          team_id\n        )\n      ").eq("connector.team_id",e).gte("match_date",n).order("match_date",{ascending:!0});if(s)throw s;return r&&0!==r.length&&r.find(e=>e.opponent.trim().toLowerCase()===a)||null}catch(x){return console.error("Error finding upcoming match:",x),null}}(o.id,k.opponentName).then(e=>c(e)).catch(e=>console.error("Failed to fetch upcoming match:",e))},[null===k||void 0===k?void 0:k.matchHasStarted,null===k||void 0===k?void 0:k.opponentName,null===o||void 0===o?void 0:o.id]);const P=(0,e.useMemo)(()=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=new Map,a=(e,a)=>{e&&a&&!t.has(e)&&t.set(e,a)};return e.forEach(e=>{const t=(null===e||void 0===e?void 0:e.data)||{},n=t.display_name||t.playerName||t.scorerName||t.goalieName||t.previousGoalieName;e.player_id&&a(e.player_id,n),t.playerNameMap&&"object"===typeof t.playerNameMap&&Object.entries(t.playerNameMap).forEach(e=>{let[t,n]=e;return a(t,n)}),Array.isArray(t.playersOff)&&t.playersOff.forEach((e,r)=>{var s;return a(e,(null===(s=t.playersOffNames)||void 0===s?void 0:s[r])||n)}),Array.isArray(t.playersOn)&&t.playersOn.forEach((e,r)=>{var s;return a(e,(null===(s=t.playersOnNames)||void 0===s?void 0:s[r])||n)}),t.sourcePlayerId&&a(t.sourcePlayerId,t.sourcePlayerName),t.targetPlayerId&&a(t.targetPlayerId,t.targetPlayerName),t.swapPlayerId&&a(t.swapPlayerId,t.swapPlayerName),t.goalieId&&a(t.goalieId,t.goalieName||n),(t.previousGoalieId||t.oldGoalieId)&&a(t.previousGoalieId||t.oldGoalieId,t.previousGoalieName||n)}),t}(y),[y]),E=(0,e.useMemo)(()=>Qg(y,{playerNameMap:P}),[y,P]),I=(0,e.useMemo)(()=>{const e={};return y.forEach(t=>{"goal_scored"!==t.event_type&&"goal_conceded"!==t.event_type||!t.player_id||(e[t.id]=t.player_id)}),e},[y]),R=(0,e.useCallback)(e=>e&&P.get(e)||null,[P]),O=(0,e.useMemo)(()=>E.filter(e=>Object.prototype.hasOwnProperty.call(Hg,e.event_type)).map(e=>{const t=(0,n.A)({},e.data||{}),a=Kg(e),r=A(a),s=Number.isFinite(r)?r:Number.isFinite(e.occurred_at_seconds)?e.occurred_at_seconds:null;if("substitution"===e.event_type&&(t.playersOff=Array.isArray(t.playersOff)?t.playersOff:[],t.playersOn=Array.isArray(t.playersOn)?t.playersOn:[],!t.playersOffNames&&t.playersOff.length>0&&(t.playersOffNames=t.playersOff.map(e=>P.get(e)).filter(Boolean)),!t.playersOnNames&&t.playersOn.length>0&&(t.playersOnNames=t.playersOn.map(e=>P.get(e)).filter(Boolean))),"goalie_enters"===e.event_type&&(t.goalieId=t.goalieId||e.player_id,t.goalieName=t.goalieName||t.display_name||(e.player_id?P.get(e.player_id):null)),"position_switch"===e.event_type){if(!t.display_name&&e.player_id){const a=P.get(e.player_id);a&&(t.display_name=a)}!t.player1Id&&e.player_id&&(t.player1Id=e.player_id)}if("substitution_out"===e.event_type&&e.player_id&&(t.playersOff=t.playersOff||[e.player_id],!t.playersOffNames)){const a=P.get(e.player_id);a&&(t.playersOffNames=[a])}if("substitution_in"===e.event_type&&e.player_id&&(t.playersOn=t.playersOn||[e.player_id],!t.playersOnNames)){const a=P.get(e.player_id);a&&(t.playersOnNames=[a])}if(Array.isArray(t.positionChanges)&&(t.positionChanges=t.positionChanges.map(e=>{const t=e.playerName||(e.playerId?P.get(e.playerId):null);return(0,n.A)((0,n.A)({},e),{},{playerName:t})})),"goalie_switch"===e.event_type){if(!t.oldGoalieName&&t.oldGoalieId){const e=P.get(t.oldGoalieId);e&&(t.oldGoalieName=e)}if(!t.newGoalieName&&t.newGoalieId){const e=P.get(t.newGoalieId);e&&(t.newGoalieName=e)}if(!t.oldGoalieNewPosition&&Array.isArray(t.positionChanges)){const e=t.positionChanges.find(e=>"goalie"===(e.oldPosition||"").toLowerCase());null!==e&&void 0!==e&&e.newPosition&&(t.oldGoalieNewPosition=e.newPosition)}if(!t.newGoaliePreviousPosition&&Array.isArray(t.positionChanges)){const e=t.positionChanges.find(e=>"goalie"===(e.newPosition||"").toLowerCase());null!==e&&void 0!==e&&e.oldPosition&&(t.newGoaliePreviousPosition=e.oldPosition)}}const i=t.display_name||(e.player_id?P.get(e.player_id):null);return i&&!t.display_name&&(t.display_name=i),{id:e.id,type:(o=e.event_type,Hg[o]||o),ordinal:"number"===typeof e.ordinal?e.ordinal:null,timestamp:a,occurredAtSeconds:s,matchTime:Number.isFinite(s)?$g(s):"00:00",periodNumber:e.period,data:(0,n.A)((0,n.A)({},t),{},{playerId:e.player_id,scorerId:e.player_id,ownScore:t.ownScore,opponentScore:t.opponentScore}),playerId:e.player_id,__sourceIndex:e.__sourceIndex};var o}),[E,P,A]),D=(0,e.useMemo)(()=>p?O:O.filter(e=>{const t=e.type;return"match_start"===t||"match_end"===t||"period_start"===t||"period_end"===t||"goal_scored"===t||"goal_conceded"===t||"fair_play_award"===t||"substitution"!==t&&"goalie_assignment"!==t&&"goalie_switch"!==t&&"position_change"!==t&&"player_inactivated"!==t&&"player_activated"!==t}),[O,p]);return b&&0===y.length?(0,Ts.jsxs)("div",{className:"min-h-screen bg-slate-900 text-slate-100",children:[(0,Ts.jsx)("div",{className:"container mx-auto px-4 py-8 max-w-2xl",children:S()}),(0,Ts.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,Ts.jsx)(Wd,{message:i("info.loadingEvents")})})]}):x&&0===y.length?(0,Ts.jsx)("div",{className:"min-h-screen bg-slate-900 text-slate-100",children:(0,Ts.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-2xl",children:[S(),(0,Ts.jsxs)(Jc,{variant:"error",icon:bm,children:[(0,Ts.jsx)("h2",{className:"text-xl font-bold text-red-300 mb-2",children:i("info.errorLoadingMatch")}),(0,Ts.jsx)("p",{className:"text-red-200",children:x})]})]})}):k?(0,Ts.jsx)("div",{className:"min-h-screen bg-slate-900 text-slate-100",children:(0,Ts.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-2xl md:max-w-4xl lg:max-w-5xl",children:[S(),(0,Ts.jsxs)("div",{className:"mb-6",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,Ts.jsx)("div",{className:"flex items-center",children:k.matchHasStarted?k.isLive?(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)(Pg,{className:"h-6 w-6 text-red-500 mr-2 animate-pulse"}),(0,Ts.jsx)("h1",{className:"text-2xl font-bold text-sky-300",children:i("status.liveMatch")})]}):(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)(Sd,{className:"h-6 w-6 text-slate-400 mr-2"}),(0,Ts.jsx)("h1",{className:"text-2xl font-bold text-slate-300",children:i("status.matchFinished")})]}):(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)(Sd,{className:"h-6 w-6 text-slate-400 mr-2"}),(0,Ts.jsx)("h1",{className:"text-2xl font-bold text-slate-300",children:i("status.matchNotStarted")})]})}),k.isLive&&k.matchHasStarted&&k.currentPeriod>0&&(0,Ts.jsx)("div",{className:"text-sm text-slate-400",children:i("info.periodWithMinute",{period:k.currentPeriod,minute:M})})]}),w&&(0,Ts.jsx)("div",{className:"text-xs text-slate-500",children:i("info.lastUpdated",{time:w.toLocaleTimeString()})})]}),(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsx)(Gg,{icon:Sd,title:i("info.matchSummary"),children:(0,Ts.jsx)(tf,{ownTeamName:k.ownTeamName,opponentTeam:k.opponentName,ownScore:k.ownScore,opponentScore:k.opponentScore,matchStartTime:k.matchStartTime,scheduledStartTime:C,totalPeriods:k.totalPeriods||k.currentPeriod,periodDurationMinutes:k.periodDurationMinutes||15,matchDuration:k.isLive?k.matchDurationSeconds||0:T,matchDurationDisplay:_,matchHasStarted:k.matchHasStarted,matchHasFinished:N})}),(0,Ts.jsx)(Gg,{icon:Sd,title:i("info.gameEvents"),headerExtra:(0,Ts.jsx)(zg,{isVisible:p,onToggle:()=>f(!p),label:i("info.substitutions")}),children:(0,Ts.jsx)(Bg,{events:D,ownTeamName:k.ownTeamName,opponentTeam:k.opponentName,matchStartTime:k.matchStartTime,showSubstitutions:p,goalScorers:I,getPlayerName:R,onGoalClick:null,selectedPlayerId:null,availablePlayers:[],onPlayerFilterChange:null,debugMode:!1,initialSortOrder:g,onSortOrderChange:j})})]})]})}):(0,Ts.jsx)("div",{className:"min-h-screen bg-slate-900 text-slate-100",children:(0,Ts.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-2xl",children:[S(),(0,Ts.jsx)(Xc,{variant:"dark",children:(0,Ts.jsx)("p",{className:"text-slate-400 text-center",children:i("info.noEventsFound")})})]})})}function av(t){let{isOpen:a,onClose:r}=t;const{t:s}=xe("auth"),[i,o]=(0,e.useState)(""),[l,c]=(0,e.useState)(""),[d,u]=(0,e.useState)(""),[m,h]=(0,e.useState)({}),[p,f]=(0,e.useState)(""),{changePassword:g,loading:v,authError:y,clearAuthError:b}=Cs();(0,e.useEffect)(()=>{a&&(o(""),c(""),u(""),h({}),f(""))},[a]),(0,e.useEffect)(()=>{y&&b()},[i,l,d,y,b]),(0,e.useEffect)(()=>{const e=e=>{"Escape"===e.key&&a&&r()};return a&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[a,r]);const x=()=>m.general?m.general:y||null;return a?p?(0,Ts.jsx)(Mc,{title:s("changePassword.success.title"),onClose:r,children:(0,Ts.jsxs)("div",{className:"space-y-6 text-center",children:[(0,Ts.jsxs)("div",{className:"text-center",children:[(0,Ts.jsx)("div",{className:"w-16 h-16 bg-emerald-600 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,Ts.jsx)("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,Ts.jsx)("h2",{className:"text-2xl font-bold text-sky-300",children:s("changePassword.success.title")}),(0,Ts.jsx)("p",{className:"text-slate-400 mt-2",children:p})]}),(0,Ts.jsx)(Lc,{onClick:r,variant:"primary",size:"lg",className:"w-full",children:s("changePassword.success.button")})]})}):(0,Ts.jsx)(Mc,{title:s("changePassword.modalTitle"),onClose:r,className:"max-h-[90vh] overflow-y-auto",children:(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"text-center",children:[(0,Ts.jsx)("h2",{className:"text-2xl font-bold text-sky-300",children:s("changePassword.header.title")}),(0,Ts.jsx)("p",{className:"text-slate-400 mt-2",children:s("changePassword.header.subtitle")})]}),x()&&(0,Ts.jsx)(Jc,{variant:"error",children:x()}),(0,Ts.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return i.trim()||(e.currentPassword=s("changePassword.errors.currentPasswordRequired")),l.trim()?l.length<8?e.newPassword=s("changePassword.errors.newPasswordTooShort"):l===i&&(e.newPassword=s("changePassword.errors.newPasswordSame")):e.newPassword=s("changePassword.errors.newPasswordRequired"),d.trim()?l!==d&&(e.confirmPassword=s("changePassword.errors.passwordsMismatch")):e.confirmPassword=s("changePassword.errors.confirmPasswordRequired"),h(e),0===Object.keys(e).length})())try{const{error:e,message:t}=await g(i,l);e?h({general:e.message}):t&&f(t)}catch(t){h({general:s("changePassword.errors.unexpected")})}},className:"space-y-4",children:[(0,Ts.jsx)(Pd,{label:s("changePassword.form.currentPasswordLabel"),htmlFor:"current-password",error:m.currentPassword,children:(0,Ts.jsx)(Rc,{id:"current-password",type:"password",value:i,onChange:e=>{o(e.target.value),m.currentPassword&&h(e=>(0,n.A)((0,n.A)({},e),{},{currentPassword:null}))},placeholder:s("changePassword.form.currentPasswordPlaceholder"),disabled:v,error:!!m.currentPassword})}),(0,Ts.jsx)(Pd,{label:s("changePassword.form.newPasswordLabel"),htmlFor:"new-password",error:m.newPassword,children:(0,Ts.jsx)(Rc,{id:"new-password",type:"password",value:l,onChange:e=>{c(e.target.value),m.newPassword&&h(e=>(0,n.A)((0,n.A)({},e),{},{newPassword:null}))},placeholder:s("changePassword.form.newPasswordPlaceholder"),disabled:v,error:!!m.newPassword})}),(0,Ts.jsx)(Pd,{label:s("changePassword.form.confirmPasswordLabel"),htmlFor:"confirm-new-password",error:m.confirmPassword,children:(0,Ts.jsx)(Rc,{id:"confirm-new-password",type:"password",value:d,onChange:e=>{u(e.target.value),m.confirmPassword&&h(e=>(0,n.A)((0,n.A)({},e),{},{confirmPassword:null}))},placeholder:s("changePassword.form.confirmPasswordPlaceholder"),disabled:v,error:!!m.confirmPassword})}),(0,Ts.jsx)(Lc,{type:"submit",variant:"primary",size:"lg",disabled:v,className:"w-full",children:s(v?"changePassword.form.submittingButton":"changePassword.form.submitButton")})]}),(0,Ts.jsxs)(Xc,{children:[(0,Ts.jsx)("h4",{className:"text-slate-300 font-medium mb-2",children:s("changePassword.requirements.title")}),(0,Ts.jsxs)("ul",{className:"text-slate-400 text-sm space-y-1",children:[(0,Ts.jsxs)("li",{children:["\u2022 ",s("changePassword.requirements.items.minLength")]}),(0,Ts.jsxs)("li",{children:["\u2022 ",s("changePassword.requirements.items.different")]}),(0,Ts.jsxs)("li",{children:["\u2022 ",s("changePassword.requirements.items.mix")]})]})]})]})}):null}const nv=["last_team_member","last_team_admin"];function rv(t){var a;let{onNavigateBack:r,onNavigateTo:s,pushNavigationState:i,removeFromNavigationStack:o}=t;const{t:l,i18n:c}=xe("profile"),{user:d,userProfile:u,updateProfile:m,loading:h,authError:p,clearAuthError:f,profileName:g,markProfileCompleted:v}=Cs(),{currentTeam:y,userTeams:b,userClubs:x,loading:w,leaveClub:S,leaveTeam:k,deleteTeam:N,error:j,clearError:T}=vi(),[A,_]=(0,e.useState)(!1),[C,M]=(0,e.useState)((null===u||void 0===u?void 0:u.name)||""),[P,E]=(0,e.useState)({}),[I,R]=(0,e.useState)(""),[O,D]=(0,e.useState)(!1),[F,L]=(0,e.useState)(!1),[q,U]=(0,e.useState)(null),[B,G]=(0,e.useState)(null),[z,V]=(0,e.useState)(null),[H,K]=(0,e.useState)(null),[W,Y]=(0,e.useState)(null),[J,Q]=(0,e.useState)(null),[$,X]=(0,e.useState)(!1),[Z,ee]=(0,e.useState)(!1),te=(0,e.useRef)(null),ae=(0,e.useRef)(null);(0,e.useEffect)(()=>(i&&i(()=>{r()}),()=>{o&&o()}),[i,o,r]),(0,e.useEffect)(()=>{A&&(R(""),p&&f())},[A,p,f]);(0,e.useEffect)(()=>{A&&te.current&&te.current.focus()},[A]),(0,e.useEffect)(()=>(I&&(ae.current=setTimeout(()=>{R("")},3e3)),()=>{ae.current&&(clearTimeout(ae.current),ae.current=null)}),[I]);const ne=()=>{const e={},t=C.trim();return t?t.length<2?e.name=l("validation.nameTooShort"):(e=>{if("string"!==typeof e)return!1;const t=e.trim();return!(t.length>50)&&!!Ms.test(t)&&!(/<script/gi.test(t)||/javascript:/gi.test(t)||/on\w+\s*=/gi.test(t))&&!Es.test(t)})(t)||(e.name=l("validation.nameInvalidChars")):e.name=l("validation.nameRequired"),E(e),0===Object.keys(e).length},re=async()=>{if(ne())try{const e=Is(C.trim()),{profile:t,error:a}=await m({name:e});a?E({general:a.message}):t&&(_(!1),R(l("messages.updateSuccess")),t.name&&t.name.trim()&&v())}catch(e){E({general:l("messages.unexpectedError")})}},se=()=>P.general?P.general:p||(!j||J||z?null:j),ie=e=>{if(!e)return l("formatting.notAvailable");try{const t="sv"===c.language?"sv-SE":"en-US";return new Date(e).toLocaleDateString(t,{year:"numeric",month:"long",day:"numeric"})}catch(t){return l("formatting.invalidDate")}},oe=()=>null!==u&&void 0!==u&&u.name?u.name:null!==d&&void 0!==d&&d.email?d.email.split("@")[0]:l("formatting.defaultUser"),le=e=>{var t,a;return(null===e||void 0===e||null===(t=e.club)||void 0===t?void 0:t.long_name)||(null===e||void 0===e||null===(a=e.club)||void 0===a?void 0:a.name)||l("formatting.unknownClub")},ce=e=>{var t;return e?null!==(t=e.club)&&void 0!==t&&t.long_name?"".concat(e.club.long_name," ").concat(e.name):e.name:l("formatting.unknownTeam")},de=()=>{var e;if(null===z||void 0===z||null===(e=z.teams)||void 0===e||!e.length)return[];const t=new Set(z.teams);return me.filter(e=>{var a;return t.has(e.name)&&(!z.clubId||(null===(a=e.club)||void 0===a?void 0:a.id)===z.clubId)})},ue=x||[],me=b||[],he=ue.length>0,pe=me.length>0;return(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("h1",{className:"text-2xl font-bold text-sky-300",children:l("screen.title")}),(0,Ts.jsx)(Lc,{onClick:r,variant:"secondary",size:"sm",children:l("screen.back")})]}),I&&(0,Ts.jsx)(Jc,{variant:"success",children:I}),se()&&(0,Ts.jsx)(Jc,{variant:"error",children:se()}),(0,Ts.jsxs)("div",{className:"bg-slate-700 rounded-lg border border-slate-600 overflow-hidden",children:[(0,Ts.jsx)("div",{className:"bg-gradient-to-r from-sky-600 to-sky-700 px-6 py-8",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Ts.jsx)("div",{className:"w-20 h-20 bg-sky-800 rounded-full flex items-center justify-center border-4 border-sky-400",children:(0,Ts.jsx)("span",{className:"text-sky-100 text-2xl font-bold",children:(()=>{const e=oe(),t=e.split(" ");return t.length>1?"".concat(t[0][0]).concat(t[t.length-1][0]).toUpperCase():e.slice(0,2).toUpperCase()})()})}),(0,Ts.jsxs)("div",{className:"flex-1",children:[(0,Ts.jsx)("h2",{className:"text-2xl font-bold text-white",children:oe()}),(0,Ts.jsx)("p",{className:"text-sky-200 opacity-90",children:null===d||void 0===d?void 0:d.email}),(null===d||void 0===d?void 0:d.email_confirmed_at)&&(0,Ts.jsxs)("div",{className:"flex items-center space-x-1 mt-1",children:[(0,Ts.jsx)("svg",{className:"w-4 h-4 text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,Ts.jsx)("span",{className:"text-emerald-300 text-sm",children:l("personalInfo.emailVerified")})]})]})]})}),(0,Ts.jsxs)("div",{className:"p-6 space-y-6",children:[(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("h3",{className:"text-lg font-semibold text-slate-200 mb-4",children:l("personalInfo.title")}),(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:l("personalInfo.fullName")}),A?(0,Ts.jsxs)("div",{className:"space-y-2",children:[(0,Ts.jsx)(Rc,{ref:te,value:C,onChange:e=>{M(e.target.value),P.name&&E(e=>(0,n.A)((0,n.A)({},e),{},{name:null}))},onKeyDown:e=>{"Enter"!==e.key||h||(e.preventDefault(),re())},placeholder:l("personalInfo.namePlaceholder"),disabled:h,error:!!P.name}),P.name&&(0,Ts.jsx)("p",{className:"text-rose-400 text-sm",children:P.name}),(0,Ts.jsxs)("div",{className:"flex space-x-2",children:[(0,Ts.jsx)(Lc,{onClick:re,variant:"primary",size:"sm",disabled:h,children:l(h?"buttons.saving":"buttons.save")}),(0,Ts.jsx)(Lc,{onClick:()=>{_(!1),M((null===u||void 0===u?void 0:u.name)||""),E({})},variant:"secondary",size:"sm",disabled:h,children:l("buttons.cancel")})]})]}):(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("span",{className:"text-slate-100",children:g}),(0,Ts.jsx)(Lc,{onClick:()=>{_(!0),M((null===u||void 0===u?void 0:u.name)||""),E({})},variant:"secondary",size:"sm",className:"Not set"===g?"animate-glow-and-fade":"",children:l("buttons.edit")})]})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:l("personalInfo.emailAddress")}),(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("span",{className:"text-slate-100",children:null===d||void 0===d?void 0:d.email}),(0,Ts.jsx)("span",{className:"text-xs text-slate-400",children:l("personalInfo.readOnly")})]})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:l("personalInfo.password")}),(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("span",{className:"text-slate-400 text-sm",children:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"}),(0,Ts.jsx)(Lc,{onClick:()=>D(!0),variant:"secondary",size:"sm",children:l("personalInfo.changePassword")})]}),(0,Ts.jsx)("p",{className:"text-slate-500 text-xs mt-1",children:l("personalInfo.passwordHint")})]})]})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsxs)("button",{onClick:()=>L(!F),className:"w-full flex items-center justify-between text-left hover:bg-slate-600 hover:bg-opacity-30 rounded-lg p-2 -m-2 transition-colors",children:[(0,Ts.jsx)("h3",{className:"text-lg font-semibold text-slate-200",children:l("accountInfo.title")}),(0,Ts.jsx)("svg",{className:"w-5 h-5 text-slate-400 transition-transform ".concat(F?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),F&&(0,Ts.jsxs)("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:l("accountInfo.created")}),(0,Ts.jsx)("span",{className:"text-slate-100 text-sm",children:ie(null===d||void 0===d?void 0:d.created_at)})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:l("accountInfo.updated")}),(0,Ts.jsx)("span",{className:"text-slate-100 text-sm",children:ie(null===u||void 0===u?void 0:u.updated_at)})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:l("accountInfo.userId")}),(0,Ts.jsx)("span",{className:"text-slate-400 text-xs font-mono break-all",children:null===d||void 0===d?void 0:d.id})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:l("accountInfo.emailStatus")}),(0,Ts.jsx)("span",{className:"text-sm ".concat(null!==d&&void 0!==d&&d.email_confirmed_at?"text-emerald-400":"text-amber-400"),children:null!==d&&void 0!==d&&d.email_confirmed_at?l("accountInfo.verified"):l("accountInfo.pendingVerification")})]})]})]}),(0,Ts.jsxs)("div",{className:"border-t border-slate-600 pt-6",children:[(0,Ts.jsx)("h3",{className:"text-lg font-semibold text-slate-200 mb-4",children:l("teamManagement.title")}),w?(0,Ts.jsx)(Xc,{variant:"dark",children:(0,Ts.jsx)("p",{className:"text-slate-400 text-sm text-center",children:l("teamManagement.loading")})}):he?(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("h4",{className:"font-medium text-slate-300 mb-3",children:l("teamManagement.yourClubs",{count:ue.length})}),(0,Ts.jsx)("div",{className:"space-y-2",children:ue.map(e=>(0,Ts.jsx)(Xc,{variant:"dark",children:(0,Ts.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,Ts.jsxs)("div",{className:"flex-1 text-left",children:[(0,Ts.jsx)("p",{className:"font-semibold text-slate-100",children:le(e)}),(0,Ts.jsx)("p",{className:"text-slate-400 text-sm",children:e.role||l("teamManagement.member")})]}),(0,Ts.jsx)(Lc,{onClick:()=>(e=>{null!==e&&void 0!==e&&e.id&&G(e)})(e),variant:"danger",size:"sm",disabled:q===e.id,children:q===e.id?l("teamManagement.leaving"):l("teamManagement.leave")})]})},e.id))})]}),y&&(0,Ts.jsx)("button",{onClick:()=>s(bi.TEAM_MANAGEMENT),className:"w-full bg-sky-900/30 border border-sky-600 rounded-lg p-4 hover:bg-sky-900/40 transition-colors",children:(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsxs)("div",{className:"text-left",children:[(0,Ts.jsx)("h4",{className:"font-medium text-sky-200",children:l("teamManagement.currentTeam")}),(0,Ts.jsx)("p",{className:"text-sky-100 font-semibold",children:null!==(a=y.club)&&void 0!==a&&a.long_name?"".concat(y.club.long_name," ").concat(y.name):y.name}),(0,Ts.jsx)("p",{className:"text-sky-300 text-sm",children:y.userRole||l("teamManagement.member")})]}),(0,Ts.jsx)("div",{className:"w-3 h-3 bg-emerald-400 rounded-full"})]})}),pe?(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("h4",{className:"font-medium text-slate-300 mb-3",children:l("teamManagement.yourTeams",{count:me.length})}),(0,Ts.jsx)("div",{className:"space-y-2",children:me.map(e=>{var t;return(0,Ts.jsx)("div",{className:"p-3 rounded-lg border transition-colors ".concat(y&&e.id===y.id?"bg-sky-900/20 border-sky-600":"bg-slate-800 border-slate-600 hover:bg-slate-700"),children:(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsxs)("div",{className:"flex-1",children:[(0,Ts.jsx)("p",{className:"font-medium text-slate-100",children:null!==(t=e.club)&&void 0!==t&&t.long_name?"".concat(e.club.long_name," ").concat(e.name):e.name}),(0,Ts.jsxs)("p",{className:"text-slate-400 text-sm",children:[e.userRole||l("teamManagement.member"),!1===e.active&&" \u2022 ".concat(l("teamManagement.inactive"))]})]}),(0,Ts.jsxs)("div",{className:"flex items-center gap-2",children:[y&&e.id!==y.id&&(0,Ts.jsx)("button",{onClick:()=>{console.log("Switch to team:",e.id)},className:"text-sky-400 hover:text-sky-300 text-sm font-medium transition-colors",children:l("teamManagement.switch")}),(0,Ts.jsx)(Lc,{onClick:()=>(e=>{null!==e&&void 0!==e&&e.id&&Y(e)})(e),variant:"danger",size:"sm",disabled:H===e.id,children:H===e.id?l("teamManagement.leaving"):l("teamManagement.leave")})]})]})},e.id)})})]}):(0,Ts.jsxs)("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-600 text-center",children:[(0,Ts.jsx)("div",{className:"w-16 h-16 bg-slate-700 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,Ts.jsx)("svg",{className:"w-8 h-8 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,Ts.jsx)("h4",{className:"font-medium text-slate-200 mb-2",children:l("emptyStates.noTeams.title")}),(0,Ts.jsx)("p",{className:"text-slate-400 text-sm mb-4",children:l("emptyStates.noTeams.description")}),(0,Ts.jsx)(Lc,{onClick:()=>s(bi.TEAM_MANAGEMENT),variant:"primary",size:"sm",className:"mx-auto",children:l("emptyStates.noTeams.action")})]})]}):(0,Ts.jsxs)("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-600 text-center",children:[(0,Ts.jsx)("div",{className:"w-16 h-16 bg-slate-700 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,Ts.jsx)("svg",{className:"w-8 h-8 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,Ts.jsx)("h4",{className:"font-medium text-slate-200 mb-2",children:l("emptyStates.noClubs.title")}),(0,Ts.jsx)("p",{className:"text-slate-400 text-sm mb-4",children:l("emptyStates.noClubs.description")}),(0,Ts.jsx)(Lc,{onClick:()=>s(bi.TEAM_MANAGEMENT),variant:"primary",size:"sm",className:"mx-auto",children:l("emptyStates.noClubs.action")})]})]})]})]}),(0,Ts.jsx)(av,{isOpen:O,onClose:()=>D(!1)}),(0,Ts.jsx)(qc,{isOpen:Boolean(B),onConfirm:async()=>{if(null!==B&&void 0!==B&&B.id&&S){U(B.id);try{const t=await S(B);var e;if("last_team_member"===(null===t||void 0===t?void 0:t.error))V({club:(null===B||void 0===B?void 0:B.club)||null,clubId:(null===B||void 0===B||null===(e=B.club)||void 0===e?void 0:e.id)||(null===B||void 0===B?void 0:B.club_id)||null,membership:B,teams:Array.isArray(null===t||void 0===t?void 0:t.teams)?t.teams:[]}),T&&T();else V(null)}finally{U(null),G(null)}}else G(null)},onCancel:()=>G(null),title:l("modals.leaveClub.title"),message:B?l("modals.leaveClub.message",{clubName:le(B)}):"",confirmText:l("modals.leaveClub.confirm"),cancelText:l("buttons.cancel"),variant:"danger"}),(0,Ts.jsx)(qc,{isOpen:Boolean(W),onConfirm:async()=>{if(null!==W&&void 0!==W&&W.id&&k){K(W.id);try{const e=await k(W);null!==e&&void 0!==e&&e.error&&nv.includes(e.error)?(Q({team:W,reason:e.error}),T&&T()):Q(null)}finally{K(null),Y(null)}}else Y(null)},onCancel:()=>Y(null),title:l("modals.leaveTeam.title"),message:W?l("modals.leaveTeam.message",{teamName:ce(W)}):"",confirmText:l("modals.leaveTeam.confirm"),cancelText:l("buttons.cancel"),variant:"danger"}),(0,Ts.jsx)(qc,{isOpen:Boolean(z),onConfirm:async()=>{const e=de()[0];if(null!==e&&void 0!==e&&e.id&&N&&!Z){ee(!0);try{if(!await N(e))return void V(null);if(S&&null!==z&&void 0!==z&&z.membership){const e=await S(z.membership);if("last_team_member"===(null===e||void 0===e?void 0:e.error))return V({club:z.club||null,clubId:z.clubId||null,membership:z.membership,teams:Array.isArray(null===e||void 0===e?void 0:e.teams)?e.teams:[]}),void(T&&T())}V(null)}finally{ee(!1)}}},onCancel:()=>{V(null),T&&T()},title:l("modals.cantLeaveClub.title"),message:(()=>{if(!z)return"";const e=de();if(e.length>0){const t=ce(e[0]);return l("modals.cantLeaveClub.lastMember",{teamName:t})}const t=Array.isArray(z.teams)?z.teams:[];if(t.length>0){var a,n;const e=(null===(a=z.club)||void 0===a?void 0:a.long_name)||(null===(n=z.club)||void 0===n?void 0:n.name),r=e?"".concat(e," ").concat(t[0]):t[0];return l("modals.cantLeaveClub.lastMember",{teamName:r})}return l("modals.cantLeaveClub.lastMember",{teamName:l("formatting.thisTeam")})})(),confirmText:l(Z?"modals.cantLeaveClub.deletingButton":"modals.cantLeaveClub.deleteButton"),cancelText:l("buttons.cancel"),variant:"danger"}),(0,Ts.jsx)(qc,{isOpen:Boolean(J),onConfirm:async()=>{var e;if(null!==J&&void 0!==J&&null!==(e=J.team)&&void 0!==e&&e.id&&N&&!$){X(!0);try{await N(J.team)}finally{X(!1),Q(null)}}},onCancel:()=>{Q(null),T&&T()},title:l("modals.cantLeaveTeam.title"),message:(()=>{if(null===J||void 0===J||!J.team)return"";const e=ce(J.team);return"last_team_member"===J.reason?l("modals.cantLeaveTeam.lastMember",{teamName:e}):l("modals.cantLeaveTeam.lastAdmin",{teamName:e})})(),confirmText:l($?"modals.cantLeaveClub.deletingButton":"modals.cantLeaveClub.deleteButton"),cancelText:l("buttons.cancel"),variant:"danger"})]})}function sv(t){const{t:a}=xe("team"),[n,r]=(0,e.useState)([]),[s,i]=(0,e.useState)(!0),[o,l]=(0,e.useState)(null),c=(0,e.useRef)(!0),d=(0,e.useCallback)(async()=>{if(t)try{c.current&&(i(!0),l(null));const e=await async function(e){try{if(!e)return{success:!1,error:"Team ID is required"};const t=(new Date).toISOString().split("T")[0],{data:a,error:n}=await Ur.from("upcoming_match").select("\n        id,\n        opponent,\n        match_date,\n        match_time,\n        venue,\n        planned_match_id,\n        connector!inner (\n          team_id\n        )\n      ").eq("connector.team_id",e).gte("match_date",t).is("planned_match_id",null).order("match_date",{ascending:!0}).order("match_time",{ascending:!0});return n?(console.error("Failed to get upcoming matches:",n),{success:!1,error:"Database error: ".concat(n.message)}):{success:!0,matches:(a||[]).map(e=>({id:e.id,opponent:e.opponent,matchDate:e.match_date,matchTime:e.match_time,venue:e.venue,plannedMatchId:e.planned_match_id||null}))}}catch(o){return console.error("Exception while getting upcoming matches:",o),{success:!1,error:"Unexpected error: ".concat(o.message)}}}(t);if(!c.current)return;e.success?r(e.matches||[]):l(e.error||a("teamMatches.error.loadUpcomingFailed"))}catch(e){console.error("Error fetching upcoming matches:",e),c.current&&l(a("teamMatches.error.loadUpcomingFailed"))}finally{c.current&&i(!1)}else c.current&&(r([]),i(!1),l(null))},[t,a]);return(0,e.useEffect)(()=>(c.current=!0,d(),()=>{c.current=!1}),[d]),{matches:n,loading:s,error:o,refetch:d}}function iv(t){let{onNavigateBack:a,onNavigateTo:r,pushNavigationState:s,removeFromNavigationStack:i}=t;const{t:o}=xe("team"),{currentTeam:l}=vi(),{matches:c,loading:d,error:u,refetch:m}=function(t){const{t:a}=xe("team"),[r,s]=(0,e.useState)([]),[i,o]=(0,e.useState)(!0),[l,c]=(0,e.useState)(null),d=(0,e.useRef)(null);return(0,e.useEffect)(()=>{if(!t)return s([]),void o(!1);let e=!0;return(async()=>{try{o(!0),c(null);const n=await Qo(t);n.success?e&&s(n.matches||[]):e&&c(n.error||a("teamMatches.error.loadFailed"))}catch(n){console.error("Error fetching active matches:",n),e&&c(a("teamMatches.error.loadFailed"))}finally{e&&o(!1)}})(),d.current=Ur.channel("team_matches:".concat(t)).on("postgres_changes",{event:"*",schema:"public",table:"match",filter:"team_id=eq.".concat(t)},t=>{if(e)if(console.log("Match change detected:",t),"INSERT"===t.eventType){const e=t.new;"pending"!==e.state&&"running"!==e.state||s(t=>[{id:e.id,opponent:e.opponent||"Internal Match",state:e.state,createdAt:e.created_at,startedAt:e.started_at,type:e.type,venueType:e.venue_type},...t])}else if("UPDATE"===t.eventType){const e=t.new;"finished"===e.state?s(t=>t.filter(t=>t.id!==e.id)):"pending"!==e.state&&"running"!==e.state||s(t=>t.some(t=>t.id===e.id)?t.map(t=>t.id===e.id?(0,n.A)((0,n.A)({},t),{},{id:e.id,opponent:e.opponent||"Internal Match",state:e.state,createdAt:e.created_at,startedAt:e.started_at,type:e.type,venueType:e.venue_type}):t):[{id:e.id,opponent:e.opponent||"Internal Match",state:e.state,createdAt:e.created_at,startedAt:e.started_at,type:e.type,venueType:e.venue_type},...t])}else"DELETE"===t.eventType&&s(e=>e.filter(e=>e.id!==t.old.id))}).subscribe(),()=>{e=!1,d.current&&d.current.unsubscribe()}},[t,s,o,c,a]),{matches:r,loading:i,error:l,refetch:async()=>{if(t)try{c(null);const e=await Qo(t);e.success?s(e.matches||[]):c(e.error||a("teamMatches.error.loadFailed"))}catch(e){console.error("Error refetching active matches:",e),c(a("teamMatches.error.loadFailed"))}}}}(null===l||void 0===l?void 0:l.id),{matches:h,loading:p,error:f,refetch:g}=sv(null===l||void 0===l?void 0:l.id),[v,y]=(0,e.useState)({isOpen:!1,title:"",message:""}),[b,x]=(0,e.useState)(null),[w,S]=(0,e.useState)(null),[k,N]=(0,e.useState)(!1),[j,T]=(0,e.useState)([]),A=c.filter(e=>"pending"===e.state),_=[...h,...A].sort((e,t)=>{if(!e.matchDate&&!t.matchDate)return 0;if(!e.matchDate)return 1;if(!t.matchDate)return-1;const a=e.matchDate.localeCompare(t.matchDate);return 0!==a?a:e.matchTime||t.matchTime?e.matchTime?t.matchTime?e.matchTime.localeCompare(t.matchTime):1:-1:0}),C=async()=>{await Promise.all([m(),g()])},M=()=>{N(!1),i&&i()},P=e=>{var t;_.length<=1?r(bi.PLAN_MATCHES,{matchesToPlan:[e]}):(t=e.id,T([t]),N(!0),s&&s(()=>N(!1),"TeamMatchesList-PlanModal"))};(0,e.useEffect)(()=>(s&&s(()=>{a()}),()=>{i&&i()}),[s,i,a]);const E=e=>{if(!e)return o("teamMatches.timestamps.noDate");const t=new Date(e),a=new Date,n=new Date(a.getFullYear(),a.getMonth(),a.getDate()),r=new Date(n);return r.setDate(r.getDate()-1),t>=n?o("teamMatches.timestamps.today",{time:t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})}):t>=r?o("teamMatches.timestamps.yesterday",{time:t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})}):(e=>{const t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(n)})(t)},I=e=>"pending"===(null===e||void 0===e?void 0:e.state)&&null!==e&&void 0!==e&&e.matchDate?R(e.matchDate,e.matchTime):E(null===e||void 0===e?void 0:e.createdAt),R=(e,t)=>{if(!e)return o("teamMatches.timestamps.dateTbd");const a=(e=>e?e.slice(0,5):null)(t);return a?"".concat(e," ").concat(a):e},O=e=>"running"===e?(0,Ts.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-emerald-600 text-emerald-100 rounded-full",children:o("teamMatches.states.running")}):"pending"===e?(0,Ts.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-sky-600 text-sky-100 rounded-full",children:o("teamMatches.states.pending")}):"upcoming"===e?(0,Ts.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-amber-600 text-amber-100 rounded-full",children:o("teamMatches.states.upcoming")}):null,D=c.length>0,F=h.length>0,L=u||f;return(d||p)&&!D&&!F?(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("h1",{className:"text-2xl font-bold text-sky-300",children:o("teamMatches.title")}),(0,Ts.jsx)(Lc,{onClick:a,variant:"secondary",size:"sm",children:o("teamMatches.back")})]}),(0,Ts.jsx)("div",{className:"bg-slate-700 rounded-lg border border-slate-600 p-8",children:(0,Ts.jsx)(Wd,{size:"sm",message:o("teamMatches.loading")})})]}):!L||D||F?D||F?(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("h1",{className:"text-2xl font-bold text-sky-300",children:o("teamMatches.title")}),(0,Ts.jsx)(Lc,{onClick:a,variant:"secondary",size:"sm",children:o("teamMatches.back")})]}),D&&(0,Ts.jsx)("div",{className:"space-y-3",children:c.map(e=>{const t="pending"===e.state,a=w===e.id;return(0,Ts.jsx)("div",{className:"bg-slate-700 rounded-lg border border-slate-600 p-4 hover:bg-slate-600 transition-colors",children:(0,Ts.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,Ts.jsxs)("div",{className:"flex-1 min-w-0 space-y-2",children:[(0,Ts.jsxs)("div",{className:"flex items-start gap-2 flex-wrap",children:[(0,Ts.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-slate-100",children:e.opponent}),O(e.state)]}),(0,Ts.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 text-xs sm:text-sm text-slate-400 flex-wrap",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Ts.jsx)(Sd,{className:"w-3.5 h-3.5"}),(0,Ts.jsx)("span",{children:I(e)})]}),e.type&&(0,Ts.jsx)("span",{className:"px-2 py-0.5 bg-slate-600 text-slate-300 rounded text-xs",children:e.type.charAt(0).toUpperCase()+e.type.slice(1)}),e.venueType&&(0,Ts.jsx)("span",{className:"px-2 py-0.5 bg-slate-600 text-slate-300 rounded text-xs",children:e.venueType.charAt(0).toUpperCase()+e.venueType.slice(1)})]})]}),(0,Ts.jsxs)("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 w-full sm:w-auto",children:[t&&(0,Ts.jsx)(Lc,{onClick:()=>P(e),variant:"accent",size:"sm",className:"w-full sm:w-auto",disabled:a,children:o("teamMatches.buttons.plan")}),t&&(0,Ts.jsx)(Lc,{onClick:()=>{return t=e.id,void r(bi.CONFIG,{resumeMatchId:t});var t},variant:"accent",size:"sm",Icon:kc,className:"w-full sm:w-auto",disabled:a,children:o("teamMatches.buttons.resumeSetup")}),(0,Ts.jsx)(Lc,{onClick:()=>{return t=e.id,void r(bi.LIVE_MATCH,{matchId:t,entryPoint:bi.TEAM_MATCHES});var t},variant:"primary",size:"sm",Icon:hd,className:"w-full sm:w-auto",children:o("teamMatches.buttons.openLive")}),(0,Ts.jsx)(Lc,{onClick:()=>(async e=>{x(e);try{const t=await id(e);t.success?y({isOpen:!0,title:o("teamMatches.notifications.linkCopied"),message:o("teamMatches.notifications.linkCopiedMessage")}):y({isOpen:!0,title:o("teamMatches.notifications.liveMatchUrl"),message:t.url||o("teamMatches.notifications.couldNotCopy")})}catch(t){console.error("Failed to copy link:",t),y({isOpen:!0,title:o("teamMatches.notifications.error"),message:o("teamMatches.error.copyFailed")})}finally{x(null)}})(e.id),variant:"secondary",size:"sm",Icon:Sc,disabled:b===e.id,className:"w-full sm:w-auto",children:b===e.id?o("teamMatches.buttons.copying"):o("teamMatches.buttons.copyLink")}),t&&(0,Ts.jsx)(Lc,{onClick:()=>(async e=>{if(!w){S(e);try{const t=await cl(e);t.success?(y({isOpen:!0,title:o("teamMatches.notifications.matchDeleted"),message:o("teamMatches.notifications.matchDeletedMessage")}),await m()):y({isOpen:!0,title:o("teamMatches.notifications.error"),message:t.error||o("teamMatches.error.deleteFailed")})}catch(t){console.error("Failed to delete pending match:",t),y({isOpen:!0,title:o("teamMatches.notifications.error"),message:o("teamMatches.error.deleteFailed")})}finally{S(null)}}})(e.id),variant:"danger",size:"sm",Icon:a?void 0:xd,disabled:a,className:"w-full sm:w-auto",children:o(a?"teamMatches.buttons.deleting":"teamMatches.buttons.delete")})]})]})},e.id)})}),F&&(0,Ts.jsxs)("div",{className:"space-y-3",children:[(0,Ts.jsxs)("div",{className:"space-y-1",children:[(0,Ts.jsx)("h2",{className:"text-lg font-semibold text-slate-200",children:o("teamMatches.upcoming.title")}),(0,Ts.jsx)("p",{className:"text-xs text-slate-400",children:o("teamMatches.upcoming.description")})]}),h.map(e=>(0,Ts.jsx)("div",{className:"bg-slate-700 rounded-lg border border-amber-500/40 p-4 hover:bg-slate-600 transition-colors",children:(0,Ts.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,Ts.jsxs)("div",{className:"flex-1 min-w-0 space-y-2",children:[(0,Ts.jsxs)("div",{className:"flex items-start gap-2 flex-wrap",children:[(0,Ts.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-slate-100",children:e.opponent}),O("upcoming")]}),(0,Ts.jsx)("p",{className:"text-xs text-amber-200",children:o("teamMatches.upcoming.notPlanned")}),(0,Ts.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 text-xs sm:text-sm text-slate-400 flex-wrap",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Ts.jsx)(Id,{className:"w-3.5 h-3.5"}),(0,Ts.jsx)("span",{children:R(e.matchDate,e.matchTime)})]}),e.venue&&(0,Ts.jsx)("span",{className:"px-2 py-0.5 bg-slate-600 text-slate-300 rounded text-xs",children:e.venue})]})]}),(0,Ts.jsx)("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 w-full sm:w-auto",children:(0,Ts.jsx)(Lc,{variant:"accent",size:"sm",className:"w-full sm:w-auto",onClick:()=>P(e),children:o("teamMatches.buttons.plan")})})]})},e.id))]}),k&&(0,Ts.jsxs)(Mc,{title:o("teamMatches.planModal.title"),onClose:M,maxWidth:"lg",children:[(0,Ts.jsx)("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto",children:_.map(e=>{const t=j.includes(e.id),a=R(e.matchDate,e.matchTime),n="pending"===e.state?o("teamMatches.states.pending"):o("teamMatches.states.upcoming");return(0,Ts.jsx)("label",{className:"flex items-center justify-between gap-3 rounded-md border px-3 py-2 text-sm cursor-pointer transition-colors ".concat(t?"border-sky-500 bg-sky-900/30 text-sky-100":"border-slate-600 bg-slate-700/40 text-slate-200 hover:border-slate-500"),children:(0,Ts.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,Ts.jsx)("input",{type:"checkbox",checked:t,onChange:()=>{return t=e.id,void T(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"h-4 w-4 rounded border-slate-500 text-sky-500 focus:ring-sky-500","aria-label":"Select ".concat(e.opponent)}),(0,Ts.jsxs)("div",{className:"min-w-0",children:[(0,Ts.jsx)("div",{className:"truncate font-medium",children:e.opponent}),(0,Ts.jsxs)("div",{className:"text-xs text-slate-400",children:[n," - ",a]})]})]})},e.id)})}),(0,Ts.jsxs)("div",{className:"pt-4 border-t border-slate-600 flex flex-col sm:flex-row gap-2 sm:justify-end",children:[(0,Ts.jsx)(Lc,{variant:"secondary",onClick:M,children:o("teamMatches.planModal.cancel")}),(0,Ts.jsx)(Lc,{variant:"accent",onClick:()=>{const e=_.filter(e=>j.includes(e.id));0!==e.length&&(M(),r(bi.PLAN_MATCHES,{matchesToPlan:e}))},disabled:0===j.length,children:o("teamMatches.planModal.planSelected")})]})]}),(0,Ts.jsx)(Uc,{isOpen:v.isOpen,onClose:()=>y({isOpen:!1,title:"",message:""}),title:v.title,message:v.message})]}):(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("h1",{className:"text-2xl font-bold text-sky-300",children:o("teamMatches.title")}),(0,Ts.jsx)(Lc,{onClick:a,variant:"secondary",size:"sm",children:o("teamMatches.back")})]}),(0,Ts.jsx)(Yd,{icon:Id,title:o("teamMatches.empty.title"),message:o("teamMatches.empty.description")})]}):(0,Ts.jsxs)("div",{className:"space-y-6",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("h1",{className:"text-2xl font-bold text-sky-300",children:o("teamMatches.title")}),(0,Ts.jsx)(Lc,{onClick:a,variant:"secondary",size:"sm",children:o("teamMatches.back")})]}),(0,Ts.jsx)(Jc,{variant:"error",icon:bm,children:(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("p",{className:"text-rose-200 font-medium",children:o("teamMatches.error.loadFailed")}),(0,Ts.jsx)("p",{className:"text-rose-300 text-sm mt-1",children:L}),(0,Ts.jsx)(Lc,{onClick:C,variant:"secondary",size:"sm",className:"mt-3",children:o("teamMatches.error.tryAgain")})]})})]})}const ov={PRACTICES:"practices",ATTENDANCE:"attendance"},lv=(e,t)=>t?!e||"object"!==typeof e||Array.isArray(e)||e.teamId===t?e:(0,n.A)((0,n.A)({},e),{},{teamId:t}):e;function cv(t,a,n){const r=(0,e.useMemo)(()=>Bs(t,a),[t,a]),[s,i]=(0,e.useState)(()=>{if(!n)return a;const e=r.loadState();return(null===e||void 0===e?void 0:e.teamId)===n?e:lv(a,n)});return(0,e.useEffect)(()=>{if(!n)return void i(e=>e===a?e:a);const e=r.loadState(),t=(null===e||void 0===e?void 0:e.teamId)===n?e:lv(a,n);i(e=>e===t?e:t)},[n,r,a]),(0,e.useEffect)(()=>{n&&r.saveState(lv(s,n))},[s,n,r]),[s,i]}const dv=(e,t)=>{if(e===t)return!0;if(!Array.isArray(e)||!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(let a=0;a<e.length;a+=1){const n=e[a],r=t[a];if(!n||!r)return!1;if(String(n.id)!==String(r.id))return!1;if(n.opponent!==r.opponent)return!1;if(n.matchDate!==r.matchDate)return!1;if(n.matchTime!==r.matchTime)return!1}return!0},uv=(e,t)=>{if(e===t)return!0;const a=Object.keys(e||{}),n=Object.keys(t||{});if(a.length!==n.length)return!1;for(const r of a){if(!Object.prototype.hasOwnProperty.call(t||{},r))return!1;const a=Array.isArray(e[r])?e[r]:[],n=Array.isArray(t[r])?t[r]:[];if(a.length!==n.length)return!1;for(let e=0;e<a.length;e+=1)if(String(a[e])!==String(n[e]))return!1}return!0},mv=(e,t)=>{if(e===t)return!0;const a=Object.keys(e||{}),n=Object.keys(t||{});if(a.length!==n.length)return!1;for(const r of a){if(!Object.prototype.hasOwnProperty.call(t||{},r))return!1;if(e[r]!==t[r])return!1}return!0},hv=(e,t)=>{if(e===t)return!0;if(!Array.isArray(e)||!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(let a=0;a<e.length;a+=1)if(String(e[a])!==String(t[a]))return!1;return!0},pv={teamId:null,ensureCoverage:!0,metric:ov.PRACTICES,targetCounts:{},lastSquadSize:null},fv=e=>Array.isArray(e)?e:[],gv=e=>{let{currentTeamId:t,matchesToPlan:a,planProgress:n}=e;const r=fv(a);if(!t)return{matches:r,selectedPlayersByMatch:{},planningStatus:{},sortMetric:ov.PRACTICES,plannedMatchIds:[],inviteSeededMatchIds:[]};const s=(null===n||void 0===n?void 0:n.teamId)===t?n:null,i=fv(null===s||void 0===s?void 0:s.matches),o=r.length>0?r:null,l=o||i,c=new Set(l.map(e=>String(null===e||void 0===e?void 0:e.id))),d=new Set(i.map(e=>String(null===e||void 0===e?void 0:e.id))),u=s&&c.size>0&&d.size>0&&c.size===d.size&&[...c].every(e=>d.has(e));if(!(s&&(!o||u))&&o&&!s)return{matches:l,selectedPlayersByMatch:{},planningStatus:{},sortMetric:ov.PRACTICES,plannedMatchIds:[],inviteSeededMatchIds:[]};const m=null===s||void 0===s?void 0:s.selectedPlayersByMatch,h=m&&"object"===typeof m?Object.entries(m).reduce((e,t)=>{let[a,n]=t;return e[a]=Array.isArray(n)?n:[],e},{}):{},p=null===s||void 0===s?void 0:s.sortMetric,f=Object.values(ov).includes(p)?p:ov.PRACTICES,g=Array.isArray(null===s||void 0===s?void 0:s.plannedMatchIds)?s.plannedMatchIds:[],v=Array.isArray(null===s||void 0===s?void 0:s.inviteSeededMatchIds)?s.inviteSeededMatchIds:[];return{matches:l,selectedPlayersByMatch:h,planningStatus:g.length>0?g.reduce((e,t)=>(e[t]="done",e),{}):{},sortMetric:f,plannedMatchIds:g,inviteSeededMatchIds:v}},vv={teamId:null,matches:[],selectedPlayersByMatch:{},sortMetric:ov.PRACTICES,plannedMatchIds:[],inviteSeededMatchIds:[]},yv=(t,a)=>{const{t:n}=xe("common"),[r,s]=(0,e.useState)(null),[i,o]=(0,e.useState)(null);return(0,e.useEffect)(()=>{let e=!0;if(!t||!a)return s(null),()=>{e=!1};o(null);return(async()=>{let r={},i=null;try{r=await a(t)}catch(l){console.error("Failed to load team preferences:",l),o(n("errors.failedToLoadMatchDefaults"))}try{i=await async function(e){if(!e)return null;try{const{data:t,error:a}=await Ur.from("match").select("id, format, formation, periods, period_duration_minutes, type, venue_type, started_at").eq("team_id",e).eq("state","finished").is("deleted_at",null).order("started_at",{ascending:!1}).limit(1).maybeSingle();return a?(console.error("Failed to fetch most recent finished match:",a),null):t||null}catch(l){return console.error("Exception while fetching most recent finished match:",l),null}}(t)}catch(l){console.error("Failed to load recent match:",l),o(n("errors.failedToLoadMatchDefaults"))}e&&s(function(){var e,t;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const r=a.matchFormat||(null===n||void 0===n?void 0:n.format)||di.matchFormat||xi.FORMATS.FORMAT_5V5,s=xi.FORMAT_CONFIGS[r]?r:di.matchFormat||xi.FORMATS.FORMAT_5V5,i=xi.FORMAT_CONFIGS[s]||xi.FORMAT_CONFIGS[xi.FORMATS.FORMAT_5V5],o=a.formation||(null===n||void 0===n?void 0:n.formation);return{format:s,formation:null!==i&&void 0!==i&&null!==(e=i.formations)&&void 0!==e&&e.includes(o)?o:(null===i||void 0===i?void 0:i.defaultFormation)||di.formation||(null===(t=xi.FORMAT_CONFIGS[xi.FORMATS.FORMAT_5V5])||void 0===t?void 0:t.defaultFormation),periods:a.numPeriods||(null===n||void 0===n?void 0:n.periods)||di.numPeriods||2,periodDurationMinutes:a.periodLength||(null===n||void 0===n?void 0:n.period_duration_minutes)||di.periodLength||20,matchType:(null===n||void 0===n?void 0:n.type)||Ol.DEFAULT_MATCH_TYPE,venueType:(null===n||void 0===n?void 0:n.venue_type)||Fs.DEFAULT_VENUE_TYPE}}(r,i))})(),()=>{e=!1}},[t,a,n]),{defaults:r,defaultsError:i}},bv={teamId:null,matches:{},providerAvailableOverridesByMatch:{}};function xv(t){const[a,n]=(0,e.useState)({}),[r,s]=(0,e.useState)(!0),i=(0,e.useRef)(null),o=(0,e.useMemo)(()=>{if(!Array.isArray(t))return"";const e=Array.from(new Set(t.map(e=>null===e||void 0===e?void 0:e.id).filter(e=>Boolean(e)).map(e=>String(e))));return e.sort(),JSON.stringify(e)},[t]);(0,e.useEffect)(()=>{const e=o?JSON.parse(o):[];if(0===e.length)return n({}),s(!1),void(i.current=o);let t=!0;return s(!0),async function(e){try{const t=Array.isArray(e)?e.filter(e=>Boolean(e)):[];if(0===t.length)return{success:!0,availabilityByMatch:{}};const{data:a,error:n}=await Ur.from("upcoming_match_player").select("\n        upcoming_match_id,\n        availability,\n        response,\n        invite_status,\n        connected_player:connected_player_id (\n          player_id\n        )\n      ").in("upcoming_match_id",t).not("connected_player.player_id","is",null);if(n)return console.error("Failed to get upcoming match player availability:",n),{success:!1,error:"Database error: ".concat(n.message)};const r={};return(a||[]).forEach(e=>{var t;const a=e.upcoming_match_id,n=null===(t=e.connected_player)||void 0===t?void 0:t.player_id;a&&n&&(r[a]||(r[a]={}),r[a][n]={availability:e.availability,response:e.response,inviteStatus:e.invite_status||null})}),{success:!0,availabilityByMatch:r}}catch(t){return console.error("Exception while getting match player availability:",t),{success:!1,error:"Unexpected error: ".concat(t.message)}}}(e).then(e=>{t&&(null!==e&&void 0!==e&&e.success?n(e.availabilityByMatch||{}):n({}))}).catch(e=>{t&&(console.error("Failed to load provider availability:",e),n({}))}).finally(()=>{t&&(i.current=o,s(!1))}),()=>{t=!1}},[o]);return{providerUnavailableByMatch:(0,e.useMemo)(()=>{const e={};return Object.entries(a||{}).forEach(t=>{let[a,n]=t;const r=Object.entries(n||{}).filter(e=>{let[,t]=e;return"unavailable"===(null===t||void 0===t?void 0:t.availability)||"declined"===(null===t||void 0===t?void 0:t.response)}).map(e=>{let[t]=e;return t});r.length>0&&(e[a]=r)}),e},[a]),providerResponseByMatch:(0,e.useMemo)(()=>{const e={};return Object.entries(a||{}).forEach(t=>{let[a,n]=t;const r={};Object.entries(n||{}).forEach(e=>{let[t,a]=e;null!==a&&void 0!==a&&a.response&&(r[t]=a.response)}),Object.keys(r).length>0&&(e[a]=r)}),e},[a]),providerInvitedByMatch:(0,e.useMemo)(()=>{const e={};return Object.entries(a||{}).forEach(t=>{let[a,n]=t;const r=Object.entries(n||{}).filter(e=>{let[,t]=e;return"invited"===(null===t||void 0===t?void 0:t.inviteStatus)}).map(e=>{let[t]=e;return t});r.length>0&&(e[a]=r)}),e},[a]),providerAvailabilityLoading:r||i.current!==o}}const wv={active:!1,sourceMatchId:null,sourcePlayerId:null,targetMatchId:null,hoveredPlayerId:null,isEligible:!1};const Sv=fc("ban",[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);function kv(t){let{players:a,selectedIds:n,unavailableIds:r,providerUnavailableIds:s,onToggleSelect:i,onToggleUnavailable:o,isSelectedInOtherMatch:l,isSelectedAndOnlyAvailableHere:c,emptyMessage:d,sortMetric:u}=t;const{t:m}=xe("team"),h=(0,e.useMemo)(()=>new Set(n||[]),[n]),p=(0,e.useMemo)(()=>new Set(r||[]),[r]),f=(0,e.useMemo)(()=>new Set(s||[]),[s]);return a&&0!==a.length?(0,Ts.jsx)("div",{className:"space-y-1 pr-1",children:a.map(e=>{const t=p.has(e.id),a=f.has(e.id),n=a&&!t,r=h.has(e.id),s=!!l&&l(e.id);return(0,Ts.jsxs)("div",{role:"button",tabIndex:0,onClick:()=>i(e.id),onKeyDown:t=>{"Enter"===t.key&&i(e.id)},className:"flex items-center justify-between gap-2 rounded border px-2 py-1 text-xs transition-colors ".concat(t?"border-rose-500/40 bg-rose-900/20 text-rose-200 opacity-70 cursor-not-allowed":r?"border-emerald-400 bg-emerald-500/20 text-emerald-50 cursor-pointer":s?"border-indigo-400/60 bg-indigo-900/20 text-indigo-100 cursor-pointer":"border-slate-700 bg-slate-900/30 text-slate-200 hover:border-slate-500 cursor-pointer"),children:[(0,Ts.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[t&&(0,Ts.jsx)(Sv,{className:"h-3.5 w-3.5 text-rose-300"}),(0,Ts.jsx)("span",{className:"truncate",children:e.displayName}),e.jerseyNumber&&(0,Ts.jsxs)("span",{className:"text-[10px] text-slate-400",children:["#",e.jerseyNumber]})]}),(0,Ts.jsxs)("div",{className:"flex items-center gap-2 text-[10px] font-mono text-slate-300",children:[u===ov.ATTENDANCE?(0,Ts.jsxs)("span",{children:[e.attendanceRate.toFixed(0),"%"]}):(0,Ts.jsx)(Ud,{content:m("planMatches.playerSelector.practicesTooltip"),position:"top",trigger:"hover",className:"inline-flex",children:(0,Ts.jsx)("span",{children:e.practicesPerMatch.toFixed(2)})}),o&&(a?(0,Ts.jsx)("button",{type:"button",onClick:t=>{t.stopPropagation(),o(e.id)},className:"rounded p-1 inline-flex items-center ".concat(n?"text-amber-300 hover:text-amber-200":"text-rose-200 hover:text-rose-100"),title:m(n?"planMatches.playerSelector.markUnavailable":"planMatches.playerSelector.markAvailable"),"aria-label":m(n?"planMatches.playerSelector.markUnavailable":"planMatches.playerSelector.markAvailable"),children:(0,Ts.jsx)(Sv,{className:"h-3.5 w-3.5"})}):(0,Ts.jsx)("button",{type:"button",onClick:t=>{t.stopPropagation(),o(e.id)},className:"rounded p-1 ".concat(t?"text-rose-200 hover:text-rose-100":"text-slate-400 hover:text-rose-200"),title:m(t?"planMatches.playerSelector.markAvailable":"planMatches.playerSelector.markUnavailable"),"aria-label":m(t?"planMatches.playerSelector.markAvailable":"planMatches.playerSelector.markUnavailable"),children:(0,Ts.jsx)(Sv,{className:"h-3.5 w-3.5"})}))]})]},e.id)})}):(0,Ts.jsx)("div",{className:"rounded border border-slate-700 bg-slate-900/30 px-2 py-2 text-xs text-slate-400",children:d||m("planMatches.playerSelector.noPlayers")})}const Nv={time:300,distance:10},jv=e=>{var t;return String(null!==(t=null===e||void 0===e?void 0:e.id)&&void 0!==t?t:"")};function Tv(t){let{items:a=[],onReorder:n,containerRef:r,activationThreshold:s=Nv,onDragMove:i,onDragEnd:o}=t;const[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)(null),[m,h]=(0,e.useState)(null),[p,f]=(0,e.useState)(null),[g,v]=(0,e.useState)(null),y=(0,e.useRef)(a),b=(0,e.useRef)(null),x=(0,e.useRef)(null),w=(0,e.useRef)(null),S=(0,e.useRef)(null),k=(0,e.useRef)(null),N=(0,e.useRef)(null),j=(0,e.useRef)(null),T=(0,e.useRef)(null),A=(0,e.useRef)(null),_=(0,e.useRef)(null),C=(0,e.useRef)(null),M=(0,e.useRef)(null),P=(0,e.useRef)(null),E=(0,e.useRef)({itemId:null,until:0}),I=(0,e.useRef)(i),R=(0,e.useRef)(o);y.current=a,I.current=i,R.current=o;const O=(0,e.useCallback)(()=>{N.current&&(clearTimeout(N.current),N.current=null),j.current&&(clearTimeout(j.current),j.current=null),T.current&&(clearTimeout(T.current),T.current=null)},[]),D=(0,e.useCallback)(()=>{S.current&&(cancelAnimationFrame(S.current),S.current=null)},[]),F=(0,e.useCallback)(()=>{A.current&&(window.removeEventListener("pointermove",A.current),A.current=null),_.current&&(window.removeEventListener("pointerup",_.current),_.current=null),C.current&&(window.removeEventListener("pointercancel",C.current),C.current=null),M.current&&(window.removeEventListener("keydown",M.current),M.current=null)},[]),L=(0,e.useCallback)(()=>{c(!1),u(null),h(null),f(null),v(null),w.current=null,b.current=null,x.current=null,k.current=null,P.current=null},[]),q=(0,e.useCallback)(()=>{var e;const t=x.current;if(null!==t&&void 0!==t&&null!==(e=t.startTarget)&&void 0!==e&&e.releasePointerCapture&&null!=t.pointerId)try{t.startTarget.releasePointerCapture(t.pointerId)}catch(a){}},[]),U=(0,e.useCallback)((e,t)=>{k.current={x:e,y:t},S.current||(S.current=requestAnimationFrame(()=>{S.current=null,k.current&&f(k.current)}))},[]),B=(0,e.useCallback)(()=>{const e=x.current;if(!e)return;const t=null===r||void 0===r?void 0:r.current,a=(y.current||[]).map(jv),n=new Map;let s=null;if(t){s=t.getBoundingClientRect();Array.from(t.querySelectorAll("[data-drag-item-id]")).forEach(e=>{const t=e.dataset.dragItemId;t&&n.set(t,e.getBoundingClientRect())})}e.order=a,e.itemRects=n,e.containerRect=s},[r]),G=(0,e.useCallback)(e=>{const t=x.current;if(null===t||void 0===t||!t.itemRects||!t.order)return null;const a=t.order.filter(e=>e!==t.itemId);let n=0;for(const r of a){const a=t.itemRects.get(r);if(!a){n+=1;continue}if(e<a.top+a.height/2)return n;n+=1}return a.length},[]),z=(0,e.useCallback)((e,t)=>{var a;const n=x.current;if(!n)return;const s=n.containerRect||(null===r||void 0===r||null===(a=r.current)||void 0===a?void 0:a.getBoundingClientRect());if(s){if(!(e>=s.left&&e<=s.right&&t>=s.top&&t<=s.bottom))return void(null!==w.current&&(w.current=null,h(null)))}const i=G(t);i!==w.current&&(w.current=i,h(i))},[G,r]),V=(0,e.useCallback)(()=>{O(),D(),q(),F(),L()},[D,O,F,q,L]),H=(0,e.useCallback)(e=>{E.current={itemId:String(null!==e&&void 0!==e?e:""),until:Date.now()+250}},[]),K=(0,e.useCallback)(e=>{const t=x.current;if(!t||"number"!==typeof e)return;const a=y.current||[];if(a.length<2)return;const r=a.map(jv),s=r.indexOf(t.itemId);if(-1===s)return;const i=((e,t,a)=>{if(!Array.isArray(e)||0===e.length)return e;if(t<0||t>=e.length)return e;const n=[...e],[r]=n.splice(t,1),s=Math.max(0,Math.min(n.length,a));return n.splice(s,0,r),n})(a,s,e);(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.length===t.length&&e.every((e,a)=>e===t[a])})(r,i.map(jv))||n&&n(i)},[n]),W=(0,e.useCallback)(e=>{var t;const a=x.current;if(!a||a.started)return!1;if(a.started=!0,c(!0),u(a.itemId),v(null),B(),U(e.clientX,e.clientY),z(e.clientX,e.clientY),e.cancelable&&e.preventDefault(),null!==(t=a.startTarget)&&void 0!==t&&t.setPointerCapture&&null!=a.pointerId)try{a.startTarget.setPointerCapture(a.pointerId)}catch(n){}return M.current=e=>{"Escape"===e.key&&(e.preventDefault(),R.current&&R.current({cancelled:!0}),V())},window.addEventListener("keydown",M.current),!0},[B,V,U,z]);(0,e.useEffect)(()=>()=>{V()},[V]);const Y=(0,e.useCallback)((e,t)=>{var a,n;const i=String(null!==e&&void 0!==e?e:"");if((y.current||[]).length<2)return;if("mouse"===t.pointerType&&0!==t.button)return;if(x.current)return;O(),D(),v(null),b.current=t.pointerId,P.current={x:t.clientX,y:t.clientY},x.current={itemId:i,pointerId:t.pointerId,startX:t.clientX,startY:t.clientY,pointerType:t.pointerType,startTarget:t.currentTarget,started:!1,order:null,itemRects:null,containerRect:null};const o=null!==(a=null===s||void 0===s?void 0:s.time)&&void 0!==a?a:Nv.time,l=null!==(n=null===s||void 0===s?void 0:s.distance)&&void 0!==n?n:Nv.distance;j.current=setTimeout(()=>{const e=x.current;e&&!e.started&&e.itemId===i&&(v(i),T.current=setTimeout(()=>{v(e=>e===i?null:e)},180))},150),N.current=setTimeout(()=>{const e=x.current;if(!e||e.started||e.itemId!==i)return;const t=P.current||{x:e.startX,y:e.startY};W({clientX:t.x,clientY:t.y,cancelable:!1,pointerId:e.pointerId})},o);const c=e=>{if(e.pointerId!==b.current)return;const t=x.current;if(t){if(P.current={x:e.clientX,y:e.clientY},!t.started){const a=Math.abs(e.clientX-t.startX),n=Math.abs(e.clientY-t.startY);if(Math.max(a,n)<l)return;if(!W(e))return}e.cancelable&&e.preventDefault(),U(e.clientX,e.clientY),z(e.clientX,e.clientY),I.current&&I.current({itemId:t.itemId,clientX:e.clientX,clientY:e.clientY})}},d=e=>{var t;if(e.pointerId!==b.current)return;const a=x.current;if(O(),null===a||void 0===a||!a.started)return void V();e.cancelable&&e.preventDefault(),U(e.clientX,e.clientY);const n=a.containerRect||(null===r||void 0===r||null===(t=r.current)||void 0===t?void 0:t.getBoundingClientRect());if(!n||e.clientX>=n.left&&e.clientX<=n.right&&e.clientY>=n.top&&e.clientY<=n.bottom){var s;const t=null!==(s=w.current)&&void 0!==s?s:G(e.clientY);"number"===typeof t&&K(t)}R.current&&R.current({cancelled:!1,clientX:e.clientX,clientY:e.clientY}),H(a.itemId),V()},u=e=>{e.pointerId===b.current&&(O(),R.current&&R.current({cancelled:!0,clientX:e.clientX,clientY:e.clientY}),V())};A.current=c,_.current=d,C.current=u,window.addEventListener("pointermove",c,{passive:!1}),window.addEventListener("pointerup",d,{passive:!1}),window.addEventListener("pointercancel",u,{passive:!1})},[s,V,D,O,G,r,K,H,U,W,z]),J=(0,e.useCallback)(e=>l&&d===String(null!==e&&void 0!==e?e:""),[l,d]),Q=(0,e.useCallback)(e=>g===String(null!==e&&void 0!==e?e:""),[g]),$=(0,e.useCallback)(e=>{if(!l)return 0;const t=x.current;if(!t||null==w.current)return 0;const a=String(null!==e&&void 0!==e?e:"");if(a===t.itemId)return 0;const n=(t.order?t.order.filter(e=>e!==t.itemId):[]).indexOf(a);return-1===n?0:n<w.current?-48:48},[l]),X=(0,e.useCallback)(e=>{const t=String(null!==e&&void 0!==e?e:""),{itemId:a,until:n}=E.current;return a===t&&Date.now()<n&&(E.current={itemId:null,until:0},!0)},[]);return{isDragging:l,draggedItemId:d,dropIndex:m,ghostPosition:p,handlePointerStart:Y,isItemBeingDragged:J,isItemDragActivating:Q,getItemShift:$,shouldSuppressClick:X}}const Av=e=>{let{player:t,isDragging:a,shift:n,onPointerStart:r,onClick:s,isInMultipleMatches:i,isSelectedAndOnlyAvailableHere:o,isDragActivating:l,isSwapTarget:c,isSwapLanding:d,isBeingDisplaced:u,responseStatus:m,sortMetric:h}=e;const{t:p}=xe("team");return t?(0,Ts.jsxs)("div",{"data-drag-item-id":String(t.id),role:"button",tabIndex:0,onPointerDown:r,onClick:a?void 0:s,onKeyDown:e=>{"Enter"===e.key&&!a&&s&&s()},className:"player-card-draggable flex items-center justify-between gap-2 rounded px-2 py-1 text-xs ".concat(c?"border-2 border-sky-300 bg-sky-800/30 text-sky-100 shadow-[0_0_12px_rgba(125,211,252,0.5)] ring-2 ring-sky-300/40":o?"border border-orange-300/50 bg-orange-900/20 text-orange-200/80":i?"border-2 border-sky-400 bg-sky-900/20 text-sky-100 shadow-lg shadow-sky-500/60":"border border-sky-500/60 bg-sky-900/20 text-sky-100"," ").concat(l?"drag-activating":""," ").concat(d?"swap-landing":""),style:{transform:u?"translateX(30px)":n?"translateY(".concat(n,"px)"):void 0,transition:a?"none":u?"transform 300ms ease-out, opacity 300ms ease-out":"transform 200ms ease-out, opacity 100ms ease-out, border-color 150ms ease-out, box-shadow 150ms ease-out",opacity:a?.3:u?.4:1},children:[(0,Ts.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:["accepted"===m&&(0,Ts.jsx)(nu,{className:"h-3 w-3 flex-shrink-0 text-emerald-400"}),"declined"===m&&(0,Ts.jsx)(Tc,{className:"h-3 w-3 flex-shrink-0 text-rose-400"}),"no_response"===m&&(0,Ts.jsx)(Nd,{className:"h-3 w-3 flex-shrink-0 text-amber-400"}),(0,Ts.jsx)("span",{className:"truncate",children:t.displayName}),t.jerseyNumber&&(0,Ts.jsxs)("span",{className:"text-[10px] text-sky-200/70",children:["#",t.jerseyNumber]})]}),(0,Ts.jsx)("div",{className:"flex items-center gap-2 text-[10px] font-mono text-sky-100/80",children:h===ov.ATTENDANCE?(0,Ts.jsxs)("span",{children:[t.attendanceRate.toFixed(0),"%"]}):(0,Ts.jsx)(Ud,{content:p("planMatches.playerSelector.practicesTooltip"),position:"top",trigger:"hover",className:"inline-flex",children:(0,Ts.jsx)("span",{children:t.practicesPerMatch.toFixed(2)})})})]}):null},_v=e.memo(Av,(e,t)=>{var a,n,r,s,i,o,l,c,d,u;return e.shift===t.shift&&e.isDragging===t.isDragging&&e.isDragActivating===t.isDragActivating&&e.isInMultipleMatches===t.isInMultipleMatches&&e.isSelectedAndOnlyAvailableHere===t.isSelectedAndOnlyAvailableHere&&e.isSwapTarget===t.isSwapTarget&&e.isSwapLanding===t.isSwapLanding&&e.isBeingDisplaced===t.isBeingDisplaced&&e.responseStatus===t.responseStatus&&(null===(a=e.player)||void 0===a?void 0:a.id)===(null===(n=t.player)||void 0===n?void 0:n.id)&&(null===(r=e.player)||void 0===r?void 0:r.displayName)===(null===(s=t.player)||void 0===s?void 0:s.displayName)&&(null===(i=e.player)||void 0===i?void 0:i.jerseyNumber)===(null===(o=t.player)||void 0===o?void 0:o.jerseyNumber)&&(null===(l=e.player)||void 0===l?void 0:l.practicesPerMatch)===(null===(c=t.player)||void 0===c?void 0:c.practicesPerMatch)&&(null===(d=e.player)||void 0===d?void 0:d.attendanceRate)===(null===(u=t.player)||void 0===u?void 0:u.attendanceRate)&&e.sortMetric===t.sortMetric});function Cv(t){let{match:a,matchId:n,matchCount:r,roster:s,rosterById:i,selectedIds:o,unavailableIds:l,providerUnavailableIds:c,playerResponses:d,planningStatus:u,canPlan:m,isSelectedInOtherMatch:h,isSelectedAndOnlyAvailableHere:p,onClearOverrides:f,onPlanMatch:g,onToggleSelect:v,onToggleUnavailable:y,formatSchedule:b,isPlayerInMultipleMatches:x,onReorderSelectedPlayers:w,registerContainer:S,onCrossDragMove:k,onCrossDragEnd:N,crossMatchState:j,swapAnimation:T,slideInAnimation:A,sortMetric:_}=t;const{t:C}=xe("team"),M=(0,e.useMemo)(()=>new Set(l||[]),[l]),P=(0,e.useMemo)(()=>[...(s||[]).filter(e=>!M.has(e.id)),...(s||[]).filter(e=>M.has(e.id))],[s,M]),E=u||null,I="loading"===E,R="done"===E,O=(0,e.useMemo)(()=>(o||[]).map(e=>i.get(e)).filter(Boolean),[i,o]),D=(0,e.useRef)(null),F=(0,e.useRef)(null),L=(0,e.useRef)(null),q=(0,e.useRef)(null),[U,B]=(0,e.useState)(!1),G=A&&A.targetMatchId===n,z=(0,e.useCallback)(e=>!!G&&String(A.targetPlayerId)===String(e),[G,A]),V=(0,e.useMemo)(()=>G&&i.get(A.sourcePlayerId)||null,[G,A,i]);(0,e.useLayoutEffect)(()=>{if(!G||!A.targetRect||!A.releasePosition)return void B(!1);const e=L.current;if(!e)return void B(!1);const{targetRect:t,releasePosition:a}=A;e.style.position="fixed",e.style.left="".concat(t.left,"px"),e.style.top="".concat(t.top,"px"),e.style.width="".concat(t.width,"px");const n=t.left+t.width/2,r=t.top+t.height/2,s=a.x-n,i=a.y-r;return e.style.transition="none",e.style.transform="translate(".concat(s,"px, ").concat(i,"px) scale(1.05)"),e.style.opacity="0.9",e.getBoundingClientRect(),B(!0),q.current=setTimeout(()=>{q.current=null,e&&(e.style.transition="transform 400ms ease-out, opacity 400ms ease-out",e.style.transform="translate(0, 0) scale(1)",e.style.opacity="1")},100),()=>{q.current&&(clearTimeout(q.current),q.current=null)}},[G,A]),(0,e.useLayoutEffect)(()=>{if(!T||T.toMatchId!==n)return;const e=D.current;if(!e)return;const t=e.querySelector('[data-drag-item-id="'.concat(T.playerId,'"]'));if(!t)return;const a=t.getBoundingClientRect(),r=T.fromRect.left-a.left,s=T.fromRect.top-a.top;return t.style.transition="none",t.style.transform="translate(".concat(r,"px, ").concat(s,"px)"),t.style.zIndex="50",t.getBoundingClientRect(),t.style.transition="transform 300ms ease-out",t.style.transform="translate(0, 0)",F.current&&clearTimeout(F.current),F.current=setTimeout(()=>{t&&t.isConnected&&(t.style.transition="",t.style.transform="",t.style.zIndex=""),F.current=null},320),()=>{F.current&&(clearTimeout(F.current),F.current=null)}},[T,n]),(0,e.useEffect)(()=>{if(r>1&&S&&n)return S(n,D)},[r,S,n]);const H=(0,e.useCallback)(e=>{k&&n&&k(e,n)},[k,n]),K=(0,e.useCallback)(e=>{N&&n&&N(e,n)},[N,n]),W=(0,e.useCallback)(e=>!(null===j||void 0===j||!j.active)&&(j.targetMatchId===n&&j.hoveredPlayerId===String(e)&&j.isEligible),[j,n]),{isDragging:Y,draggedItemId:J,ghostPosition:Q,handlePointerStart:$,isItemBeingDragged:X,isItemDragActivating:Z,getItemShift:ee,shouldSuppressClick:te}=Tv({items:O,onReorder:e=>{if(!w)return;const t=e.map(e=>e.id);w(a.id,t)},containerRef:D,activationThreshold:{time:300,distance:10},onDragMove:r>1?H:void 0,onDragEnd:r>1?K:void 0}),ae=(0,e.useMemo)(()=>J&&O.find(e=>String(e.id)===String(J))||null,[J,O]);return(0,Ts.jsxs)("div",{className:"bg-slate-800/70 border border-slate-700 rounded-lg p-3 space-y-3",children:[(0,Ts.jsxs)("div",{className:"grid grid-cols-2 gap-2 items-start",children:[(0,Ts.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ts.jsx)(Lc,{size:"sm",variant:R?"secondary":"accent",onClick:g,disabled:I||R||!m,className:"px-2",children:C(I?"planMatches.matchCard.saving":R?"planMatches.matchCard.saved":"planMatches.matchCard.save")}),(0,Ts.jsx)(Lc,{size:"sm",variant:"secondary",onClick:f,disabled:I||R||!f,className:"px-2",children:C("planMatches.matchCard.reset")})]}),(0,Ts.jsx)("div",{className:"flex items-center justify-end gap-3 min-w-0 text-right",children:(0,Ts.jsxs)("div",{className:"min-w-0",children:[(0,Ts.jsx)("div",{className:"truncate text-sm font-semibold text-slate-100",children:a.opponent}),(0,Ts.jsx)("div",{className:"text-xs text-slate-400",children:b(a.matchDate,a.matchTime)})]})})]}),(0,Ts.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,Ts.jsxs)("div",{className:"space-y-1",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-400",children:[(0,Ts.jsx)("span",{children:C("planMatches.matchCard.roster")}),(0,Ts.jsx)("span",{children:(null===s||void 0===s?void 0:s.length)||0})]}),(0,Ts.jsx)(kv,{players:P,selectedIds:o,unavailableIds:l,providerUnavailableIds:c,onToggleSelect:v,onToggleUnavailable:y,isSelectedInOtherMatch:h,isSelectedAndOnlyAvailableHere:p,sortMetric:_})]}),(0,Ts.jsxs)("div",{className:"space-y-1",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-400",children:[(0,Ts.jsx)("span",{children:C("planMatches.matchCard.selected")}),(0,Ts.jsx)("span",{children:o.length})]}),(0,Ts.jsxs)("div",{ref:D,className:"space-y-1 pr-1",children:[O.map(e=>(0,Ts.jsx)(_v,{player:e,isDragging:X(e.id),shift:ee(e.id),onPointerStart:t=>$(e.id,t),onClick:()=>{te(e.id)||v(e.id)},isInMultipleMatches:x(e.id),isSelectedAndOnlyAvailableHere:p(e.id),isDragActivating:Z(e.id),isSwapTarget:W(e.id),isSwapLanding:T&&T.sourceNewMatchId===n&&String(T.sourcePlayerId)===String(e.id),isBeingDisplaced:z(e.id),responseStatus:d&&d[e.id]||null,sortMetric:_},e.id)),0===O.length&&(0,Ts.jsx)("div",{className:"rounded border border-slate-700 bg-slate-900/30 px-2 py-2 text-xs text-slate-400",children:C("planMatches.matchCard.empty")}),Y&&Q&&ae&&(0,Ts.jsx)(Hd,{children:(0,Ts.jsx)("div",{className:"fixed pointer-events-none z-[1000] ghost-card",style:{left:Q.x,top:Q.y,transform:"translate(-50%, -50%) scale(1.05)",opacity:.9},children:(0,Ts.jsx)(_v,{player:ae,isDragging:!1,shift:0,isInMultipleMatches:x(ae.id),isSelectedAndOnlyAvailableHere:p(ae.id),responseStatus:d&&d[ae.id]||null,sortMetric:_})})}),G&&V&&(0,Ts.jsx)(Hd,{children:(0,Ts.jsx)("div",{ref:L,className:"slide-in-overlay",style:{visibility:U?"visible":"hidden"},children:(0,Ts.jsx)(_v,{player:V,isDragging:!1,shift:0,isInMultipleMatches:x(V.id),isSelectedAndOnlyAvailableHere:p(V.id),responseStatus:d&&d[V.id]||null,sortMetric:_})})})]})]})]})]})}function Mv(e){let{isOpen:t,matches:a,autoSelectMatches:r,rosterCount:s,targetCounts:i,autoSelectSettings:o,onUpdateTargetCount:l,onUpdateSettings:c,onCancel:d,onConfirm:u,formatSchedule:m}=e;const{t:h}=xe("team");if(!t)return null;const p=a.length>1;return(0,Ts.jsxs)(Mc,{title:h("planMatches.autoSelect.title"),onClose:d,children:[(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{className:"space-y-2",children:[(0,Ts.jsx)("div",{className:"text-sm font-semibold text-slate-200",children:h(p?"planMatches.autoSelect.squadSizeMulti":"planMatches.autoSelect.squadSizeSingle")}),(0,Ts.jsx)("div",{className:"space-y-2",children:r.map(e=>{var t;return(0,Ts.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,Ts.jsxs)("div",{className:"min-w-0",children:[(0,Ts.jsx)("div",{className:"truncate text-sm text-slate-100",children:e.opponent}),(0,Ts.jsx)("div",{className:"text-xs text-slate-400",children:m(e.matchDate,e.matchTime)})]}),(0,Ts.jsx)("div",{className:"w-20",children:(0,Ts.jsx)(Rc,{type:"number",min:"0",max:s,value:null!==(t=i[e.id])&&void 0!==t?t:"",onChange:t=>l(e.id,t.target.value),className:"text-xs py-1 px-2"})})]},e.id)})})]}),p&&(0,Ts.jsxs)("label",{className:"flex items-center gap-2 text-sm text-slate-200",children:[(0,Ts.jsx)("input",{type:"checkbox",checked:o.ensureCoverage,onChange:e=>c((0,n.A)((0,n.A)({},o),{},{ensureCoverage:e.target.checked})),className:"h-4 w-4 rounded border-slate-500 text-sky-500 focus:ring-sky-500"}),h("planMatches.autoSelect.ensureCoverage")]}),p&&(0,Ts.jsxs)("div",{className:"space-y-2",children:[(0,Ts.jsxs)("label",{className:"flex items-center gap-2 text-sm text-slate-200",children:[(0,Ts.jsx)("input",{type:"radio",name:"auto-select-strategy",checked:o.metric===ov.PRACTICES,onChange:()=>c((0,n.A)((0,n.A)({},o),{},{metric:ov.PRACTICES})),className:"h-4 w-4 border-slate-500 text-sky-500 focus:ring-sky-500"}),h("planMatches.autoSelect.prioritizePractices")]}),(0,Ts.jsxs)("label",{className:"flex items-center gap-2 text-sm text-slate-200",children:[(0,Ts.jsx)("input",{type:"radio",name:"auto-select-strategy",checked:o.metric===ov.ATTENDANCE,onChange:()=>c((0,n.A)((0,n.A)({},o),{},{metric:ov.ATTENDANCE})),className:"h-4 w-4 border-slate-500 text-sky-500 focus:ring-sky-500"}),h("planMatches.autoSelect.prioritizeAttendance")]})]})]}),(0,Ts.jsxs)("div",{className:"pt-4 border-t border-slate-600 flex flex-col sm:flex-row gap-2 sm:justify-end",children:[(0,Ts.jsx)(Lc,{variant:"secondary",onClick:d,children:h("planMatches.autoSelect.cancel")}),(0,Ts.jsx)(Lc,{variant:"accent",onClick:u,children:h("planMatches.autoSelect.apply")})]})]})}const Pv=fc("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);function Ev(e){let{sortMetric:t,onSortChange:a,statsLoading:n,statsError:r,defaultsError:s,onRecommend:i}=e;const{t:o}=xe("team");return(0,Ts.jsxs)("div",{className:"flex flex-wrap items-center gap-2 lg:flex-nowrap lg:relative",children:[(0,Ts.jsxs)("div",{className:"inline-flex items-center gap-1 rounded-md border border-slate-600 bg-slate-800/80 p-1",children:[(0,Ts.jsx)("button",{type:"button",onClick:()=>a(ov.PRACTICES),className:"flex items-center gap-1 px-2 py-1 text-xs rounded ".concat(t===ov.PRACTICES?"bg-sky-600 text-white":"text-slate-300 hover:text-slate-100"),title:o("planMatches.toolbar.sortByPractices"),children:"P/M"}),(0,Ts.jsx)("button",{type:"button",onClick:()=>a(ov.ATTENDANCE),className:"flex items-center gap-1 px-2 py-1 text-xs rounded ".concat(t===ov.ATTENDANCE?"bg-sky-600 text-white":"text-slate-300 hover:text-slate-100"),title:o("planMatches.toolbar.sortByAttendance"),children:"%"})]}),n&&(0,Ts.jsx)("span",{className:"text-xs text-slate-400",children:o("planMatches.toolbar.statsLoading")}),r&&(0,Ts.jsx)("span",{className:"text-xs text-rose-300",children:r}),s&&(0,Ts.jsx)("span",{className:"text-xs text-rose-300",children:s}),(0,Ts.jsx)("div",{className:"w-full flex justify-center lg:w-auto lg:absolute lg:left-1/2 lg:top-1/2 lg:-translate-x-1/2 lg:-translate-y-1/2",children:(0,Ts.jsx)(Lc,{size:"md",variant:"primary",onClick:i,className:"px-4 shadow-lg shadow-sky-500/40 ring-1 ring-sky-400/60 bg-gradient-to-r from-sky-500 via-sky-400 to-cyan-500 hover:from-sky-400 hover:via-sky-300 hover:to-cyan-400",Icon:Pv,children:o("planMatches.toolbar.recommend")})})]})}const Iv=(e,t)=>t===ov.ATTENDANCE?e.attendanceRate:e.practicesPerMatch,Rv=(e,t)=>[...e||[]].sort((e,a)=>{const n=(Iv(a,t)||0)-(Iv(e,t)||0);return 0!==n?n:(e.displayName||"").localeCompare(a.displayName||"")}),Ov=!1;function Dv(t){let{onNavigateBack:a,pushNavigationState:r,removeFromNavigationStack:s,matchesToPlan:i=[]}=t;const{t:o}=xe("team"),{currentTeam:l,teamPlayers:c,loadTeamPreferences:d}=vi(),[u,m]=(0,e.useState)({isOpen:!1,title:"",message:""}),[h,p]=(0,e.useState)(!1),[f,g]=(0,e.useState)(null),{unavailablePlayersByMatch:v,providerAvailableOverridesByMatch:y,setUnavailablePlayersByMatch:b,setProviderAvailableOverridesByMatch:x}=(t=>{const[a,r]=cv(Br.PLAN_MATCH_UNAVAILABLE_PLAYERS,bv,t);return{unavailablePlayersByMatch:(0,e.useMemo)(()=>null!==a&&void 0!==a&&a.matches&&"object"===typeof a.matches?a.matches:{},[null===a||void 0===a?void 0:a.matches]),providerAvailableOverridesByMatch:(0,e.useMemo)(()=>null!==a&&void 0!==a&&a.providerAvailableOverridesByMatch&&"object"===typeof a.providerAvailableOverridesByMatch?a.providerAvailableOverridesByMatch:{},[null===a||void 0===a?void 0:a.providerAvailableOverridesByMatch]),setUnavailablePlayersByMatch:(0,e.useCallback)(e=>{r(a=>{const r=a&&"object"===typeof a?a:bv,s=r.matches&&"object"===typeof r.matches?r.matches:{},i="function"===typeof e?e(s):e;return uv(s,i)?a:(0,n.A)((0,n.A)({},r),{},{teamId:null!==t&&void 0!==t?t:null,matches:i})})},[t,r]),setProviderAvailableOverridesByMatch:(0,e.useCallback)(e=>{r(a=>{const r=a&&"object"===typeof a?a:bv,s=r.providerAvailableOverridesByMatch&&"object"===typeof r.providerAvailableOverridesByMatch?r.providerAvailableOverridesByMatch:{},i="function"===typeof e?e(s):e;return uv(s,i)?a:(0,n.A)((0,n.A)({},r),{},{teamId:null!==t&&void 0!==t?t:null,providerAvailableOverridesByMatch:i})})},[t,r])}})(null===l||void 0===l?void 0:l.id),{autoSelectSettings:w,targetCounts:S,lastSquadSize:k,setAutoSelectSettings:N,setTargetCounts:j,setLastSquadSize:T}=(t=>{const[a,r]=cv(Br.PLAN_MATCH_AUTO_SELECT_SETTINGS,pv,t),s=(0,e.useMemo)(()=>({ensureCoverage:"boolean"!==typeof(null===a||void 0===a?void 0:a.ensureCoverage)||a.ensureCoverage,metric:Object.values(ov).includes(null===a||void 0===a?void 0:a.metric)?a.metric:ov.PRACTICES}),[null===a||void 0===a?void 0:a.ensureCoverage,null===a||void 0===a?void 0:a.metric]),i=(0,e.useMemo)(()=>null!==a&&void 0!==a&&a.targetCounts&&"object"===typeof a.targetCounts?a.targetCounts:{},[null===a||void 0===a?void 0:a.targetCounts]),o=(0,e.useCallback)(e=>{r(a=>{const r=a&&"object"===typeof a?a:pv,s="boolean"!==typeof r.ensureCoverage||r.ensureCoverage,i=Object.values(ov).includes(r.metric)?r.metric:ov.PRACTICES,o="function"===typeof e?e({ensureCoverage:s,metric:i}):e,l="boolean"===typeof(null===o||void 0===o?void 0:o.ensureCoverage)?o.ensureCoverage:s,c=Object.values(ov).includes(null===o||void 0===o?void 0:o.metric)?o.metric:i;return l===s&&c===i?a:(0,n.A)((0,n.A)({},r),{},{teamId:null!==t&&void 0!==t?t:null,ensureCoverage:l,metric:c,targetCounts:r.targetCounts||{}})})},[t,r]),l=(0,e.useMemo)(()=>{const e=null===a||void 0===a?void 0:a.lastSquadSize;return"number"===typeof e&&e>0?e:null},[null===a||void 0===a?void 0:a.lastSquadSize]),c=(0,e.useCallback)(e=>{r(a=>{const r=a&&"object"===typeof a?a:pv,s="number"===typeof r.lastSquadSize&&r.lastSquadSize>0?r.lastSquadSize:null;return e===s?a:(0,n.A)((0,n.A)({},r),{},{teamId:null!==t&&void 0!==t?t:null,lastSquadSize:e})})},[t,r]);return{autoSelectSettings:s,targetCounts:i,lastSquadSize:l,setAutoSelectSettings:o,setTargetCounts:(0,e.useCallback)(e=>{r(a=>{const r=a&&"object"===typeof a?a:pv,s=r.targetCounts&&"object"===typeof r.targetCounts?r.targetCounts:{},i="function"===typeof e?e(s):e;return mv(s,i)?a:(0,n.A)((0,n.A)({},r),{},{teamId:null!==t&&void 0!==t?t:null,ensureCoverage:"boolean"!==typeof r.ensureCoverage||r.ensureCoverage,metric:Object.values(ov).includes(r.metric)?r.metric:ov.PRACTICES,targetCounts:i})})},[t,r]),setLastSquadSize:c}})(null===l||void 0===l?void 0:l.id),{matches:A,selectedPlayersByMatch:_,sortMetric:C,inviteSeededMatchIds:M,setSelectedPlayersByMatch:P,setSortMetric:E,setPlannedMatchIds:I,setInviteSeededMatchIds:R,planningStatus:O,setPlanningStatus:D}=(t=>{let{teamId:a,matchesToPlan:r,debugEnabled:s}=t;const[i,o]=(0,e.useState)({}),[l,c]=cv(Br.PLAN_MATCH_PROGRESS,vv,a),d=(0,e.useRef)(l);d.current=l;const u=(0,e.useMemo)(()=>Array.isArray(null===l||void 0===l?void 0:l.matches)&&l.matches.length>0?l.matches:Array.isArray(r)?r:[],[null===l||void 0===l?void 0:l.matches,r]),m=(0,e.useMemo)(()=>null!==l&&void 0!==l&&l.selectedPlayersByMatch&&"object"===typeof l.selectedPlayersByMatch?l.selectedPlayersByMatch:{},[null===l||void 0===l?void 0:l.selectedPlayersByMatch]),h=(0,e.useMemo)(()=>Object.values(ov).includes(null===l||void 0===l?void 0:l.sortMetric)?l.sortMetric:ov.PRACTICES,[null===l||void 0===l?void 0:l.sortMetric]),p=(0,e.useMemo)(()=>Array.isArray(null===l||void 0===l?void 0:l.plannedMatchIds)?l.plannedMatchIds:[],[null===l||void 0===l?void 0:l.plannedMatchIds]),f=(0,e.useMemo)(()=>Array.isArray(null===l||void 0===l?void 0:l.inviteSeededMatchIds)?l.inviteSeededMatchIds:[],[null===l||void 0===l?void 0:l.inviteSeededMatchIds]),g=(0,e.useCallback)(e=>{c(t=>{const r=t&&"object"===typeof t?t:vv,s=Array.isArray(r.matches)?r.matches:[],i="function"===typeof e?e(s):e;return dv(s,i)?t:(0,n.A)((0,n.A)({},r),{},{teamId:null!==a&&void 0!==a?a:null,matches:i})})},[a,c]),v=(0,e.useCallback)(e=>{c(t=>{const r=t&&"object"===typeof t?t:vv,s=r.selectedPlayersByMatch&&"object"===typeof r.selectedPlayersByMatch?r.selectedPlayersByMatch:{},i="function"===typeof e?e(s):e;return uv(s,i)?t:(0,n.A)((0,n.A)({},r),{},{teamId:null!==a&&void 0!==a?a:null,selectedPlayersByMatch:i})})},[a,c]),y=(0,e.useCallback)(e=>{c(t=>{const r=t&&"object"===typeof t?t:vv,s=Object.values(ov).includes(r.sortMetric)?r.sortMetric:ov.PRACTICES,i="function"===typeof e?e(s):e;return i===s?t:(0,n.A)((0,n.A)({},r),{},{teamId:null!==a&&void 0!==a?a:null,sortMetric:i})})},[a,c]),b=(0,e.useCallback)(e=>{c(t=>{const r=t&&"object"===typeof t?t:vv,s=Array.isArray(r.plannedMatchIds)?r.plannedMatchIds:[],i="function"===typeof e?e(s):e;return hv(s,i)?t:(0,n.A)((0,n.A)({},r),{},{teamId:null!==a&&void 0!==a?a:null,plannedMatchIds:i})})},[a,c]),x=(0,e.useCallback)(e=>{c(t=>{const r=t&&"object"===typeof t?t:vv,s=Array.isArray(r.inviteSeededMatchIds)?r.inviteSeededMatchIds:[],i="function"===typeof e?e(s):e;return hv(s,i)?t:(0,n.A)((0,n.A)({},r),{},{teamId:null!==a&&void 0!==a?a:null,inviteSeededMatchIds:i})})},[a,c]),w=(0,e.useRef)(null);return(0,e.useEffect)(()=>{w.current=null},[a]),(0,e.useEffect)(()=>{if(!a){const e=gv({currentTeamId:null,matchesToPlan:r,planProgress:null});return g(e.matches),v(e.selectedPlayersByMatch),y(e.sortMetric),b(e.plannedMatchIds),x(e.inviteSeededMatchIds),o(t=>mv(t,e.planningStatus)?t:e.planningStatus),w.current=null,void(s&&console.debug("[PlanMatchesScreen] plan progress load: no team",{matchesToPlanCount:Array.isArray(r)?r.length:0}))}if(dv(w.current,r))return void(s&&console.debug("[PlanMatchesScreen] plan progress load: matchesToPlan unchanged, skipping"));if(!Array.isArray(r)||0===r.length)return void(w.current=r);w.current=r;const e=gv({currentTeamId:a,matchesToPlan:r,planProgress:d.current});var t;s&&console.debug("[PlanMatchesScreen] plan progress load",{teamId:a,matchesToPlanCount:Array.isArray(r)?r.length:0,storedMatchCount:Array.isArray(null===(t=d.current)||void 0===t?void 0:t.matches)?d.current.matches.length:0,resolvedMatchCount:e.matches.length}),g(e.matches),v(e.selectedPlayersByMatch),y(e.sortMetric),b(e.plannedMatchIds),x(e.inviteSeededMatchIds),o(t=>mv(t,e.planningStatus)?t:e.planningStatus)},[s,r,g,x,o,b,v,y,a]),(0,e.useEffect)(()=>{0!==p.length&&o(e=>{let t=!1;const a=(0,n.A)({},e);return p.forEach(e=>{a[e]||(a[e]="done",t=!0)}),t?a:e})},[p]),{matches:u,selectedPlayersByMatch:m,sortMetric:h,plannedMatchIds:p,inviteSeededMatchIds:f,setSelectedPlayersByMatch:v,setSortMetric:y,setPlannedMatchIds:b,setInviteSeededMatchIds:x,planningStatus:i,setPlanningStatus:o}})({teamId:null===l||void 0===l?void 0:l.id,matchesToPlan:i,debugEnabled:Ov}),F=(0,e.useRef)(new Set);(0,e.useEffect)(()=>{F.current=new Set},[null===l||void 0===l?void 0:l.id]),(0,e.useEffect)(()=>{let e=!0;const t=A.filter(e=>"pending"===e.state).map(e=>e.id).filter(e=>!F.current.has(e));if(0!==t.length)return t.forEach(e=>F.current.add(e)),async function(e){try{if(!Array.isArray(e)||0===e.length)return{success:!0,selections:{}};const{data:t,error:a}=await Ur.from("match").select("id, initial_config").in("id",e).eq("state","pending").is("deleted_at",null);if(a)return console.error("Failed to fetch squad selections:",a),{success:!1,error:"Database error: ".concat(a.message)};const n={};return(t||[]).forEach(e=>{var t;const a=null===(t=e.initial_config)||void 0===t?void 0:t.squadSelection;Array.isArray(a)&&a.length>0&&(n[e.id]=a)}),{success:!0,selections:n}}catch(t){return console.error("Exception while fetching squad selections:",t),{success:!1,error:"Unexpected error: ".concat(t.message)}}}(t).then(t=>{if(!e)return;if(!t.success||!t.selections)return;const a=t.selections;0!==Object.keys(a).length&&P(e=>{let t=!1;const r=(0,n.A)({},e);return Object.entries(a).forEach(e=>{let[a,n]=e;r[a]&&0!==r[a].length||(r[a]=n,t=!0)}),t?r:e})}),()=>{e=!1}},[A,P]);const L=(0,e.useMemo)(()=>A.length>1?A:f?A.filter(e=>e.id===f):A,[f,A]),{providerUnavailableByMatch:q,providerResponseByMatch:U,providerInvitedByMatch:B,providerAvailabilityLoading:G}=xv(A),z=(0,e.useMemo)(()=>{const e={};return new Set([...Object.keys(v||{}),...Object.keys(y||{}),...Object.keys(q||{}),...A.map(e=>String(e.id))]).forEach(t=>{const a=v[t]||[],n=q[t]||[],r=new Set(y[t]||[]),s=n.filter(e=>!r.has(e)),i=Array.from(new Set([...a,...s]));i.length>0&&(e[t]=i)}),e},[A,y,q,v]),V=(0,e.useMemo)(()=>new Date,[]),H=(0,e.useMemo)(()=>{const e=new Date;return e.setMonth(e.getMonth()-6),e},[]),{attendanceStats:K,statsLoading:W,statsError:Y}=((t,a,n)=>{const{t:r}=xe("common"),[s,i]=(0,e.useState)([]),[o,l]=(0,e.useState)(!1),[c,d]=(0,e.useState)(null);return(0,e.useEffect)(()=>{if(!t)return void i([]);let e=!0;return l(!0),d(null),Ku(t,a,n).then(t=>{e&&i(t||[])}).catch(t=>{e&&(console.error("Failed to load attendance stats:",t),d((null===t||void 0===t?void 0:t.message)||r("errors.failedToLoadAttendanceStats")))}).finally(()=>{e&&l(!1)}),()=>{e=!1}},[t,a,n,r]),{attendanceStats:s,statsLoading:o,statsError:c}})(null===l||void 0===l?void 0:l.id,H,V),{defaults:J,defaultsError:Q}=yv(null===l||void 0===l?void 0:l.id,d);(0,e.useEffect)(()=>(r&&r(()=>{a()}),()=>{s&&s()}),[r,s,a]),(0,e.useEffect)(()=>{0!==A.length&&P(e=>{let t=!1;const a=(0,n.A)({},e);return A.forEach(e=>{a[e.id]||(a[e.id]=[],t=!0)}),t?a:e})},[A,P]);const $=(0,e.useRef)(new Set(M.map(String)));(0,e.useEffect)(()=>{M.forEach(e=>$.current.add(String(e)))},[M]),(0,e.useEffect)(()=>{if(G)return;if(0===A.length)return;const e=A.map(e=>String(e.id)).filter(e=>!$.current.has(e));if(0===e.length)return;e.forEach(e=>$.current.add(e)),R(t=>[...t,...e]);const t={};e.forEach(e=>{const a=B[e];if(a&&a.length>0){const n=new Set(z[e]||[]),r=a.filter(e=>!n.has(e));r.length>0&&(t[e]=r)}}),0!==Object.keys(t).length&&P(e=>{let a=!1;const r=(0,n.A)({},e);return Object.entries(t).forEach(e=>{let[t,n]=e;0===(r[t]||[]).length&&(r[t]=n,a=!0)}),a?r:e})},[G,A,B,z,R,P]);const X=(0,e.useMemo)(()=>(c||[]).filter(e=>!1!==e.on_roster).map(e=>({id:e.id,displayName:e.display_name||e.first_name||o("planMatches.unknownPlayer"),firstName:e.first_name||null,lastName:e.last_name||null,jerseyNumber:e.jersey_number})),[c,o]);(0,e.useEffect)(()=>{if(!J||0===A.length)return;const e=Math.max(0,(0,xi.getMinimumPlayersForFormat)(J.format)),t=X.length,a=t>0?"number"===typeof k&&k>0?Math.min(t,k):Math.min(t,e+2):0;j(e=>{let t=!1;const r=(0,n.A)({},e);return A.forEach(e=>{"number"!==typeof r[e.id]&&(r[e.id]=a,t=!0)}),t?r:e})},[J,A,X.length,k,j]);const Z=(0,e.useMemo)(()=>{const e=new Map;return K.forEach(t=>{e.set(t.playerId,t)}),e},[K]),ee=(0,e.useMemo)(()=>X.map(e=>{var t,a;const r=Z.get(e.id);return(0,n.A)((0,n.A)({},e),{},{practicesPerMatch:null!==(t=null===r||void 0===r?void 0:r.practicesPerMatch)&&void 0!==t?t:0,attendanceRate:null!==(a=null===r||void 0===r?void 0:r.attendanceRate)&&void 0!==a?a:0})}),[X,Z]),te=(0,e.useMemo)(()=>{const e=new Map;return ee.forEach(t=>{e.set(t.id,t)}),e},[ee]),ae=(0,e.useMemo)(()=>Rv(ee,C),[ee,C]),ne=(e,t)=>{if(!e)return o("teamMatches.timestamps.dateTbd");if(!t)return e;const a=t.slice(0,5);return"".concat(e," ").concat(a)},re=(0,e.useCallback)(e=>new Set(z[e]||[]),[z]),se=(0,e.useCallback)((e,t)=>{re(e).has(t)||P(a=>{const r=new Set(a[e]||[]);return r.has(t)?r.delete(t):r.add(t),(0,n.A)((0,n.A)({},a),{},{[e]:Array.from(r)})})},[re,P]),ie=(0,e.useCallback)((e,t)=>{const a=new Set(q[e]||[]),r=new Set(y[e]||[]);if(a.has(t)){const a=r.has(t);return x(r=>{const s=new Set(r[e]||[]);return a?s.delete(t):s.add(t),(0,n.A)((0,n.A)({},r),{},{[e]:Array.from(s)})}),a||b(a=>{const r=new Set(a[e]||[]);return r.has(t)?(r.delete(t),(0,n.A)((0,n.A)({},a),{},{[e]:Array.from(r)})):a}),void(a&&P(a=>{const r=new Set(a[e]||[]);return r.has(t)?(r.delete(t),(0,n.A)((0,n.A)({},a),{},{[e]:Array.from(r)})):a}))}const s=(v[e]||[]).includes(t);b(a=>{const r=new Set(a[e]||[]);return r.has(t)?r.delete(t):r.add(t),(0,n.A)((0,n.A)({},a),{},{[e]:Array.from(r)})}),s||P(a=>{const r=new Set(a[e]||[]);return r.has(t)?(r.delete(t),(0,n.A)((0,n.A)({},a),{},{[e]:Array.from(r)})):a})},[y,q,x,P,b,v]),oe=(0,e.useCallback)(e=>{b(t=>{const a=(0,n.A)({},t);return delete a[e],a}),x(t=>{const a=(0,n.A)({},t);return delete a[e],a});const t=B[e]||[],a=new Set(q[e]||[]),r=t.filter(e=>!a.has(e));P(t=>(0,n.A)((0,n.A)({},t),{},{[e]:r}))},[B,q,b,x,P]),le=(0,e.useCallback)((e,t)=>{P(a=>(0,n.A)((0,n.A)({},a),{},{[e]:t}))},[P]),ce=(0,e.useCallback)((e,t,a,r)=>{P(s=>{const i=[...s[e]||[]],o=[...s[a]||[]],l=i.indexOf(t),c=o.indexOf(r);return-1===l||-1===c?s:(i[l]=r,o[c]=t,(0,n.A)((0,n.A)({},s),{},{[e]:i,[a]:o}))})},[P]),{registerContainer:de,handleDragMove:ue,handleDragEnd:me,crossMatchState:he,swapAnimation:pe,slideInAnimation:fe}=function(t){let{selectedPlayersByMatch:a,unavailablePlayersByMatch:n,onSwapPlayers:r}=t;const[s,i]=(0,e.useState)(wv),[o,l]=(0,e.useState)(null),[c,d]=(0,e.useState)(null),u=(0,e.useRef)(wv),m=(0,e.useRef)(new Map),h=(0,e.useRef)(a),p=(0,e.useRef)(n),f=(0,e.useRef)(r),g=(0,e.useRef)(c),v=(0,e.useRef)(null),y=(0,e.useRef)(null);h.current=a,p.current=n,f.current=r,g.current=c;const b=(0,e.useCallback)((e,t)=>(m.current.set(e,t),()=>{m.current.delete(e)}),[]),x=(0,e.useCallback)(()=>{y.current&&(clearTimeout(y.current),y.current=null),v.current&&(clearTimeout(v.current),v.current=null)},[]),w=(0,e.useCallback)(()=>{x();const e=g.current;e&&(d(null),l(null),f.current&&f.current(e.sourceMatchId,e.sourcePlayerId,e.targetMatchId,e.targetPlayerId))},[x]),S=(0,e.useCallback)((e,t)=>{let{itemId:a,clientX:n,clientY:r}=e,s=null,o=null;for(const[i,u]of m.current.entries()){if(i===t)continue;const e=u.current;if(!e)continue;const a=e.getBoundingClientRect();if(n>=a.left&&n<=a.right&&r>=a.top&&r<=a.bottom){s=i,o=u;break}}if(!s||!o)return void(u.current.active&&(u.current=wv,i(wv)));const l=o.current;if(!l)return;const c=Array.from(l.querySelectorAll("[data-drag-item-id]"));let d=null;for(const i of c){const e=i.getBoundingClientRect();if(n>=e.left&&n<=e.right&&r>=e.top&&r<=e.bottom){d=i.dataset.dragItemId;break}}if(!d){if(null!==u.current.hoveredPlayerId){const e={active:!0,sourceMatchId:t,sourcePlayerId:a,targetMatchId:s,hoveredPlayerId:null,isEligible:!1};u.current=e,i(e)}return}const f=p.current[s]||[],g=p.current[t]||[],v=f.includes(a),y=g.includes(d),b=(h.current[t]||[]).includes(d),x=(h.current[s]||[]).includes(a),w=!v&&!y&&!b&&!x,S=u.current;if(S.hoveredPlayerId===d&&S.isEligible===w&&S.targetMatchId===s&&S.sourcePlayerId===a)return;const k={active:!0,sourceMatchId:t,sourcePlayerId:a,targetMatchId:s,hoveredPlayerId:d,isEligible:w};u.current=k,i(k)},[]),k=(0,e.useCallback)((e,t)=>{let{cancelled:a,clientX:n,clientY:r}=e;const s=u.current;if(!a&&s.active&&s.isEligible&&s.hoveredPlayerId&&f.current){y.current&&w(),v.current&&(clearTimeout(v.current),v.current=null),l(null);let e=null;const a=m.current.get(s.targetMatchId);if(null!==a&&void 0!==a&&a.current){const t=a.current.querySelector('[data-drag-item-id="'.concat(s.hoveredPlayerId,'"]'));t&&(e=t.getBoundingClientRect())}if(e&&null!=n&&null!=r){const a={sourceMatchId:t,sourcePlayerId:s.sourcePlayerId,targetMatchId:s.targetMatchId,targetPlayerId:s.hoveredPlayerId,releasePosition:{x:n,y:r},targetRect:e};d(a),y.current=setTimeout(()=>{y.current=null;let e=a.targetRect;const t=m.current.get(a.targetMatchId);if(null!==t&&void 0!==t&&t.current){const n=t.current.querySelector('[data-drag-item-id="'.concat(a.targetPlayerId,'"]'));if(n){const t=n.getBoundingClientRect();t.width>0&&t.height>0&&(e=t)}}d(null),f.current(a.sourceMatchId,a.sourcePlayerId,a.targetMatchId,a.targetPlayerId),v.current&&clearTimeout(v.current),l({playerId:a.targetPlayerId,fromRect:e,toMatchId:a.sourceMatchId,sourcePlayerId:a.sourcePlayerId,sourceNewMatchId:a.targetMatchId}),v.current=setTimeout(()=>{l(null),v.current=null},700)},500)}else f.current(t,s.sourcePlayerId,s.targetMatchId,s.hoveredPlayerId),e&&(v.current&&clearTimeout(v.current),l({playerId:s.hoveredPlayerId,fromRect:e,toMatchId:t,sourcePlayerId:s.sourcePlayerId,sourceNewMatchId:s.targetMatchId}),v.current=setTimeout(()=>{l(null),v.current=null},700))}u.current=wv,i(wv)},[w]);return(0,e.useEffect)(()=>x,[x]),{registerContainer:b,handleDragMove:S,handleDragEnd:k,crossMatchState:s,swapAnimation:o,slideInAnimation:c}}({selectedPlayersByMatch:_,unavailablePlayersByMatch:z,onSwapPlayers:ce}),ge=(0,e.useCallback)((e,t)=>{const a=(e=>{let{rosterWithStats:t,metric:a,targetCount:n,unavailableIds:r}=e;const s=Math.max(0,n||0),i=new Set(r||[]);return Rv(t,a).filter(e=>!i.has(e.id)).slice(0,s).map(e=>e.id)})({rosterWithStats:ee,metric:t,targetCount:S[e]||0,unavailableIds:z[e]});P(t=>(0,n.A)((0,n.A)({},t),{},{[e]:a}))},[z,ee,S,P]),ve=(0,e.useCallback)((e,t)=>{const a=(e=>{let{rosterWithStats:t,metric:a,matches:n,targetCounts:r,unavailableByMatch:s,ensureCoverage:i}=e;const o=Rv(t,a),l=(n||[]).map(e=>e.id),c=l.reduce((e,t)=>(e[t]=(null===r||void 0===r?void 0:r[t])||0,e),{}),d=l.reduce((e,t)=>e+c[t],0),u=i&&d>=o.length,m=l.reduce((e,t)=>(e[t]=[],e),{});return u&&o.forEach(e=>{const t=l.filter(t=>!(m[t].length>=c[t])&&!new Set((null===s||void 0===s?void 0:s[t])||[]).has(e.id));0!==t.length&&(t.sort((e,t)=>m[e].length-m[t].length),m[t[0]].push(e.id))}),l.forEach(e=>{const t=c[e],a=new Set((null===s||void 0===s?void 0:s[e])||[]);o.forEach(n=>{m[e].length>=t||a.has(n.id)||m[e].includes(n.id)||m[e].push(n.id)})}),m})({rosterWithStats:ee,metric:e,matches:A,targetCounts:S,unavailableByMatch:z,ensureCoverage:t});P(e=>(0,n.A)((0,n.A)({},e),a))},[A,z,ee,S,P]),ye=(0,e.useCallback)(e=>A.filter(t=>(_[t.id]||[]).includes(e)).length>1,[A,_]),be=(0,e.useCallback)((e,t)=>A.some(a=>a.id!==e&&(_[a.id]||[]).includes(t)),[A,_]),we=(0,e.useCallback)((e,t)=>{if(A.length<2)return!1;return!!(_[e]||[]).includes(t)&&A.some(a=>a.id!==e&&(z[a.id]||[]).includes(t))},[A,z,_]),Se=async e=>{var t;if(null===l||void 0===l||!l.id||!J)return;const a=_[e.id]||[];if(0===a.length)return void m({isOpen:!0,title:o("planMatches.notifications.noPlayersTitle"),message:o("planMatches.notifications.noPlayersMessage")});D(t=>(0,n.A)((0,n.A)({},t),{},{[e.id]:"loading"}));const r=await async function(e){let{teamId:t,teamName:a,upcomingMatch:n,selectedSquadIds:r,rosterPlayers:s,defaults:i}=e;if(!t)return{success:!1,error:"Team ID is required."};if(null===n||void 0===n||!n.id)return{success:!1,error:"Upcoming match is required."};if(!Array.isArray(r)||0===r.length)return{success:!1,error:"Select at least one player for the match."};if(null===i||void 0===i||!i.format||null===i||void 0===i||!i.formation)return{success:!1,error:"Match defaults are missing."};try{const e=r.length,o=(0,xi.createTeamConfig)(i.format,e,i.formation),l=(0,wi.getInitialFormationTemplate)(o),c=tl({teamConfig:o,selectedFormation:i.formation,periods:i.periods,periodDurationMinutes:i.periodDurationMinutes,opponentTeam:n.opponent,matchType:i.matchType,venueType:i.venueType,teamName:a},t),d=ul({formation:l,teamConfig:o,matchData:c,matchType:i.matchType,venueType:i.venueType,opponentTeam:n.opponent,numPeriods:i.periods,periodDurationMinutes:i.periodDurationMinutes,captainId:null,periodGoalieIds:{},selectedSquadIds:r}),u=function(e){return(e||[]).map(e=>({id:e.id,displayName:e.display_name||e.first_name||"Unknown Player",firstName:e.first_name||e.display_name||"Unknown Player",lastName:e.last_name||null,stats:{startedMatchAs:null,startedAtRole:null,startedAtPosition:null,startLocked:!1,periodsAsGoalie:0,periodsAsDefender:0,periodsAsAttacker:0,periodsAsMidfielder:0,timeOnFieldSeconds:0,timeAsSubSeconds:0,timeAsGoalieSeconds:0,timeAsDefenderSeconds:0,timeAsAttackerSeconds:0,timeAsMidfielderSeconds:0,currentRole:null,currentStatus:null,lastStintStartTimeEpoch:0,currentPositionKey:null,isInactive:!1,isCaptain:!1,goals:0,saves:0,blocks:0,cards:[],hasFairPlayAward:!1}}))}(s),m=await Ko(c,u,r);if(!m.success)return{success:!1,error:m.error||"Failed to create planned match."};const h=m.matchId,p=await ll(h,d);if(!p.success)return await cl(h),{success:!1,error:p.error||"Failed to save match configuration."};Wo(h,{ownTeamName:a||null,opponentTeamName:n.opponent||null,totalPeriods:i.periods,periodDurationMinutes:i.periodDurationMinutes}).catch(e=>{console.warn("Failed to log match_created event:",e)});const{data:f,error:g}=await Ur.rpc("link_upcoming_match_to_planned_match",{p_upcoming_match_id:n.id,p_planned_match_id:h});if(g||null===f||void 0===f||!f.success){const e=(null===f||void 0===f?void 0:f.message)||(null===f||void 0===f?void 0:f.error)||(null===g||void 0===g?void 0:g.message);return console.error("Failed to link upcoming match to planned match:",g||f),{success:!0,matchId:h,warning:e?"Planned match created, but upcoming match was not linked: ".concat(e):"Planned match created, but upcoming match was not linked."}}return{success:!0,matchId:h}}catch(o){return console.error("Exception while planning upcoming match:",o),{success:!1,error:"Unexpected error: ".concat(o.message)}}}({teamId:l.id,teamName:(null===(t=l.club)||void 0===t?void 0:t.name)||l.name||null,upcomingMatch:e,selectedSquadIds:a,rosterPlayers:c,defaults:J});r.success?(D(t=>(0,n.A)((0,n.A)({},t),{},{[e.id]:"done"})),I(t=>{const a=String(e.id);return t.some(e=>String(e)===a)?t:[...t,a]}),m({isOpen:!0,title:o("planMatches.notifications.matchPlanned"),message:r.warning||o("planMatches.notifications.pendingCreated")})):(D(t=>(0,n.A)((0,n.A)({},t),{},{[e.id]:"error"})),m({isOpen:!0,title:o("planMatches.notifications.planningFailed"),message:r.error||o("planMatches.notifications.planningFailedMessage")}))};return null!==l&&void 0!==l&&l.id?0===A.length?(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("h1",{className:"text-2xl font-bold text-sky-300",children:o("planMatches.title")}),(0,Ts.jsx)(Lc,{onClick:a,variant:"secondary",size:"sm",children:o("planMatches.back")})]}),(0,Ts.jsx)(Xc,{padding:"lg",className:"text-slate-300 text-sm",children:o("planMatches.noMatches")})]}):(0,Ts.jsxs)("div",{className:"space-y-4 lg:space-y-3",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("div",{className:"flex items-center gap-3",children:(0,Ts.jsx)("h1",{className:"text-2xl font-bold text-sky-300",children:o("planMatches.title")})}),(0,Ts.jsx)(Lc,{onClick:a,variant:"secondary",size:"sm",children:o("planMatches.back")})]}),(0,Ts.jsx)(Ev,{sortMetric:C,onSortChange:E,statsLoading:W,statsError:Y,defaultsError:Q,onRecommend:()=>{g(null),p(!0),r&&r(()=>p(!1),"PlanMatches-AutoSelect")}}),(0,Ts.jsx)("div",{className:"grid gap-4 ".concat(A.length>1?"lg:grid-cols-2":""),children:A.map(e=>{const t=_[e.id]||[],a=z[e.id]||[],n=q[e.id]||[],r=U[e.id]||null,s=r&&t.some(e=>"accepted"===r[e])?r:null;return(0,Ts.jsx)(Cv,{match:e,matchId:e.id,matchCount:A.length,roster:ae,rosterById:te,selectedIds:t,unavailableIds:a,providerUnavailableIds:n,playerResponses:s,sortMetric:C,planningStatus:O[e.id],canPlan:Boolean(J),onClearOverrides:()=>oe(e.id),onPlanMatch:()=>Se(e),onToggleSelect:t=>se(e.id,t),onToggleUnavailable:t=>ie(e.id,t),formatSchedule:ne,isSelectedInOtherMatch:t=>be(e.id,t),isSelectedAndOnlyAvailableHere:t=>we(e.id,t),isPlayerInMultipleMatches:ye,onReorderSelectedPlayers:le,registerContainer:de,onCrossDragMove:ue,onCrossDragEnd:me,crossMatchState:he,swapAnimation:pe,slideInAnimation:fe},e.id)})}),(0,Ts.jsx)(Mv,{isOpen:h,matches:A,autoSelectMatches:L,rosterCount:X.length,targetCounts:S,autoSelectSettings:w,onUpdateTargetCount:(e,t)=>{const a=Number(t),r=Number.isFinite(a)?Math.max(0,a):0,s=X.length>0?Math.min(X.length,r):r;j(t=>(0,n.A)((0,n.A)({},t),{},{[e]:s})),T(s)},onUpdateSettings:N,onCancel:()=>{p(!1),s&&s(),g(null)},onConfirm:()=>{var e;if(p(!1),s&&s(),A.length>1)return ve(w.metric,w.ensureCoverage),void g(null);const t=f||(null===(e=A[0])||void 0===e?void 0:e.id);t&&ge(t,C),g(null)},formatSchedule:ne}),(0,Ts.jsx)(Uc,{isOpen:u.isOpen,onClose:()=>m({isOpen:!1,title:"",message:""}),title:u.title,message:u.message})]}):(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsx)("h1",{className:"text-2xl font-bold text-sky-300",children:o("planMatches.title")}),(0,Ts.jsx)(Lc,{onClick:a,variant:"secondary",size:"sm",children:o("planMatches.back")})]}),(0,Ts.jsx)(Xc,{padding:"lg",className:"text-slate-300 text-sm",children:o("planMatches.teamRequired")})]})}function Fv(e){let{isOpen:t,onAbandon:a,onCancel:n,isMatchRunning:r}=e;const{t:s}=xe("modals");if(!t)return null;const i=s(r?"abandonMatch.titleRunning":"abandonMatch.titleNotRunning"),o=s(r?"abandonMatch.messageRunning":"abandonMatch.messageNotRunning"),l=s(r?"abandonMatch.subtitleRunning":"abandonMatch.subtitleNotRunning");return(0,Ts.jsxs)(Mc,{title:i,subtitle:l,icon:lu,iconColor:r?"amber":"blue",onClose:n,children:[(0,Ts.jsx)("p",{className:"text-slate-200 mb-6 leading-relaxed",children:o}),(0,Ts.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,Ts.jsx)(Lc,{onClick:n,variant:"accent",className:"w-full",children:s("abandonMatch.cancel")}),(0,Ts.jsx)(Lc,{onClick:a,variant:"danger",className:"w-full",children:s(r?"abandonMatch.abandonMatch":"abandonMatch.startNewGame")})]})]})}const Lv=fc("volume-2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),qv=fc("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),Uv=fc("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]);function Bv(t){var a,r;let{isOpen:s,onClose:i}=t;const{t:o}=xe("modals"),{preferences:l,updateAudioPreferences:c,updateLanguagePreference:d,updateThemePreference:u,preferencesLoading:m}=Pl(),[h,p]=(0,e.useState)(!1),[f,g]=(0,e.useState)(null),[v,y]=(0,e.useState)({});(0,e.useEffect)(()=>{if(s&&!m){g(null),wl.triggerFullPreload();const e={};fl.forEach(t=>{e[t.value]={loaded:wl.isLoaded(t.value),loading:wl.isLoading(t.value)}}),y(e)}},[s,m]);const b=(0,e.useCallback)(async()=>{if(h||!l.audio.enabled)return;const e=l.audio.selectedSound;p(!0),g(null),y(t=>(0,n.A)((0,n.A)({},t),{},{[e]:(0,n.A)((0,n.A)({},t[e]),{},{loading:!wl.isLoaded(e)})}));try{await wl.play(e,l.audio.volume),y(t=>(0,n.A)((0,n.A)({},t),{},{[e]:{loaded:!0,loading:!1}}))}catch(t){console.error("Failed to test sound:",t),g(t.message),y(t=>(0,n.A)((0,n.A)({},t),{},{[e]:{loaded:!1,loading:!1}}))}finally{setTimeout(()=>p(!1),1e3)}},[l.audio,h]),x=(0,e.useCallback)(e=>{if(c(e),e.selectedSound&&e.selectedSound!==l.audio.selectedSound){const t=e.selectedSound;if(y(e=>(0,n.A)((0,n.A)({},e),{},{[t]:{loaded:wl.isLoaded(t),loading:!wl.isLoaded(t)}})),!wl.isLoaded(t)){const e=wl.loadSound(t,!0);e&&"function"===typeof e.then&&e.then(()=>{y(e=>(0,n.A)((0,n.A)({},e),{},{[t]:{loaded:!0,loading:!1}}))}).catch(()=>{y(e=>(0,n.A)((0,n.A)({},e),{},{[t]:{loaded:!1,loading:!1}}))})}}},[l.audio,c]);if(!s)return null;if(m)return(0,Ts.jsx)(Mc,{title:o("preferences.title"),children:(0,Ts.jsxs)("div",{className:"flex items-center justify-center space-x-3",children:[(0,Ts.jsx)("div",{className:"w-4 h-4 border-2 border-sky-400 border-t-transparent rounded-full animate-spin"}),(0,Ts.jsx)("span",{className:"text-slate-100",children:o("preferences.loadingPreferences")})]})});const w=fl.map(e=>({value:e.value,label:e.label})),S=gl.map(e=>({value:e.value,label:e.label})),k=vl.map(e=>({value:e.value,label:e.label}));return(0,Ts.jsx)(Mc,{title:o("preferences.title"),icon:yc,iconColor:"sky",onClose:i,className:"max-h-[90vh] overflow-y-auto",children:(0,Ts.jsxs)("div",{className:"space-y-8",children:[(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-3 border-b border-slate-600 pb-2",children:[(0,Ts.jsx)(Lv,{className:"h-5 w-5 text-sky-400"}),(0,Ts.jsx)("h3",{className:"text-lg font-medium text-sky-200",children:o("preferences.substitutionAlerts")})]}),(0,Ts.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{className:"text-sm font-medium text-slate-100",children:o("preferences.enableAudioAlerts")}),(0,Ts.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:o("preferences.enableAudioDescription")})]}),(0,Ts.jsx)("button",{onClick:()=>x({enabled:!l.audio.enabled}),className:"relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-offset-2 focus:ring-offset-slate-800 ".concat(l.audio.enabled?"bg-sky-600":"bg-slate-600"),"aria-label":l.audio.enabled?o("preferences.disableAudioLabel"):o("preferences.enableAudioLabel"),children:(0,Ts.jsx)("span",{className:"inline-block w-4 h-4 transform bg-white rounded-full transition-transform ".concat(l.audio.enabled?"translate-x-6":"translate-x-1")})})]}),(0,Ts.jsxs)("div",{className:"space-y-3 transition-opacity ".concat(l.audio.enabled?"":"opacity-50"),children:[(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{className:"block text-sm font-medium text-slate-100 mb-2",children:o("preferences.alertSound")}),(0,Ts.jsxs)("div",{className:"flex space-x-2",children:[(0,Ts.jsx)("div",{className:"flex-1",children:(0,Ts.jsx)(Dc,{value:l.audio.selectedSound,onChange:e=>x({selectedSound:e}),options:w,disabled:!l.audio.enabled})}),(0,Ts.jsx)("button",{onClick:b,disabled:h||!l.audio.enabled,className:"px-3 py-2 bg-slate-700 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed text-slate-100 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-offset-2 focus:ring-offset-slate-800",title:null!==(a=v[l.audio.selectedSound])&&void 0!==a&&a.loading?o("preferences.loadingSound"):o("preferences.previewSound"),children:null!==(r=v[l.audio.selectedSound])&&void 0!==r&&r.loading&&!h?(0,Ts.jsx)(gd,{className:"h-4 w-4 animate-spin"}):(0,Ts.jsx)(kc,{className:"h-4 w-4"})})]}),f&&(0,Ts.jsx)("p",{className:"text-xs text-rose-400 mt-1",children:o("preferences.unableToPreview",{error:f})}),h&&!f&&(0,Ts.jsx)("p",{className:"text-xs text-emerald-400 mt-1",children:o("preferences.playingPreview")})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)(Lv,{className:"h-4 w-4 text-slate-400"}),(0,Ts.jsx)("label",{className:"text-sm font-medium text-slate-100",children:o("preferences.volume")})]}),(0,Ts.jsxs)("span",{className:"text-sm text-slate-400 font-mono",children:[Math.round(100*l.audio.volume),"%"]})]}),(0,Ts.jsx)(Wc,{value:l.audio.volume,onChange:e=>x({volume:e}),min:0,max:1,step:.05,disabled:!l.audio.enabled,className:"w-full"}),(0,Ts.jsxs)("div",{className:"flex justify-between text-xs text-slate-500 mt-1",children:[(0,Ts.jsx)("span",{children:"0%"}),(0,Ts.jsx)("span",{children:"100%"})]})]})]}),(0,Ts.jsx)("div",{className:"bg-slate-700 rounded-lg p-3",children:(0,Ts.jsxs)("p",{className:"text-xs text-slate-300 leading-relaxed",children:[(0,Ts.jsx)("strong",{children:o("preferences.noteLabel")})," ",o("preferences.audioNote")]})})]}),(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-3 border-b border-slate-600 pb-2",children:[(0,Ts.jsx)(qv,{className:"h-5 w-5 text-sky-400"}),(0,Ts.jsx)("h3",{className:"text-lg font-medium text-sky-200",children:o("preferences.language")})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{className:"block text-sm font-medium text-slate-100 mb-2",children:o("preferences.applicationLanguage")}),(0,Ts.jsx)(Dc,{value:l.language,onChange:d,options:S}),(0,Ts.jsx)("p",{className:"text-xs text-slate-400 mt-2",children:o("preferences.moreLanguages")})]})]}),(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-3 border-b border-slate-600 pb-2",children:[(0,Ts.jsx)(Uv,{className:"h-5 w-5 text-sky-400"}),(0,Ts.jsx)("h3",{className:"text-lg font-medium text-sky-200",children:o("preferences.uiTheme")})]}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("label",{className:"block text-sm font-medium text-slate-100 mb-2",children:o("preferences.colorTheme")}),(0,Ts.jsx)(Dc,{value:l.theme,onChange:u,options:k}),(0,Ts.jsx)("p",{className:"text-xs text-slate-400 mt-2",children:o("preferences.moreThemes")})]})]})]})})}function Gv(){const{preferences:t}=Pl(),{i18n:a}=xe();return(0,e.useEffect)(()=>{t.language&&a.language!==t.language&&a.changeLanguage(t.language)},[t.language,a]),null}function zv(t){let{isOpen:a,onExtend:n,onDismiss:r,onSignOut:s,sessionExpiry:i,loading:o}=t;const{t:l}=xe("auth"),[c,d]=(0,e.useState)(""),[u,m]=(0,e.useState)(!1);(0,e.useEffect)(()=>{if(!a||!i)return;const e=()=>{const e=Date.now(),t=i.getTime()-e;if(t<=0)return void d(l("sessionExpiry.expired"));const a=Math.floor(t/6e4),n=Math.floor(t%6e4/1e3);d(a>0?"".concat(a,":").concat(n.toString().padStart(2,"0")):l("sessionExpiry.seconds",{count:n}))};e();const t=setInterval(e,1e3);return()=>clearInterval(t)},[a,i,l]);return a?(0,Ts.jsxs)(Mc,{title:l("sessionExpiry.title"),icon:lu,iconColor:"amber",maxWidth:"lg",children:[(0,Ts.jsxs)("div",{className:"space-y-3",children:[(0,Ts.jsxs)("p",{className:"text-sm text-slate-300",children:[l("sessionExpiry.message",{time:c}).split(c)[0],(0,Ts.jsx)("span",{className:"font-semibold text-amber-400",children:c}),l("sessionExpiry.message",{time:c}).split(c)[1]]}),(0,Ts.jsx)("div",{className:"bg-slate-700/50 rounded-lg p-3 border border-slate-600",children:(0,Ts.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)("svg",{className:"w-4 h-4 text-sky-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,Ts.jsx)("p",{className:"text-xs text-slate-400",children:l("sessionExpiry.autoSaveInfo")})]})})]}),(0,Ts.jsxs)("div",{className:"flex flex-col sm:flex-row-reverse gap-3 pt-4 border-t border-slate-600 mt-4",children:[(0,Ts.jsx)(Lc,{onClick:async()=>{m(!0);try{await n()||console.error("Session extension failed")}catch(e){console.error("Error extending session:",e)}finally{m(!1)}},disabled:u||o,variant:"primary",className:"w-full sm:w-auto",children:u?(0,Ts.jsxs)("span",{className:"flex items-center justify-center",children:[(0,Ts.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,Ts.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Ts.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),l("sessionExpiry.extendingButton")]}):l("sessionExpiry.extendButton")}),(0,Ts.jsx)(Lc,{onClick:r,disabled:u||o,variant:"secondary",className:"w-full sm:w-auto",children:l("sessionExpiry.continueButton")}),(0,Ts.jsx)(Lc,{onClick:()=>{s()},disabled:u||o,variant:"secondary",className:"w-full sm:w-auto text-rose-300 hover:text-rose-200 hover:bg-rose-900/50",children:l("sessionExpiry.signOutButton")})]})]}):null}function Vv(e){let{setView:t,onClose:a}=e;const{t:n}=xe("auth"),{markProfileCompleted:r}=Cs();return(0,Ts.jsxs)(Mc,{title:n("profileCompletion.welcome"),subtitle:n("profileCompletion.subtitle"),icon:Xu,iconColor:"sky",children:[(0,Ts.jsxs)(Xc,{className:"mb-6",children:[(0,Ts.jsx)("h3",{className:"text-sm font-semibold text-slate-300 mb-3",children:n("profileCompletion.benefitsTitle")}),(0,Ts.jsxs)("ul",{className:"space-y-2 text-sm text-slate-400",children:[(0,Ts.jsxs)("li",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)("svg",{className:"w-4 h-4 text-emerald-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,Ts.jsx)("span",{children:n("profileCompletion.benefits.personalize")})]}),(0,Ts.jsxs)("li",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)("svg",{className:"w-4 h-4 text-emerald-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,Ts.jsx)("span",{children:n("profileCompletion.benefits.displayName")})]}),(0,Ts.jsxs)("li",{className:"flex items-center space-x-2",children:[(0,Ts.jsx)("svg",{className:"w-4 h-4 text-emerald-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ts.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,Ts.jsx)("span",{children:n("profileCompletion.benefits.preferences")})]})]})]}),(0,Ts.jsxs)("div",{className:"space-y-3",children:[(0,Ts.jsx)(Lc,{onClick:()=>{r(),t(bi.PROFILE)},variant:"primary",size:"lg",className:"w-full",children:n("profileCompletion.completeButton")}),(0,Ts.jsx)("button",{onClick:()=>{r(),a&&a()},className:"w-full text-slate-400 hover:text-slate-300 text-sm transition-colors py-2",children:n("profileCompletion.skipButton")})]}),(0,Ts.jsx)("p",{className:"text-xs text-slate-500 mt-4 text-center",children:n("profileCompletion.finePrint")})]})}const Hv=Bs(Br.PENDING_INVITATION,{invitation:null}),Kv=(e,t)=>!!t.hasInvitation&&(!(!e&&t.isCustomInvitation)&&!!(t.teamId&&t.role&&t.invitationId)),Wv=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e.isSupabaseInvitation||!e.accessToken)return!1;if(!t)return!0;const a=t.invited_at,n=t.confirmed_at,r=t.last_sign_in_at;if(a&&n&&r){const e=new Date(n).getTime(),t=new Date(r).getTime();return Math.abs(t-e)<6e4}return!1},Yv=(e,t)=>t.hasInvitation?Wv(t,e)?{type:"account_setup",messageKey:"auth:invitation.statusMessages.accountSetup"}:t.isCustomInvitation&&!e?{type:"sign_in_required",messageKey:"auth:invitation.statusMessages.signInRequired"}:e&&Kv(e,t)?{type:"ready_to_process",messageKey:"auth:invitation.statusMessages.processing"}:{type:"unknown"}:{type:"none"},Jv=e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"admin":return"Administrator";case"coach":return"Coach";case"parent":return"Parent";case"player":return"Player";default:return e||"Member"}};function Qv(t){let{invitationParams:a,onInvitationProcessed:n,onRequestSignIn:r}=t;const{t:s}=xe("auth"),{user:i,signOut:o,enableProfileFetchSkip:l,disableProfileFetchSkip:c}=Cs(),{acceptTeamInvitation:d,loading:u,error:m}=vi(),[h,p]=(0,e.useState)(""),[f,g]=(0,e.useState)(""),[v,y]=(0,e.useState)(""),[b,x]=(0,e.useState)(!1),[w,S]=(0,e.useState)(!1),k=(e=>e.hasInvitation?{teamId:e.teamId,role:e.role,invitationId:e.invitationId,displayRole:Jv(e.role)}:null)(a),N=Yv(i,a),j=Wv(a,i),T=()=>{if(null!==a&&void 0!==a&&a.isSupabaseInvitation&&null!==a&&void 0!==a&&a.accessToken){const e=(e=>{if(!e)return null;try{var t;const a=e.split(".")[1];if(!a)return null;const n=Uint8Array.from(atob(a),e=>e.charCodeAt(0)),r=new TextDecoder("utf-8").decode(n);return(null===(t=JSON.parse(r).user_metadata)||void 0===t?void 0:t.team_name)||null}catch(m){return console.error("Error decoding JWT:",m),null}})(a.accessToken);if(e)return e}return(null===k||void 0===k?void 0:k.teamName)||s("invitation.loadingTeam")},A=(e=>{switch(null===e||void 0===e?void 0:e.toLowerCase()){case"admin":return dd;case"coach":case"player":default:return od;case"parent":return bc}})(null===k||void 0===k?void 0:k.role);return(0,Ts.jsxs)(Mc,{title:s("invitation.title"),subtitle:s("invitation.subtitle"),icon:xu,iconColor:"sky",children:[k&&(0,Ts.jsx)(Xc,{className:"mb-6",children:(0,Ts.jsxs)("div",{className:"space-y-3",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ts.jsx)(od,{className:"w-5 h-5 text-sky-400"}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("p",{className:"text-slate-300 font-medium",children:s("invitation.teamLabel")}),(0,Ts.jsx)("p",{className:"text-slate-400 text-sm",children:T()})]})]}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ts.jsx)(A,{className:"w-5 h-5 text-emerald-400"}),(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("p",{className:"text-slate-300 font-medium",children:s("invitation.roleLabel")}),(0,Ts.jsx)("p",{className:"text-slate-400 text-sm",children:k.displayRole})]})]})]})}),w?(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)(Jc,{variant:"success",icon:kd,className:"mb-4",children:[(0,Ts.jsx)("p",{className:"text-emerald-200 text-lg font-medium mb-2",children:s("invitation.passwordSuccess.title")}),(0,Ts.jsx)("p",{className:"text-emerald-300 text-sm mb-3",children:s("invitation.passwordSuccess.message")}),(0,Ts.jsxs)("div",{className:"bg-emerald-800/50 rounded-lg p-3 mb-3",children:[(0,Ts.jsx)("p",{className:"text-emerald-200 text-sm font-medium",children:s("invitation.passwordSuccess.nextStepsTitle")}),(0,Ts.jsxs)("ul",{className:"text-emerald-300 text-sm mt-1 space-y-1",children:[(0,Ts.jsxs)("li",{children:["\u2022 ",s("invitation.passwordSuccess.step1")]}),(0,Ts.jsxs)("li",{children:["\u2022 ",s("invitation.passwordSuccess.step2",{email:null===i||void 0===i?void 0:i.email})]}),(0,Ts.jsxs)("li",{children:["\u2022 ",s("invitation.passwordSuccess.step3")]})]})]})]}),(0,Ts.jsx)(Lc,{onClick:async()=>{try{x(!0),c(),await o(),r&&r(null===i||void 0===i?void 0:i.email)}catch(m){console.error("Error signing out:",m),y(s("invitation.errors.signOutFailed"))}finally{x(!1)}},variant:"primary",size:"lg",disabled:b,className:"w-full",children:s(b?"invitation.passwordSuccess.buttonProcessing":"invitation.passwordSuccess.button")})]}):"account_setup"===N.type&&j&&(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)(Jc,{variant:"info",icon:kd,className:"mb-4",children:[(0,Ts.jsx)("p",{className:"text-sky-200 text-sm font-medium",children:s("invitation.accountSetup.statusTitle")}),(0,Ts.jsx)("p",{className:"text-sky-300 text-sm",children:s("invitation.accountSetup.statusMessage")})]}),(0,Ts.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),h!==f)return void y(s("invitation.errors.passwordMismatch"));const t=Jm(h,{t:s});var a;if(t.isValid)try{x(!0),y(""),l(),console.log("Setting password for authenticated user...");const{data:e,error:t}=await Ur.auth.updateUser({password:h});if(t)throw t;console.log("Password updated successfully",e),S(!0),a={invitationId:null===k||void 0===k?void 0:k.invitationId,teamName:T(),role:null===k||void 0===k?void 0:k.role,email:null===i||void 0===i?void 0:i.email},"undefined"!==typeof window&&Hv.saveState({invitation:a}),console.log("Password setup complete. User will be signed out and redirected to sign-in.")}catch(m){console.error("Error setting up account:",m),y(m.message||s("invitation.errors.setupFailed")),c()}finally{x(!1)}else y(t.error)},className:"space-y-4",children:[(0,Ts.jsxs)(Pd,{label:s("invitation.accountSetup.passwordLabel"),htmlFor:"password",children:[(0,Ts.jsx)(Rc,{id:"password",type:"password",value:h,onChange:e=>p(e.target.value),placeholder:s("invitation.accountSetup.passwordPlaceholder"),disabled:b}),(0,Ts.jsx)("p",{className:"text-slate-500 text-xs mt-1",children:s("invitation.accountSetup.passwordRequirements")})]}),(0,Ts.jsx)(Pd,{label:s("invitation.accountSetup.confirmLabel"),htmlFor:"confirm-password",children:(0,Ts.jsx)(Rc,{id:"confirm-password",type:"password",value:f,onChange:e=>g(e.target.value),placeholder:s("invitation.accountSetup.confirmPlaceholder"),disabled:b})}),v&&(0,Ts.jsx)(Jc,{variant:"error",icon:lu,children:v}),(0,Ts.jsx)(Lc,{type:"submit",variant:"primary",size:"lg",disabled:b||!h||!f,className:"w-full",children:s(b?"invitation.accountSetup.submittingButton":"invitation.accountSetup.submitButton")})]})]}),"ready_to_process"===N.type&&i&&(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsxs)(Jc,{variant:"success",icon:kd,className:"mb-4",children:[(0,Ts.jsx)("p",{className:"text-emerald-200 text-sm font-medium",children:s("invitation.readyToJoin.statusTitle")}),(0,Ts.jsx)("p",{className:"text-emerald-300 text-sm",children:s("invitation.readyToJoin.statusMessage")})]}),m&&(0,Ts.jsx)(Jc,{variant:"error",icon:lu,children:m}),(0,Ts.jsx)(Lc,{onClick:async()=>{if(null!==k&&void 0!==k&&k.invitationId)try{x(!0);const e=await d(k.invitationId);e.success&&(null===n||void 0===n||n(e))}catch(m){console.error("Error accepting invitation:",m)}finally{x(!1)}else console.error("No invitation ID available")},variant:"primary",size:"lg",disabled:b||u,className:"w-full",children:s(b||u?"invitation.readyToJoin.processingButton":"invitation.readyToJoin.acceptButton")})]}),"sign_in_required"===N.type&&(0,Ts.jsxs)("div",{className:"space-y-4",children:[(0,Ts.jsx)(Xc,{children:(0,Ts.jsx)("p",{className:"text-slate-300 text-sm text-center",children:s("invitation.signInRequired.message")})}),(0,Ts.jsx)("div",{className:"text-center text-xs text-slate-500",children:s("invitation.signInRequired.closeInstruction")})]}),(0,Ts.jsx)("div",{className:"mt-6 text-center",children:(0,Ts.jsx)("p",{className:"text-xs text-slate-500",children:s("invitation.validity")})})]})}function $v(t){let{isOpen:a,invitations:n,onClose:r,onInvitationProcessed:s}=t;const{t:i,i18n:o}=xe("team"),{acceptTeamInvitation:l,declineTeamInvitation:c,getUserTeams:d,switchCurrentTeam:u,getTeamPlayers:m,getClubMemberships:h,loading:p}=vi(),[f,g]=(0,e.useState)(new Set),[v,y]=(0,e.useState)("");if(!a||!n||0===n.length)return null;return(0,Ts.jsxs)(Mc,{title:i("invitationNotification.title"),icon:od,iconColor:"blue",onClose:r,maxWidth:"2xl",className:"max-h-[90vh] overflow-y-auto",children:[v&&(0,Ts.jsx)(Jc,{variant:"success",icon:kd,className:"mb-4",children:v}),(0,Ts.jsx)("p",{className:"text-slate-300 text-sm mb-6",children:1===n.length?i("invitationNotification.inviteDescription"):i("invitationNotification.inviteDescriptionPlural",{count:n.length})}),(0,Ts.jsx)("div",{className:"space-y-4",children:n.map(e=>{return(0,Ts.jsxs)(Xc,{variant:"subtle",children:[(0,Ts.jsx)("div",{className:"flex items-start justify-between mb-3",children:(0,Ts.jsxs)("div",{children:[(0,Ts.jsx)("h3",{className:"font-medium text-slate-100 mb-1",children:(a=e.team,a.club&&a.club.long_name?"".concat(a.club.long_name," ").concat(a.name):a.name)}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-slate-400",children:[(0,Ts.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Ts.jsx)(md,{className:"w-4 h-4"}),(0,Ts.jsx)("span",{children:i("invitationNotification.role",{role:e.role})})]}),(0,Ts.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,Ts.jsx)(Id,{className:"w-4 h-4"}),(0,Ts.jsx)("span",{children:i("invitationNotification.expires",{date:(t=e.expiresAt,new Date(t).toLocaleDateString(o.language,{month:"short",day:"numeric",year:"numeric"}))})})]})]})]})}),e.invitedBy&&(0,Ts.jsx)("p",{className:"text-sm text-slate-300 mb-3",children:i("invitationNotification.invitedBy",{name:e.invitedBy.name})}),e.message&&(0,Ts.jsx)("div",{className:"mb-4 p-3 bg-slate-600/30 rounded border-l-4 border-blue-400",children:(0,Ts.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,Ts.jsx)(du,{className:"w-4 h-4 text-blue-400 mt-0.5 flex-shrink-0"}),(0,Ts.jsx)("p",{className:"text-sm text-slate-200",children:e.message})]})}),(0,Ts.jsxs)("div",{className:"flex items-center justify-end space-x-3",children:[(0,Ts.jsx)(Lc,{onClick:()=>(async e=>{if(!f.has(e.id)){g(t=>new Set([...t,e.id]));try{const t=await c(e.id);t.success?null===s||void 0===s||s(e,"declined"):console.error("Failed to decline invitation:",t.error)}catch(t){console.error("Error declining invitation:",t)}finally{g(t=>{const a=new Set(t);return a.delete(e.id),a})}}})(e),disabled:p||f.has(e.id),variant:"secondary",size:"sm",Icon:f.has(e.id)?null:uu,children:f.has(e.id)?(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-slate-400"}),i("invitationNotification.buttons.declining")]}):i("invitationNotification.buttons.decline")}),(0,Ts.jsx)(Lc,{onClick:()=>(async e=>{if(!f.has(e.id)){g(t=>new Set([...t,e.id]));try{const r=await l(e.id);if(r.success){y(i("invitationNotification.successJoined",{teamName:e.team.name}));try{const n=await d();if(n&&n.length>0){const r=n.find(t=>t.id===e.teamId);if(r){await u(r.id);try{await h()}catch(t){console.error("Error refreshing club memberships:",t)}try{await m(r.id)}catch(a){console.error("Error loading team players:",a)}}}}catch(n){console.error("Error refreshing team data:",n)}null===s||void 0===s||s(e,"accepted"),setTimeout(()=>{y("")},3e3)}else console.error("Failed to accept invitation:",r.error)}catch(r){console.error("Error accepting invitation:",r)}finally{g(t=>{const a=new Set(t);return a.delete(e.id),a})}}})(e),disabled:p||f.has(e.id),variant:"primary",size:"sm",Icon:f.has(e.id)?null:kd,children:f.has(e.id)?(0,Ts.jsxs)(Ts.Fragment,{children:[(0,Ts.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),i("invitationNotification.buttons.accepting")]}):i("invitationNotification.buttons.accept")})]})]},e.id);var t,a})}),(0,Ts.jsx)("div",{className:"mt-6 pt-4 border-t border-slate-600",children:(0,Ts.jsx)("div",{className:"flex items-center justify-end",children:(0,Ts.jsx)(Lc,{onClick:r,variant:"secondary",Icon:Sd,children:i("invitationNotification.buttons.decideLater")})})})]})}function Xv(){const[t,a]=(0,e.useState)(null);(0,e.useEffect)(()=>{(async()=>{const e=(()=>{if("undefined"===typeof window)return{hasInvitation:!1};const e=new URLSearchParams(window.location.search),t=e.get("invitation"),a=e.get("team"),n=e.get("role"),r=e.get("invitation_id"),s=new URLSearchParams(window.location.hash.substring(1)),i=s.get("access_token"),o=s.get("token_type"),l=s.get("expires_in"),c=s.get("refresh_token"),d=!("true"!==t||!a||!n),u=!(!i||"bearer"!==o);return{hasInvitation:d||u,teamId:a,role:n,invitationId:r,accessToken:i,tokenType:o,expiresIn:l,refreshToken:c,isSupabaseInvitation:u,isCustomInvitation:d,params:{invitation:t,teamId:a,role:n,invitationId:r,accessToken:i,tokenType:o,expiresIn:l,refreshToken:c}}})();if(e.hasInvitation&&(console.log("Invitation detected:",e),a(e),e.isSupabaseInvitation&&e.accessToken&&e.refreshToken))try{console.log("Setting Supabase session with invitation tokens...");const{data:t,error:a}=await Ur.auth.setSession({access_token:e.accessToken,refresh_token:e.refreshToken});a?console.error("Error setting session:",a):console.log("Session set successfully:",t)}catch(t){console.error("Exception setting session:",t)}})()},[]);return{invitationParams:t,setInvitationParams:a,clearInvitationParams:()=>{(()=>{if("undefined"===typeof window)return;const e=new URL(window.location),t=e.searchParams;t.delete("invitation"),t.delete("team"),t.delete("role"),t.delete("invitation_id");const a=t.toString()?"".concat(e.pathname,"?").concat(t.toString()):e.pathname;window.history.replaceState({},"",a)})(),a(null)},hasInvitation:!(null===t||void 0===t||!t.hasInvitation)}}function Zv(t){let{onSuccess:a=()=>{},onNavigate:n=()=>{},clearInvitationParams:r=()=>{}}=t;const{user:s}=Cs(),{acceptTeamInvitation:i}=vi(),[o,l]=(0,e.useState)(!1),c=(0,e.useCallback)(async e=>{if(e.invitationId)if(o)console.log("Invitation already being processed, skipping");else try{l(!0),console.log("Processing invitation:",e.invitationId);const t=await i(e.invitationId);return t.success?(r(),a(t.message||"Welcome to the team!"),n(bi.TEAM_MANAGEMENT),t):(console.error("Failed to accept invitation:",t.error),t)}catch(t){return console.error("Error processing invitation:",t),{success:!1,error:t.message}}finally{l(!1)}else console.error("No invitation ID provided")},[i,o,a,n,r]),d=(0,e.useCallback)(e=>{null!==e&&void 0!==e&&e.success&&(r(),a(e.message||"Welcome to the team!"),n(bi.TEAM_MANAGEMENT))},[a,n,r]),u=(0,e.useCallback)(e=>{if(s&&e&&Kv(s,e)){if(Wv(e,s))return void console.log("User needs to complete account setup before processing invitation");console.log("User is ready to process invitation"),c(e)}},[s,c]),m=(0,e.useCallback)(e=>{if(s&&!e&&"undefined"!==typeof window&&Hv.hasStoredState()){console.log("User signed in, checking for pending invitation...");const e=(()=>{if("undefined"===typeof window)return null;const e=Hv.loadState();if(e.invitation){const t=e.invitation;return Hv.clearState(),t}return null})();if(e&&e.invitationId){console.log("Processing pending invitation:",e),c({invitationId:e.invitationId});const t=e.teamName?" Welcome to ".concat(e.teamName,"!"):" Welcome to the team!",n="Successfully joined as ".concat(e.role||"member",".").concat(t);a(n)}}},[s,c,a]);return{isProcessing:o,handleInvitationAcceptance:c,handleInvitationProcessed:d,processInvitationForUser:u,processPendingInvitationForUser:m}}function ey(t){let{path:a,navigateTarget:n,activeViews:r,hookName:s}=t;const i=new Set(r||[n]);return function(t,r){const o=(0,e.useRef)(null),l=(0,e.useRef)(!1);(0,e.useEffect)(()=>{if("undefined"!==typeof window){if(null===o.current){let t=(window.location.pathname||"").replace(/\/+$/,"")||"/";if("/"===t)try{sessionStorage.getItem("redirect")===a&&(t=a,sessionStorage.removeItem("redirect"),console.log("[".concat(s,"] Reading from sessionStorage redirect:"),t))}catch(e){console.warn("[".concat(s,"] Could not read sessionStorage:"),e)}o.current=t}l.current||(o.current!==a||i.has(t)||null===r||void 0===r||r(n),l.current=!0)}else l.current=!0},[r,t]),(0,e.useEffect)(()=>{if("undefined"===typeof window)return;const e=(window.location.pathname||"").replace(/\/+$/,"")||"/";let n=null;if(i.has(t)?n=a:e===a&&(n="/"),null!==n&&e!==n){const e=window.location.search||"",t=window.location.hash||"",a="".concat(n).concat(e).concat(t);window.history.replaceState(window.history.state,"",a)}},[t])}}const ty=ey({path:"/stats",navigateTarget:bi.STATISTICS,hookName:"useStatisticsRouting"});const ay=ey({path:"/team",navigateTarget:bi.TEAM_MANAGEMENT,hookName:"useTeamManagementRouting"}),ny=ey({path:"/tactics",navigateTarget:bi.TACTICAL_BOARD,hookName:"useTacticalBoardRouting"}),ry=ey({path:"/plan",navigateTarget:bi.TEAM_MATCHES,activeViews:[bi.TEAM_MATCHES,bi.PLAN_MATCHES],hookName:"usePlanMatchesRouting"}),sy=ey({path:"/profile",navigateTarget:bi.PROFILE,hookName:"useProfileRouting"});function iy(e){return Ro((t,a)=>{var n;if("events_saved"!==t||null===a||void 0===a||null===(n=a.events)||void 0===n||!n.length)return;const r=a.events[a.events.length-1],s=(t=>{var a;if("function"===typeof e){const a=e(t);if(a)return a}else if(e)return e;return(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.matchId)||(null===t||void 0===t?void 0:t.matchId)||null})(r);s&&r&&Bo.persistEvent(r,s).catch(e=>{console.warn("Background event persistence failed:",e)})})}try{(()=>{const e={migrated:[],skipped:[],errors:[]};try{Object.entries(Kr).forEach(t=>{let[a,n]=t;try{const t=localStorage.getItem(a);null!==t&&(null===localStorage.getItem(n)?(localStorage.setItem(n,t),localStorage.removeItem(a),e.migrated.push({from:a,to:n})):(localStorage.removeItem(a),e.skipped.push({key:a,reason:"new_key_exists"})))}catch(r){e.errors.push({key:a,error:r.message})}})}catch(t){console.error("Storage key migration failed:",t),e.errors.push({error:t.message})}return e})().migrated.length,0}catch(my){console.error("Storage key migration error:",my)}const oy=Bs(Br.DISMISSED_MODALS,{}),ly=()=>oy.loadState(),cy=()=>{oy.clearState()};function dy(){const{t:t}=xe(["modals","navigation","common"]),a=ql(),{retryMatchPersistence:r,continueWithoutSavingMatch:s,showMatchPersistenceError:i,persistenceErrorMessage:o,isMatchPersistenceRetrying:l}=a,c=(0,e.useRef)(a.currentMatchId);(0,e.useEffect)(()=>{c.current=a.currentMatchId},[a.currentMatchId]);const d=a.view===bi.GAME&&("pending"===a.matchState||"running"===a.matchState),u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{enableBrowserBack:a=!0,fallbackView:r=null}=t,s=he(t,oc);return lc((0,n.A)({enableBrowserBackIntegration:a,fallbackView:r,onNavigate:e},s))}(a.setView,{enableBrowserBack:!d,fallbackView:bi.CONFIG}),m=(0,e.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const a=u.navigateTo(e,t);var n;(a&&t&&we(t),a&&e===bi.LIVE_MATCH)&&(null!==t&&void 0!==t&&t.matchId&&E(t.matchId),R(null!==(n=null===t||void 0===t?void 0:t.entryPoint)&&void 0!==n?n:null));return a},[u]),h=(0,e.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return u.navigateBack(e)},[u]),p=$l(a.periodDurationMinutes,a.alertMinutes,a.playAlertSounds,a.currentPeriodNumber,a.view===bi.GAME,a.currentMatchId),{showSessionWarning:f,sessionExpiry:g,extendSession:v,dismissSessionWarning:y,signOut:b,loading:x,needsProfileCompletion:w,user:S}=Cs(),{currentTeam:k,teamPlayers:N,hasPendingRequests:j,pendingRequestsCount:T,canManageTeam:A,isMatchRunning:_}=vi(),C=(0,e.useMemo)(()=>{var e;return S&&null!==k&&void 0!==k&&null!==(e=k.club)&&void 0!==e&&e.name?k.club.name:Ul.OWN_TEAM_NAME},[S,k]),M=mh(),[P,E]=(0,e.useState)(null),[I,R]=(0,e.useState)(null);ty(a.view,m),function(t,a,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const s=(0,e.useRef)(null),i=(0,e.useRef)(!1),o=(0,e.useRef)(null),l=(0,e.useRef)(!1);(0,e.useEffect)(()=>{if("undefined"===typeof window)return void(i.current=!0);if(null===s.current){let e=(window.location.pathname||"").replace(/\/+$/,"")||"/";if("/"===e)try{const t=sessionStorage.getItem("redirect");t&&(e=t.replace(/\/+$/,"")||"/",console.log("[useLiveMatchRouting] Reading from sessionStorage redirect:",e))}catch(t){console.warn("[useLiveMatchRouting] Could not read sessionStorage:",t)}s.current=e,console.log("[useLiveMatchRouting] Initial path captured:",s.current)}if(i.current)return;const e=s.current.match(/^\/live\/([0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12})$/i);if(e&&e[1]){const r=e[1];console.log("[useLiveMatchRouting] Detected /live/ route, matchId:",r),o.current=r,n(r),null===a||void 0===a||a(bi.LIVE_MATCH);try{sessionStorage.removeItem("redirect"),console.log("[useLiveMatchRouting] Cleared sessionStorage redirect")}catch(t){}}i.current=!0},[a,n]),(0,e.useEffect)(()=>{r&&r!==o.current&&(o.current=r)},[r]),(0,e.useEffect)(()=>{if("undefined"===typeof window)return;const e=(window.location.pathname||"").replace(/\/+$/,"")||"/",a=e.startsWith("/live/");if(a&&t===bi.LIVE_MATCH&&o.current&&(l.current=!0),a&&o.current&&!l.current&&t!==bi.LIVE_MATCH)return;const n=o.current||r;let s=null;if(t===bi.LIVE_MATCH&&n?s="/live/".concat(n):a&&(s="/"),console.log("[useLiveMatchRouting] URL sync:",{view:t,currentPath:e,targetPath:s,willUpdate:null!==s&&e!==s}),null!==s&&e!==s){const e=window.location.search||"",t=window.location.hash||"",a="".concat(s).concat(e).concat(t);window.history.replaceState(window.history.state,"",a),s.startsWith("/live/")&&(l.current=!0)}},[r,t])}(a.view,m,E,P),ay(a.view,m),ny(a.view,m),ry(a.view,m),sy(a.view,m);const{setView:O}=a;(0,e.useEffect)(()=>{const{hasTokens:e}=sh();e&&M.openReset()},[M]),(0,e.useEffect)(()=>{(function(e){const{hasTokens:t}=sh();if(t)return!0;if(e&&"undefined"!==typeof window)return window.location.pathname.includes("reset")||window.location.search.includes("password");return!1})(S)&&M.openReset()},[S,M]);const D=(()=>{if("true"===new URLSearchParams(window.location.search).get("debug"))return!0;const e=ad.loadState();return!(!e||!0!==e.enabled)||"true"==={NODE_ENV:"production",PUBLIC_URL:"https://sportwizard.se",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN5amRtY2RtZGVyY3l4b29qa3ZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUzNTI1MTksImV4cCI6MjA3MDkyODUxOX0.MkjyGrTOud4xSr-PrATGkOFTLKjZzx6eoAsDaVsEVzk",REACT_APP_SUPABASE_URL:"https://cyjdmcdmdercyxoojkvl.supabase.co"}.REACT_APP_DEBUG})(),{clearHistory:F,syncCurrentView:L}=ic();(0,e.useEffect)(()=>{L(a.view)},[a.view,L]),(0,e.useEffect)(()=>{const e=iy(()=>c.current);return()=>{"function"===typeof e&&e()}},[]);const[q,U]=(0,e.useState)(!1),[B,G]=(0,e.useState)(0),z=(0,e.useCallback)(async()=>(cy(),F(),a.setView(bi.CONFIG),await b()),[a,b,F]),V=(0,e.useCallback)(async()=>{"running"!==a.matchState?await z():U(!0)},[z,a.matchState]),H=(0,e.useCallback)(()=>{G(e=>e+1)},[]),K=(0,e.useCallback)(async()=>{U(!1),await z()},[z]),W=(0,e.useCallback)(()=>{U(!1)},[]),[Y,J]=(0,e.useState)(!1),[Q,$]=(0,e.useState)({timeString:""}),[X,Z]=(0,e.useState)(!1),[ee,te]=(0,e.useState)(!1),ae=(0,e.useRef)(()=>{te(!1)}),ne=(0,e.useRef)(!1),[re,se]=(0,e.useState)(!1),[ie,oe]=(0,e.useState)(null),[le,ce]=(0,e.useState)(!1),[de,ue]=(0,e.useState)(null),[me,pe]=(0,e.useState)(""),fe=(0,e.useRef)(!1),ge=(0,e.useCallback)(e=>{pe(e),setTimeout(()=>{pe("")},3e3)},[]),ve=(0,e.useRef)(null),ye=(0,e.useCallback)(e=>{a.view===bi.TACTICAL_BOARD&&O(ie||e||bi.CONFIG)},[a.view,ie,O]),[be,we]=(0,e.useState)(null),Se=Xv(),ke=Zv({onSuccess:ge,onNavigate:a.setView,clearInvitationParams:Se.clearInvitationParams}),Ne=function(t){let{onSuccess:a=()=>{},onNavigate:n=()=>{},currentView:r=null,currentMatchState:s=null}=t;const{user:i}=Cs(),{getUserPendingInvitations:o}=vi(),[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)([]),[m,h]=(0,e.useState)(!1),p=(0,e.useCallback)(async()=>{if(i&&!m&&(r!==bi.GAME||!s||"finished"===s))try{console.log("Checking for pending invitation notifications...");const e=await o();e&&e.length>0?(console.log("Found ".concat(e.length," pending invitation(s)")),u(e),c(!0)):console.log("No pending invitations found"),h(!0)}catch(my){console.error("Error checking pending invitations:",my),h(!0)}},[i,o,m,r,s]),f=(0,e.useCallback)((e,t)=>{if(u(t=>t.filter(t=>t.id!==e.id)),u(t=>(t.length<=1&&c(!1),t.filter(t=>t.id!==e.id))),"accepted"===t){const t="Successfully joined ".concat(e.team.name,"!");a(t),setTimeout(()=>{n(bi.TEAM_MANAGEMENT)},1e3)}else"declined"===t&&a("Invitation declined")},[a,n]),g=(0,e.useCallback)(()=>{i||(h(!1),u([]),c(!1))},[i]);return(0,e.useEffect)(()=>{g()},[g]),{showInvitationNotifications:l,pendingInvitations:d,hasCheckedInvitations:m,checkPendingInvitationNotifications:p,handleInvitationNotificationProcessed:f,resetNotificationState:g,setShowInvitationNotifications:c,setPendingInvitations:u,setHasCheckedInvitations:h}}({onSuccess:ge,onNavigate:a.setView,currentView:a.view,currentMatchState:a.matchState});(0,e.useEffect)(()=>{a.view!==bi.TEAM_MANAGEMENT&&be&&we(null)},[a.view,be]),(0,e.useEffect)(()=>{R(e=>a.view!==bi.LIVE_MATCH&&e?null:e)},[a.view]);const je=ke.handleInvitationProcessed,Te=(0,e.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";console.log("Handling sign-in request after password setup",e),Se.clearInvitationParams(),M.openLogin(e)},[M,Se]),Ae=Ne.checkPendingInvitationNotifications,_e=Ne.handleInvitationNotificationProcessed;(0,e.useEffect)(()=>{ke.processInvitationForUser(Se.invitationParams)},[S,Se.invitationParams,ke]),(0,e.useEffect)(()=>{ke.processPendingInvitationForUser(Se.invitationParams)},[S,Se.invitationParams,ke]),(0,e.useEffect)(()=>{if(S&&!Se.invitationParams&&!w){const e=setTimeout(()=>{Ae()},1e3);return()=>clearTimeout(e)}},[S,Se.invitationParams,w,Ae]),(0,e.useEffect)(()=>{cy()},[null===S||void 0===S?void 0:S.id]);const Ce=(0,e.useCallback)(()=>{var e;console.log("\ud83c\udf10 App: handleGlobalNavigation called",{currentView:a.view,currentPeriodNumber:a.currentPeriodNumber,matchState:a.matchState,canNavigateWithHistory:u.canNavigateBack,navigationHistoryLength:(null===(e=u.navigationHistory)||void 0===e?void 0:e.length)||0,previousView:u.previousView});const t=u.canNavigateBack;a.view===bi.TACTICAL_BOARD?(console.log("\ud83c\udf10 App: Handling Tactical Board back navigation"),ye()):a.view!==bi.PERIOD_SETUP||1!==a.currentPeriodNumber||t?t?(console.log("\ud83c\udf10 App: Using navigation history to go back",{targetView:u.previousView}),h()):(console.log("\ud83c\udf10 App: Showing new game modal (default fallback)"),te(!0),ve.current&&!ne.current&&(ne.current=!0,ve.current(()=>{ne.current=!1,ae.current({removeNavigationState:!1})},"App-NewGameModal"))):(console.log("\ud83c\udf10 App: PERIOD_SETUP -> CONFIG (no history available)"),O(bi.CONFIG))},[a.currentPeriodNumber,a.matchState,a.view,ye,u.canNavigateBack,u.navigationHistory,u.previousView,h,O]),{pushNavigationState:Me,removeFromNavigationStack:Pe}=Xl(Ce),Ee=(0,e.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{removeNavigationState:t=!0}=e;ne.current=!1,te(!1),t&&Pe()},[Pe]);(0,e.useEffect)(()=>{ae.current=Ee},[Ee]);const[Ie,Re]=(0,e.useState)(!1),[Oe,De]=(0,e.useState)(null),[Fe,Le]=(0,e.useState)(!1),qe=(0,e.useCallback)(async e=>{if("function"===typeof e){if(!a.currentMatchId)return Le(!1),void e();try{const{data:t,error:n}=await Ur.from("match").select("id, state").eq("id",a.currentMatchId).is("deleted_at",null).eq("state","running").single();if(n)return"PGRST116"===n.code?(Le(!1),void e()):(console.error("Database error checking match:",n),Le(!0),De(()=>e),void Re(!0));t?(Le(!0),De(()=>e),Re(!0)):(Le(!1),De(null),e())}catch(t){console.error("Unexpected error checking active match:",t),Le(!0),De(()=>e),Re(!0)}}else console.warn("checkForActiveMatch: requires a callback function")},[a.currentMatchId]),Ue=(0,e.useCallback)(async()=>{try{if(a.currentMatchId){const e=(new Date).toISOString(),{error:t}=await Ur.from("match").update({deleted_at:e}).eq("id",a.currentMatchId).eq("state","running").is("deleted_at",null);t&&console.error("Error marking match as deleted:",t)}Oe&&Oe(),Re(!1),De(null),Le(!1)}catch(e){console.error("Unexpected error during match abandonment:",e),Oe&&Oe(),Re(!1),De(null),Le(!1)}},[a.currentMatchId,Oe]),Be=(0,e.useCallback)(()=>{Re(!1),De(null),Le(!1)},[]);(0,e.useEffect)(()=>{ve.current=Me},[Me]);const Ge=(0,e.useMemo)(()=>Ki(a.allPlayers,a.selectedSquadIds),[a.allPlayers,a.selectedSquadIds]);(0,e.useEffect)(()=>{const e=setTimeout(()=>{window.history.pushState({app:"dif-coach"},"",window.location.href)},100);return()=>{clearTimeout(e)}},[]);const ze=(0,e.useMemo)(()=>a.formation.goalie?Wi(a.allPlayers,a.selectedSquadIds,a.formation.goalie):[],[a.allPlayers,a.selectedSquadIds,a.formation.goalie]),Ve=(0,e.useCallback)(()=>{R(null);h(bi.STATS)!==bi.STATS&&O(bi.STATS)},[h,O]),He=()=>{a.handleStartGame()},Ke=()=>{a.handleActualMatchStart(),p.startTimers(a.currentPeriodNumber,a.teamConfig,C,a.opponentTeam,a.formation,a.numPeriods,a.allPlayers)},We=(e,t)=>{const n=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();return!t||t<=0?e:e+Xi(t,a)}(e,t||a.lastSubstitutionTimestamp);p.restoreSubTimer(n)},Ye=()=>{const e=Math.floor(p.matchTimerSeconds/60),t=p.matchTimerSeconds%60;if(p.matchTimerSeconds>60){const a=e>0?"".concat(e,":").concat(t.toString().padStart(2,"0")):"".concat(t," seconds");return $({timeString:a}),J(!0),void Me(()=>{J(!1)})}const n=a.currentPeriodNumber>=a.numPeriods;p.stopTimers(a.currentPeriodNumber,n,a.formation,a.teamConfig),a.handleEndPeriod(p.isSubTimerPaused)},Je=(0,e.useCallback)(async()=>{await r()},[r]),Qe=(0,e.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{removeNavigationState:t=!0}=e;t&&fe.current&&(Pe(),fe.current=!1),s()},[s,Pe]);(0,e.useEffect)(()=>{i&&!fe.current?(fe.current=!0,Me(()=>{fe.current=!1,Qe({removeNavigationState:!1})},"App-MatchPersistenceErrorModal")):!i&&fe.current&&(Pe(),fe.current=!1)},[i,Qe,Me,Pe]);const $e=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{preserveConfiguration:t=!1}=e,r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e.map(e=>{var t,a,r,s;return(0,n.A)((0,n.A)({},e),{},{hasFairPlayAward:!1,stats:(0,n.A)((0,n.A)({},{startedMatchAs:null,startedAtRole:null,startedAtPosition:null,startLocked:!1,periodsAsGoalie:0,periodsAsDefender:0,periodsAsAttacker:0,periodsAsMidfielder:0,timeOnFieldSeconds:0,timeAsSubSeconds:0,timeAsGoalieSeconds:0,timeAsDefenderSeconds:0,timeAsAttackerSeconds:0,timeAsMidfielderSeconds:0,currentRole:null,currentStatus:null,lastStintStartTimeEpoch:0,currentPositionKey:null,isInactive:!1,isCaptain:!1,goals:0,saves:0,blocks:0,cards:[],hasFairPlayAward:!1}),{},{isInactive:null!==(t=null===e||void 0===e||null===(a=e.stats)||void 0===a?void 0:a.isInactive)&&void 0!==t&&t,isCaptain:null!==(r=null===e||void 0===e||null===(s=e.stats)||void 0===s?void 0:s.isCaptain)&&void 0!==r&&r})})}):[]}(a.allPlayers||[]);if(t){const e={selectedSquadIds:[...a.selectedSquadIds||[]],periodGoalieIds:(0,n.A)({},a.periodGoalieIds||{}),formation:a.formation?(0,n.A)({},a.formation):null,teamConfig:a.teamConfig?(0,n.A)({},a.teamConfig):null,selectedFormation:a.selectedFormation,numPeriods:a.numPeriods,periodDurationMinutes:a.periodDurationMinutes,opponentTeam:a.opponentTeam,matchType:a.matchType,venueType:a.venueType,captainId:a.captainId,alertMinutes:a.alertMinutes};return Do(),F(),p.clearAllTimersForNewGame(),a.setView(bi.CONFIG),a.setCurrentPeriodNumber(1),a.setGameLog([]),a.setMatchEvents([]),a.setMatchStartTime(null),a.setGoalScorers({}),a.setEventSequenceNumber(0),a.setLastEventBackup(null),a.setRotationQueue([]),a.setNextPlayerToSubOut(null,!0),a.setNextPlayerIdToSubOut(null),a.setLastSubstitutionTimestamp(null),a.setTimerPauseStartTime(null),a.setTotalMatchPausedDuration(0),a.setMatchState("not_started"),a.setMatchCreated(!1),a.setCurrentMatchId(null),a.resetScore(),a.setAllPlayers(r),e.teamConfig&&a.updateTeamConfig(e.teamConfig),e.selectedFormation&&a.setSelectedFormation(e.selectedFormation),e.formation&&a.setFormation(e.formation),a.setSelectedSquadIds(e.selectedSquadIds||[]),a.setPeriodGoalieIds(e.periodGoalieIds||{}),"number"===typeof e.numPeriods&&a.setNumPeriods(e.numPeriods),"number"===typeof e.periodDurationMinutes&&a.setPeriodDurationMinutes(e.periodDurationMinutes),"number"===typeof e.alertMinutes&&a.setAlertMinutes(e.alertMinutes),a.setOpponentTeam(e.opponentTeam||""),e.matchType&&a.setMatchType(e.matchType),e.venueType&&a.setVenueType(e.venueType),a.setCaptain(e.captainId||null),a.setHasActiveConfiguration(!0),void H()}if(Do(),F(),a.setAllPlayers(r),p.clearAllTimersForNewGame(),a.setView(bi.CONFIG),a.setCurrentPeriodNumber(1),a.setGameLog([]),k&&N&&N.length>0&&a.syncPlayersFromTeamRoster)try{a.syncPlayersFromTeamRoster(N).success||(console.warn("\u26a0\ufe0f New Game: Team sync failed, using initial roster"),a.setAllPlayers(qi(Sl)))}catch(my){console.warn("\u26a0\ufe0f New Game: Team sync error, using initial roster:",my),a.setAllPlayers(qi(Sl))}else a.setAllPlayers(qi(Sl));a.setSelectedSquadIds([]),a.setPeriodGoalieIds({}),a.setFormation({goalie:null,leftDefender:null,rightDefender:null,leftAttacker:null,rightAttacker:null,substitute:null}),a.resetScore(),a.setOpponentTeam(""),a.clearStoredState(),H()},Xe=()=>{Z(!0),Me(()=>{Z(!1)})},Ze=(0,e.useCallback)(e=>{ue(e),ce(!0),Me(()=>{ce(!1),ue(null)})},[Me]),et=(0,e.useCallback)(()=>{se(!0),Me(()=>{se(!1)})},[Me]),tt=(0,e.useCallback)(()=>{se(!1)},[]),at=(0,e.useCallback)(()=>{de&&((e,t)=>{const a=ly();a["".concat(e,"_").concat(t)]={dismissedAt:Date.now(),teamId:t},oy.saveState(a)})("team_access",de.id),ce(!1),ue(null),Pe()},[de,Pe]),nt=(0,e.useCallback)(e=>{ge(e)},[ge]);(0,e.useEffect)(()=>{var e,t;_||A&&j&&k&&!le&&!w&&(e="team_access",t=k.id,void 0===ly()["".concat(e,"_").concat(t)]&&Ze(k))},[A,j,k,le,w,T,Ze,_]);const rt=()=>{var e,n;switch(a.view){case bi.CONFIG:return(0,Ts.jsx)(qh,{allPlayers:a.allPlayers,setAllPlayers:a.setAllPlayers,selectedSquadIds:a.selectedSquadIds,setSelectedSquadIds:a.setSelectedSquadIds,numPeriods:a.numPeriods,setNumPeriods:a.setNumPeriods,periodDurationMinutes:a.periodDurationMinutes,setPeriodDurationMinutes:a.setPeriodDurationMinutes,periodGoalieIds:a.periodGoalieIds,setPeriodGoalieIds:a.setPeriodGoalieIds,teamConfig:a.teamConfig,updateTeamConfig:a.updateTeamConfig,selectedFormation:a.selectedFormation,setSelectedFormation:a.setSelectedFormation,updateFormationSelection:a.updateFormationSelection,createTeamConfigFromSquadSize:a.createTeamConfigFromSquadSize,formation:a.formation,setFormation:a.setFormation,alertMinutes:a.alertMinutes,setAlertMinutes:a.setAlertMinutes,handleStartPeriodSetup:a.handleStartPeriodSetup,handleSaveConfiguration:a.handleSaveConfiguration,selectedSquadPlayers:Ge,opponentTeam:a.opponentTeam,setOpponentTeam:a.setOpponentTeam,matchType:a.matchType,setMatchType:a.setMatchType,venueType:a.venueType,setVenueType:a.setVenueType,captainId:a.captainId,setCaptain:a.setCaptain,debugMode:D,authModal:M,syncPlayersFromTeamRoster:a.syncPlayersFromTeamRoster,setCurrentMatchId:a.setCurrentMatchId,currentMatchId:a.currentMatchId,setMatchCreated:a.setMatchCreated,hasActiveConfiguration:a.hasActiveConfiguration,setHasActiveConfiguration:a.setHasActiveConfiguration,clearStoredState:a.clearStoredState,configurationSessionId:B,resumeMatchId:null===be||void 0===be?void 0:be.resumeMatchId,onNavigateBack:h,onNavigateTo:m,onOpenTemporaryPlayerModal:Xe,pushNavigationState:Me,removeFromNavigationStack:Pe});case bi.PERIOD_SETUP:return(0,Ts.jsx)(Xh,{currentPeriodNumber:a.currentPeriodNumber,formation:a.formation,setFormation:a.setFormation,availableForAssignment:ze,allPlayers:a.allPlayers,setAllPlayers:a.setAllPlayers,handleStartGame:He,gameLog:a.gameLog,selectedSquadPlayers:Ge,periodGoalieIds:a.periodGoalieIds,setPeriodGoalieIds:a.setPeriodGoalieIds,numPeriods:a.numPeriods,teamConfig:a.teamConfig,selectedFormation:a.selectedFormation,onNavigateBack:h,pushNavigationState:Me,removeFromNavigationStack:Pe,ownScore:a.ownScore,opponentScore:a.opponentScore,opponentTeam:a.opponentTeam,ownTeamName:C,rotationQueue:a.rotationQueue,setRotationQueue:a.setRotationQueue,preparePeriodWithGameLog:a.preparePeriodWithGameLog,handleSavePeriodConfiguration:a.handleSavePeriodConfiguration,matchState:a.matchState,debugMode:D});case bi.GAME:return(0,Ts.jsx)($p,{currentPeriodNumber:a.currentPeriodNumber,formation:a.formation,setFormation:a.setFormation,allPlayers:a.allPlayers,setAllPlayers:a.setAllPlayers,matchTimerSeconds:p.matchTimerSeconds,subTimerSeconds:p.subTimerSeconds,isSubTimerPaused:p.isSubTimerPaused,pauseSubTimer:p.pauseSubTimer,resumeSubTimer:p.resumeSubTimer,setShowNewGameModal:te,formatTime:Bl,resetSubTimer:p.resetSubTimer,handleUndoSubstitution:We,handleEndPeriod:Ye,nextPlayerToSubOut:a.nextPlayerToSubOut,nextPlayerIdToSubOut:a.nextPlayerIdToSubOut,selectedSquadPlayers:Ge,setNextPlayerToSubOut:a.setNextPlayerToSubOut,setNextPlayerIdToSubOut:a.setNextPlayerIdToSubOut,teamConfig:a.teamConfig,selectedFormation:a.selectedFormation,alertMinutes:a.alertMinutes,ownTeamName:C,togglePlayerInactive:a.togglePlayerInactive,switchPlayerPositions:a.switchPlayerPositions,rotationQueue:a.rotationQueue,setRotationQueue:a.setRotationQueue,switchGoalie:a.switchGoalie,setLastSubstitutionTimestamp:a.setLastSubstitutionTimestamp,getOutfieldPlayers:a.getOutfieldPlayers,pushNavigationState:Me,removeFromNavigationStack:Pe,onNavigateBack:h,ownScore:a.ownScore,opponentScore:a.opponentScore,opponentTeam:a.opponentTeam,addGoalScored:a.addGoalScored,addGoalConceded:a.addGoalConceded,setScore:a.setScore,matchEvents:a.matchEvents||[],goalScorers:a.goalScorers||{},matchStartTime:a.matchStartTime,matchState:a.matchState,currentMatchId:a.currentMatchId,handleActualMatchStart:Ke,periodDurationMinutes:a.periodDurationMinutes,trackGoalScorer:a.trackGoalScorer,getPlayerName:e=>{const n=a.allPlayers.find(t=>t.id===e);return n?Kl(n):t("common:errors.unknownPlayer")}});case bi.STATS:return(0,Ts.jsx)(nf,{allPlayers:null!==(e=a.allPlayers)&&void 0!==e&&e.length?a.allPlayers:(null===(n=a.gameLog[a.gameLog.length-1])||void 0===n?void 0:n.finalStatsSnapshotForAllPlayers)||Ge,onNavigateTo:m,onNavigateBack:h,pushNavigationState:Me,removeFromNavigationStack:Pe,setAllPlayers:a.setAllPlayers,setSelectedSquadIds:a.setSelectedSquadIds,setPeriodGoalieIds:a.setPeriodGoalieIds,setGameLog:a.setGameLog,initializePlayers:qi,initialRoster:Sl,clearStoredState:a.clearStoredState,clearTimerState:p.clearTimerState,ownScore:a.ownScore,opponentScore:a.opponentScore,opponentTeam:a.opponentTeam,resetScore:a.resetScore,setOpponentTeam:a.setOpponentTeam,currentMatchId:a.currentMatchId,matchEvents:a.matchEvents||[],goalScorers:a.goalScorers||{},showSuccessMessage:ge,checkForActiveMatch:qe,handleRestartMatch:$e,selectedSquadIds:a.selectedSquadIds,onStartNewConfigurationSession:H,matchStartTime:a.matchStartTime,periodDurationMinutes:a.periodDurationMinutes,gameLog:a.gameLog,formation:a.formation,ownTeamName:C,matchType:a.matchType});case bi.PROFILE:return(0,Ts.jsx)(rv,{onNavigateBack:h,onNavigateTo:m,pushNavigationState:Me,removeFromNavigationStack:Pe});case bi.TACTICAL_BOARD:return(0,Ts.jsx)(Mg,{onNavigateBack:ye,pushNavigationState:Me,removeFromNavigationStack:Pe,fromView:ie});case bi.TEAM_MANAGEMENT:return(0,Ts.jsx)(Mm,{onNavigateBack:h,pushNavigationState:Me,removeFromNavigationStack:Pe,openToTab:null===be||void 0===be?void 0:be.openToTab,openAddRosterPlayerModal:null===be||void 0===be?void 0:be.openAddRosterPlayerModal,onShowSuccessMessage:ge});case bi.TEAM_MATCHES:return(0,Ts.jsx)(iv,{onNavigateBack:h,onNavigateTo:m,pushNavigationState:Me,removeFromNavigationStack:Pe});case bi.PLAN_MATCHES:return(0,Ts.jsx)(Dv,{onNavigateBack:h,pushNavigationState:Me,removeFromNavigationStack:Pe,matchesToPlan:null===be||void 0===be?void 0:be.matchesToPlan});case bi.LIVE_MATCH:const r=(null===be||void 0===be?void 0:be.matchId)||P,s=(null===be||void 0===be?void 0:be.entryPoint)||I,i=Boolean(S)&&s===bi.STATS;return r?(0,Ts.jsx)(tv,{matchId:r,showBackButton:i,onNavigateBack:i?Ve:void 0}):(0,Ts.jsx)("div",{className:"min-h-screen bg-slate-900 text-slate-100 flex items-center justify-center",children:(0,Ts.jsxs)("div",{className:"text-center space-y-4",children:[i&&(0,Ts.jsx)("div",{className:"flex justify-center",children:(0,Ts.jsx)("button",{type:"button",onClick:Ve,className:"inline-flex items-center gap-2 px-4 py-2 bg-slate-700 text-slate-100 rounded-md hover:bg-slate-600 transition-colors",children:t("navigation:back")})}),(0,Ts.jsx)("p",{className:"text-slate-400",children:t("common:errors.invalidMatchId")})]})});case bi.STATISTICS:return(0,Ts.jsx)(pg,{onNavigateBack:h,authModal:M,onNavigateTo:m,pushNavigationState:Me,removeFromNavigationStack:Pe});default:return(0,Ts.jsx)("div",{children:t("common:errors.unknownView")})}};return(0,Ts.jsxs)("div",{className:"min-h-screen bg-slate-900 text-slate-100 flex flex-col items-center p-2 sm:p-4 font-sans",children:[(0,Ts.jsxs)("header",{className:"w-full max-w-2xl md:max-w-4xl lg:max-w-5xl xl:max-w-6xl relative text-center mb-4",children:[(0,Ts.jsx)("div",{className:"absolute top-0 right-0",children:(0,Ts.jsx)(Ld,{onRestartMatch:async()=>{const e="running"===a.matchState;await qe(()=>{$e({preserveConfiguration:e})})},onAddPlayer:Xe,onNavigateToTacticalBoard:()=>{oe(a.view),m(bi.TACTICAL_BOARD,{fromView:a.view})},currentView:a.view,teamConfig:a.teamConfig,allPlayers:a.allPlayers,selectedSquadIds:a.selectedSquadIds,onNavigateTo:m,authModal:M,onOpenTeamAdminModal:Ze,onOpenPreferencesModal:et,onSignOut:V,currentMatchId:a.currentMatchId,matchState:a.matchState})}),(0,Ts.jsx)("h1",{className:"text-3xl sm:text-4xl font-bold text-sky-400",children:"Sport Wizard"})]}),me&&(0,Ts.jsx)("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 px-6 py-3 bg-emerald-900/80 backdrop-blur-sm border border-emerald-600 rounded-lg shadow-2xl shadow-emerald-500/50",children:(0,Ts.jsxs)("p",{className:"text-emerald-200 text-sm font-medium",children:["\u2713 ",me]})}),a.view===bi.TACTICAL_BOARD?(0,Ts.jsx)("div",{className:"w-full",children:rt()}):(0,Ts.jsx)("main",{className:"w-full max-w-2xl md:max-w-4xl lg:max-w-5xl xl:max-w-6xl bg-slate-800 p-3 sm:p-6 rounded-lg shadow-xl",children:rt()}),(0,Ts.jsx)("footer",{className:"mt-8 text-center text-sm text-slate-500",children:(0,Ts.jsx)("p",{children:t("common:footer.copyright",{year:(new Date).getFullYear()})})}),(0,Ts.jsx)(qc,{isOpen:Y,onConfirm:()=>{J(!1),Pe();const e=a.currentPeriodNumber>=a.numPeriods;p.stopTimers(a.currentPeriodNumber,e,a.formation,a.teamConfig),a.handleEndPeriod(p.isSubTimerPaused)},onCancel:()=>{J(!1),Pe()},title:t("modals:endPeriodEarly.title"),message:t("modals:endPeriodEarly.message",{timeString:Q.timeString})}),(0,Ts.jsx)(qc,{isOpen:q,onConfirm:K,onCancel:W,title:t("modals:signOutDuringMatch.title"),message:t("modals:signOutDuringMatch.message"),confirmText:t("modals:signOutDuringMatch.confirmSignOut"),cancelText:t("modals:signOutDuringMatch.cancelStayLoggedIn")}),(0,Ts.jsx)(qc,{isOpen:i,onConfirm:Je,onCancel:Qe,title:t("modals:unableToSaveMatch.title"),message:o,confirmText:t(l?"modals:unableToSaveMatch.retrying":"modals:unableToSaveMatch.retry"),cancelText:t("modals:unableToSaveMatch.continueWithoutSaving"),variant:"primary",confirmDisabled:l,cancelDisabled:l}),(0,Ts.jsx)(qd,{isOpen:X,onClose:()=>{Z(!1),Pe()},onAddPlayer:async e=>{if(Z(!1),Pe(),null!==k&&void 0!==k&&k.id){let t=a.currentMatchId;if(!t){const e=tl({teamConfig:a.teamConfig,selectedFormation:a.selectedFormation,periods:a.numPeriods,periodDurationMinutes:a.periodDurationMinutes,opponentTeam:a.opponentTeam,captainId:a.captainId,matchType:a.matchType,venueType:a.venueType},k.id),n=a.selectedSquadIds.length>0?a.allPlayers:[],r=await Ko(e,n,a.selectedSquadIds);if(!r.success)return void console.error("Failed to create match for temporary player:",r.error);t=r.matchId,a.setCurrentMatchId(t),a.setMatchCreated(!0)}const n=await a.addTemporaryPlayer(e,{teamId:k.id,matchId:t});return void(null!==n&&void 0!==n&&n.success||console.error("Failed to create temporary player:",null===n||void 0===n?void 0:n.error))}await a.addTemporaryPlayer(e)}}),(0,Ts.jsx)(Bc,{isOpen:ee,onPrimary:()=>{Ee()},onSecondary:async()=>{await qe(()=>{Ee(),$e()})},onTertiary:()=>{var e,t;Ee();const a=(null===(e=window.history.state)||void 0===e?void 0:e.navigationLevel)||(null===(t=window.history.state)||void 0===t?void 0:t.modalLevel)||0;a>0?window.history.go(-(a+1)):window.history.length>1?window.history.back():window.close()},title:t("modals:newGame.title"),message:t("modals:newGame.message"),primaryText:t("modals:newGame.stayOnPage"),secondaryText:t("modals:newGame.yesStartNewGame"),tertiaryText:t("modals:newGame.leaveSportWizard"),primaryVariant:"accent",secondaryVariant:"primary",tertiaryVariant:"danger"}),(0,Ts.jsx)(Fv,{isOpen:Ie,onAbandon:Ue,onCancel:Be,isMatchRunning:Fe}),(0,Ts.jsx)(zv,{isOpen:f,onExtend:v,onDismiss:y,onSignOut:V,sessionExpiry:g,loading:x}),(0,Ts.jsx)(uh,{isOpen:M.isOpen,onClose:M.closeModal,initialMode:M.mode,initialEmail:M.initialEmail}),le&&de&&(0,Ts.jsx)(mu,{team:de,onClose:at,onSuccess:nt,isStandaloneMode:!0}),w&&(0,Ts.jsx)(Vv,{setView:m}),Se.invitationParams&&Se.invitationParams.hasInvitation&&(()=>{const e=Yv(S,Se.invitationParams);return"account_setup"===e.type||"sign_in_required"===e.type?(0,Ts.jsx)(Qv,{invitationParams:Se.invitationParams,onInvitationProcessed:je,onRequestSignIn:Te}):null})(),(0,Ts.jsx)($v,{isOpen:Ne.showInvitationNotifications,invitations:Ne.pendingInvitations,onClose:()=>{},onInvitationProcessed:_e}),(0,Ts.jsx)(Bv,{isOpen:re,onClose:tt})]})}const uy=function(){return(0,Ts.jsx)(_s,{children:(0,Ts.jsx)(yi,{children:(0,Ts.jsxs)(Rl,{children:[(0,Ts.jsx)(Gv,{}),(0,Ts.jsx)(sc,{children:(0,Ts.jsx)(dy,{})})]})})})};t.createRoot(document.getElementById("root")).render((0,Ts.jsx)(uy,{}))})()})();
//# sourceMappingURL=main.22bbc86e.js.map